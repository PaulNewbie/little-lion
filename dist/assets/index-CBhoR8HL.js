(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function Fx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var zv={exports:{}},Ld={};var ZE;function DO(){if(ZE)return Ld;ZE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,o){var u=null;if(o!==void 0&&(u=""+o),i.key!==void 0&&(u=""+i.key),"key"in i){o={};for(var h in i)h!=="key"&&(o[h]=i[h])}else o=i;return i=o.ref,{$$typeof:n,type:s,key:u,ref:i!==void 0?i:null,props:o}}return Ld.Fragment=e,Ld.jsx=t,Ld.jsxs=t,Ld}var e1;function OO(){return e1||(e1=1,zv.exports=DO()),zv.exports}var l=OO(),qv={exports:{}},Ve={};var t1;function PO(){if(t1)return Ve;t1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),b=Symbol.iterator;function S(M){return M===null||typeof M!="object"?null:(M=b&&M[b]||M["@@iterator"],typeof M=="function"?M:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,C={};function L(M,W,H){this.props=M,this.context=W,this.refs=C,this.updater=H||w}L.prototype.isReactComponent={},L.prototype.setState=function(M,W){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,W,"setState")},L.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function z(){}z.prototype=L.prototype;function U(M,W,H){this.props=M,this.context=W,this.refs=C,this.updater=H||w}var F=U.prototype=new z;F.constructor=U,A(F,L.prototype),F.isPureReactComponent=!0;var K=Array.isArray;function Z(){}var j={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function R(M,W,H){var ce=H.ref;return{$$typeof:n,type:M,key:W,ref:ce!==void 0?ce:null,props:H}}function O(M,W){return R(M.type,W,M.props)}function V(M){return typeof M=="object"&&M!==null&&M.$$typeof===n}function B(M){var W={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(H){return W[H]})}var k=/\/+/g;function fe(M,W){return typeof M=="object"&&M!==null&&M.key!=null?B(""+M.key):W.toString(36)}function me(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(Z,Z):(M.status="pending",M.then(function(W){M.status==="pending"&&(M.status="fulfilled",M.value=W)},function(W){M.status==="pending"&&(M.status="rejected",M.reason=W)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function G(M,W,H,ce,de){var we=typeof M;(we==="undefined"||we==="boolean")&&(M=null);var Pe=!1;if(M===null)Pe=!0;else switch(we){case"bigint":case"string":case"number":Pe=!0;break;case"object":switch(M.$$typeof){case n:case e:Pe=!0;break;case g:return Pe=M._init,G(Pe(M._payload),W,H,ce,de)}}if(Pe)return de=de(M),Pe=ce===""?"."+fe(M,0):ce,K(de)?(H="",Pe!=null&&(H=Pe.replace(k,"$&/")+"/"),G(de,W,H,"",function(Rn){return Rn})):de!=null&&(V(de)&&(de=O(de,H+(de.key==null||M&&M.key===de.key?"":(""+de.key).replace(k,"$&/")+"/")+Pe)),W.push(de)),1;Pe=0;var tt=ce===""?".":ce+":";if(K(M))for(var He=0;He<M.length;He++)ce=M[He],we=tt+fe(ce,He),Pe+=G(ce,W,H,we,de);else if(He=S(M),typeof He=="function")for(M=He.call(M),He=0;!(ce=M.next()).done;)ce=ce.value,we=tt+fe(ce,He++),Pe+=G(ce,W,H,we,de);else if(we==="object"){if(typeof M.then=="function")return G(me(M),W,H,ce,de);throw W=String(M),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return Pe}function ne(M,W,H){if(M==null)return M;var ce=[],de=0;return G(M,ce,"","",function(we){return W.call(H,we,de++)}),ce}function Y(M){if(M._status===-1){var W=M._result;W=W(),W.then(function(H){(M._status===0||M._status===-1)&&(M._status=1,M._result=H)},function(H){(M._status===0||M._status===-1)&&(M._status=2,M._result=H)}),M._status===-1&&(M._status=0,M._result=W)}if(M._status===1)return M._result.default;throw M._result}var ge=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},le={map:ne,forEach:function(M,W,H){ne(M,function(){W.apply(this,arguments)},H)},count:function(M){var W=0;return ne(M,function(){W++}),W},toArray:function(M){return ne(M,function(W){return W})||[]},only:function(M){if(!V(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Ve.Activity=x,Ve.Children=le,Ve.Component=L,Ve.Fragment=t,Ve.Profiler=i,Ve.PureComponent=U,Ve.StrictMode=s,Ve.Suspense=f,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(M){return j.H.useMemoCache(M)}},Ve.cache=function(M){return function(){return M.apply(null,arguments)}},Ve.cacheSignal=function(){return null},Ve.cloneElement=function(M,W,H){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var ce=A({},M.props),de=M.key;if(W!=null)for(we in W.key!==void 0&&(de=""+W.key),W)!N.call(W,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&W.ref===void 0||(ce[we]=W[we]);var we=arguments.length-2;if(we===1)ce.children=H;else if(1<we){for(var Pe=Array(we),tt=0;tt<we;tt++)Pe[tt]=arguments[tt+2];ce.children=Pe}return R(M.type,de,ce)},Ve.createContext=function(M){return M={$$typeof:u,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:o,_context:M},M},Ve.createElement=function(M,W,H){var ce,de={},we=null;if(W!=null)for(ce in W.key!==void 0&&(we=""+W.key),W)N.call(W,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(de[ce]=W[ce]);var Pe=arguments.length-2;if(Pe===1)de.children=H;else if(1<Pe){for(var tt=Array(Pe),He=0;He<Pe;He++)tt[He]=arguments[He+2];de.children=tt}if(M&&M.defaultProps)for(ce in Pe=M.defaultProps,Pe)de[ce]===void 0&&(de[ce]=Pe[ce]);return R(M,we,de)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(M){return{$$typeof:h,render:M}},Ve.isValidElement=V,Ve.lazy=function(M){return{$$typeof:g,_payload:{_status:-1,_result:M},_init:Y}},Ve.memo=function(M,W){return{$$typeof:p,type:M,compare:W===void 0?null:W}},Ve.startTransition=function(M){var W=j.T,H={};j.T=H;try{var ce=M(),de=j.S;de!==null&&de(H,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(Z,ge)}catch(we){ge(we)}finally{W!==null&&H.types!==null&&(W.types=H.types),j.T=W}},Ve.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Ve.use=function(M){return j.H.use(M)},Ve.useActionState=function(M,W,H){return j.H.useActionState(M,W,H)},Ve.useCallback=function(M,W){return j.H.useCallback(M,W)},Ve.useContext=function(M){return j.H.useContext(M)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(M,W){return j.H.useDeferredValue(M,W)},Ve.useEffect=function(M,W){return j.H.useEffect(M,W)},Ve.useEffectEvent=function(M){return j.H.useEffectEvent(M)},Ve.useId=function(){return j.H.useId()},Ve.useImperativeHandle=function(M,W,H){return j.H.useImperativeHandle(M,W,H)},Ve.useInsertionEffect=function(M,W){return j.H.useInsertionEffect(M,W)},Ve.useLayoutEffect=function(M,W){return j.H.useLayoutEffect(M,W)},Ve.useMemo=function(M,W){return j.H.useMemo(M,W)},Ve.useOptimistic=function(M,W){return j.H.useOptimistic(M,W)},Ve.useReducer=function(M,W,H){return j.H.useReducer(M,W,H)},Ve.useRef=function(M){return j.H.useRef(M)},Ve.useState=function(M){return j.H.useState(M)},Ve.useSyncExternalStore=function(M,W,H){return j.H.useSyncExternalStore(M,W,H)},Ve.useTransition=function(){return j.H.useTransition()},Ve.version="19.2.1",Ve}var n1;function zx(){return n1||(n1=1,qv.exports=PO()),qv.exports}var I=zx();const rn=Fx(I);var Hv={exports:{}},Vd={},Gv={exports:{}},$v={};var s1;function kO(){return s1||(s1=1,(function(n){function e(G,ne){var Y=G.length;G.push(ne);e:for(;0<Y;){var ge=Y-1>>>1,le=G[ge];if(0<i(le,ne))G[ge]=ne,G[Y]=le,Y=ge;else break e}}function t(G){return G.length===0?null:G[0]}function s(G){if(G.length===0)return null;var ne=G[0],Y=G.pop();if(Y!==ne){G[0]=Y;e:for(var ge=0,le=G.length,M=le>>>1;ge<M;){var W=2*(ge+1)-1,H=G[W],ce=W+1,de=G[ce];if(0>i(H,Y))ce<le&&0>i(de,H)?(G[ge]=de,G[ce]=Y,ge=ce):(G[ge]=H,G[W]=Y,ge=W);else if(ce<le&&0>i(de,Y))G[ge]=de,G[ce]=Y,ge=ce;else break e}}return ne}function i(G,ne){var Y=G.sortIndex-ne.sortIndex;return Y!==0?Y:G.id-ne.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var u=Date,h=u.now();n.unstable_now=function(){return u.now()-h}}var f=[],p=[],g=1,x=null,b=3,S=!1,w=!1,A=!1,C=!1,L=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function F(G){for(var ne=t(p);ne!==null;){if(ne.callback===null)s(p);else if(ne.startTime<=G)s(p),ne.sortIndex=ne.expirationTime,e(f,ne);else break;ne=t(p)}}function K(G){if(A=!1,F(G),!w)if(t(f)!==null)w=!0,Z||(Z=!0,B());else{var ne=t(p);ne!==null&&me(K,ne.startTime-G)}}var Z=!1,j=-1,N=5,R=-1;function O(){return C?!0:!(n.unstable_now()-R<N)}function V(){if(C=!1,Z){var G=n.unstable_now();R=G;var ne=!0;try{e:{w=!1,A&&(A=!1,z(j),j=-1),S=!0;var Y=b;try{t:{for(F(G),x=t(f);x!==null&&!(x.expirationTime>G&&O());){var ge=x.callback;if(typeof ge=="function"){x.callback=null,b=x.priorityLevel;var le=ge(x.expirationTime<=G);if(G=n.unstable_now(),typeof le=="function"){x.callback=le,F(G),ne=!0;break t}x===t(f)&&s(f),F(G)}else s(f);x=t(f)}if(x!==null)ne=!0;else{var M=t(p);M!==null&&me(K,M.startTime-G),ne=!1}}break e}finally{x=null,b=Y,S=!1}ne=void 0}}finally{ne?B():Z=!1}}}var B;if(typeof U=="function")B=function(){U(V)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,fe=k.port2;k.port1.onmessage=V,B=function(){fe.postMessage(null)}}else B=function(){L(V,0)};function me(G,ne){j=L(function(){G(n.unstable_now())},ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(G){switch(b){case 1:case 2:case 3:var ne=3;break;default:ne=b}var Y=b;b=ne;try{return G()}finally{b=Y}},n.unstable_requestPaint=function(){C=!0},n.unstable_runWithPriority=function(G,ne){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var Y=b;b=G;try{return ne()}finally{b=Y}},n.unstable_scheduleCallback=function(G,ne,Y){var ge=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ge+Y:ge):Y=ge,G){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Y+le,G={id:g++,callback:ne,priorityLevel:G,startTime:Y,expirationTime:le,sortIndex:-1},Y>ge?(G.sortIndex=Y,e(p,G),t(f)===null&&G===t(p)&&(A?(z(j),j=-1):A=!0,me(K,Y-ge))):(G.sortIndex=le,e(f,G),w||S||(w=!0,Z||(Z=!0,B()))),G},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(G){var ne=b;return function(){var Y=b;b=ne;try{return G.apply(this,arguments)}finally{b=Y}}}})($v)),$v}var r1;function MO(){return r1||(r1=1,Gv.exports=kO()),Gv.exports}var Kv={exports:{}},ts={};var i1;function LO(){if(i1)return ts;i1=1;var n=zx();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(f,p,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:f,containerInfo:p,implementation:g}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ts.createPortal=function(f,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(f,p,null,g)},ts.flushSync=function(f){var p=u.T,g=s.p;try{if(u.T=null,s.p=2,f)return f()}finally{u.T=p,s.p=g,s.d.f()}},ts.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,s.d.C(f,p))},ts.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},ts.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var g=p.as,x=h(g,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?s.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:x,integrity:b,fetchPriority:S}):g==="script"&&s.d.X(f,{crossOrigin:x,integrity:b,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ts.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=h(p.as,p.crossOrigin);s.d.M(f,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&s.d.M(f)},ts.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,x=h(g,p.crossOrigin);s.d.L(f,g,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ts.preloadModule=function(f,p){if(typeof f=="string")if(p){var g=h(p.as,p.crossOrigin);s.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else s.d.m(f)},ts.requestFormReset=function(f){s.d.r(f)},ts.unstable_batchedUpdates=function(f,p){return f(p)},ts.useFormState=function(f,p,g){return u.H.useFormState(f,p,g)},ts.useFormStatus=function(){return u.H.useHostTransitionStatus()},ts.version="19.2.1",ts}var a1;function VO(){if(a1)return Kv.exports;a1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Kv.exports=LO(),Kv.exports}var o1;function UO(){if(o1)return Vd;o1=1;var n=MO(),e=zx(),t=VO();function s(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,c=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(c=a.return),r=a.return;while(r)}return a.tag===3?c:null}function u(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function f(r){if(o(r)!==r)throw Error(s(188))}function p(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(s(188));return a!==r?null:r}for(var c=r,d=a;;){var y=c.return;if(y===null)break;var v=y.alternate;if(v===null){if(d=y.return,d!==null){c=d;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===c)return f(y),r;if(v===d)return f(y),a;v=v.sibling}throw Error(s(188))}if(c.return!==d.return)c=y,d=v;else{for(var E=!1,D=y.child;D;){if(D===c){E=!0,c=y,d=v;break}if(D===d){E=!0,d=y,c=v;break}D=D.sibling}if(!E){for(D=v.child;D;){if(D===c){E=!0,c=v,d=y;break}if(D===d){E=!0,d=v,c=y;break}D=D.sibling}if(!E)throw Error(s(189))}}if(c.alternate!==d)throw Error(s(190))}if(c.tag!==3)throw Error(s(188));return c.stateNode.current===c?r:a}function g(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=g(r),a!==null)return a;r=r.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),U=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function B(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var k=Symbol.for("react.client.reference");function fe(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===k?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case L:return"Profiler";case C:return"StrictMode";case K:return"Suspense";case Z:return"SuspenseList";case R:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case U:return r.displayName||"Context";case z:return(r._context.displayName||"Context")+".Consumer";case F:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case j:return a=r.displayName||null,a!==null?a:fe(r.type)||"Memo";case N:a=r._payload,r=r._init;try{return fe(r(a))}catch{}}return null}var me=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},ge=[],le=-1;function M(r){return{current:r}}function W(r){0>le||(r.current=ge[le],ge[le]=null,le--)}function H(r,a){le++,ge[le]=r.current,r.current=a}var ce=M(null),de=M(null),we=M(null),Pe=M(null);function tt(r,a){switch(H(we,a),H(de,r),H(ce,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?SE(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=SE(a),r=wE(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}W(ce),H(ce,r)}function He(){W(ce),W(de),W(we)}function Rn(r){r.memoizedState!==null&&H(Pe,r);var a=ce.current,c=wE(a,r.type);a!==c&&(H(de,r),H(ce,c))}function us(r){de.current===r&&(W(ce),W(de)),Pe.current===r&&(W(Pe),Od._currentValue=Y)}var ys,rr;function ot(r){if(ys===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);ys=a&&a[1]||"",rr=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ys+r+rr}var vs=!1;function Zt(r,a){if(!r||vs)return"";vs=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(oe){var se=oe}Reflect.construct(r,[],pe)}else{try{pe.call()}catch(oe){se=oe}r.call(pe.prototype)}}else{try{throw Error()}catch(oe){se=oe}(pe=r())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(oe){if(oe&&se&&typeof oe.stack=="string")return[oe.stack,se.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),E=v[0],D=v[1];if(E&&D){var q=E.split(`
`),te=D.split(`
`);for(y=d=0;d<q.length&&!q[d].includes("DetermineComponentFrameRoot");)d++;for(;y<te.length&&!te[y].includes("DetermineComponentFrameRoot");)y++;if(d===q.length||y===te.length)for(d=q.length-1,y=te.length-1;1<=d&&0<=y&&q[d]!==te[y];)y--;for(;1<=d&&0<=y;d--,y--)if(q[d]!==te[y]){if(d!==1||y!==1)do if(d--,y--,0>y||q[d]!==te[y]){var ue=`
`+q[d].replace(" at new "," at ");return r.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",r.displayName)),ue}while(1<=d&&0<=y);break}}}finally{vs=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?ot(c):""}function ir(r,a){switch(r.tag){case 26:case 27:case 5:return ot(r.type);case 16:return ot("Lazy");case 13:return r.child!==a&&a!==null?ot("Suspense Fallback"):ot("Suspense");case 19:return ot("SuspenseList");case 0:case 15:return Zt(r.type,!1);case 11:return Zt(r.type.render,!1);case 1:return Zt(r.type,!0);case 31:return ot("Activity");default:return""}}function zr(r){try{var a="",c=null;do a+=ir(r,c),c=r,r=r.return;while(r);return a}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Pt=Object.prototype.hasOwnProperty,Kt=n.unstable_scheduleCallback,xs=n.unstable_cancelCallback,Se=n.unstable_shouldYield,It=n.unstable_requestPaint,Bt=n.unstable_now,Ln=n.unstable_getCurrentPriorityLevel,Vs=n.unstable_ImmediatePriority,bs=n.unstable_UserBlockingPriority,Us=n.unstable_NormalPriority,_s=n.unstable_LowPriority,Io=n.unstable_IdlePriority,Ro=n.log,Kl=n.unstable_setDisableYieldValue,Jn=null,vn=null;function Ss(r){if(typeof Ro=="function"&&Kl(r),vn&&typeof vn.setStrictMode=="function")try{vn.setStrictMode(Jn,r)}catch{}}var Ft=Math.clz32?Math.clz32:Ql,jo=Math.log,qr=Math.LN2;function Ql(r){return r>>>=0,r===0?32:31-(jo(r)/qr|0)|0}var Bs=256,Ai=262144,Qt=4194304;function kt(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Mt(r,a,c){var d=r.pendingLanes;if(d===0)return 0;var y=0,v=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var D=d&134217727;return D!==0?(d=D&~v,d!==0?y=kt(d):(E&=D,E!==0?y=kt(E):c||(c=D&~r,c!==0&&(y=kt(c))))):(D=d&~v,D!==0?y=kt(D):E!==0?y=kt(E):c||(c=d&~r,c!==0&&(y=kt(c)))),y===0?0:a!==0&&a!==y&&(a&v)===0&&(v=y&-y,c=a&-a,v>=c||v===32&&(c&4194048)!==0)?a:y}function Zn(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function Rt(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ds(){var r=Qt;return Qt<<=1,(Qt&62914560)===0&&(Qt=4194304),r}function ar(r){for(var a=[],c=0;31>c;c++)a.push(r);return a}function wr(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Yl(r,a,c,d,y,v){var E=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var D=r.entanglements,q=r.expirationTimes,te=r.hiddenUpdates;for(c=E&~c;0<c;){var ue=31-Ft(c),pe=1<<ue;D[ue]=0,q[ue]=-1;var se=te[ue];if(se!==null)for(te[ue]=null,ue=0;ue<se.length;ue++){var oe=se[ue];oe!==null&&(oe.lane&=-536870913)}c&=~pe}d!==0&&Hr(r,d,0),v!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=v&~(E&~a))}function Hr(r,a,c){r.pendingLanes|=a,r.suspendedLanes&=~a;var d=31-Ft(a);r.entangledLanes|=a,r.entanglements[d]=r.entanglements[d]|1073741824|c&261930}function Ci(r,a){var c=r.entangledLanes|=a;for(r=r.entanglements;c;){var d=31-Ft(c),y=1<<d;y&a|r[d]&a&&(r[d]|=a),c&=~y}}function Gr(r,a){var c=a&-a;return c=(c&42)!==0?1:Er(c),(c&(r.suspendedLanes|a))!==0?0:c}function Er(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Fs(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function da(){var r=ne.p;return r!==0?r:(r=window.event,r===void 0?32:$E(r.type))}function zs(r,a){var c=ne.p;try{return ne.p=r,a()}finally{ne.p=c}}var hs=Math.random().toString(36).slice(2),Yt="__reactFiber$"+hs,xn="__reactProps$"+hs,or="__reactContainer$"+hs,Ue="__reactEvents$"+hs,Dt="__reactListeners$"+hs,Lt="__reactHandles$"+hs,es="__reactResources$"+hs,en="__reactMarker$"+hs;function $r(r){delete r[Yt],delete r[xn],delete r[Ue],delete r[Dt],delete r[Lt]}function lr(r){var a=r[Yt];if(a)return a;for(var c=r.parentNode;c;){if(a=c[or]||c[Yt]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(r=RE(r);r!==null;){if(c=r[Yt])return c;r=RE(r)}return a}r=c,c=r.parentNode}return null}function ws(r){if(r=r[Yt]||r[or]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function qs(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(s(33))}function Kr(r){var a=r[es];return a||(a=r[es]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function bn(r){r[en]=!0}var Bu=new Set,Fu={};function Qr(r,a){Yr(r,a),Yr(r+"Capture",a)}function Yr(r,a){for(Fu[r]=a,r=0;r<a.length;r++)Bu.add(a[r])}var zu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qu={},Hu={};function cf(r){return Pt.call(Hu,r)?!0:Pt.call(qu,r)?!1:zu.test(r)?Hu[r]=!0:(qu[r]=!0,!1)}function Wl(r,a,c){if(cf(a))if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+c)}}function Hs(r,a,c){if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+c)}}function _n(r,a,c,d){if(d===null)r.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(a,c,""+d)}}function Vn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ha(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Gu(r,a,c){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,v=d.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return y.call(this)},set:function(E){c=""+E,v.call(this,E)}}),Object.defineProperty(r,a,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(E){c=""+E},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function mt(r){if(!r._valueTracker){var a=ha(r)?"checked":"value";r._valueTracker=Gu(r,a,""+r[a])}}function Do(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var c=a.getValue(),d="";return r&&(d=ha(r)?r.checked?"true":"false":r.value),r=d,r!==c?(a.setValue(r),!0):!1}function Wr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Oo=/[\n"\\]/g;function Es(r){return r.replace(Oo,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Xl(r,a,c,d,y,v,E,D){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),a!=null?E==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Vn(a)):r.value!==""+Vn(a)&&(r.value=""+Vn(a)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),a!=null?$u(r,E,Vn(a)):c!=null?$u(r,E,Vn(c)):d!=null&&r.removeAttribute("value"),y==null&&v!=null&&(r.defaultChecked=!!v),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?r.name=""+Vn(D):r.removeAttribute("name")}function uf(r,a,c,d,y,v,E,D){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(r.type=v),a!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||a!=null)){mt(r);return}c=c!=null?""+Vn(c):"",a=a!=null?""+Vn(a):c,D||a===r.value||(r.value=a),r.defaultValue=a}d=d??y,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=D?r.checked:!!d,r.defaultChecked=!!d,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),mt(r)}function $u(r,a,c){a==="number"&&Wr(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function fa(r,a,c,d){if(r=r.options,a){a={};for(var y=0;y<c.length;y++)a["$"+c[y]]=!0;for(c=0;c<r.length;c++)y=a.hasOwnProperty("$"+r[c].value),r[c].selected!==y&&(r[c].selected=y),y&&d&&(r[c].defaultSelected=!0)}else{for(c=""+Vn(c),a=null,y=0;y<r.length;y++){if(r[y].value===c){r[y].selected=!0,d&&(r[y].defaultSelected=!0);return}a!==null||r[y].disabled||(a=r[y])}a!==null&&(a.selected=!0)}}function df(r,a,c){if(a!=null&&(a=""+Vn(a),a!==r.value&&(r.value=a),c==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=c!=null?""+Vn(c):""}function pa(r,a,c,d){if(a==null){if(d!=null){if(c!=null)throw Error(s(92));if(me(d)){if(1<d.length)throw Error(s(93));d=d[0]}c=d}c==null&&(c=""),a=c}c=Vn(a),r.defaultValue=c,d=r.textContent,d===c&&d!==""&&d!==null&&(r.value=d),mt(r)}function Ts(r,a){if(a){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=a;return}}r.textContent=a}var hf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ku(r,a,c){var d=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":d?r.setProperty(a,c):typeof c!="number"||c===0||hf.has(a)?a==="float"?r.cssFloat=c:r[a]=(""+c).trim():r[a]=c+"px"}function Qu(r,a,c){if(a!=null&&typeof a!="object")throw Error(s(62));if(r=r.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var y in a)d=a[y],a.hasOwnProperty(y)&&c[y]!==d&&Ku(r,y,d)}else for(var v in a)a.hasOwnProperty(v)&&Ku(r,v,a[v])}function Jl(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ff=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ma=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zl(r){return ma.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Tr(){}var Yu=null;function cr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ga=null,Xr=null;function Po(r){var a=ws(r);if(a&&(r=a.stateNode)){var c=r[xn]||null;e:switch(r=a.stateNode,a.type){case"input":if(Xl(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Es(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var d=c[a];if(d!==r&&d.form===r.form){var y=d[xn]||null;if(!y)throw Error(s(90));Xl(d,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(a=0;a<c.length;a++)d=c[a],d.form===r.form&&Do(d)}break e;case"textarea":df(r,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&fa(r,!!c.multiple,a,!1)}}}var ec=!1;function ya(r,a,c){if(ec)return r(a,c);ec=!0;try{var d=r(a);return d}finally{if(ec=!1,(ga!==null||Xr!==null)&&(ap(),ga&&(a=ga,r=Xr,Xr=ga=null,Po(a),r)))for(a=0;a<r.length;a++)Po(r[a])}}function Ar(r,a){var c=r.stateNode;if(c===null)return null;var d=c[xn]||null;if(d===null)return null;c=d[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(s(231,a,typeof c));return c}var ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ko=!1;if(ur)try{var Et={};Object.defineProperty(Et,"passive",{get:function(){ko=!0}}),window.addEventListener("test",Et,Et),window.removeEventListener("test",Et,Et)}catch{ko=!1}var Jr=null,Wu=null,Mo=null;function Xu(){if(Mo)return Mo;var r,a=Wu,c=a.length,d,y="value"in Jr?Jr.value:Jr.textContent,v=y.length;for(r=0;r<c&&a[r]===y[r];r++);var E=c-r;for(d=1;d<=E&&a[c-d]===y[v-d];d++);return Mo=y.slice(r,1<d?1-d:void 0)}function Lo(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Ni(){return!0}function Cr(){return!1}function qn(r){function a(c,d,y,v,E){this._reactName=c,this._targetInst=y,this.type=d,this.nativeEvent=v,this.target=E,this.currentTarget=null;for(var D in r)r.hasOwnProperty(D)&&(c=r[D],this[D]=c?c(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ni:Cr,this.isPropagationStopped=Cr,this}return x(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ni)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ni)},persist:function(){},isPersistent:Ni}),a}var Ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zr=qn(Ii),va=x({},Ii,{view:0,detail:0}),Ju=qn(va),xa,tc,ei,nc=x({},va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ba,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ei&&(ei&&r.type==="mousemove"?(xa=r.screenX-ei.screenX,tc=r.screenY-ei.screenY):tc=xa=0,ei=r),xa)},movementY:function(r){return"movementY"in r?r.movementY:tc}}),Zu=qn(nc),Vo=x({},nc,{dataTransfer:0}),pf=qn(Vo),mf=x({},va,{relatedTarget:0}),Uo=qn(mf),ed=x({},Ii,{animationName:0,elapsedTime:0,pseudoElement:0}),gf=qn(ed),sc=x({},Ii,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),yf=qn(sc),vf=x({},Ii,{data:0}),ti=qn(vf),xf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_f={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sf(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=_f[r])?!!a[r]:!1}function ba(){return Sf}var fs=x({},va,{key:function(r){if(r.key){var a=xf[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Lo(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?bf[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ba,charCode:function(r){return r.type==="keypress"?Lo(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Lo(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),wf=qn(fs),Ef=x({},nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ri=qn(Ef),m=x({},va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ba}),_=qn(m),T=x({},Ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),P=qn(T),J=x({},nc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),re=qn(J),xe=x({},Ii,{newState:0,oldState:0}),Be=qn(xe),cn=[9,13,27,32],ht=ur&&"CompositionEvent"in window,zt=null;ur&&"documentMode"in document&&(zt=document.documentMode);var dr=ur&&"TextEvent"in window&&!zt,ni=ur&&(!ht||zt&&8<zt&&11>=zt),Nr=" ",Ir=!1;function Bo(r,a){switch(r){case"keyup":return cn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ic=!1;function nD(r,a){switch(r){case"compositionend":return rc(a);case"keypress":return a.which!==32?null:(Ir=!0,Nr);case"textInput":return r=a.data,r===Nr&&Ir?null:r;default:return null}}function sD(r,a){if(ic)return r==="compositionend"||!ht&&Bo(r,a)?(r=Xu(),Mo=Wu=Jr=null,ic=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return ni&&a.locale!=="ko"?null:a.data;default:return null}}var rD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function O_(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!rD[r.type]:a==="textarea"}function P_(r,a,c,d){ga?Xr?Xr.push(d):Xr=[d]:ga=d,a=fp(a,"onChange"),0<a.length&&(c=new Zr("onChange","change",null,c,d),r.push({event:c,listeners:a}))}var td=null,nd=null;function iD(r){gE(r,0)}function Tf(r){var a=qs(r);if(Do(a))return r}function k_(r,a){if(r==="change")return a}var M_=!1;if(ur){var Yg;if(ur){var Wg="oninput"in document;if(!Wg){var L_=document.createElement("div");L_.setAttribute("oninput","return;"),Wg=typeof L_.oninput=="function"}Yg=Wg}else Yg=!1;M_=Yg&&(!document.documentMode||9<document.documentMode)}function V_(){td&&(td.detachEvent("onpropertychange",U_),nd=td=null)}function U_(r){if(r.propertyName==="value"&&Tf(nd)){var a=[];P_(a,nd,r,cr(r)),ya(iD,a)}}function aD(r,a,c){r==="focusin"?(V_(),td=a,nd=c,td.attachEvent("onpropertychange",U_)):r==="focusout"&&V_()}function oD(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Tf(nd)}function lD(r,a){if(r==="click")return Tf(a)}function cD(r,a){if(r==="input"||r==="change")return Tf(a)}function uD(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Gs=typeof Object.is=="function"?Object.is:uD;function sd(r,a){if(Gs(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var c=Object.keys(r),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var y=c[d];if(!Pt.call(a,y)||!Gs(r[y],a[y]))return!1}return!0}function B_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function F_(r,a){var c=B_(r);r=0;for(var d;c;){if(c.nodeType===3){if(d=r+c.textContent.length,r<=a&&d>=a)return{node:c,offset:a-r};r=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=B_(c)}}function z_(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?z_(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function q_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Wr(r.document);a instanceof r.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)r=a.contentWindow;else break;a=Wr(r.document)}return a}function Xg(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var dD=ur&&"documentMode"in document&&11>=document.documentMode,ac=null,Jg=null,rd=null,Zg=!1;function H_(r,a,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Zg||ac==null||ac!==Wr(d)||(d=ac,"selectionStart"in d&&Xg(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),rd&&sd(rd,d)||(rd=d,d=fp(Jg,"onSelect"),0<d.length&&(a=new Zr("onSelect","select",null,a,c),r.push({event:a,listeners:d}),a.target=ac)))}function Fo(r,a){var c={};return c[r.toLowerCase()]=a.toLowerCase(),c["Webkit"+r]="webkit"+a,c["Moz"+r]="moz"+a,c}var oc={animationend:Fo("Animation","AnimationEnd"),animationiteration:Fo("Animation","AnimationIteration"),animationstart:Fo("Animation","AnimationStart"),transitionrun:Fo("Transition","TransitionRun"),transitionstart:Fo("Transition","TransitionStart"),transitioncancel:Fo("Transition","TransitionCancel"),transitionend:Fo("Transition","TransitionEnd")},ey={},G_={};ur&&(G_=document.createElement("div").style,"AnimationEvent"in window||(delete oc.animationend.animation,delete oc.animationiteration.animation,delete oc.animationstart.animation),"TransitionEvent"in window||delete oc.transitionend.transition);function zo(r){if(ey[r])return ey[r];if(!oc[r])return r;var a=oc[r],c;for(c in a)if(a.hasOwnProperty(c)&&c in G_)return ey[r]=a[c];return r}var $_=zo("animationend"),K_=zo("animationiteration"),Q_=zo("animationstart"),hD=zo("transitionrun"),fD=zo("transitionstart"),pD=zo("transitioncancel"),Y_=zo("transitionend"),W_=new Map,ty="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ty.push("scrollEnd");function Rr(r,a){W_.set(r,a),Qr(a,[r])}var Af=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},hr=[],lc=0,ny=0;function Cf(){for(var r=lc,a=ny=lc=0;a<r;){var c=hr[a];hr[a++]=null;var d=hr[a];hr[a++]=null;var y=hr[a];hr[a++]=null;var v=hr[a];if(hr[a++]=null,d!==null&&y!==null){var E=d.pending;E===null?y.next=y:(y.next=E.next,E.next=y),d.pending=y}v!==0&&X_(c,y,v)}}function Nf(r,a,c,d){hr[lc++]=r,hr[lc++]=a,hr[lc++]=c,hr[lc++]=d,ny|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function sy(r,a,c,d){return Nf(r,a,c,d),If(r)}function qo(r,a){return Nf(r,null,null,a),If(r)}function X_(r,a,c){r.lanes|=c;var d=r.alternate;d!==null&&(d.lanes|=c);for(var y=!1,v=r.return;v!==null;)v.childLanes|=c,d=v.alternate,d!==null&&(d.childLanes|=c),v.tag===22&&(r=v.stateNode,r===null||r._visibility&1||(y=!0)),r=v,v=v.return;return r.tag===3?(v=r.stateNode,y&&a!==null&&(y=31-Ft(c),r=v.hiddenUpdates,d=r[y],d===null?r[y]=[a]:d.push(a),a.lane=c|536870912),v):null}function If(r){if(50<Ad)throw Ad=0,hv=null,Error(s(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var cc={};function mD(r,a,c,d){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $s(r,a,c,d){return new mD(r,a,c,d)}function ry(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ji(r,a){var c=r.alternate;return c===null?(c=$s(r.tag,a,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=a,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,a=r.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function J_(r,a){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,a=c.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function Rf(r,a,c,d,y,v){var E=0;if(d=r,typeof r=="function")ry(r)&&(E=1);else if(typeof r=="string")E=bO(r,c,ce.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case R:return r=$s(31,c,a,y),r.elementType=R,r.lanes=v,r;case A:return Ho(c.children,y,v,a);case C:E=8,y|=24;break;case L:return r=$s(12,c,a,y|2),r.elementType=L,r.lanes=v,r;case K:return r=$s(13,c,a,y),r.elementType=K,r.lanes=v,r;case Z:return r=$s(19,c,a,y),r.elementType=Z,r.lanes=v,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case U:E=10;break e;case z:E=9;break e;case F:E=11;break e;case j:E=14;break e;case N:E=16,d=null;break e}E=29,c=Error(s(130,r===null?"null":typeof r,"")),d=null}return a=$s(E,c,a,y),a.elementType=r,a.type=d,a.lanes=v,a}function Ho(r,a,c,d){return r=$s(7,r,d,a),r.lanes=c,r}function iy(r,a,c){return r=$s(6,r,null,a),r.lanes=c,r}function Z_(r){var a=$s(18,null,null,0);return a.stateNode=r,a}function ay(r,a,c){return a=$s(4,r.children!==null?r.children:[],r.key,a),a.lanes=c,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var eS=new WeakMap;function fr(r,a){if(typeof r=="object"&&r!==null){var c=eS.get(r);return c!==void 0?c:(a={value:r,source:a,stack:zr(a)},eS.set(r,a),a)}return{value:r,source:a,stack:zr(a)}}var uc=[],dc=0,jf=null,id=0,pr=[],mr=0,_a=null,si=1,ri="";function Di(r,a){uc[dc++]=id,uc[dc++]=jf,jf=r,id=a}function tS(r,a,c){pr[mr++]=si,pr[mr++]=ri,pr[mr++]=_a,_a=r;var d=si;r=ri;var y=32-Ft(d)-1;d&=~(1<<y),c+=1;var v=32-Ft(a)+y;if(30<v){var E=y-y%5;v=(d&(1<<E)-1).toString(32),d>>=E,y-=E,si=1<<32-Ft(a)+y|c<<y|d,ri=v+r}else si=1<<v|c<<y|d,ri=r}function oy(r){r.return!==null&&(Di(r,1),tS(r,1,0))}function ly(r){for(;r===jf;)jf=uc[--dc],uc[dc]=null,id=uc[--dc],uc[dc]=null;for(;r===_a;)_a=pr[--mr],pr[mr]=null,ri=pr[--mr],pr[mr]=null,si=pr[--mr],pr[mr]=null}function nS(r,a){pr[mr++]=si,pr[mr++]=ri,pr[mr++]=_a,si=a.id,ri=a.overflow,_a=r}var Hn=null,Vt=null,nt=!1,Sa=null,gr=!1,cy=Error(s(519));function wa(r){var a=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ad(fr(a,r)),cy}function sS(r){var a=r.stateNode,c=r.type,d=r.memoizedProps;switch(a[Yt]=r,a[xn]=d,c){case"dialog":Ke("cancel",a),Ke("close",a);break;case"iframe":case"object":case"embed":Ke("load",a);break;case"video":case"audio":for(c=0;c<Nd.length;c++)Ke(Nd[c],a);break;case"source":Ke("error",a);break;case"img":case"image":case"link":Ke("error",a),Ke("load",a);break;case"details":Ke("toggle",a);break;case"input":Ke("invalid",a),uf(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ke("invalid",a);break;case"textarea":Ke("invalid",a),pa(a,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||d.suppressHydrationWarning===!0||bE(a.textContent,c)?(d.popover!=null&&(Ke("beforetoggle",a),Ke("toggle",a)),d.onScroll!=null&&Ke("scroll",a),d.onScrollEnd!=null&&Ke("scrollend",a),d.onClick!=null&&(a.onclick=Tr),a=!0):a=!1,a||wa(r,!0)}function rS(r){for(Hn=r.return;Hn;)switch(Hn.tag){case 5:case 31:case 13:gr=!1;return;case 27:case 3:gr=!0;return;default:Hn=Hn.return}}function hc(r){if(r!==Hn)return!1;if(!nt)return rS(r),nt=!0,!1;var a=r.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||Cv(r.type,r.memoizedProps)),c=!c),c&&Vt&&wa(r),rS(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));Vt=IE(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));Vt=IE(r)}else a===27?(a=Vt,La(r.type)?(r=Dv,Dv=null,Vt=r):Vt=a):Vt=Hn?vr(r.stateNode.nextSibling):null;return!0}function Go(){Vt=Hn=null,nt=!1}function uy(){var r=Sa;return r!==null&&(Is===null?Is=r:Is.push.apply(Is,r),Sa=null),r}function ad(r){Sa===null?Sa=[r]:Sa.push(r)}var dy=M(null),$o=null,Oi=null;function Ea(r,a,c){H(dy,a._currentValue),a._currentValue=c}function Pi(r){r._currentValue=dy.current,W(dy)}function hy(r,a,c){for(;r!==null;){var d=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),r===c)break;r=r.return}}function fy(r,a,c,d){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var v=y.dependencies;if(v!==null){var E=y.child;v=v.firstContext;e:for(;v!==null;){var D=v;v=y;for(var q=0;q<a.length;q++)if(D.context===a[q]){v.lanes|=c,D=v.alternate,D!==null&&(D.lanes|=c),hy(v.return,c,r),d||(E=null);break e}v=D.next}}else if(y.tag===18){if(E=y.return,E===null)throw Error(s(341));E.lanes|=c,v=E.alternate,v!==null&&(v.lanes|=c),hy(E,c,r),E=null}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===r){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}}function fc(r,a,c,d){r=null;for(var y=a,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var E=y.alternate;if(E===null)throw Error(s(387));if(E=E.memoizedProps,E!==null){var D=y.type;Gs(y.pendingProps.value,E.value)||(r!==null?r.push(D):r=[D])}}else if(y===Pe.current){if(E=y.alternate,E===null)throw Error(s(387));E.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(Od):r=[Od])}y=y.return}r!==null&&fy(a,r,c,d),a.flags|=262144}function Df(r){for(r=r.firstContext;r!==null;){if(!Gs(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ko(r){$o=r,Oi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Gn(r){return iS($o,r)}function Of(r,a){return $o===null&&Ko(r),iS(r,a)}function iS(r,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},Oi===null){if(r===null)throw Error(s(308));Oi=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Oi=Oi.next=a;return c}var gD=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(c,d){r.push(d)}};this.abort=function(){a.aborted=!0,r.forEach(function(c){return c()})}},yD=n.unstable_scheduleCallback,vD=n.unstable_NormalPriority,Sn={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function py(){return{controller:new gD,data:new Map,refCount:0}}function od(r){r.refCount--,r.refCount===0&&yD(vD,function(){r.controller.abort()})}var ld=null,my=0,pc=0,mc=null;function xD(r,a){if(ld===null){var c=ld=[];my=0,pc=vv(),mc={status:"pending",value:void 0,then:function(d){c.push(d)}}}return my++,a.then(aS,aS),a}function aS(){if(--my===0&&ld!==null){mc!==null&&(mc.status="fulfilled");var r=ld;ld=null,pc=0,mc=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function bD(r,a){var c=[],d={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return r.then(function(){d.status="fulfilled",d.value=a;for(var y=0;y<c.length;y++)(0,c[y])(a)},function(y){for(d.status="rejected",d.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),d}var oS=G.S;G.S=function(r,a){Hw=Bt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&xD(r,a),oS!==null&&oS(r,a)};var Qo=M(null);function gy(){var r=Qo.current;return r!==null?r:jt.pooledCache}function Pf(r,a){a===null?H(Qo,Qo.current):H(Qo,a.pool)}function lS(){var r=gy();return r===null?null:{parent:Sn._currentValue,pool:r}}var gc=Error(s(460)),yy=Error(s(474)),kf=Error(s(542)),Mf={then:function(){}};function cS(r){return r=r.status,r==="fulfilled"||r==="rejected"}function uS(r,a,c){switch(c=r[c],c===void 0?r.push(a):c!==a&&(a.then(Tr,Tr),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,hS(r),r;default:if(typeof a.status=="string")a.then(Tr,Tr);else{if(r=jt,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=a,r.status="pending",r.then(function(d){if(a.status==="pending"){var y=a;y.status="fulfilled",y.value=d}},function(d){if(a.status==="pending"){var y=a;y.status="rejected",y.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,hS(r),r}throw Wo=a,gc}}function Yo(r){try{var a=r._init;return a(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Wo=c,gc):c}}var Wo=null;function dS(){if(Wo===null)throw Error(s(459));var r=Wo;return Wo=null,r}function hS(r){if(r===gc||r===kf)throw Error(s(483))}var yc=null,cd=0;function Lf(r){var a=cd;return cd+=1,yc===null&&(yc=[]),uS(yc,r,a)}function ud(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function Vf(r,a){throw a.$$typeof===b?Error(s(525)):(r=Object.prototype.toString.call(a),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function fS(r){function a(Q,$){if(r){var ee=Q.deletions;ee===null?(Q.deletions=[$],Q.flags|=16):ee.push($)}}function c(Q,$){if(!r)return null;for(;$!==null;)a(Q,$),$=$.sibling;return null}function d(Q){for(var $=new Map;Q!==null;)Q.key!==null?$.set(Q.key,Q):$.set(Q.index,Q),Q=Q.sibling;return $}function y(Q,$){return Q=ji(Q,$),Q.index=0,Q.sibling=null,Q}function v(Q,$,ee){return Q.index=ee,r?(ee=Q.alternate,ee!==null?(ee=ee.index,ee<$?(Q.flags|=67108866,$):ee):(Q.flags|=67108866,$)):(Q.flags|=1048576,$)}function E(Q){return r&&Q.alternate===null&&(Q.flags|=67108866),Q}function D(Q,$,ee,he){return $===null||$.tag!==6?($=iy(ee,Q.mode,he),$.return=Q,$):($=y($,ee),$.return=Q,$)}function q(Q,$,ee,he){var je=ee.type;return je===A?ue(Q,$,ee.props.children,he,ee.key):$!==null&&($.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===N&&Yo(je)===$.type)?($=y($,ee.props),ud($,ee),$.return=Q,$):($=Rf(ee.type,ee.key,ee.props,null,Q.mode,he),ud($,ee),$.return=Q,$)}function te(Q,$,ee,he){return $===null||$.tag!==4||$.stateNode.containerInfo!==ee.containerInfo||$.stateNode.implementation!==ee.implementation?($=ay(ee,Q.mode,he),$.return=Q,$):($=y($,ee.children||[]),$.return=Q,$)}function ue(Q,$,ee,he,je){return $===null||$.tag!==7?($=Ho(ee,Q.mode,he,je),$.return=Q,$):($=y($,ee),$.return=Q,$)}function pe(Q,$,ee){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=iy(""+$,Q.mode,ee),$.return=Q,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case S:return ee=Rf($.type,$.key,$.props,null,Q.mode,ee),ud(ee,$),ee.return=Q,ee;case w:return $=ay($,Q.mode,ee),$.return=Q,$;case N:return $=Yo($),pe(Q,$,ee)}if(me($)||B($))return $=Ho($,Q.mode,ee,null),$.return=Q,$;if(typeof $.then=="function")return pe(Q,Lf($),ee);if($.$$typeof===U)return pe(Q,Of(Q,$),ee);Vf(Q,$)}return null}function se(Q,$,ee,he){var je=$!==null?$.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return je!==null?null:D(Q,$,""+ee,he);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:return ee.key===je?q(Q,$,ee,he):null;case w:return ee.key===je?te(Q,$,ee,he):null;case N:return ee=Yo(ee),se(Q,$,ee,he)}if(me(ee)||B(ee))return je!==null?null:ue(Q,$,ee,he,null);if(typeof ee.then=="function")return se(Q,$,Lf(ee),he);if(ee.$$typeof===U)return se(Q,$,Of(Q,ee),he);Vf(Q,ee)}return null}function oe(Q,$,ee,he,je){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return Q=Q.get(ee)||null,D($,Q,""+he,je);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case S:return Q=Q.get(he.key===null?ee:he.key)||null,q($,Q,he,je);case w:return Q=Q.get(he.key===null?ee:he.key)||null,te($,Q,he,je);case N:return he=Yo(he),oe(Q,$,ee,he,je)}if(me(he)||B(he))return Q=Q.get(ee)||null,ue($,Q,he,je,null);if(typeof he.then=="function")return oe(Q,$,ee,Lf(he),je);if(he.$$typeof===U)return oe(Q,$,ee,Of($,he),je);Vf($,he)}return null}function Ae(Q,$,ee,he){for(var je=null,lt=null,Ne=$,qe=$=0,Je=null;Ne!==null&&qe<ee.length;qe++){Ne.index>qe?(Je=Ne,Ne=null):Je=Ne.sibling;var ct=se(Q,Ne,ee[qe],he);if(ct===null){Ne===null&&(Ne=Je);break}r&&Ne&&ct.alternate===null&&a(Q,Ne),$=v(ct,$,qe),lt===null?je=ct:lt.sibling=ct,lt=ct,Ne=Je}if(qe===ee.length)return c(Q,Ne),nt&&Di(Q,qe),je;if(Ne===null){for(;qe<ee.length;qe++)Ne=pe(Q,ee[qe],he),Ne!==null&&($=v(Ne,$,qe),lt===null?je=Ne:lt.sibling=Ne,lt=Ne);return nt&&Di(Q,qe),je}for(Ne=d(Ne);qe<ee.length;qe++)Je=oe(Ne,Q,qe,ee[qe],he),Je!==null&&(r&&Je.alternate!==null&&Ne.delete(Je.key===null?qe:Je.key),$=v(Je,$,qe),lt===null?je=Je:lt.sibling=Je,lt=Je);return r&&Ne.forEach(function(za){return a(Q,za)}),nt&&Di(Q,qe),je}function ke(Q,$,ee,he){if(ee==null)throw Error(s(151));for(var je=null,lt=null,Ne=$,qe=$=0,Je=null,ct=ee.next();Ne!==null&&!ct.done;qe++,ct=ee.next()){Ne.index>qe?(Je=Ne,Ne=null):Je=Ne.sibling;var za=se(Q,Ne,ct.value,he);if(za===null){Ne===null&&(Ne=Je);break}r&&Ne&&za.alternate===null&&a(Q,Ne),$=v(za,$,qe),lt===null?je=za:lt.sibling=za,lt=za,Ne=Je}if(ct.done)return c(Q,Ne),nt&&Di(Q,qe),je;if(Ne===null){for(;!ct.done;qe++,ct=ee.next())ct=pe(Q,ct.value,he),ct!==null&&($=v(ct,$,qe),lt===null?je=ct:lt.sibling=ct,lt=ct);return nt&&Di(Q,qe),je}for(Ne=d(Ne);!ct.done;qe++,ct=ee.next())ct=oe(Ne,Q,qe,ct.value,he),ct!==null&&(r&&ct.alternate!==null&&Ne.delete(ct.key===null?qe:ct.key),$=v(ct,$,qe),lt===null?je=ct:lt.sibling=ct,lt=ct);return r&&Ne.forEach(function(jO){return a(Q,jO)}),nt&&Di(Q,qe),je}function Ct(Q,$,ee,he){if(typeof ee=="object"&&ee!==null&&ee.type===A&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:e:{for(var je=ee.key;$!==null;){if($.key===je){if(je=ee.type,je===A){if($.tag===7){c(Q,$.sibling),he=y($,ee.props.children),he.return=Q,Q=he;break e}}else if($.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===N&&Yo(je)===$.type){c(Q,$.sibling),he=y($,ee.props),ud(he,ee),he.return=Q,Q=he;break e}c(Q,$);break}else a(Q,$);$=$.sibling}ee.type===A?(he=Ho(ee.props.children,Q.mode,he,ee.key),he.return=Q,Q=he):(he=Rf(ee.type,ee.key,ee.props,null,Q.mode,he),ud(he,ee),he.return=Q,Q=he)}return E(Q);case w:e:{for(je=ee.key;$!==null;){if($.key===je)if($.tag===4&&$.stateNode.containerInfo===ee.containerInfo&&$.stateNode.implementation===ee.implementation){c(Q,$.sibling),he=y($,ee.children||[]),he.return=Q,Q=he;break e}else{c(Q,$);break}else a(Q,$);$=$.sibling}he=ay(ee,Q.mode,he),he.return=Q,Q=he}return E(Q);case N:return ee=Yo(ee),Ct(Q,$,ee,he)}if(me(ee))return Ae(Q,$,ee,he);if(B(ee)){if(je=B(ee),typeof je!="function")throw Error(s(150));return ee=je.call(ee),ke(Q,$,ee,he)}if(typeof ee.then=="function")return Ct(Q,$,Lf(ee),he);if(ee.$$typeof===U)return Ct(Q,$,Of(Q,ee),he);Vf(Q,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,$!==null&&$.tag===6?(c(Q,$.sibling),he=y($,ee),he.return=Q,Q=he):(c(Q,$),he=iy(ee,Q.mode,he),he.return=Q,Q=he),E(Q)):c(Q,$)}return function(Q,$,ee,he){try{cd=0;var je=Ct(Q,$,ee,he);return yc=null,je}catch(Ne){if(Ne===gc||Ne===kf)throw Ne;var lt=$s(29,Ne,null,Q.mode);return lt.lanes=he,lt.return=Q,lt}}}var Xo=fS(!0),pS=fS(!1),Ta=!1;function vy(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xy(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Aa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ca(r,a,c){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(ft&2)!==0){var y=d.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),d.pending=a,a=If(r),X_(r,null,c),a}return Nf(r,d,a,c),If(r)}function dd(r,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var d=a.lanes;d&=r.pendingLanes,c|=d,a.lanes=c,Ci(r,c)}}function by(r,a){var c=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var y=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var E={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?y=v=E:v=v.next=E,c=c.next}while(c!==null);v===null?y=v=a:v=v.next=a}else y=v=a;c={baseState:d.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=a:r.next=a,c.lastBaseUpdate=a}var _y=!1;function hd(){if(_y){var r=mc;if(r!==null)throw r}}function fd(r,a,c,d){_y=!1;var y=r.updateQueue;Ta=!1;var v=y.firstBaseUpdate,E=y.lastBaseUpdate,D=y.shared.pending;if(D!==null){y.shared.pending=null;var q=D,te=q.next;q.next=null,E===null?v=te:E.next=te,E=q;var ue=r.alternate;ue!==null&&(ue=ue.updateQueue,D=ue.lastBaseUpdate,D!==E&&(D===null?ue.firstBaseUpdate=te:D.next=te,ue.lastBaseUpdate=q))}if(v!==null){var pe=y.baseState;E=0,ue=te=q=null,D=v;do{var se=D.lane&-536870913,oe=se!==D.lane;if(oe?(Xe&se)===se:(d&se)===se){se!==0&&se===pc&&(_y=!0),ue!==null&&(ue=ue.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ae=r,ke=D;se=a;var Ct=c;switch(ke.tag){case 1:if(Ae=ke.payload,typeof Ae=="function"){pe=Ae.call(Ct,pe,se);break e}pe=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=ke.payload,se=typeof Ae=="function"?Ae.call(Ct,pe,se):Ae,se==null)break e;pe=x({},pe,se);break e;case 2:Ta=!0}}se=D.callback,se!==null&&(r.flags|=64,oe&&(r.flags|=8192),oe=y.callbacks,oe===null?y.callbacks=[se]:oe.push(se))}else oe={lane:se,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ue===null?(te=ue=oe,q=pe):ue=ue.next=oe,E|=se;if(D=D.next,D===null){if(D=y.shared.pending,D===null)break;oe=D,D=oe.next,oe.next=null,y.lastBaseUpdate=oe,y.shared.pending=null}}while(!0);ue===null&&(q=pe),y.baseState=q,y.firstBaseUpdate=te,y.lastBaseUpdate=ue,v===null&&(y.shared.lanes=0),Da|=E,r.lanes=E,r.memoizedState=pe}}function mS(r,a){if(typeof r!="function")throw Error(s(191,r));r.call(a)}function gS(r,a){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)mS(c[r],a)}var vc=M(null),Uf=M(0);function yS(r,a){r=qi,H(Uf,r),H(vc,a),qi=r|a.baseLanes}function Sy(){H(Uf,qi),H(vc,vc.current)}function wy(){qi=Uf.current,W(vc),W(Uf)}var Ks=M(null),yr=null;function Na(r){var a=r.alternate;H(un,un.current&1),H(Ks,r),yr===null&&(a===null||vc.current!==null||a.memoizedState!==null)&&(yr=r)}function Ey(r){H(un,un.current),H(Ks,r),yr===null&&(yr=r)}function vS(r){r.tag===22?(H(un,un.current),H(Ks,r),yr===null&&(yr=r)):Ia()}function Ia(){H(un,un.current),H(Ks,Ks.current)}function Qs(r){W(Ks),yr===r&&(yr=null),W(un)}var un=M(0);function Bf(r){for(var a=r;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Rv(c)||jv(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ki=0,Fe=null,Tt=null,wn=null,Ff=!1,xc=!1,Jo=!1,zf=0,pd=0,bc=null,_D=0;function tn(){throw Error(s(321))}function Ty(r,a){if(a===null)return!1;for(var c=0;c<a.length&&c<r.length;c++)if(!Gs(r[c],a[c]))return!1;return!0}function Ay(r,a,c,d,y,v){return ki=v,Fe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,G.H=r===null||r.memoizedState===null?tw:Fy,Jo=!1,v=c(d,y),Jo=!1,xc&&(v=bS(a,c,d,y)),xS(r),v}function xS(r){G.H=yd;var a=Tt!==null&&Tt.next!==null;if(ki=0,wn=Tt=Fe=null,Ff=!1,pd=0,bc=null,a)throw Error(s(300));r===null||En||(r=r.dependencies,r!==null&&Df(r)&&(En=!0))}function bS(r,a,c,d){Fe=r;var y=0;do{if(xc&&(bc=null),pd=0,xc=!1,25<=y)throw Error(s(301));if(y+=1,wn=Tt=null,r.updateQueue!=null){var v=r.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}G.H=nw,v=a(c,d)}while(xc);return v}function SD(){var r=G.H,a=r.useState()[0];return a=typeof a.then=="function"?md(a):a,r=r.useState()[0],(Tt!==null?Tt.memoizedState:null)!==r&&(Fe.flags|=1024),a}function Cy(){var r=zf!==0;return zf=0,r}function Ny(r,a,c){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~c}function Iy(r){if(Ff){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Ff=!1}ki=0,wn=Tt=Fe=null,xc=!1,pd=zf=0,bc=null}function ps(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Fe.memoizedState=wn=r:wn=wn.next=r,wn}function dn(){if(Tt===null){var r=Fe.alternate;r=r!==null?r.memoizedState:null}else r=Tt.next;var a=wn===null?Fe.memoizedState:wn.next;if(a!==null)wn=a,Tt=r;else{if(r===null)throw Fe.alternate===null?Error(s(467)):Error(s(310));Tt=r,r={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},wn===null?Fe.memoizedState=wn=r:wn=wn.next=r}return wn}function qf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function md(r){var a=pd;return pd+=1,bc===null&&(bc=[]),r=uS(bc,r,a),a=Fe,(wn===null?a.memoizedState:wn.next)===null&&(a=a.alternate,G.H=a===null||a.memoizedState===null?tw:Fy),r}function Hf(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return md(r);if(r.$$typeof===U)return Gn(r)}throw Error(s(438,String(r)))}function Ry(r){var a=null,c=Fe.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var d=Fe.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(y){return y.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=qf(),Fe.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(r),d=0;d<r;d++)c[d]=O;return a.index++,c}function Mi(r,a){return typeof a=="function"?a(r):a}function Gf(r){var a=dn();return jy(a,Tt,r)}function jy(r,a,c){var d=r.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=c;var y=r.baseQueue,v=d.pending;if(v!==null){if(y!==null){var E=y.next;y.next=v.next,v.next=E}a.baseQueue=y=v,d.pending=null}if(v=r.baseState,y===null)r.memoizedState=v;else{a=y.next;var D=E=null,q=null,te=a,ue=!1;do{var pe=te.lane&-536870913;if(pe!==te.lane?(Xe&pe)===pe:(ki&pe)===pe){var se=te.revertLane;if(se===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),pe===pc&&(ue=!0);else if((ki&se)===se){te=te.next,se===pc&&(ue=!0);continue}else pe={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},q===null?(D=q=pe,E=v):q=q.next=pe,Fe.lanes|=se,Da|=se;pe=te.action,Jo&&c(v,pe),v=te.hasEagerState?te.eagerState:c(v,pe)}else se={lane:pe,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},q===null?(D=q=se,E=v):q=q.next=se,Fe.lanes|=pe,Da|=pe;te=te.next}while(te!==null&&te!==a);if(q===null?E=v:q.next=D,!Gs(v,r.memoizedState)&&(En=!0,ue&&(c=mc,c!==null)))throw c;r.memoizedState=v,r.baseState=E,r.baseQueue=q,d.lastRenderedState=v}return y===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function Dy(r){var a=dn(),c=a.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var d=c.dispatch,y=c.pending,v=a.memoizedState;if(y!==null){c.pending=null;var E=y=y.next;do v=r(v,E.action),E=E.next;while(E!==y);Gs(v,a.memoizedState)||(En=!0),a.memoizedState=v,a.baseQueue===null&&(a.baseState=v),c.lastRenderedState=v}return[v,d]}function _S(r,a,c){var d=Fe,y=dn(),v=nt;if(v){if(c===void 0)throw Error(s(407));c=c()}else c=a();var E=!Gs((Tt||y).memoizedState,c);if(E&&(y.memoizedState=c,En=!0),y=y.queue,ky(ES.bind(null,d,y,r),[r]),y.getSnapshot!==a||E||wn!==null&&wn.memoizedState.tag&1){if(d.flags|=2048,_c(9,{destroy:void 0},wS.bind(null,d,y,c,a),null),jt===null)throw Error(s(349));v||(ki&127)!==0||SS(d,a,c)}return c}function SS(r,a,c){r.flags|=16384,r={getSnapshot:a,value:c},a=Fe.updateQueue,a===null?(a=qf(),Fe.updateQueue=a,a.stores=[r]):(c=a.stores,c===null?a.stores=[r]:c.push(r))}function wS(r,a,c,d){a.value=c,a.getSnapshot=d,TS(a)&&AS(r)}function ES(r,a,c){return c(function(){TS(a)&&AS(r)})}function TS(r){var a=r.getSnapshot;r=r.value;try{var c=a();return!Gs(r,c)}catch{return!0}}function AS(r){var a=qo(r,2);a!==null&&Rs(a,r,2)}function Oy(r){var a=ps();if(typeof r=="function"){var c=r;if(r=c(),Jo){Ss(!0);try{c()}finally{Ss(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mi,lastRenderedState:r},a}function CS(r,a,c,d){return r.baseState=c,jy(r,Tt,typeof d=="function"?d:Mi)}function wD(r,a,c,d,y){if(Qf(r))throw Error(s(485));if(r=a.action,r!==null){var v={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){v.listeners.push(E)}};G.T!==null?c(!0):v.isTransition=!1,d(v),c=a.pending,c===null?(v.next=a.pending=v,NS(a,v)):(v.next=c.next,a.pending=c.next=v)}}function NS(r,a){var c=a.action,d=a.payload,y=r.state;if(a.isTransition){var v=G.T,E={};G.T=E;try{var D=c(y,d),q=G.S;q!==null&&q(E,D),IS(r,a,D)}catch(te){Py(r,a,te)}finally{v!==null&&E.types!==null&&(v.types=E.types),G.T=v}}else try{v=c(y,d),IS(r,a,v)}catch(te){Py(r,a,te)}}function IS(r,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){RS(r,a,d)},function(d){return Py(r,a,d)}):RS(r,a,c)}function RS(r,a,c){a.status="fulfilled",a.value=c,jS(a),r.state=c,a=r.pending,a!==null&&(c=a.next,c===a?r.pending=null:(c=c.next,a.next=c,NS(r,c)))}function Py(r,a,c){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=c,jS(a),a=a.next;while(a!==d)}r.action=null}function jS(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function DS(r,a){return a}function OS(r,a){if(nt){var c=jt.formState;if(c!==null){e:{var d=Fe;if(nt){if(Vt){t:{for(var y=Vt,v=gr;y.nodeType!==8;){if(!v){y=null;break t}if(y=vr(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){Vt=vr(y.nextSibling),d=y.data==="F!";break e}}wa(d)}d=!1}d&&(a=c[0])}}return c=ps(),c.memoizedState=c.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:DS,lastRenderedState:a},c.queue=d,c=JS.bind(null,Fe,d),d.dispatch=c,d=Oy(!1),v=By.bind(null,Fe,!1,d.queue),d=ps(),y={state:a,dispatch:null,action:r,pending:null},d.queue=y,c=wD.bind(null,Fe,y,v,c),y.dispatch=c,d.memoizedState=r,[a,c,!1]}function PS(r){var a=dn();return kS(a,Tt,r)}function kS(r,a,c){if(a=jy(r,a,DS)[0],r=Gf(Mi)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=md(a)}catch(E){throw E===gc?kf:E}else d=a;a=dn();var y=a.queue,v=y.dispatch;return c!==a.memoizedState&&(Fe.flags|=2048,_c(9,{destroy:void 0},ED.bind(null,y,c),null)),[d,v,r]}function ED(r,a){r.action=a}function MS(r){var a=dn(),c=Tt;if(c!==null)return kS(a,c,r);dn(),a=a.memoizedState,c=dn();var d=c.queue.dispatch;return c.memoizedState=r,[a,d,!1]}function _c(r,a,c,d){return r={tag:r,create:c,deps:d,inst:a,next:null},a=Fe.updateQueue,a===null&&(a=qf(),Fe.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=r.next=r:(d=c.next,c.next=r,r.next=d,a.lastEffect=r),r}function LS(){return dn().memoizedState}function $f(r,a,c,d){var y=ps();Fe.flags|=r,y.memoizedState=_c(1|a,{destroy:void 0},c,d===void 0?null:d)}function Kf(r,a,c,d){var y=dn();d=d===void 0?null:d;var v=y.memoizedState.inst;Tt!==null&&d!==null&&Ty(d,Tt.memoizedState.deps)?y.memoizedState=_c(a,v,c,d):(Fe.flags|=r,y.memoizedState=_c(1|a,v,c,d))}function VS(r,a){$f(8390656,8,r,a)}function ky(r,a){Kf(2048,8,r,a)}function TD(r){Fe.flags|=4;var a=Fe.updateQueue;if(a===null)a=qf(),Fe.updateQueue=a,a.events=[r];else{var c=a.events;c===null?a.events=[r]:c.push(r)}}function US(r){var a=dn().memoizedState;return TD({ref:a,nextImpl:r}),function(){if((ft&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}function BS(r,a){return Kf(4,2,r,a)}function FS(r,a){return Kf(4,4,r,a)}function zS(r,a){if(typeof a=="function"){r=r();var c=a(r);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function qS(r,a,c){c=c!=null?c.concat([r]):null,Kf(4,4,zS.bind(null,a,r),c)}function My(){}function HS(r,a){var c=dn();a=a===void 0?null:a;var d=c.memoizedState;return a!==null&&Ty(a,d[1])?d[0]:(c.memoizedState=[r,a],r)}function GS(r,a){var c=dn();a=a===void 0?null:a;var d=c.memoizedState;if(a!==null&&Ty(a,d[1]))return d[0];if(d=r(),Jo){Ss(!0);try{r()}finally{Ss(!1)}}return c.memoizedState=[d,a],d}function Ly(r,a,c){return c===void 0||(ki&1073741824)!==0&&(Xe&261930)===0?r.memoizedState=a:(r.memoizedState=c,r=$w(),Fe.lanes|=r,Da|=r,c)}function $S(r,a,c,d){return Gs(c,a)?c:vc.current!==null?(r=Ly(r,c,d),Gs(r,a)||(En=!0),r):(ki&42)===0||(ki&1073741824)!==0&&(Xe&261930)===0?(En=!0,r.memoizedState=c):(r=$w(),Fe.lanes|=r,Da|=r,a)}function KS(r,a,c,d,y){var v=ne.p;ne.p=v!==0&&8>v?v:8;var E=G.T,D={};G.T=D,By(r,!1,a,c);try{var q=y(),te=G.S;if(te!==null&&te(D,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ue=bD(q,d);gd(r,a,ue,Xs(r))}else gd(r,a,d,Xs(r))}catch(pe){gd(r,a,{then:function(){},status:"rejected",reason:pe},Xs())}finally{ne.p=v,E!==null&&D.types!==null&&(E.types=D.types),G.T=E}}function AD(){}function Vy(r,a,c,d){if(r.tag!==5)throw Error(s(476));var y=QS(r).queue;KS(r,y,a,Y,c===null?AD:function(){return YS(r),c(d)})}function QS(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mi,lastRenderedState:Y},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mi,lastRenderedState:c},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function YS(r){var a=QS(r);a.next===null&&(a=r.alternate.memoizedState),gd(r,a.next.queue,{},Xs())}function Uy(){return Gn(Od)}function WS(){return dn().memoizedState}function XS(){return dn().memoizedState}function CD(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var c=Xs();r=Aa(c);var d=Ca(a,r,c);d!==null&&(Rs(d,a,c),dd(d,a,c)),a={cache:py()},r.payload=a;return}a=a.return}}function ND(r,a,c){var d=Xs();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Qf(r)?ZS(a,c):(c=sy(r,a,c,d),c!==null&&(Rs(c,r,d),ew(c,a,d)))}function JS(r,a,c){var d=Xs();gd(r,a,c,d)}function gd(r,a,c,d){var y={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Qf(r))ZS(a,y);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=a.lastRenderedReducer,v!==null))try{var E=a.lastRenderedState,D=v(E,c);if(y.hasEagerState=!0,y.eagerState=D,Gs(D,E))return Nf(r,a,y,0),jt===null&&Cf(),!1}catch{}if(c=sy(r,a,y,d),c!==null)return Rs(c,r,d),ew(c,a,d),!0}return!1}function By(r,a,c,d){if(d={lane:2,revertLane:vv(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Qf(r)){if(a)throw Error(s(479))}else a=sy(r,c,d,2),a!==null&&Rs(a,r,2)}function Qf(r){var a=r.alternate;return r===Fe||a!==null&&a===Fe}function ZS(r,a){xc=Ff=!0;var c=r.pending;c===null?a.next=a:(a.next=c.next,c.next=a),r.pending=a}function ew(r,a,c){if((c&4194048)!==0){var d=a.lanes;d&=r.pendingLanes,c|=d,a.lanes=c,Ci(r,c)}}var yd={readContext:Gn,use:Hf,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn};yd.useEffectEvent=tn;var tw={readContext:Gn,use:Hf,useCallback:function(r,a){return ps().memoizedState=[r,a===void 0?null:a],r},useContext:Gn,useEffect:VS,useImperativeHandle:function(r,a,c){c=c!=null?c.concat([r]):null,$f(4194308,4,zS.bind(null,a,r),c)},useLayoutEffect:function(r,a){return $f(4194308,4,r,a)},useInsertionEffect:function(r,a){$f(4,2,r,a)},useMemo:function(r,a){var c=ps();a=a===void 0?null:a;var d=r();if(Jo){Ss(!0);try{r()}finally{Ss(!1)}}return c.memoizedState=[d,a],d},useReducer:function(r,a,c){var d=ps();if(c!==void 0){var y=c(a);if(Jo){Ss(!0);try{c(a)}finally{Ss(!1)}}}else y=a;return d.memoizedState=d.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},d.queue=r,r=r.dispatch=ND.bind(null,Fe,r),[d.memoizedState,r]},useRef:function(r){var a=ps();return r={current:r},a.memoizedState=r},useState:function(r){r=Oy(r);var a=r.queue,c=JS.bind(null,Fe,a);return a.dispatch=c,[r.memoizedState,c]},useDebugValue:My,useDeferredValue:function(r,a){var c=ps();return Ly(c,r,a)},useTransition:function(){var r=Oy(!1);return r=KS.bind(null,Fe,r.queue,!0,!1),ps().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,c){var d=Fe,y=ps();if(nt){if(c===void 0)throw Error(s(407));c=c()}else{if(c=a(),jt===null)throw Error(s(349));(Xe&127)!==0||SS(d,a,c)}y.memoizedState=c;var v={value:c,getSnapshot:a};return y.queue=v,VS(ES.bind(null,d,v,r),[r]),d.flags|=2048,_c(9,{destroy:void 0},wS.bind(null,d,v,c,a),null),c},useId:function(){var r=ps(),a=jt.identifierPrefix;if(nt){var c=ri,d=si;c=(d&~(1<<32-Ft(d)-1)).toString(32)+c,a="_"+a+"R_"+c,c=zf++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=_D++,a="_"+a+"r_"+c.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:Uy,useFormState:OS,useActionState:OS,useOptimistic:function(r){var a=ps();a.memoizedState=a.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=By.bind(null,Fe,!0,c),c.dispatch=a,[r,a]},useMemoCache:Ry,useCacheRefresh:function(){return ps().memoizedState=CD.bind(null,Fe)},useEffectEvent:function(r){var a=ps(),c={impl:r};return a.memoizedState=c,function(){if((ft&2)!==0)throw Error(s(440));return c.impl.apply(void 0,arguments)}}},Fy={readContext:Gn,use:Hf,useCallback:HS,useContext:Gn,useEffect:ky,useImperativeHandle:qS,useInsertionEffect:BS,useLayoutEffect:FS,useMemo:GS,useReducer:Gf,useRef:LS,useState:function(){return Gf(Mi)},useDebugValue:My,useDeferredValue:function(r,a){var c=dn();return $S(c,Tt.memoizedState,r,a)},useTransition:function(){var r=Gf(Mi)[0],a=dn().memoizedState;return[typeof r=="boolean"?r:md(r),a]},useSyncExternalStore:_S,useId:WS,useHostTransitionStatus:Uy,useFormState:PS,useActionState:PS,useOptimistic:function(r,a){var c=dn();return CS(c,Tt,r,a)},useMemoCache:Ry,useCacheRefresh:XS};Fy.useEffectEvent=US;var nw={readContext:Gn,use:Hf,useCallback:HS,useContext:Gn,useEffect:ky,useImperativeHandle:qS,useInsertionEffect:BS,useLayoutEffect:FS,useMemo:GS,useReducer:Dy,useRef:LS,useState:function(){return Dy(Mi)},useDebugValue:My,useDeferredValue:function(r,a){var c=dn();return Tt===null?Ly(c,r,a):$S(c,Tt.memoizedState,r,a)},useTransition:function(){var r=Dy(Mi)[0],a=dn().memoizedState;return[typeof r=="boolean"?r:md(r),a]},useSyncExternalStore:_S,useId:WS,useHostTransitionStatus:Uy,useFormState:MS,useActionState:MS,useOptimistic:function(r,a){var c=dn();return Tt!==null?CS(c,Tt,r,a):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:Ry,useCacheRefresh:XS};nw.useEffectEvent=US;function zy(r,a,c,d){a=r.memoizedState,c=c(d,a),c=c==null?a:x({},a,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var qy={enqueueSetState:function(r,a,c){r=r._reactInternals;var d=Xs(),y=Aa(d);y.payload=a,c!=null&&(y.callback=c),a=Ca(r,y,d),a!==null&&(Rs(a,r,d),dd(a,r,d))},enqueueReplaceState:function(r,a,c){r=r._reactInternals;var d=Xs(),y=Aa(d);y.tag=1,y.payload=a,c!=null&&(y.callback=c),a=Ca(r,y,d),a!==null&&(Rs(a,r,d),dd(a,r,d))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var c=Xs(),d=Aa(c);d.tag=2,a!=null&&(d.callback=a),a=Ca(r,d,c),a!==null&&(Rs(a,r,c),dd(a,r,c))}};function sw(r,a,c,d,y,v,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,v,E):a.prototype&&a.prototype.isPureReactComponent?!sd(c,d)||!sd(y,v):!0}function rw(r,a,c,d){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,d),a.state!==r&&qy.enqueueReplaceState(a,a.state,null)}function Zo(r,a){var c=a;if("ref"in a){c={};for(var d in a)d!=="ref"&&(c[d]=a[d])}if(r=r.defaultProps){c===a&&(c=x({},c));for(var y in r)c[y]===void 0&&(c[y]=r[y])}return c}function iw(r){Af(r)}function aw(r){console.error(r)}function ow(r){Af(r)}function Yf(r,a){try{var c=r.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function lw(r,a,c){try{var d=r.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Hy(r,a,c){return c=Aa(c),c.tag=3,c.payload={element:null},c.callback=function(){Yf(r,a)},c}function cw(r){return r=Aa(r),r.tag=3,r}function uw(r,a,c,d){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var v=d.value;r.payload=function(){return y(v)},r.callback=function(){lw(a,c,d)}}var E=c.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){lw(a,c,d),typeof y!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function ID(r,a,c,d,y){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=c.alternate,a!==null&&fc(a,c,y,!0),c=Ks.current,c!==null){switch(c.tag){case 31:case 13:return yr===null?op():c.alternate===null&&nn===0&&(nn=3),c.flags&=-257,c.flags|=65536,c.lanes=y,d===Mf?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([d]):a.add(d),mv(r,d,y)),!1;case 22:return c.flags|=65536,d===Mf?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([d]):c.add(d)),mv(r,d,y)),!1}throw Error(s(435,c.tag))}return mv(r,d,y),op(),!1}if(nt)return a=Ks.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=y,d!==cy&&(r=Error(s(422),{cause:d}),ad(fr(r,c)))):(d!==cy&&(a=Error(s(423),{cause:d}),ad(fr(a,c))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,d=fr(d,c),y=Hy(r.stateNode,d,y),by(r,y),nn!==4&&(nn=2)),!1;var v=Error(s(520),{cause:d});if(v=fr(v,c),Td===null?Td=[v]:Td.push(v),nn!==4&&(nn=2),a===null)return!0;d=fr(d,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,r=y&-y,c.lanes|=r,r=Hy(c.stateNode,d,r),by(c,r),!1;case 1:if(a=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Oa===null||!Oa.has(v))))return c.flags|=65536,y&=-y,c.lanes|=y,y=cw(y),uw(y,r,c,d),by(c,y),!1}c=c.return}while(c!==null);return!1}var Gy=Error(s(461)),En=!1;function $n(r,a,c,d){a.child=r===null?pS(a,null,c,d):Xo(a,r.child,c,d)}function dw(r,a,c,d,y){c=c.render;var v=a.ref;if("ref"in d){var E={};for(var D in d)D!=="ref"&&(E[D]=d[D])}else E=d;return Ko(a),d=Ay(r,a,c,E,v,y),D=Cy(),r!==null&&!En?(Ny(r,a,y),Li(r,a,y)):(nt&&D&&oy(a),a.flags|=1,$n(r,a,d,y),a.child)}function hw(r,a,c,d,y){if(r===null){var v=c.type;return typeof v=="function"&&!ry(v)&&v.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=v,fw(r,a,v,d,y)):(r=Rf(c.type,null,d,a,a.mode,y),r.ref=a.ref,r.return=a,a.child=r)}if(v=r.child,!Zy(r,y)){var E=v.memoizedProps;if(c=c.compare,c=c!==null?c:sd,c(E,d)&&r.ref===a.ref)return Li(r,a,y)}return a.flags|=1,r=ji(v,d),r.ref=a.ref,r.return=a,a.child=r}function fw(r,a,c,d,y){if(r!==null){var v=r.memoizedProps;if(sd(v,d)&&r.ref===a.ref)if(En=!1,a.pendingProps=d=v,Zy(r,y))(r.flags&131072)!==0&&(En=!0);else return a.lanes=r.lanes,Li(r,a,y)}return $y(r,a,c,d,y)}function pw(r,a,c,d){var y=d.children,v=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((a.flags&128)!==0){if(v=v!==null?v.baseLanes|c:c,r!==null){for(d=a.child=r.child,y=0;d!==null;)y=y|d.lanes|d.childLanes,d=d.sibling;d=y&~v}else d=0,a.child=null;return mw(r,a,v,c,d)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&Pf(a,v!==null?v.cachePool:null),v!==null?yS(a,v):Sy(),vS(a);else return d=a.lanes=536870912,mw(r,a,v!==null?v.baseLanes|c:c,c,d)}else v!==null?(Pf(a,v.cachePool),yS(a,v),Ia(),a.memoizedState=null):(r!==null&&Pf(a,null),Sy(),Ia());return $n(r,a,y,c),a.child}function vd(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function mw(r,a,c,d,y){var v=gy();return v=v===null?null:{parent:Sn._currentValue,pool:v},a.memoizedState={baseLanes:c,cachePool:v},r!==null&&Pf(a,null),Sy(),vS(a),r!==null&&fc(r,a,d,!0),a.childLanes=y,null}function Wf(r,a){return a=Jf({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function gw(r,a,c){return Xo(a,r.child,null,c),r=Wf(a,a.pendingProps),r.flags|=2,Qs(a),a.memoizedState=null,r}function RD(r,a,c){var d=a.pendingProps,y=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(nt){if(d.mode==="hidden")return r=Wf(a,d),a.lanes=536870912,vd(null,r);if(Ey(a),(r=Vt)?(r=NE(r,gr),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:_a!==null?{id:si,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},c=Z_(r),c.return=a,a.child=c,Hn=a,Vt=null)):r=null,r===null)throw wa(a);return a.lanes=536870912,null}return Wf(a,d)}var v=r.memoizedState;if(v!==null){var E=v.dehydrated;if(Ey(a),y)if(a.flags&256)a.flags&=-257,a=gw(r,a,c);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(s(558));else if(En||fc(r,a,c,!1),y=(c&r.childLanes)!==0,En||y){if(d=jt,d!==null&&(E=Gr(d,c),E!==0&&E!==v.retryLane))throw v.retryLane=E,qo(r,E),Rs(d,r,E),Gy;op(),a=gw(r,a,c)}else r=v.treeContext,Vt=vr(E.nextSibling),Hn=a,nt=!0,Sa=null,gr=!1,r!==null&&nS(a,r),a=Wf(a,d),a.flags|=4096;return a}return r=ji(r.child,{mode:d.mode,children:d.children}),r.ref=a.ref,a.child=r,r.return=a,r}function Xf(r,a){var c=a.ref;if(c===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(s(284));(r===null||r.ref!==c)&&(a.flags|=4194816)}}function $y(r,a,c,d,y){return Ko(a),c=Ay(r,a,c,d,void 0,y),d=Cy(),r!==null&&!En?(Ny(r,a,y),Li(r,a,y)):(nt&&d&&oy(a),a.flags|=1,$n(r,a,c,y),a.child)}function yw(r,a,c,d,y,v){return Ko(a),a.updateQueue=null,c=bS(a,d,c,y),xS(r),d=Cy(),r!==null&&!En?(Ny(r,a,v),Li(r,a,v)):(nt&&d&&oy(a),a.flags|=1,$n(r,a,c,v),a.child)}function vw(r,a,c,d,y){if(Ko(a),a.stateNode===null){var v=cc,E=c.contextType;typeof E=="object"&&E!==null&&(v=Gn(E)),v=new c(d,v),a.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=qy,a.stateNode=v,v._reactInternals=a,v=a.stateNode,v.props=d,v.state=a.memoizedState,v.refs={},vy(a),E=c.contextType,v.context=typeof E=="object"&&E!==null?Gn(E):cc,v.state=a.memoizedState,E=c.getDerivedStateFromProps,typeof E=="function"&&(zy(a,c,E,d),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(E=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),E!==v.state&&qy.enqueueReplaceState(v,v.state,null),fd(a,d,v,y),hd(),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(r===null){v=a.stateNode;var D=a.memoizedProps,q=Zo(c,D);v.props=q;var te=v.context,ue=c.contextType;E=cc,typeof ue=="object"&&ue!==null&&(E=Gn(ue));var pe=c.getDerivedStateFromProps;ue=typeof pe=="function"||typeof v.getSnapshotBeforeUpdate=="function",D=a.pendingProps!==D,ue||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(D||te!==E)&&rw(a,v,d,E),Ta=!1;var se=a.memoizedState;v.state=se,fd(a,d,v,y),hd(),te=a.memoizedState,D||se!==te||Ta?(typeof pe=="function"&&(zy(a,c,pe,d),te=a.memoizedState),(q=Ta||sw(a,c,q,d,se,te,E))?(ue||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(a.flags|=4194308)):(typeof v.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=te),v.props=d,v.state=te,v.context=E,d=q):(typeof v.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{v=a.stateNode,xy(r,a),E=a.memoizedProps,ue=Zo(c,E),v.props=ue,pe=a.pendingProps,se=v.context,te=c.contextType,q=cc,typeof te=="object"&&te!==null&&(q=Gn(te)),D=c.getDerivedStateFromProps,(te=typeof D=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(E!==pe||se!==q)&&rw(a,v,d,q),Ta=!1,se=a.memoizedState,v.state=se,fd(a,d,v,y),hd();var oe=a.memoizedState;E!==pe||se!==oe||Ta||r!==null&&r.dependencies!==null&&Df(r.dependencies)?(typeof D=="function"&&(zy(a,c,D,d),oe=a.memoizedState),(ue=Ta||sw(a,c,ue,d,se,oe,q)||r!==null&&r.dependencies!==null&&Df(r.dependencies))?(te||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,oe,q),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,oe,q)),typeof v.componentDidUpdate=="function"&&(a.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof v.componentDidUpdate!="function"||E===r.memoizedProps&&se===r.memoizedState||(a.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&se===r.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=oe),v.props=d,v.state=oe,v.context=q,d=ue):(typeof v.componentDidUpdate!="function"||E===r.memoizedProps&&se===r.memoizedState||(a.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&se===r.memoizedState||(a.flags|=1024),d=!1)}return v=d,Xf(r,a),d=(a.flags&128)!==0,v||d?(v=a.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:v.render(),a.flags|=1,r!==null&&d?(a.child=Xo(a,r.child,null,y),a.child=Xo(a,null,c,y)):$n(r,a,c,y),a.memoizedState=v.state,r=a.child):r=Li(r,a,y),r}function xw(r,a,c,d){return Go(),a.flags|=256,$n(r,a,c,d),a.child}var Ky={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qy(r){return{baseLanes:r,cachePool:lS()}}function Yy(r,a,c){return r=r!==null?r.childLanes&~c:0,a&&(r|=Ws),r}function bw(r,a,c){var d=a.pendingProps,y=!1,v=(a.flags&128)!==0,E;if((E=v)||(E=r!==null&&r.memoizedState===null?!1:(un.current&2)!==0),E&&(y=!0,a.flags&=-129),E=(a.flags&32)!==0,a.flags&=-33,r===null){if(nt){if(y?Na(a):Ia(),(r=Vt)?(r=NE(r,gr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:_a!==null?{id:si,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},c=Z_(r),c.return=a,a.child=c,Hn=a,Vt=null)):r=null,r===null)throw wa(a);return jv(r)?a.lanes=32:a.lanes=536870912,null}var D=d.children;return d=d.fallback,y?(Ia(),y=a.mode,D=Jf({mode:"hidden",children:D},y),d=Ho(d,y,c,null),D.return=a,d.return=a,D.sibling=d,a.child=D,d=a.child,d.memoizedState=Qy(c),d.childLanes=Yy(r,E,c),a.memoizedState=Ky,vd(null,d)):(Na(a),Wy(a,D))}var q=r.memoizedState;if(q!==null&&(D=q.dehydrated,D!==null)){if(v)a.flags&256?(Na(a),a.flags&=-257,a=Xy(r,a,c)):a.memoizedState!==null?(Ia(),a.child=r.child,a.flags|=128,a=null):(Ia(),D=d.fallback,y=a.mode,d=Jf({mode:"visible",children:d.children},y),D=Ho(D,y,c,null),D.flags|=2,d.return=a,D.return=a,d.sibling=D,a.child=d,Xo(a,r.child,null,c),d=a.child,d.memoizedState=Qy(c),d.childLanes=Yy(r,E,c),a.memoizedState=Ky,a=vd(null,d));else if(Na(a),jv(D)){if(E=D.nextSibling&&D.nextSibling.dataset,E)var te=E.dgst;E=te,d=Error(s(419)),d.stack="",d.digest=E,ad({value:d,source:null,stack:null}),a=Xy(r,a,c)}else if(En||fc(r,a,c,!1),E=(c&r.childLanes)!==0,En||E){if(E=jt,E!==null&&(d=Gr(E,c),d!==0&&d!==q.retryLane))throw q.retryLane=d,qo(r,d),Rs(E,r,d),Gy;Rv(D)||op(),a=Xy(r,a,c)}else Rv(D)?(a.flags|=192,a.child=r.child,a=null):(r=q.treeContext,Vt=vr(D.nextSibling),Hn=a,nt=!0,Sa=null,gr=!1,r!==null&&nS(a,r),a=Wy(a,d.children),a.flags|=4096);return a}return y?(Ia(),D=d.fallback,y=a.mode,q=r.child,te=q.sibling,d=ji(q,{mode:"hidden",children:d.children}),d.subtreeFlags=q.subtreeFlags&65011712,te!==null?D=ji(te,D):(D=Ho(D,y,c,null),D.flags|=2),D.return=a,d.return=a,d.sibling=D,a.child=d,vd(null,d),d=a.child,D=r.child.memoizedState,D===null?D=Qy(c):(y=D.cachePool,y!==null?(q=Sn._currentValue,y=y.parent!==q?{parent:q,pool:q}:y):y=lS(),D={baseLanes:D.baseLanes|c,cachePool:y}),d.memoizedState=D,d.childLanes=Yy(r,E,c),a.memoizedState=Ky,vd(r.child,d)):(Na(a),c=r.child,r=c.sibling,c=ji(c,{mode:"visible",children:d.children}),c.return=a,c.sibling=null,r!==null&&(E=a.deletions,E===null?(a.deletions=[r],a.flags|=16):E.push(r)),a.child=c,a.memoizedState=null,c)}function Wy(r,a){return a=Jf({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Jf(r,a){return r=$s(22,r,null,a),r.lanes=0,r}function Xy(r,a,c){return Xo(a,r.child,null,c),r=Wy(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function _w(r,a,c){r.lanes|=a;var d=r.alternate;d!==null&&(d.lanes|=a),hy(r.return,a,c)}function Jy(r,a,c,d,y,v){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:y,treeForkCount:v}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=d,E.tail=c,E.tailMode=y,E.treeForkCount=v)}function Sw(r,a,c){var d=a.pendingProps,y=d.revealOrder,v=d.tail;d=d.children;var E=un.current,D=(E&2)!==0;if(D?(E=E&1|2,a.flags|=128):E&=1,H(un,E),$n(r,a,d,c),d=nt?id:0,!D&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&_w(r,c,a);else if(r.tag===19)_w(r,c,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(y){case"forwards":for(c=a.child,y=null;c!==null;)r=c.alternate,r!==null&&Bf(r)===null&&(y=c),c=c.sibling;c=y,c===null?(y=a.child,a.child=null):(y=c.sibling,c.sibling=null),Jy(a,!1,y,c,v,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,y=a.child,a.child=null;y!==null;){if(r=y.alternate,r!==null&&Bf(r)===null){a.child=y;break}r=y.sibling,y.sibling=c,c=y,y=r}Jy(a,!0,c,null,v,d);break;case"together":Jy(a,!1,null,null,void 0,d);break;default:a.memoizedState=null}return a.child}function Li(r,a,c){if(r!==null&&(a.dependencies=r.dependencies),Da|=a.lanes,(c&a.childLanes)===0)if(r!==null){if(fc(r,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(s(153));if(a.child!==null){for(r=a.child,c=ji(r,r.pendingProps),a.child=c,c.return=a;r.sibling!==null;)r=r.sibling,c=c.sibling=ji(r,r.pendingProps),c.return=a;c.sibling=null}return a.child}function Zy(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&Df(r)))}function jD(r,a,c){switch(a.tag){case 3:tt(a,a.stateNode.containerInfo),Ea(a,Sn,r.memoizedState.cache),Go();break;case 27:case 5:Rn(a);break;case 4:tt(a,a.stateNode.containerInfo);break;case 10:Ea(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Ey(a),null;break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(Na(a),a.flags|=128,null):(c&a.child.childLanes)!==0?bw(r,a,c):(Na(a),r=Li(r,a,c),r!==null?r.sibling:null);Na(a);break;case 19:var y=(r.flags&128)!==0;if(d=(c&a.childLanes)!==0,d||(fc(r,a,c,!1),d=(c&a.childLanes)!==0),y){if(d)return Sw(r,a,c);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),H(un,un.current),d)break;return null;case 22:return a.lanes=0,pw(r,a,c,a.pendingProps);case 24:Ea(a,Sn,r.memoizedState.cache)}return Li(r,a,c)}function ww(r,a,c){if(r!==null)if(r.memoizedProps!==a.pendingProps)En=!0;else{if(!Zy(r,c)&&(a.flags&128)===0)return En=!1,jD(r,a,c);En=(r.flags&131072)!==0}else En=!1,nt&&(a.flags&1048576)!==0&&tS(a,id,a.index);switch(a.lanes=0,a.tag){case 16:e:{var d=a.pendingProps;if(r=Yo(a.elementType),a.type=r,typeof r=="function")ry(r)?(d=Zo(r,d),a.tag=1,a=vw(null,a,r,d,c)):(a.tag=0,a=$y(null,a,r,d,c));else{if(r!=null){var y=r.$$typeof;if(y===F){a.tag=11,a=dw(null,a,r,d,c);break e}else if(y===j){a.tag=14,a=hw(null,a,r,d,c);break e}}throw a=fe(r)||r,Error(s(306,a,""))}}return a;case 0:return $y(r,a,a.type,a.pendingProps,c);case 1:return d=a.type,y=Zo(d,a.pendingProps),vw(r,a,d,y,c);case 3:e:{if(tt(a,a.stateNode.containerInfo),r===null)throw Error(s(387));d=a.pendingProps;var v=a.memoizedState;y=v.element,xy(r,a),fd(a,d,null,c);var E=a.memoizedState;if(d=E.cache,Ea(a,Sn,d),d!==v.cache&&fy(a,[Sn],c,!0),hd(),d=E.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:E.cache},a.updateQueue.baseState=v,a.memoizedState=v,a.flags&256){a=xw(r,a,d,c);break e}else if(d!==y){y=fr(Error(s(424)),a),ad(y),a=xw(r,a,d,c);break e}else for(r=a.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Vt=vr(r.firstChild),Hn=a,nt=!0,Sa=null,gr=!0,c=pS(a,null,d,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Go(),d===y){a=Li(r,a,c);break e}$n(r,a,d,c)}a=a.child}return a;case 26:return Xf(r,a),r===null?(c=PE(a.type,null,a.pendingProps,null))?a.memoizedState=c:nt||(c=a.type,r=a.pendingProps,d=pp(we.current).createElement(c),d[Yt]=a,d[xn]=r,Kn(d,c,r),bn(d),a.stateNode=d):a.memoizedState=PE(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return Rn(a),r===null&&nt&&(d=a.stateNode=jE(a.type,a.pendingProps,we.current),Hn=a,gr=!0,y=Vt,La(a.type)?(Dv=y,Vt=vr(d.firstChild)):Vt=y),$n(r,a,a.pendingProps.children,c),Xf(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&nt&&((y=d=Vt)&&(d=oO(d,a.type,a.pendingProps,gr),d!==null?(a.stateNode=d,Hn=a,Vt=vr(d.firstChild),gr=!1,y=!0):y=!1),y||wa(a)),Rn(a),y=a.type,v=a.pendingProps,E=r!==null?r.memoizedProps:null,d=v.children,Cv(y,v)?d=null:E!==null&&Cv(y,E)&&(a.flags|=32),a.memoizedState!==null&&(y=Ay(r,a,SD,null,null,c),Od._currentValue=y),Xf(r,a),$n(r,a,d,c),a.child;case 6:return r===null&&nt&&((r=c=Vt)&&(c=lO(c,a.pendingProps,gr),c!==null?(a.stateNode=c,Hn=a,Vt=null,r=!0):r=!1),r||wa(a)),null;case 13:return bw(r,a,c);case 4:return tt(a,a.stateNode.containerInfo),d=a.pendingProps,r===null?a.child=Xo(a,null,d,c):$n(r,a,d,c),a.child;case 11:return dw(r,a,a.type,a.pendingProps,c);case 7:return $n(r,a,a.pendingProps,c),a.child;case 8:return $n(r,a,a.pendingProps.children,c),a.child;case 12:return $n(r,a,a.pendingProps.children,c),a.child;case 10:return d=a.pendingProps,Ea(a,a.type,d.value),$n(r,a,d.children,c),a.child;case 9:return y=a.type._context,d=a.pendingProps.children,Ko(a),y=Gn(y),d=d(y),a.flags|=1,$n(r,a,d,c),a.child;case 14:return hw(r,a,a.type,a.pendingProps,c);case 15:return fw(r,a,a.type,a.pendingProps,c);case 19:return Sw(r,a,c);case 31:return RD(r,a,c);case 22:return pw(r,a,c,a.pendingProps);case 24:return Ko(a),d=Gn(Sn),r===null?(y=gy(),y===null&&(y=jt,v=py(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=c),y=v),a.memoizedState={parent:d,cache:y},vy(a),Ea(a,Sn,y)):((r.lanes&c)!==0&&(xy(r,a),fd(a,null,null,c),hd()),y=r.memoizedState,v=a.memoizedState,y.parent!==d?(y={parent:d,cache:d},a.memoizedState=y,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=y),Ea(a,Sn,d)):(d=v.cache,Ea(a,Sn,d),d!==y.cache&&fy(a,[Sn],c,!0))),$n(r,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(s(156,a.tag))}function Vi(r){r.flags|=4}function ev(r,a,c,d,y){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(y&335544128)===y)if(r.stateNode.complete)r.flags|=8192;else if(Ww())r.flags|=8192;else throw Wo=Mf,yy}else r.flags&=-16777217}function Ew(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!UE(a))if(Ww())r.flags|=8192;else throw Wo=Mf,yy}function Zf(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?ds():536870912,r.lanes|=a,Tc|=a)}function xd(r,a){if(!nt)switch(r.tailMode){case"hidden":a=r.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Ut(r){var a=r.alternate!==null&&r.alternate.child===r.child,c=0,d=0;if(a)for(var y=r.child;y!==null;)c|=y.lanes|y.childLanes,d|=y.subtreeFlags&65011712,d|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)c|=y.lanes|y.childLanes,d|=y.subtreeFlags,d|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=d,r.childLanes=c,a}function DD(r,a,c){var d=a.pendingProps;switch(ly(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ut(a),null;case 1:return Ut(a),null;case 3:return c=a.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),Pi(Sn),He(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(hc(a)?Vi(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,uy())),Ut(a),null;case 26:var y=a.type,v=a.memoizedState;return r===null?(Vi(a),v!==null?(Ut(a),Ew(a,v)):(Ut(a),ev(a,y,null,d,c))):v?v!==r.memoizedState?(Vi(a),Ut(a),Ew(a,v)):(Ut(a),a.flags&=-16777217):(r=r.memoizedProps,r!==d&&Vi(a),Ut(a),ev(a,y,r,d,c)),null;case 27:if(us(a),c=we.current,y=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==d&&Vi(a);else{if(!d){if(a.stateNode===null)throw Error(s(166));return Ut(a),null}r=ce.current,hc(a)?sS(a):(r=jE(y,d,c),a.stateNode=r,Vi(a))}return Ut(a),null;case 5:if(us(a),y=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==d&&Vi(a);else{if(!d){if(a.stateNode===null)throw Error(s(166));return Ut(a),null}if(v=ce.current,hc(a))sS(a);else{var E=pp(we.current);switch(v){case 1:v=E.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=E.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=E.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=E.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=E.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof d.is=="string"?E.createElement("select",{is:d.is}):E.createElement("select"),d.multiple?v.multiple=!0:d.size&&(v.size=d.size);break;default:v=typeof d.is=="string"?E.createElement(y,{is:d.is}):E.createElement(y)}}v[Yt]=a,v[xn]=d;e:for(E=a.child;E!==null;){if(E.tag===5||E.tag===6)v.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===a)break e;for(;E.sibling===null;){if(E.return===null||E.return===a)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}a.stateNode=v;e:switch(Kn(v,y,d),y){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Vi(a)}}return Ut(a),ev(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,c),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==d&&Vi(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(s(166));if(r=we.current,hc(a)){if(r=a.stateNode,c=a.memoizedProps,d=null,y=Hn,y!==null)switch(y.tag){case 27:case 5:d=y.memoizedProps}r[Yt]=a,r=!!(r.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||bE(r.nodeValue,c)),r||wa(a,!0)}else r=pp(r).createTextNode(d),r[Yt]=a,a.stateNode=r}return Ut(a),null;case 31:if(c=a.memoizedState,r===null||r.memoizedState!==null){if(d=hc(a),c!==null){if(r===null){if(!d)throw Error(s(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[Yt]=a}else Go(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ut(a),r=!1}else c=uy(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return a.flags&256?(Qs(a),a):(Qs(a),null);if((a.flags&128)!==0)throw Error(s(558))}return Ut(a),null;case 13:if(d=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=hc(a),d!==null&&d.dehydrated!==null){if(r===null){if(!y)throw Error(s(318));if(y=a.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(s(317));y[Yt]=a}else Go(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ut(a),y=!1}else y=uy(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return a.flags&256?(Qs(a),a):(Qs(a),null)}return Qs(a),(a.flags&128)!==0?(a.lanes=c,a):(c=d!==null,r=r!==null&&r.memoizedState!==null,c&&(d=a.child,y=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(y=d.alternate.memoizedState.cachePool.pool),v=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==y&&(d.flags|=2048)),c!==r&&c&&(a.child.flags|=8192),Zf(a,a.updateQueue),Ut(a),null);case 4:return He(),r===null&&Sv(a.stateNode.containerInfo),Ut(a),null;case 10:return Pi(a.type),Ut(a),null;case 19:if(W(un),d=a.memoizedState,d===null)return Ut(a),null;if(y=(a.flags&128)!==0,v=d.rendering,v===null)if(y)xd(d,!1);else{if(nn!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(v=Bf(r),v!==null){for(a.flags|=128,xd(d,!1),r=v.updateQueue,a.updateQueue=r,Zf(a,r),a.subtreeFlags=0,r=c,c=a.child;c!==null;)J_(c,r),c=c.sibling;return H(un,un.current&1|2),nt&&Di(a,d.treeForkCount),a.child}r=r.sibling}d.tail!==null&&Bt()>rp&&(a.flags|=128,y=!0,xd(d,!1),a.lanes=4194304)}else{if(!y)if(r=Bf(v),r!==null){if(a.flags|=128,y=!0,r=r.updateQueue,a.updateQueue=r,Zf(a,r),xd(d,!0),d.tail===null&&d.tailMode==="hidden"&&!v.alternate&&!nt)return Ut(a),null}else 2*Bt()-d.renderingStartTime>rp&&c!==536870912&&(a.flags|=128,y=!0,xd(d,!1),a.lanes=4194304);d.isBackwards?(v.sibling=a.child,a.child=v):(r=d.last,r!==null?r.sibling=v:a.child=v,d.last=v)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=Bt(),r.sibling=null,c=un.current,H(un,y?c&1|2:c&1),nt&&Di(a,d.treeForkCount),r):(Ut(a),null);case 22:case 23:return Qs(a),wy(),d=a.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(c&536870912)!==0&&(a.flags&128)===0&&(Ut(a),a.subtreeFlags&6&&(a.flags|=8192)):Ut(a),c=a.updateQueue,c!==null&&Zf(a,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==c&&(a.flags|=2048),r!==null&&W(Qo),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Pi(Sn),Ut(a),null;case 25:return null;case 30:return null}throw Error(s(156,a.tag))}function OD(r,a){switch(ly(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return Pi(Sn),He(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return us(a),null;case 31:if(a.memoizedState!==null){if(Qs(a),a.alternate===null)throw Error(s(340));Go()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(Qs(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(s(340));Go()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return W(un),null;case 4:return He(),null;case 10:return Pi(a.type),null;case 22:case 23:return Qs(a),wy(),r!==null&&W(Qo),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return Pi(Sn),null;case 25:return null;default:return null}}function Tw(r,a){switch(ly(a),a.tag){case 3:Pi(Sn),He();break;case 26:case 27:case 5:us(a);break;case 4:He();break;case 31:a.memoizedState!==null&&Qs(a);break;case 13:Qs(a);break;case 19:W(un);break;case 10:Pi(a.type);break;case 22:case 23:Qs(a),wy(),r!==null&&W(Qo);break;case 24:Pi(Sn)}}function bd(r,a){try{var c=a.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var y=d.next;c=y;do{if((c.tag&r)===r){d=void 0;var v=c.create,E=c.inst;d=v(),E.destroy=d}c=c.next}while(c!==y)}}catch(D){yt(a,a.return,D)}}function Ra(r,a,c){try{var d=a.updateQueue,y=d!==null?d.lastEffect:null;if(y!==null){var v=y.next;d=v;do{if((d.tag&r)===r){var E=d.inst,D=E.destroy;if(D!==void 0){E.destroy=void 0,y=a;var q=c,te=D;try{te()}catch(ue){yt(y,q,ue)}}}d=d.next}while(d!==v)}}catch(ue){yt(a,a.return,ue)}}function Aw(r){var a=r.updateQueue;if(a!==null){var c=r.stateNode;try{gS(a,c)}catch(d){yt(r,r.return,d)}}}function Cw(r,a,c){c.props=Zo(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(d){yt(r,a,d)}}function _d(r,a){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof c=="function"?r.refCleanup=c(d):c.current=d}}catch(y){yt(r,a,y)}}function ii(r,a){var c=r.ref,d=r.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(y){yt(r,a,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){yt(r,a,y)}else c.current=null}function Nw(r){var a=r.type,c=r.memoizedProps,d=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(y){yt(r,r.return,y)}}function tv(r,a,c){try{var d=r.stateNode;tO(d,r.type,c,a),d[xn]=a}catch(y){yt(r,r.return,y)}}function Iw(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&La(r.type)||r.tag===4}function nv(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Iw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&La(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function sv(r,a,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(r),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Tr));else if(d!==4&&(d===27&&La(r.type)&&(c=r.stateNode,a=null),r=r.child,r!==null))for(sv(r,a,c),r=r.sibling;r!==null;)sv(r,a,c),r=r.sibling}function ep(r,a,c){var d=r.tag;if(d===5||d===6)r=r.stateNode,a?c.insertBefore(r,a):c.appendChild(r);else if(d!==4&&(d===27&&La(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(ep(r,a,c),r=r.sibling;r!==null;)ep(r,a,c),r=r.sibling}function Rw(r){var a=r.stateNode,c=r.memoizedProps;try{for(var d=r.type,y=a.attributes;y.length;)a.removeAttributeNode(y[0]);Kn(a,d,c),a[Yt]=r,a[xn]=c}catch(v){yt(r,r.return,v)}}var Ui=!1,Tn=!1,rv=!1,jw=typeof WeakSet=="function"?WeakSet:Set,Un=null;function PD(r,a){if(r=r.containerInfo,Tv=_p,r=q_(r),Xg(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var y=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var E=0,D=-1,q=-1,te=0,ue=0,pe=r,se=null;t:for(;;){for(var oe;pe!==c||y!==0&&pe.nodeType!==3||(D=E+y),pe!==v||d!==0&&pe.nodeType!==3||(q=E+d),pe.nodeType===3&&(E+=pe.nodeValue.length),(oe=pe.firstChild)!==null;)se=pe,pe=oe;for(;;){if(pe===r)break t;if(se===c&&++te===y&&(D=E),se===v&&++ue===d&&(q=E),(oe=pe.nextSibling)!==null)break;pe=se,se=pe.parentNode}pe=oe}c=D===-1||q===-1?null:{start:D,end:q}}else c=null}c=c||{start:0,end:0}}else c=null;for(Av={focusedElem:r,selectionRange:c},_p=!1,Un=a;Un!==null;)if(a=Un,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,Un=r;else for(;Un!==null;){switch(a=Un,v=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)y=r[c],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&v!==null){r=void 0,c=a,y=v.memoizedProps,v=v.memoizedState,d=c.stateNode;try{var Ae=Zo(c.type,y);r=d.getSnapshotBeforeUpdate(Ae,v),d.__reactInternalSnapshotBeforeUpdate=r}catch(ke){yt(c,c.return,ke)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,c=r.nodeType,c===9)Iv(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Iv(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=a.sibling,r!==null){r.return=a.return,Un=r;break}Un=a.return}}function Dw(r,a,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Fi(r,c),d&4&&bd(5,c);break;case 1:if(Fi(r,c),d&4)if(r=c.stateNode,a===null)try{r.componentDidMount()}catch(E){yt(c,c.return,E)}else{var y=Zo(c.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(y,a,r.__reactInternalSnapshotBeforeUpdate)}catch(E){yt(c,c.return,E)}}d&64&&Aw(c),d&512&&_d(c,c.return);break;case 3:if(Fi(r,c),d&64&&(r=c.updateQueue,r!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{gS(r,a)}catch(E){yt(c,c.return,E)}}break;case 27:a===null&&d&4&&Rw(c);case 26:case 5:Fi(r,c),a===null&&d&4&&Nw(c),d&512&&_d(c,c.return);break;case 12:Fi(r,c);break;case 31:Fi(r,c),d&4&&kw(r,c);break;case 13:Fi(r,c),d&4&&Mw(r,c),d&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=qD.bind(null,c),cO(r,c))));break;case 22:if(d=c.memoizedState!==null||Ui,!d){a=a!==null&&a.memoizedState!==null||Tn,y=Ui;var v=Tn;Ui=d,(Tn=a)&&!v?zi(r,c,(c.subtreeFlags&8772)!==0):Fi(r,c),Ui=y,Tn=v}break;case 30:break;default:Fi(r,c)}}function Ow(r){var a=r.alternate;a!==null&&(r.alternate=null,Ow(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&$r(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var qt=null,As=!1;function Bi(r,a,c){for(c=c.child;c!==null;)Pw(r,a,c),c=c.sibling}function Pw(r,a,c){if(vn&&typeof vn.onCommitFiberUnmount=="function")try{vn.onCommitFiberUnmount(Jn,c)}catch{}switch(c.tag){case 26:Tn||ii(c,a),Bi(r,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Tn||ii(c,a);var d=qt,y=As;La(c.type)&&(qt=c.stateNode,As=!1),Bi(r,a,c),Rd(c.stateNode),qt=d,As=y;break;case 5:Tn||ii(c,a);case 6:if(d=qt,y=As,qt=null,Bi(r,a,c),qt=d,As=y,qt!==null)if(As)try{(qt.nodeType===9?qt.body:qt.nodeName==="HTML"?qt.ownerDocument.body:qt).removeChild(c.stateNode)}catch(v){yt(c,a,v)}else try{qt.removeChild(c.stateNode)}catch(v){yt(c,a,v)}break;case 18:qt!==null&&(As?(r=qt,AE(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Oc(r)):AE(qt,c.stateNode));break;case 4:d=qt,y=As,qt=c.stateNode.containerInfo,As=!0,Bi(r,a,c),qt=d,As=y;break;case 0:case 11:case 14:case 15:Ra(2,c,a),Tn||Ra(4,c,a),Bi(r,a,c);break;case 1:Tn||(ii(c,a),d=c.stateNode,typeof d.componentWillUnmount=="function"&&Cw(c,a,d)),Bi(r,a,c);break;case 21:Bi(r,a,c);break;case 22:Tn=(d=Tn)||c.memoizedState!==null,Bi(r,a,c),Tn=d;break;default:Bi(r,a,c)}}function kw(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Oc(r)}catch(c){yt(a,a.return,c)}}}function Mw(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Oc(r)}catch(c){yt(a,a.return,c)}}function kD(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new jw),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new jw),a;default:throw Error(s(435,r.tag))}}function tp(r,a){var c=kD(r);a.forEach(function(d){if(!c.has(d)){c.add(d);var y=HD.bind(null,r,d);d.then(y,y)}})}function Cs(r,a){var c=a.deletions;if(c!==null)for(var d=0;d<c.length;d++){var y=c[d],v=r,E=a,D=E;e:for(;D!==null;){switch(D.tag){case 27:if(La(D.type)){qt=D.stateNode,As=!1;break e}break;case 5:qt=D.stateNode,As=!1;break e;case 3:case 4:qt=D.stateNode.containerInfo,As=!0;break e}D=D.return}if(qt===null)throw Error(s(160));Pw(v,E,y),qt=null,As=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Lw(a,r),a=a.sibling}var jr=null;function Lw(r,a){var c=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Cs(a,r),Ns(r),d&4&&(Ra(3,r,r.return),bd(3,r),Ra(5,r,r.return));break;case 1:Cs(a,r),Ns(r),d&512&&(Tn||c===null||ii(c,c.return)),d&64&&Ui&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var y=jr;if(Cs(a,r),Ns(r),d&512&&(Tn||c===null||ii(c,c.return)),d&4){var v=c!==null?c.memoizedState:null;if(d=r.memoizedState,c===null)if(d===null)if(r.stateNode===null){e:{d=r.type,c=r.memoizedProps,y=y.ownerDocument||y;t:switch(d){case"title":v=y.getElementsByTagName("title")[0],(!v||v[en]||v[Yt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(d),y.head.insertBefore(v,y.querySelector("head > title"))),Kn(v,d,c),v[Yt]=r,bn(v),d=v;break e;case"link":var E=LE("link","href",y).get(d+(c.href||""));if(E){for(var D=0;D<E.length;D++)if(v=E[D],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){E.splice(D,1);break t}}v=y.createElement(d),Kn(v,d,c),y.head.appendChild(v);break;case"meta":if(E=LE("meta","content",y).get(d+(c.content||""))){for(D=0;D<E.length;D++)if(v=E[D],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){E.splice(D,1);break t}}v=y.createElement(d),Kn(v,d,c),y.head.appendChild(v);break;default:throw Error(s(468,d))}v[Yt]=r,bn(v),d=v}r.stateNode=d}else VE(y,r.type,r.stateNode);else r.stateNode=ME(y,d,r.memoizedProps);else v!==d?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,d===null?VE(y,r.type,r.stateNode):ME(y,d,r.memoizedProps)):d===null&&r.stateNode!==null&&tv(r,r.memoizedProps,c.memoizedProps)}break;case 27:Cs(a,r),Ns(r),d&512&&(Tn||c===null||ii(c,c.return)),c!==null&&d&4&&tv(r,r.memoizedProps,c.memoizedProps);break;case 5:if(Cs(a,r),Ns(r),d&512&&(Tn||c===null||ii(c,c.return)),r.flags&32){y=r.stateNode;try{Ts(y,"")}catch(Ae){yt(r,r.return,Ae)}}d&4&&r.stateNode!=null&&(y=r.memoizedProps,tv(r,y,c!==null?c.memoizedProps:y)),d&1024&&(rv=!0);break;case 6:if(Cs(a,r),Ns(r),d&4){if(r.stateNode===null)throw Error(s(162));d=r.memoizedProps,c=r.stateNode;try{c.nodeValue=d}catch(Ae){yt(r,r.return,Ae)}}break;case 3:if(yp=null,y=jr,jr=mp(a.containerInfo),Cs(a,r),jr=y,Ns(r),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Oc(a.containerInfo)}catch(Ae){yt(r,r.return,Ae)}rv&&(rv=!1,Vw(r));break;case 4:d=jr,jr=mp(r.stateNode.containerInfo),Cs(a,r),Ns(r),jr=d;break;case 12:Cs(a,r),Ns(r);break;case 31:Cs(a,r),Ns(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,tp(r,d)));break;case 13:Cs(a,r),Ns(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(sp=Bt()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,tp(r,d)));break;case 22:y=r.memoizedState!==null;var q=c!==null&&c.memoizedState!==null,te=Ui,ue=Tn;if(Ui=te||y,Tn=ue||q,Cs(a,r),Tn=ue,Ui=te,Ns(r),d&8192)e:for(a=r.stateNode,a._visibility=y?a._visibility&-2:a._visibility|1,y&&(c===null||q||Ui||Tn||el(r)),c=null,a=r;;){if(a.tag===5||a.tag===26){if(c===null){q=c=a;try{if(v=q.stateNode,y)E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{D=q.stateNode;var pe=q.memoizedProps.style,se=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;D.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Ae){yt(q,q.return,Ae)}}}else if(a.tag===6){if(c===null){q=a;try{q.stateNode.nodeValue=y?"":q.memoizedProps}catch(Ae){yt(q,q.return,Ae)}}}else if(a.tag===18){if(c===null){q=a;try{var oe=q.stateNode;y?CE(oe,!0):CE(q.stateNode,!1)}catch(Ae){yt(q,q.return,Ae)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=r.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,tp(r,c))));break;case 19:Cs(a,r),Ns(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,tp(r,d)));break;case 30:break;case 21:break;default:Cs(a,r),Ns(r)}}function Ns(r){var a=r.flags;if(a&2){try{for(var c,d=r.return;d!==null;){if(Iw(d)){c=d;break}d=d.return}if(c==null)throw Error(s(160));switch(c.tag){case 27:var y=c.stateNode,v=nv(r);ep(r,v,y);break;case 5:var E=c.stateNode;c.flags&32&&(Ts(E,""),c.flags&=-33);var D=nv(r);ep(r,D,E);break;case 3:case 4:var q=c.stateNode.containerInfo,te=nv(r);sv(r,te,q);break;default:throw Error(s(161))}}catch(ue){yt(r,r.return,ue)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function Vw(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;Vw(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Fi(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Dw(r,a.alternate,a),a=a.sibling}function el(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Ra(4,a,a.return),el(a);break;case 1:ii(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&Cw(a,a.return,c),el(a);break;case 27:Rd(a.stateNode);case 26:case 5:ii(a,a.return),el(a);break;case 22:a.memoizedState===null&&el(a);break;case 30:el(a);break;default:el(a)}r=r.sibling}}function zi(r,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,y=r,v=a,E=v.flags;switch(v.tag){case 0:case 11:case 15:zi(y,v,c),bd(4,v);break;case 1:if(zi(y,v,c),d=v,y=d.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(te){yt(d,d.return,te)}if(d=v,y=d.updateQueue,y!==null){var D=d.stateNode;try{var q=y.shared.hiddenCallbacks;if(q!==null)for(y.shared.hiddenCallbacks=null,y=0;y<q.length;y++)mS(q[y],D)}catch(te){yt(d,d.return,te)}}c&&E&64&&Aw(v),_d(v,v.return);break;case 27:Rw(v);case 26:case 5:zi(y,v,c),c&&d===null&&E&4&&Nw(v),_d(v,v.return);break;case 12:zi(y,v,c);break;case 31:zi(y,v,c),c&&E&4&&kw(y,v);break;case 13:zi(y,v,c),c&&E&4&&Mw(y,v);break;case 22:v.memoizedState===null&&zi(y,v,c),_d(v,v.return);break;case 30:break;default:zi(y,v,c)}a=a.sibling}}function iv(r,a){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&od(c))}function av(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&od(r))}function Dr(r,a,c,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Uw(r,a,c,d),a=a.sibling}function Uw(r,a,c,d){var y=a.flags;switch(a.tag){case 0:case 11:case 15:Dr(r,a,c,d),y&2048&&bd(9,a);break;case 1:Dr(r,a,c,d);break;case 3:Dr(r,a,c,d),y&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&od(r)));break;case 12:if(y&2048){Dr(r,a,c,d),r=a.stateNode;try{var v=a.memoizedProps,E=v.id,D=v.onPostCommit;typeof D=="function"&&D(E,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(q){yt(a,a.return,q)}}else Dr(r,a,c,d);break;case 31:Dr(r,a,c,d);break;case 13:Dr(r,a,c,d);break;case 23:break;case 22:v=a.stateNode,E=a.alternate,a.memoizedState!==null?v._visibility&2?Dr(r,a,c,d):Sd(r,a):v._visibility&2?Dr(r,a,c,d):(v._visibility|=2,Sc(r,a,c,d,(a.subtreeFlags&10256)!==0||!1)),y&2048&&iv(E,a);break;case 24:Dr(r,a,c,d),y&2048&&av(a.alternate,a);break;default:Dr(r,a,c,d)}}function Sc(r,a,c,d,y){for(y=y&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var v=r,E=a,D=c,q=d,te=E.flags;switch(E.tag){case 0:case 11:case 15:Sc(v,E,D,q,y),bd(8,E);break;case 23:break;case 22:var ue=E.stateNode;E.memoizedState!==null?ue._visibility&2?Sc(v,E,D,q,y):Sd(v,E):(ue._visibility|=2,Sc(v,E,D,q,y)),y&&te&2048&&iv(E.alternate,E);break;case 24:Sc(v,E,D,q,y),y&&te&2048&&av(E.alternate,E);break;default:Sc(v,E,D,q,y)}a=a.sibling}}function Sd(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=r,d=a,y=d.flags;switch(d.tag){case 22:Sd(c,d),y&2048&&iv(d.alternate,d);break;case 24:Sd(c,d),y&2048&&av(d.alternate,d);break;default:Sd(c,d)}a=a.sibling}}var wd=8192;function wc(r,a,c){if(r.subtreeFlags&wd)for(r=r.child;r!==null;)Bw(r,a,c),r=r.sibling}function Bw(r,a,c){switch(r.tag){case 26:wc(r,a,c),r.flags&wd&&r.memoizedState!==null&&_O(c,jr,r.memoizedState,r.memoizedProps);break;case 5:wc(r,a,c);break;case 3:case 4:var d=jr;jr=mp(r.stateNode.containerInfo),wc(r,a,c),jr=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=wd,wd=16777216,wc(r,a,c),wd=d):wc(r,a,c));break;default:wc(r,a,c)}}function Fw(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function Ed(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];Un=d,qw(d,r)}Fw(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)zw(r),r=r.sibling}function zw(r){switch(r.tag){case 0:case 11:case 15:Ed(r),r.flags&2048&&Ra(9,r,r.return);break;case 3:Ed(r);break;case 12:Ed(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,np(r)):Ed(r);break;default:Ed(r)}}function np(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];Un=d,qw(d,r)}Fw(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Ra(8,a,a.return),np(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,np(a));break;default:np(a)}r=r.sibling}}function qw(r,a){for(;Un!==null;){var c=Un;switch(c.tag){case 0:case 11:case 15:Ra(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:od(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Un=d;else e:for(c=r;Un!==null;){d=Un;var y=d.sibling,v=d.return;if(Ow(d),d===c){Un=null;break e}if(y!==null){y.return=v,Un=y;break e}Un=v}}}var MD={getCacheForType:function(r){var a=Gn(Sn),c=a.data.get(r);return c===void 0&&(c=r(),a.data.set(r,c)),c},cacheSignal:function(){return Gn(Sn).controller.signal}},LD=typeof WeakMap=="function"?WeakMap:Map,ft=0,jt=null,$e=null,Xe=0,gt=0,Ys=null,ja=!1,Ec=!1,ov=!1,qi=0,nn=0,Da=0,tl=0,lv=0,Ws=0,Tc=0,Td=null,Is=null,cv=!1,sp=0,Hw=0,rp=1/0,ip=null,Oa=null,jn=0,Pa=null,Ac=null,Hi=0,uv=0,dv=null,Gw=null,Ad=0,hv=null;function Xs(){return(ft&2)!==0&&Xe!==0?Xe&-Xe:G.T!==null?vv():da()}function $w(){if(Ws===0)if((Xe&536870912)===0||nt){var r=Ai;Ai<<=1,(Ai&3932160)===0&&(Ai=262144),Ws=r}else Ws=536870912;return r=Ks.current,r!==null&&(r.flags|=32),Ws}function Rs(r,a,c){(r===jt&&(gt===2||gt===9)||r.cancelPendingCommit!==null)&&(Cc(r,0),ka(r,Xe,Ws,!1)),wr(r,c),((ft&2)===0||r!==jt)&&(r===jt&&((ft&2)===0&&(tl|=c),nn===4&&ka(r,Xe,Ws,!1)),ai(r))}function Kw(r,a,c){if((ft&6)!==0)throw Error(s(327));var d=!c&&(a&127)===0&&(a&r.expiredLanes)===0||Zn(r,a),y=d?BD(r,a):pv(r,a,!0),v=d;do{if(y===0){Ec&&!d&&ka(r,a,0,!1);break}else{if(c=r.current.alternate,v&&!VD(c)){y=pv(r,a,!1),v=!1;continue}if(y===2){if(v=a,r.errorRecoveryDisabledLanes&v)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){a=E;e:{var D=r;y=Td;var q=D.current.memoizedState.isDehydrated;if(q&&(Cc(D,E).flags|=256),E=pv(D,E,!1),E!==2){if(ov&&!q){D.errorRecoveryDisabledLanes|=v,tl|=v,y=4;break e}v=Is,Is=y,v!==null&&(Is===null?Is=v:Is.push.apply(Is,v))}y=E}if(v=!1,y!==2)continue}}if(y===1){Cc(r,0),ka(r,a,0,!0);break}e:{switch(d=r,v=y,v){case 0:case 1:throw Error(s(345));case 4:if((a&4194048)!==a)break;case 6:ka(d,a,Ws,!ja);break e;case 2:Is=null;break;case 3:case 5:break;default:throw Error(s(329))}if((a&62914560)===a&&(y=sp+300-Bt(),10<y)){if(ka(d,a,Ws,!ja),Mt(d,0,!0)!==0)break e;Hi=a,d.timeoutHandle=EE(Qw.bind(null,d,c,Is,ip,cv,a,Ws,tl,Tc,ja,v,"Throttled",-0,0),y);break e}Qw(d,c,Is,ip,cv,a,Ws,tl,Tc,ja,v,null,-0,0)}}break}while(!0);ai(r)}function Qw(r,a,c,d,y,v,E,D,q,te,ue,pe,se,oe){if(r.timeoutHandle=-1,pe=a.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Tr},Bw(a,v,pe);var Ae=(v&62914560)===v?sp-Bt():(v&4194048)===v?Hw-Bt():0;if(Ae=SO(pe,Ae),Ae!==null){Hi=v,r.cancelPendingCommit=Ae(nE.bind(null,r,a,v,c,d,y,E,D,q,ue,pe,null,se,oe)),ka(r,v,E,!te);return}}nE(r,a,v,c,d,y,E,D,q)}function VD(r){for(var a=r;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var y=c[d],v=y.getSnapshot;y=y.value;try{if(!Gs(v(),y))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ka(r,a,c,d){a&=~lv,a&=~tl,r.suspendedLanes|=a,r.pingedLanes&=~a,d&&(r.warmLanes|=a),d=r.expirationTimes;for(var y=a;0<y;){var v=31-Ft(y),E=1<<v;d[v]=-1,y&=~E}c!==0&&Hr(r,c,a)}function ap(){return(ft&6)===0?(Cd(0),!1):!0}function fv(){if($e!==null){if(gt===0)var r=$e.return;else r=$e,Oi=$o=null,Iy(r),yc=null,cd=0,r=$e;for(;r!==null;)Tw(r.alternate,r),r=r.return;$e=null}}function Cc(r,a){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,rO(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),Hi=0,fv(),jt=r,$e=c=ji(r.current,null),Xe=a,gt=0,Ys=null,ja=!1,Ec=Zn(r,a),ov=!1,Tc=Ws=lv=tl=Da=nn=0,Is=Td=null,cv=!1,(a&8)!==0&&(a|=a&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=a;0<d;){var y=31-Ft(d),v=1<<y;a|=r[y],d&=~v}return qi=a,Cf(),c}function Yw(r,a){Fe=null,G.H=yd,a===gc||a===kf?(a=dS(),gt=3):a===yy?(a=dS(),gt=4):gt=a===Gy?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ys=a,$e===null&&(nn=1,Yf(r,fr(a,r.current)))}function Ww(){var r=Ks.current;return r===null?!0:(Xe&4194048)===Xe?yr===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?r===yr:!1}function Xw(){var r=G.H;return G.H=yd,r===null?yd:r}function Jw(){var r=G.A;return G.A=MD,r}function op(){nn=4,ja||(Xe&4194048)!==Xe&&Ks.current!==null||(Ec=!0),(Da&134217727)===0&&(tl&134217727)===0||jt===null||ka(jt,Xe,Ws,!1)}function pv(r,a,c){var d=ft;ft|=2;var y=Xw(),v=Jw();(jt!==r||Xe!==a)&&(ip=null,Cc(r,a)),a=!1;var E=nn;e:do try{if(gt!==0&&$e!==null){var D=$e,q=Ys;switch(gt){case 8:fv(),E=6;break e;case 3:case 2:case 9:case 6:Ks.current===null&&(a=!0);var te=gt;if(gt=0,Ys=null,Nc(r,D,q,te),c&&Ec){E=0;break e}break;default:te=gt,gt=0,Ys=null,Nc(r,D,q,te)}}UD(),E=nn;break}catch(ue){Yw(r,ue)}while(!0);return a&&r.shellSuspendCounter++,Oi=$o=null,ft=d,G.H=y,G.A=v,$e===null&&(jt=null,Xe=0,Cf()),E}function UD(){for(;$e!==null;)Zw($e)}function BD(r,a){var c=ft;ft|=2;var d=Xw(),y=Jw();jt!==r||Xe!==a?(ip=null,rp=Bt()+500,Cc(r,a)):Ec=Zn(r,a);e:do try{if(gt!==0&&$e!==null){a=$e;var v=Ys;t:switch(gt){case 1:gt=0,Ys=null,Nc(r,a,v,1);break;case 2:case 9:if(cS(v)){gt=0,Ys=null,eE(a);break}a=function(){gt!==2&&gt!==9||jt!==r||(gt=7),ai(r)},v.then(a,a);break e;case 3:gt=7;break e;case 4:gt=5;break e;case 7:cS(v)?(gt=0,Ys=null,eE(a)):(gt=0,Ys=null,Nc(r,a,v,7));break;case 5:var E=null;switch($e.tag){case 26:E=$e.memoizedState;case 5:case 27:var D=$e;if(E?UE(E):D.stateNode.complete){gt=0,Ys=null;var q=D.sibling;if(q!==null)$e=q;else{var te=D.return;te!==null?($e=te,lp(te)):$e=null}break t}}gt=0,Ys=null,Nc(r,a,v,5);break;case 6:gt=0,Ys=null,Nc(r,a,v,6);break;case 8:fv(),nn=6;break e;default:throw Error(s(462))}}FD();break}catch(ue){Yw(r,ue)}while(!0);return Oi=$o=null,G.H=d,G.A=y,ft=c,$e!==null?0:(jt=null,Xe=0,Cf(),nn)}function FD(){for(;$e!==null&&!Se();)Zw($e)}function Zw(r){var a=ww(r.alternate,r,qi);r.memoizedProps=r.pendingProps,a===null?lp(r):$e=a}function eE(r){var a=r,c=a.alternate;switch(a.tag){case 15:case 0:a=yw(c,a,a.pendingProps,a.type,void 0,Xe);break;case 11:a=yw(c,a,a.pendingProps,a.type.render,a.ref,Xe);break;case 5:Iy(a);default:Tw(c,a),a=$e=J_(a,qi),a=ww(c,a,qi)}r.memoizedProps=r.pendingProps,a===null?lp(r):$e=a}function Nc(r,a,c,d){Oi=$o=null,Iy(a),yc=null,cd=0;var y=a.return;try{if(ID(r,y,a,c,Xe)){nn=1,Yf(r,fr(c,r.current)),$e=null;return}}catch(v){if(y!==null)throw $e=y,v;nn=1,Yf(r,fr(c,r.current)),$e=null;return}a.flags&32768?(nt||d===1?r=!0:Ec||(Xe&536870912)!==0?r=!1:(ja=r=!0,(d===2||d===9||d===3||d===6)&&(d=Ks.current,d!==null&&d.tag===13&&(d.flags|=16384))),tE(a,r)):lp(a)}function lp(r){var a=r;do{if((a.flags&32768)!==0){tE(a,ja);return}r=a.return;var c=DD(a.alternate,a,qi);if(c!==null){$e=c;return}if(a=a.sibling,a!==null){$e=a;return}$e=a=r}while(a!==null);nn===0&&(nn=5)}function tE(r,a){do{var c=OD(r.alternate,r);if(c!==null){c.flags&=32767,$e=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(r=r.sibling,r!==null)){$e=r;return}$e=r=c}while(r!==null);nn=6,$e=null}function nE(r,a,c,d,y,v,E,D,q){r.cancelPendingCommit=null;do cp();while(jn!==0);if((ft&6)!==0)throw Error(s(327));if(a!==null){if(a===r.current)throw Error(s(177));if(v=a.lanes|a.childLanes,v|=ny,Yl(r,c,v,E,D,q),r===jt&&($e=jt=null,Xe=0),Ac=a,Pa=r,Hi=c,uv=v,dv=y,Gw=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,GD(Us,function(){return oE(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=G.T,G.T=null,y=ne.p,ne.p=2,E=ft,ft|=4;try{PD(r,a,c)}finally{ft=E,ne.p=y,G.T=d}}jn=1,sE(),rE(),iE()}}function sE(){if(jn===1){jn=0;var r=Pa,a=Ac,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=G.T,G.T=null;var d=ne.p;ne.p=2;var y=ft;ft|=4;try{Lw(a,r);var v=Av,E=q_(r.containerInfo),D=v.focusedElem,q=v.selectionRange;if(E!==D&&D&&D.ownerDocument&&z_(D.ownerDocument.documentElement,D)){if(q!==null&&Xg(D)){var te=q.start,ue=q.end;if(ue===void 0&&(ue=te),"selectionStart"in D)D.selectionStart=te,D.selectionEnd=Math.min(ue,D.value.length);else{var pe=D.ownerDocument||document,se=pe&&pe.defaultView||window;if(se.getSelection){var oe=se.getSelection(),Ae=D.textContent.length,ke=Math.min(q.start,Ae),Ct=q.end===void 0?ke:Math.min(q.end,Ae);!oe.extend&&ke>Ct&&(E=Ct,Ct=ke,ke=E);var Q=F_(D,ke),$=F_(D,Ct);if(Q&&$&&(oe.rangeCount!==1||oe.anchorNode!==Q.node||oe.anchorOffset!==Q.offset||oe.focusNode!==$.node||oe.focusOffset!==$.offset)){var ee=pe.createRange();ee.setStart(Q.node,Q.offset),oe.removeAllRanges(),ke>Ct?(oe.addRange(ee),oe.extend($.node,$.offset)):(ee.setEnd($.node,$.offset),oe.addRange(ee))}}}}for(pe=[],oe=D;oe=oe.parentNode;)oe.nodeType===1&&pe.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<pe.length;D++){var he=pe[D];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}_p=!!Tv,Av=Tv=null}finally{ft=y,ne.p=d,G.T=c}}r.current=a,jn=2}}function rE(){if(jn===2){jn=0;var r=Pa,a=Ac,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=G.T,G.T=null;var d=ne.p;ne.p=2;var y=ft;ft|=4;try{Dw(r,a.alternate,a)}finally{ft=y,ne.p=d,G.T=c}}jn=3}}function iE(){if(jn===4||jn===3){jn=0,It();var r=Pa,a=Ac,c=Hi,d=Gw;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?jn=5:(jn=0,Ac=Pa=null,aE(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(Oa=null),Fs(c),a=a.stateNode,vn&&typeof vn.onCommitFiberRoot=="function")try{vn.onCommitFiberRoot(Jn,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=G.T,y=ne.p,ne.p=2,G.T=null;try{for(var v=r.onRecoverableError,E=0;E<d.length;E++){var D=d[E];v(D.value,{componentStack:D.stack})}}finally{G.T=a,ne.p=y}}(Hi&3)!==0&&cp(),ai(r),y=r.pendingLanes,(c&261930)!==0&&(y&42)!==0?r===hv?Ad++:(Ad=0,hv=r):Ad=0,Cd(0)}}function aE(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,od(a)))}function cp(){return sE(),rE(),iE(),oE()}function oE(){if(jn!==5)return!1;var r=Pa,a=uv;uv=0;var c=Fs(Hi),d=G.T,y=ne.p;try{ne.p=32>c?32:c,G.T=null,c=dv,dv=null;var v=Pa,E=Hi;if(jn=0,Ac=Pa=null,Hi=0,(ft&6)!==0)throw Error(s(331));var D=ft;if(ft|=4,zw(v.current),Uw(v,v.current,E,c),ft=D,Cd(0,!1),vn&&typeof vn.onPostCommitFiberRoot=="function")try{vn.onPostCommitFiberRoot(Jn,v)}catch{}return!0}finally{ne.p=y,G.T=d,aE(r,a)}}function lE(r,a,c){a=fr(c,a),a=Hy(r.stateNode,a,2),r=Ca(r,a,2),r!==null&&(wr(r,2),ai(r))}function yt(r,a,c){if(r.tag===3)lE(r,r,c);else for(;a!==null;){if(a.tag===3){lE(a,r,c);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Oa===null||!Oa.has(d))){r=fr(c,r),c=cw(2),d=Ca(a,c,2),d!==null&&(uw(c,d,a,r),wr(d,2),ai(d));break}}a=a.return}}function mv(r,a,c){var d=r.pingCache;if(d===null){d=r.pingCache=new LD;var y=new Set;d.set(a,y)}else y=d.get(a),y===void 0&&(y=new Set,d.set(a,y));y.has(c)||(ov=!0,y.add(c),r=zD.bind(null,r,a,c),a.then(r,r))}function zD(r,a,c){var d=r.pingCache;d!==null&&d.delete(a),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,jt===r&&(Xe&c)===c&&(nn===4||nn===3&&(Xe&62914560)===Xe&&300>Bt()-sp?(ft&2)===0&&Cc(r,0):lv|=c,Tc===Xe&&(Tc=0)),ai(r)}function cE(r,a){a===0&&(a=ds()),r=qo(r,a),r!==null&&(wr(r,a),ai(r))}function qD(r){var a=r.memoizedState,c=0;a!==null&&(c=a.retryLane),cE(r,c)}function HD(r,a){var c=0;switch(r.tag){case 31:case 13:var d=r.stateNode,y=r.memoizedState;y!==null&&(c=y.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(s(314))}d!==null&&d.delete(a),cE(r,c)}function GD(r,a){return Kt(r,a)}var up=null,Ic=null,gv=!1,dp=!1,yv=!1,Ma=0;function ai(r){r!==Ic&&r.next===null&&(Ic===null?up=Ic=r:Ic=Ic.next=r),dp=!0,gv||(gv=!0,KD())}function Cd(r,a){if(!yv&&dp){yv=!0;do for(var c=!1,d=up;d!==null;){if(r!==0){var y=d.pendingLanes;if(y===0)var v=0;else{var E=d.suspendedLanes,D=d.pingedLanes;v=(1<<31-Ft(42|r)+1)-1,v&=y&~(E&~D),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,fE(d,v))}else v=Xe,v=Mt(d,d===jt?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||Zn(d,v)||(c=!0,fE(d,v));d=d.next}while(c);yv=!1}}function $D(){uE()}function uE(){dp=gv=!1;var r=0;Ma!==0&&sO()&&(r=Ma);for(var a=Bt(),c=null,d=up;d!==null;){var y=d.next,v=dE(d,a);v===0?(d.next=null,c===null?up=y:c.next=y,y===null&&(Ic=c)):(c=d,(r!==0||(v&3)!==0)&&(dp=!0)),d=y}jn!==0&&jn!==5||Cd(r),Ma!==0&&(Ma=0)}function dE(r,a){for(var c=r.suspendedLanes,d=r.pingedLanes,y=r.expirationTimes,v=r.pendingLanes&-62914561;0<v;){var E=31-Ft(v),D=1<<E,q=y[E];q===-1?((D&c)===0||(D&d)!==0)&&(y[E]=Rt(D,a)):q<=a&&(r.expiredLanes|=D),v&=~D}if(a=jt,c=Xe,c=Mt(r,r===a?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,c===0||r===a&&(gt===2||gt===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&xs(d),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Zn(r,c)){if(a=c&-c,a===r.callbackPriority)return a;switch(d!==null&&xs(d),Fs(c)){case 2:case 8:c=bs;break;case 32:c=Us;break;case 268435456:c=Io;break;default:c=Us}return d=hE.bind(null,r),c=Kt(c,d),r.callbackPriority=a,r.callbackNode=c,a}return d!==null&&d!==null&&xs(d),r.callbackPriority=2,r.callbackNode=null,2}function hE(r,a){if(jn!==0&&jn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(cp()&&r.callbackNode!==c)return null;var d=Xe;return d=Mt(r,r===jt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(Kw(r,d,a),dE(r,Bt()),r.callbackNode!=null&&r.callbackNode===c?hE.bind(null,r):null)}function fE(r,a){if(cp())return null;Kw(r,a,!0)}function KD(){iO(function(){(ft&6)!==0?Kt(Vs,$D):uE()})}function vv(){if(Ma===0){var r=pc;r===0&&(r=Bs,Bs<<=1,(Bs&261888)===0&&(Bs=256)),Ma=r}return Ma}function pE(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Zl(""+r)}function mE(r,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,r.id&&c.setAttribute("form",r.id),a.parentNode.insertBefore(c,a),r=new FormData(r),c.parentNode.removeChild(c),r}function QD(r,a,c,d,y){if(a==="submit"&&c&&c.stateNode===y){var v=pE((y[xn]||null).action),E=d.submitter;E&&(a=(a=E[xn]||null)?pE(a.formAction):E.getAttribute("formAction"),a!==null&&(v=a,E=null));var D=new Zr("action","action",null,d,y);r.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Ma!==0){var q=E?mE(y,E):new FormData(y);Vy(c,{pending:!0,data:q,method:y.method,action:v},null,q)}}else typeof v=="function"&&(D.preventDefault(),q=E?mE(y,E):new FormData(y),Vy(c,{pending:!0,data:q,method:y.method,action:v},v,q))},currentTarget:y}]})}}for(var xv=0;xv<ty.length;xv++){var bv=ty[xv],YD=bv.toLowerCase(),WD=bv[0].toUpperCase()+bv.slice(1);Rr(YD,"on"+WD)}Rr($_,"onAnimationEnd"),Rr(K_,"onAnimationIteration"),Rr(Q_,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(hD,"onTransitionRun"),Rr(fD,"onTransitionStart"),Rr(pD,"onTransitionCancel"),Rr(Y_,"onTransitionEnd"),Yr("onMouseEnter",["mouseout","mouseover"]),Yr("onMouseLeave",["mouseout","mouseover"]),Yr("onPointerEnter",["pointerout","pointerover"]),Yr("onPointerLeave",["pointerout","pointerover"]),Qr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Nd));function gE(r,a){a=(a&4)!==0;for(var c=0;c<r.length;c++){var d=r[c],y=d.event;d=d.listeners;e:{var v=void 0;if(a)for(var E=d.length-1;0<=E;E--){var D=d[E],q=D.instance,te=D.currentTarget;if(D=D.listener,q!==v&&y.isPropagationStopped())break e;v=D,y.currentTarget=te;try{v(y)}catch(ue){Af(ue)}y.currentTarget=null,v=q}else for(E=0;E<d.length;E++){if(D=d[E],q=D.instance,te=D.currentTarget,D=D.listener,q!==v&&y.isPropagationStopped())break e;v=D,y.currentTarget=te;try{v(y)}catch(ue){Af(ue)}y.currentTarget=null,v=q}}}}function Ke(r,a){var c=a[Ue];c===void 0&&(c=a[Ue]=new Set);var d=r+"__bubble";c.has(d)||(yE(a,r,2,!1),c.add(d))}function _v(r,a,c){var d=0;a&&(d|=4),yE(c,r,d,a)}var hp="_reactListening"+Math.random().toString(36).slice(2);function Sv(r){if(!r[hp]){r[hp]=!0,Bu.forEach(function(c){c!=="selectionchange"&&(XD.has(c)||_v(c,!1,r),_v(c,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[hp]||(a[hp]=!0,_v("selectionchange",!1,a))}}function yE(r,a,c,d){switch($E(a)){case 2:var y=TO;break;case 8:y=AO;break;default:y=Lv}c=y.bind(null,a,c,r),y=void 0,!ko||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),d?y!==void 0?r.addEventListener(a,c,{capture:!0,passive:y}):r.addEventListener(a,c,!0):y!==void 0?r.addEventListener(a,c,{passive:y}):r.addEventListener(a,c,!1)}function wv(r,a,c,d,y){var v=d;if((a&1)===0&&(a&2)===0&&d!==null)e:for(;;){if(d===null)return;var E=d.tag;if(E===3||E===4){var D=d.stateNode.containerInfo;if(D===y)break;if(E===4)for(E=d.return;E!==null;){var q=E.tag;if((q===3||q===4)&&E.stateNode.containerInfo===y)return;E=E.return}for(;D!==null;){if(E=lr(D),E===null)return;if(q=E.tag,q===5||q===6||q===26||q===27){d=v=E;continue e}D=D.parentNode}}d=d.return}ya(function(){var te=v,ue=cr(c),pe=[];e:{var se=W_.get(r);if(se!==void 0){var oe=Zr,Ae=r;switch(r){case"keypress":if(Lo(c)===0)break e;case"keydown":case"keyup":oe=wf;break;case"focusin":Ae="focus",oe=Uo;break;case"focusout":Ae="blur",oe=Uo;break;case"beforeblur":case"afterblur":oe=Uo;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Zu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=pf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=_;break;case $_:case K_:case Q_:oe=gf;break;case Y_:oe=P;break;case"scroll":case"scrollend":oe=Ju;break;case"wheel":oe=re;break;case"copy":case"cut":case"paste":oe=yf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Ri;break;case"toggle":case"beforetoggle":oe=Be}var ke=(a&4)!==0,Ct=!ke&&(r==="scroll"||r==="scrollend"),Q=ke?se!==null?se+"Capture":null:se;ke=[];for(var $=te,ee;$!==null;){var he=$;if(ee=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||ee===null||Q===null||(he=Ar($,Q),he!=null&&ke.push(Id($,he,ee))),Ct)break;$=$.return}0<ke.length&&(se=new oe(se,Ae,null,c,ue),pe.push({event:se,listeners:ke}))}}if((a&7)===0){e:{if(se=r==="mouseover"||r==="pointerover",oe=r==="mouseout"||r==="pointerout",se&&c!==Yu&&(Ae=c.relatedTarget||c.fromElement)&&(lr(Ae)||Ae[or]))break e;if((oe||se)&&(se=ue.window===ue?ue:(se=ue.ownerDocument)?se.defaultView||se.parentWindow:window,oe?(Ae=c.relatedTarget||c.toElement,oe=te,Ae=Ae?lr(Ae):null,Ae!==null&&(Ct=o(Ae),ke=Ae.tag,Ae!==Ct||ke!==5&&ke!==27&&ke!==6)&&(Ae=null)):(oe=null,Ae=te),oe!==Ae)){if(ke=Zu,he="onMouseLeave",Q="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(ke=Ri,he="onPointerLeave",Q="onPointerEnter",$="pointer"),Ct=oe==null?se:qs(oe),ee=Ae==null?se:qs(Ae),se=new ke(he,$+"leave",oe,c,ue),se.target=Ct,se.relatedTarget=ee,he=null,lr(ue)===te&&(ke=new ke(Q,$+"enter",Ae,c,ue),ke.target=ee,ke.relatedTarget=Ct,he=ke),Ct=he,oe&&Ae)t:{for(ke=JD,Q=oe,$=Ae,ee=0,he=Q;he;he=ke(he))ee++;he=0;for(var je=$;je;je=ke(je))he++;for(;0<ee-he;)Q=ke(Q),ee--;for(;0<he-ee;)$=ke($),he--;for(;ee--;){if(Q===$||$!==null&&Q===$.alternate){ke=Q;break t}Q=ke(Q),$=ke($)}ke=null}else ke=null;oe!==null&&vE(pe,se,oe,ke,!1),Ae!==null&&Ct!==null&&vE(pe,Ct,Ae,ke,!0)}}e:{if(se=te?qs(te):window,oe=se.nodeName&&se.nodeName.toLowerCase(),oe==="select"||oe==="input"&&se.type==="file")var lt=k_;else if(O_(se))if(M_)lt=cD;else{lt=oD;var Ne=aD}else oe=se.nodeName,!oe||oe.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?te&&Jl(te.elementType)&&(lt=k_):lt=lD;if(lt&&(lt=lt(r,te))){P_(pe,lt,c,ue);break e}Ne&&Ne(r,se,te),r==="focusout"&&te&&se.type==="number"&&te.memoizedProps.value!=null&&$u(se,"number",se.value)}switch(Ne=te?qs(te):window,r){case"focusin":(O_(Ne)||Ne.contentEditable==="true")&&(ac=Ne,Jg=te,rd=null);break;case"focusout":rd=Jg=ac=null;break;case"mousedown":Zg=!0;break;case"contextmenu":case"mouseup":case"dragend":Zg=!1,H_(pe,c,ue);break;case"selectionchange":if(dD)break;case"keydown":case"keyup":H_(pe,c,ue)}var qe;if(ht)e:{switch(r){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else ic?Bo(r,c)&&(Je="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Je="onCompositionStart");Je&&(ni&&c.locale!=="ko"&&(ic||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&ic&&(qe=Xu()):(Jr=ue,Wu="value"in Jr?Jr.value:Jr.textContent,ic=!0)),Ne=fp(te,Je),0<Ne.length&&(Je=new ti(Je,r,null,c,ue),pe.push({event:Je,listeners:Ne}),qe?Je.data=qe:(qe=rc(c),qe!==null&&(Je.data=qe)))),(qe=dr?nD(r,c):sD(r,c))&&(Je=fp(te,"onBeforeInput"),0<Je.length&&(Ne=new ti("onBeforeInput","beforeinput",null,c,ue),pe.push({event:Ne,listeners:Je}),Ne.data=qe)),QD(pe,r,te,c,ue)}gE(pe,a)})}function Id(r,a,c){return{instance:r,listener:a,currentTarget:c}}function fp(r,a){for(var c=a+"Capture",d=[];r!==null;){var y=r,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=Ar(r,c),y!=null&&d.unshift(Id(r,y,v)),y=Ar(r,a),y!=null&&d.push(Id(r,y,v))),r.tag===3)return d;r=r.return}return[]}function JD(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function vE(r,a,c,d,y){for(var v=a._reactName,E=[];c!==null&&c!==d;){var D=c,q=D.alternate,te=D.stateNode;if(D=D.tag,q!==null&&q===d)break;D!==5&&D!==26&&D!==27||te===null||(q=te,y?(te=Ar(c,v),te!=null&&E.unshift(Id(c,te,q))):y||(te=Ar(c,v),te!=null&&E.push(Id(c,te,q)))),c=c.return}E.length!==0&&r.push({event:a,listeners:E})}var ZD=/\r\n?/g,eO=/\u0000|\uFFFD/g;function xE(r){return(typeof r=="string"?r:""+r).replace(ZD,`
`).replace(eO,"")}function bE(r,a){return a=xE(a),xE(r)===a}function At(r,a,c,d,y,v){switch(c){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Ts(r,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Ts(r,""+d);break;case"className":Hs(r,"class",d);break;case"tabIndex":Hs(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Hs(r,c,d);break;case"style":Qu(r,d,v);break;case"data":if(a!=="object"){Hs(r,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||c!=="href")){r.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Zl(""+d),r.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(a!=="input"&&At(r,a,"name",y.name,y,null),At(r,a,"formEncType",y.formEncType,y,null),At(r,a,"formMethod",y.formMethod,y,null),At(r,a,"formTarget",y.formTarget,y,null)):(At(r,a,"encType",y.encType,y,null),At(r,a,"method",y.method,y,null),At(r,a,"target",y.target,y,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(c);break}d=Zl(""+d),r.setAttribute(c,d);break;case"onClick":d!=null&&(r.onclick=Tr);break;case"onScroll":d!=null&&Ke("scroll",r);break;case"onScrollEnd":d!=null&&Ke("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(c=d.__html,c!=null){if(y.children!=null)throw Error(s(60));r.innerHTML=c}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}c=Zl(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""+d):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":d===!0?r.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(c,d):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(c,d):r.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(c):r.setAttribute(c,d);break;case"popover":Ke("beforetoggle",r),Ke("toggle",r),Wl(r,"popover",d);break;case"xlinkActuate":_n(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":_n(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":_n(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":_n(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":_n(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":_n(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":_n(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":_n(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":_n(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Wl(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=ff.get(c)||c,Wl(r,c,d))}}function Ev(r,a,c,d,y,v){switch(c){case"style":Qu(r,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(c=d.__html,c!=null){if(y.children!=null)throw Error(s(60));r.innerHTML=c}}break;case"children":typeof d=="string"?Ts(r,d):(typeof d=="number"||typeof d=="bigint")&&Ts(r,""+d);break;case"onScroll":d!=null&&Ke("scroll",r);break;case"onScrollEnd":d!=null&&Ke("scrollend",r);break;case"onClick":d!=null&&(r.onclick=Tr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fu.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),a=c.slice(2,y?c.length-7:void 0),v=r[xn]||null,v=v!=null?v[c]:null,typeof v=="function"&&r.removeEventListener(a,v,y),typeof d=="function")){typeof v!="function"&&v!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(a,d,y);break e}c in r?r[c]=d:d===!0?r.setAttribute(c,""):Wl(r,c,d)}}}function Kn(r,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",r),Ke("load",r);var d=!1,y=!1,v;for(v in c)if(c.hasOwnProperty(v)){var E=c[v];if(E!=null)switch(v){case"src":d=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:At(r,a,v,E,c,null)}}y&&At(r,a,"srcSet",c.srcSet,c,null),d&&At(r,a,"src",c.src,c,null);return;case"input":Ke("invalid",r);var D=v=E=y=null,q=null,te=null;for(d in c)if(c.hasOwnProperty(d)){var ue=c[d];if(ue!=null)switch(d){case"name":y=ue;break;case"type":E=ue;break;case"checked":q=ue;break;case"defaultChecked":te=ue;break;case"value":v=ue;break;case"defaultValue":D=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,a));break;default:At(r,a,d,ue,c,null)}}uf(r,v,D,q,te,E,y,!1);return;case"select":Ke("invalid",r),d=E=v=null;for(y in c)if(c.hasOwnProperty(y)&&(D=c[y],D!=null))switch(y){case"value":v=D;break;case"defaultValue":E=D;break;case"multiple":d=D;default:At(r,a,y,D,c,null)}a=v,c=E,r.multiple=!!d,a!=null?fa(r,!!d,a,!1):c!=null&&fa(r,!!d,c,!0);return;case"textarea":Ke("invalid",r),v=y=d=null;for(E in c)if(c.hasOwnProperty(E)&&(D=c[E],D!=null))switch(E){case"value":d=D;break;case"defaultValue":y=D;break;case"children":v=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(s(91));break;default:At(r,a,E,D,c,null)}pa(r,d,y,v);return;case"option":for(q in c)c.hasOwnProperty(q)&&(d=c[q],d!=null)&&(q==="selected"?r.selected=d&&typeof d!="function"&&typeof d!="symbol":At(r,a,q,d,c,null));return;case"dialog":Ke("beforetoggle",r),Ke("toggle",r),Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":Ke("load",r);break;case"video":case"audio":for(d=0;d<Nd.length;d++)Ke(Nd[d],r);break;case"image":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"embed":case"source":case"link":Ke("error",r),Ke("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in c)if(c.hasOwnProperty(te)&&(d=c[te],d!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,a));default:At(r,a,te,d,c,null)}return;default:if(Jl(a)){for(ue in c)c.hasOwnProperty(ue)&&(d=c[ue],d!==void 0&&Ev(r,a,ue,d,c,void 0));return}}for(D in c)c.hasOwnProperty(D)&&(d=c[D],d!=null&&At(r,a,D,d,c,null))}function tO(r,a,c,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,E=null,D=null,q=null,te=null,ue=null;for(oe in c){var pe=c[oe];if(c.hasOwnProperty(oe)&&pe!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":q=pe;default:d.hasOwnProperty(oe)||At(r,a,oe,null,d,pe)}}for(var se in d){var oe=d[se];if(pe=c[se],d.hasOwnProperty(se)&&(oe!=null||pe!=null))switch(se){case"type":v=oe;break;case"name":y=oe;break;case"checked":te=oe;break;case"defaultChecked":ue=oe;break;case"value":E=oe;break;case"defaultValue":D=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,a));break;default:oe!==pe&&At(r,a,se,oe,d,pe)}}Xl(r,E,D,q,te,ue,v,y);return;case"select":oe=E=D=se=null;for(v in c)if(q=c[v],c.hasOwnProperty(v)&&q!=null)switch(v){case"value":break;case"multiple":oe=q;default:d.hasOwnProperty(v)||At(r,a,v,null,d,q)}for(y in d)if(v=d[y],q=c[y],d.hasOwnProperty(y)&&(v!=null||q!=null))switch(y){case"value":se=v;break;case"defaultValue":D=v;break;case"multiple":E=v;default:v!==q&&At(r,a,y,v,d,q)}a=D,c=E,d=oe,se!=null?fa(r,!!c,se,!1):!!d!=!!c&&(a!=null?fa(r,!!c,a,!0):fa(r,!!c,c?[]:"",!1));return;case"textarea":oe=se=null;for(D in c)if(y=c[D],c.hasOwnProperty(D)&&y!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:At(r,a,D,null,d,y)}for(E in d)if(y=d[E],v=c[E],d.hasOwnProperty(E)&&(y!=null||v!=null))switch(E){case"value":se=y;break;case"defaultValue":oe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(s(91));break;default:y!==v&&At(r,a,E,y,d,v)}df(r,se,oe);return;case"option":for(var Ae in c)se=c[Ae],c.hasOwnProperty(Ae)&&se!=null&&!d.hasOwnProperty(Ae)&&(Ae==="selected"?r.selected=!1:At(r,a,Ae,null,d,se));for(q in d)se=d[q],oe=c[q],d.hasOwnProperty(q)&&se!==oe&&(se!=null||oe!=null)&&(q==="selected"?r.selected=se&&typeof se!="function"&&typeof se!="symbol":At(r,a,q,se,d,oe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in c)se=c[ke],c.hasOwnProperty(ke)&&se!=null&&!d.hasOwnProperty(ke)&&At(r,a,ke,null,d,se);for(te in d)if(se=d[te],oe=c[te],d.hasOwnProperty(te)&&se!==oe&&(se!=null||oe!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(s(137,a));break;default:At(r,a,te,se,d,oe)}return;default:if(Jl(a)){for(var Ct in c)se=c[Ct],c.hasOwnProperty(Ct)&&se!==void 0&&!d.hasOwnProperty(Ct)&&Ev(r,a,Ct,void 0,d,se);for(ue in d)se=d[ue],oe=c[ue],!d.hasOwnProperty(ue)||se===oe||se===void 0&&oe===void 0||Ev(r,a,ue,se,d,oe);return}}for(var Q in c)se=c[Q],c.hasOwnProperty(Q)&&se!=null&&!d.hasOwnProperty(Q)&&At(r,a,Q,null,d,se);for(pe in d)se=d[pe],oe=c[pe],!d.hasOwnProperty(pe)||se===oe||se==null&&oe==null||At(r,a,pe,se,d,oe)}function _E(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nO(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var y=c[d],v=y.transferSize,E=y.initiatorType,D=y.duration;if(v&&D&&_E(E)){for(E=0,D=y.responseEnd,d+=1;d<c.length;d++){var q=c[d],te=q.startTime;if(te>D)break;var ue=q.transferSize,pe=q.initiatorType;ue&&_E(pe)&&(q=q.responseEnd,E+=ue*(q<D?1:(D-te)/(q-te)))}if(--d,a+=8*(v+E)/(y.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Tv=null,Av=null;function pp(r){return r.nodeType===9?r:r.ownerDocument}function SE(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wE(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Cv(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Nv=null;function sO(){var r=window.event;return r&&r.type==="popstate"?r===Nv?!1:(Nv=r,!0):(Nv=null,!1)}var EE=typeof setTimeout=="function"?setTimeout:void 0,rO=typeof clearTimeout=="function"?clearTimeout:void 0,TE=typeof Promise=="function"?Promise:void 0,iO=typeof queueMicrotask=="function"?queueMicrotask:typeof TE<"u"?function(r){return TE.resolve(null).then(r).catch(aO)}:EE;function aO(r){setTimeout(function(){throw r})}function La(r){return r==="head"}function AE(r,a){var c=a,d=0;do{var y=c.nextSibling;if(r.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"||c==="/&"){if(d===0){r.removeChild(y),Oc(a);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Rd(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,Rd(c);for(var v=c.firstChild;v;){var E=v.nextSibling,D=v.nodeName;v[en]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&v.rel.toLowerCase()==="stylesheet"||c.removeChild(v),v=E}}else c==="body"&&Rd(r.ownerDocument.body);c=y}while(c);Oc(a)}function CE(r,a){var c=r;r=0;do{var d=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=d}while(c)}function Iv(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Iv(c),$r(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function oO(r,a,c,d){for(;r.nodeType===1;){var y=c;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[en])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(v=r.getAttribute("rel"),v==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(v!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(v=r.getAttribute("src"),(v!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===v)return r}else return r;if(r=vr(r.nextSibling),r===null)break}return null}function lO(r,a,c){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=vr(r.nextSibling),r===null))return null;return r}function NE(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=vr(r.nextSibling),r===null))return null;return r}function Rv(r){return r.data==="$?"||r.data==="$~"}function jv(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function cO(r,a){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||c.readyState!=="loading")a();else{var d=function(){a(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function vr(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var Dv=null;function IE(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(a===0)return vr(r.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}r=r.nextSibling}return null}function RE(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return r;a--}else c!=="/$"&&c!=="/&"||a++}r=r.previousSibling}return null}function jE(r,a,c){switch(a=pp(c),r){case"html":if(r=a.documentElement,!r)throw Error(s(452));return r;case"head":if(r=a.head,!r)throw Error(s(453));return r;case"body":if(r=a.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function Rd(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);$r(r)}var xr=new Map,DE=new Set;function mp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Gi=ne.d;ne.d={f:uO,r:dO,D:hO,C:fO,L:pO,m:mO,X:yO,S:gO,M:vO};function uO(){var r=Gi.f(),a=ap();return r||a}function dO(r){var a=ws(r);a!==null&&a.tag===5&&a.type==="form"?YS(a):Gi.r(r)}var Rc=typeof document>"u"?null:document;function OE(r,a,c){var d=Rc;if(d&&typeof a=="string"&&a){var y=Es(a);y='link[rel="'+r+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),DE.has(y)||(DE.add(y),r={rel:r,crossOrigin:c,href:a},d.querySelector(y)===null&&(a=d.createElement("link"),Kn(a,"link",r),bn(a),d.head.appendChild(a)))}}function hO(r){Gi.D(r),OE("dns-prefetch",r,null)}function fO(r,a){Gi.C(r,a),OE("preconnect",r,a)}function pO(r,a,c){Gi.L(r,a,c);var d=Rc;if(d&&r&&a){var y='link[rel="preload"][as="'+Es(a)+'"]';a==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+Es(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+Es(c.imageSizes)+'"]')):y+='[href="'+Es(r)+'"]';var v=y;switch(a){case"style":v=jc(r);break;case"script":v=Dc(r)}xr.has(v)||(r=x({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:r,as:a},c),xr.set(v,r),d.querySelector(y)!==null||a==="style"&&d.querySelector(jd(v))||a==="script"&&d.querySelector(Dd(v))||(a=d.createElement("link"),Kn(a,"link",r),bn(a),d.head.appendChild(a)))}}function mO(r,a){Gi.m(r,a);var c=Rc;if(c&&r){var d=a&&typeof a.as=="string"?a.as:"script",y='link[rel="modulepreload"][as="'+Es(d)+'"][href="'+Es(r)+'"]',v=y;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Dc(r)}if(!xr.has(v)&&(r=x({rel:"modulepreload",href:r},a),xr.set(v,r),c.querySelector(y)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Dd(v)))return}d=c.createElement("link"),Kn(d,"link",r),bn(d),c.head.appendChild(d)}}}function gO(r,a,c){Gi.S(r,a,c);var d=Rc;if(d&&r){var y=Kr(d).hoistableStyles,v=jc(r);a=a||"default";var E=y.get(v);if(!E){var D={loading:0,preload:null};if(E=d.querySelector(jd(v)))D.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":a},c),(c=xr.get(v))&&Ov(r,c);var q=E=d.createElement("link");bn(q),Kn(q,"link",r),q._p=new Promise(function(te,ue){q.onload=te,q.onerror=ue}),q.addEventListener("load",function(){D.loading|=1}),q.addEventListener("error",function(){D.loading|=2}),D.loading|=4,gp(E,a,d)}E={type:"stylesheet",instance:E,count:1,state:D},y.set(v,E)}}}function yO(r,a){Gi.X(r,a);var c=Rc;if(c&&r){var d=Kr(c).hoistableScripts,y=Dc(r),v=d.get(y);v||(v=c.querySelector(Dd(y)),v||(r=x({src:r,async:!0},a),(a=xr.get(y))&&Pv(r,a),v=c.createElement("script"),bn(v),Kn(v,"link",r),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(y,v))}}function vO(r,a){Gi.M(r,a);var c=Rc;if(c&&r){var d=Kr(c).hoistableScripts,y=Dc(r),v=d.get(y);v||(v=c.querySelector(Dd(y)),v||(r=x({src:r,async:!0,type:"module"},a),(a=xr.get(y))&&Pv(r,a),v=c.createElement("script"),bn(v),Kn(v,"link",r),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(y,v))}}function PE(r,a,c,d){var y=(y=we.current)?mp(y):null;if(!y)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=jc(c.href),c=Kr(y).hoistableStyles,d=c.get(a),d||(d={type:"style",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=jc(c.href);var v=Kr(y).hoistableStyles,E=v.get(r);if(E||(y=y.ownerDocument||y,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(r,E),(v=y.querySelector(jd(r)))&&!v._p&&(E.instance=v,E.state.loading=5),xr.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},xr.set(r,c),v||xO(y,r,c,E.state))),a&&d===null)throw Error(s(528,""));return E}if(a&&d!==null)throw Error(s(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Dc(c),c=Kr(y).hoistableScripts,d=c.get(a),d||(d={type:"script",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function jc(r){return'href="'+Es(r)+'"'}function jd(r){return'link[rel="stylesheet"]['+r+"]"}function kE(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function xO(r,a,c,d){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=r.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),Kn(a,"link",c),bn(a),r.head.appendChild(a))}function Dc(r){return'[src="'+Es(r)+'"]'}function Dd(r){return"script[async]"+r}function ME(r,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var d=r.querySelector('style[data-href~="'+Es(c.href)+'"]');if(d)return a.instance=d,bn(d),d;var y=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),bn(d),Kn(d,"style",y),gp(d,c.precedence,r),a.instance=d;case"stylesheet":y=jc(c.href);var v=r.querySelector(jd(y));if(v)return a.state.loading|=4,a.instance=v,bn(v),v;d=kE(c),(y=xr.get(y))&&Ov(d,y),v=(r.ownerDocument||r).createElement("link"),bn(v);var E=v;return E._p=new Promise(function(D,q){E.onload=D,E.onerror=q}),Kn(v,"link",d),a.state.loading|=4,gp(v,c.precedence,r),a.instance=v;case"script":return v=Dc(c.src),(y=r.querySelector(Dd(v)))?(a.instance=y,bn(y),y):(d=c,(y=xr.get(v))&&(d=x({},c),Pv(d,y)),r=r.ownerDocument||r,y=r.createElement("script"),bn(y),Kn(y,"link",d),r.head.appendChild(y),a.instance=y);case"void":return null;default:throw Error(s(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,gp(d,c.precedence,r));return a.instance}function gp(r,a,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=d.length?d[d.length-1]:null,v=y,E=0;E<d.length;E++){var D=d[E];if(D.dataset.precedence===a)v=D;else if(v!==y)break}v?v.parentNode.insertBefore(r,v.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(r,a.firstChild))}function Ov(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function Pv(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var yp=null;function LE(r,a,c){if(yp===null){var d=new Map,y=yp=new Map;y.set(c,d)}else y=yp,d=y.get(c),d||(d=new Map,y.set(c,d));if(d.has(r))return d;for(d.set(r,null),c=c.getElementsByTagName(r),y=0;y<c.length;y++){var v=c[y];if(!(v[en]||v[Yt]||r==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var E=v.getAttribute(a)||"";E=r+E;var D=d.get(E);D?D.push(v):d.set(E,[v])}}return d}function VE(r,a,c){r=r.ownerDocument||r,r.head.insertBefore(c,a==="title"?r.querySelector("head > title"):null)}function bO(r,a,c){if(c===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(r=a.disabled,typeof a.precedence=="string"&&r==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function UE(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function _O(r,a,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=jc(d.href),v=a.querySelector(jd(y));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=vp.bind(r),a.then(r,r)),c.state.loading|=4,c.instance=v,bn(v);return}v=a.ownerDocument||a,d=kE(d),(y=xr.get(y))&&Ov(d,y),v=v.createElement("link"),bn(v);var E=v;E._p=new Promise(function(D,q){E.onload=D,E.onerror=q}),Kn(v,"link",d),c.instance=v}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=vp.bind(r),a.addEventListener("load",c),a.addEventListener("error",c))}}var kv=0;function SO(r,a){return r.stylesheets&&r.count===0&&bp(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var d=setTimeout(function(){if(r.stylesheets&&bp(r,r.stylesheets),r.unsuspend){var v=r.unsuspend;r.unsuspend=null,v()}},6e4+a);0<r.imgBytes&&kv===0&&(kv=62500*nO());var y=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&bp(r,r.stylesheets),r.unsuspend)){var v=r.unsuspend;r.unsuspend=null,v()}},(r.imgBytes>kv?50:800)+a);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(y)}}:null}function vp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bp(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var xp=null;function bp(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,xp=new Map,a.forEach(wO,r),xp=null,vp.call(r))}function wO(r,a){if(!(a.state.loading&4)){var c=xp.get(r);if(c)var d=c.get(null);else{c=new Map,xp.set(r,c);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var E=y[v];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(c.set(E.dataset.precedence,E),d=E)}d&&c.set(null,d)}y=a.instance,E=y.getAttribute("data-precedence"),v=c.get(E)||d,v===d&&c.set(null,y),c.set(E,y),this.count++,d=vp.bind(this),y.addEventListener("load",d),y.addEventListener("error",d),v?v.parentNode.insertBefore(y,v.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),a.state.loading|=4}}var Od={$$typeof:U,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function EO(r,a,c,d,y,v,E,D,q){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ar(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ar(0),this.hiddenUpdates=ar(null),this.identifierPrefix=d,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function BE(r,a,c,d,y,v,E,D,q,te,ue,pe){return r=new EO(r,a,c,E,q,te,ue,pe,D),a=1,v===!0&&(a|=24),v=$s(3,null,null,a),r.current=v,v.stateNode=r,a=py(),a.refCount++,r.pooledCache=a,a.refCount++,v.memoizedState={element:d,isDehydrated:c,cache:a},vy(v),r}function FE(r){return r?(r=cc,r):cc}function zE(r,a,c,d,y,v){y=FE(y),d.context===null?d.context=y:d.pendingContext=y,d=Aa(a),d.payload={element:c},v=v===void 0?null:v,v!==null&&(d.callback=v),c=Ca(r,d,a),c!==null&&(Rs(c,r,a),dd(c,r,a))}function qE(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<a?c:a}}function Mv(r,a){qE(r,a),(r=r.alternate)&&qE(r,a)}function HE(r){if(r.tag===13||r.tag===31){var a=qo(r,67108864);a!==null&&Rs(a,r,67108864),Mv(r,67108864)}}function GE(r){if(r.tag===13||r.tag===31){var a=Xs();a=Er(a);var c=qo(r,a);c!==null&&Rs(c,r,a),Mv(r,a)}}var _p=!0;function TO(r,a,c,d){var y=G.T;G.T=null;var v=ne.p;try{ne.p=2,Lv(r,a,c,d)}finally{ne.p=v,G.T=y}}function AO(r,a,c,d){var y=G.T;G.T=null;var v=ne.p;try{ne.p=8,Lv(r,a,c,d)}finally{ne.p=v,G.T=y}}function Lv(r,a,c,d){if(_p){var y=Vv(d);if(y===null)wv(r,a,d,Sp,c),KE(r,d);else if(NO(y,r,a,c,d))d.stopPropagation();else if(KE(r,d),a&4&&-1<CO.indexOf(r)){for(;y!==null;){var v=ws(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var E=kt(v.pendingLanes);if(E!==0){var D=v;for(D.pendingLanes|=2,D.entangledLanes|=2;E;){var q=1<<31-Ft(E);D.entanglements[1]|=q,E&=~q}ai(v),(ft&6)===0&&(rp=Bt()+500,Cd(0))}}break;case 31:case 13:D=qo(v,2),D!==null&&Rs(D,v,2),ap(),Mv(v,2)}if(v=Vv(d),v===null&&wv(r,a,d,Sp,c),v===y)break;y=v}y!==null&&d.stopPropagation()}else wv(r,a,d,null,c)}}function Vv(r){return r=cr(r),Uv(r)}var Sp=null;function Uv(r){if(Sp=null,r=lr(r),r!==null){var a=o(r);if(a===null)r=null;else{var c=a.tag;if(c===13){if(r=u(a),r!==null)return r;r=null}else if(c===31){if(r=h(a),r!==null)return r;r=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Sp=r,null}function $E(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ln()){case Vs:return 2;case bs:return 8;case Us:case _s:return 32;case Io:return 268435456;default:return 32}default:return 32}}var Bv=!1,Va=null,Ua=null,Ba=null,Pd=new Map,kd=new Map,Fa=[],CO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function KE(r,a){switch(r){case"focusin":case"focusout":Va=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":Ba=null;break;case"pointerover":case"pointerout":Pd.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":kd.delete(a.pointerId)}}function Md(r,a,c,d,y,v){return r===null||r.nativeEvent!==v?(r={blockedOn:a,domEventName:c,eventSystemFlags:d,nativeEvent:v,targetContainers:[y]},a!==null&&(a=ws(a),a!==null&&HE(a)),r):(r.eventSystemFlags|=d,a=r.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),r)}function NO(r,a,c,d,y){switch(a){case"focusin":return Va=Md(Va,r,a,c,d,y),!0;case"dragenter":return Ua=Md(Ua,r,a,c,d,y),!0;case"mouseover":return Ba=Md(Ba,r,a,c,d,y),!0;case"pointerover":var v=y.pointerId;return Pd.set(v,Md(Pd.get(v)||null,r,a,c,d,y)),!0;case"gotpointercapture":return v=y.pointerId,kd.set(v,Md(kd.get(v)||null,r,a,c,d,y)),!0}return!1}function QE(r){var a=lr(r.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=u(c),a!==null){r.blockedOn=a,zs(r.priority,function(){GE(c)});return}}else if(a===31){if(a=h(c),a!==null){r.blockedOn=a,zs(r.priority,function(){GE(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function wp(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var c=Vv(r.nativeEvent);if(c===null){c=r.nativeEvent;var d=new c.constructor(c.type,c);Yu=d,c.target.dispatchEvent(d),Yu=null}else return a=ws(c),a!==null&&HE(a),r.blockedOn=c,!1;a.shift()}return!0}function YE(r,a,c){wp(r)&&c.delete(a)}function IO(){Bv=!1,Va!==null&&wp(Va)&&(Va=null),Ua!==null&&wp(Ua)&&(Ua=null),Ba!==null&&wp(Ba)&&(Ba=null),Pd.forEach(YE),kd.forEach(YE)}function Ep(r,a){r.blockedOn===a&&(r.blockedOn=null,Bv||(Bv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,IO)))}var Tp=null;function WE(r){Tp!==r&&(Tp=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Tp===r&&(Tp=null);for(var a=0;a<r.length;a+=3){var c=r[a],d=r[a+1],y=r[a+2];if(typeof d!="function"){if(Uv(d||c)===null)continue;break}var v=ws(c);v!==null&&(r.splice(a,3),a-=3,Vy(v,{pending:!0,data:y,method:c.method,action:d},d,y))}}))}function Oc(r){function a(q){return Ep(q,r)}Va!==null&&Ep(Va,r),Ua!==null&&Ep(Ua,r),Ba!==null&&Ep(Ba,r),Pd.forEach(a),kd.forEach(a);for(var c=0;c<Fa.length;c++){var d=Fa[c];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Fa.length&&(c=Fa[0],c.blockedOn===null);)QE(c),c.blockedOn===null&&Fa.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var y=c[d],v=c[d+1],E=y[xn]||null;if(typeof v=="function")E||WE(c);else if(E){var D=null;if(v&&v.hasAttribute("formAction")){if(y=v,E=v[xn]||null)D=E.formAction;else if(Uv(y)!==null)continue}else D=E.action;typeof D=="function"?c[d+1]=D:(c.splice(d,3),d-=3),WE(c)}}}function XE(){function r(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(E){return y=E})},focusReset:"manual",scroll:"manual"})}function a(){y!==null&&(y(),y=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,y=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),y!==null&&(y(),y=null)}}}function Fv(r){this._internalRoot=r}Ap.prototype.render=Fv.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(s(409));var c=a.current,d=Xs();zE(c,d,r,a,null,null)},Ap.prototype.unmount=Fv.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;zE(r.current,2,null,r,null,null),ap(),a[or]=null}};function Ap(r){this._internalRoot=r}Ap.prototype.unstable_scheduleHydration=function(r){if(r){var a=da();r={blockedOn:null,target:r,priority:a};for(var c=0;c<Fa.length&&a!==0&&a<Fa[c].priority;c++);Fa.splice(c,0,r),c===0&&QE(r)}};var JE=e.version;if(JE!=="19.2.1")throw Error(s(527,JE,"19.2.1"));ne.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=p(a),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var RO={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cp.isDisabled&&Cp.supportsFiber)try{Jn=Cp.inject(RO),vn=Cp}catch{}}return Vd.createRoot=function(r,a){if(!i(r))throw Error(s(299));var c=!1,d="",y=iw,v=aw,E=ow;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(y=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),a=BE(r,1,!1,null,null,c,d,null,y,v,E,XE),r[or]=a.current,Sv(r),new Fv(a)},Vd.hydrateRoot=function(r,a,c){if(!i(r))throw Error(s(299));var d=!1,y="",v=iw,E=aw,D=ow,q=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(E=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.formState!==void 0&&(q=c.formState)),a=BE(r,1,!0,a,c??null,d,y,q,v,E,D,XE),a.context=FE(null),c=a.current,d=Xs(),d=Er(d),y=Aa(d),y.callback=null,Ca(c,y,d),c=d,a.current.lanes=c,wr(a,c),ai(a),r[or]=a.current,Sv(r),new Ap(a)},Vd.version="19.2.1",Vd}var l1;function BO(){if(l1)return Hv.exports;l1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Hv.exports=UO(),Hv.exports}var FO=BO();const zO=Fx(FO);var c1="popstate";function qO(n={}){function e(s,i){let{pathname:o,search:u,hash:h}=s.location;return N0("",{pathname:o,search:u,hash:h},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:mh(i)}return GO(e,t,null,n)}function Gt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function tr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HO(){return Math.random().toString(36).substring(2,10)}function u1(n,e){return{usr:n.state,key:n.key,idx:e}}function N0(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Eu(e):e,state:t,key:e&&e.key||s||HO()}}function mh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Eu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function GO(n,e,t,s={}){let{window:i=document.defaultView,v5Compat:o=!1}=s,u=i.history,h="POP",f=null,p=g();p==null&&(p=0,u.replaceState({...u.state,idx:p},""));function g(){return(u.state||{idx:null}).idx}function x(){h="POP";let C=g(),L=C==null?null:C-p;p=C,f&&f({action:h,location:A.location,delta:L})}function b(C,L){h="PUSH";let z=N0(A.location,C,L);p=g()+1;let U=u1(z,p),F=A.createHref(z);try{u.pushState(U,"",F)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;i.location.assign(F)}o&&f&&f({action:h,location:A.location,delta:1})}function S(C,L){h="REPLACE";let z=N0(A.location,C,L);p=g();let U=u1(z,p),F=A.createHref(z);u.replaceState(U,"",F),o&&f&&f({action:h,location:A.location,delta:0})}function w(C){return $O(C)}let A={get action(){return h},get location(){return n(i,u)},listen(C){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(c1,x),f=C,()=>{i.removeEventListener(c1,x),f=null}},createHref(C){return e(i,C)},createURL:w,encodeLocation(C){let L=w(C);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:b,replace:S,go(C){return u.go(C)}};return A}function $O(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gt(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:mh(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function _A(n,e,t="/"){return KO(n,e,t,!1)}function KO(n,e,t,s){let i=typeof e=="string"?Eu(e):e,o=Zi(i.pathname||"/",t);if(o==null)return null;let u=SA(n);QO(u);let h=null;for(let f=0;h==null&&f<u.length;++f){let p=i3(o);h=s3(u[f],p,s)}return h}function SA(n,e=[],t=[],s="",i=!1){let o=(u,h,f=i,p)=>{let g={relativePath:p===void 0?u.path||"":p,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(s)&&f)return;Gt(g.relativePath.startsWith(s),`Absolute route path "${g.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(s.length)}let x=Xi([s,g.relativePath]),b=t.concat(g);u.children&&u.children.length>0&&(Gt(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),SA(u.children,e,b,x,f)),!(u.path==null&&!u.index)&&e.push({path:x,score:t3(x,u.index),routesMeta:b})};return n.forEach((u,h)=>{if(u.path===""||!u.path?.includes("?"))o(u,h);else for(let f of wA(u.path))o(u,h,!0,f)}),e}function wA(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(s.length===0)return i?[o,""]:[o];let u=wA(s.join("/")),h=[];return h.push(...u.map(f=>f===""?o:[o,f].join("/"))),i&&h.push(...u),h.map(f=>n.startsWith("/")&&f===""?"/":f)}function QO(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:n3(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var YO=/^:[\w-]+$/,WO=3,XO=2,JO=1,ZO=10,e3=-2,d1=n=>n==="*";function t3(n,e){let t=n.split("/"),s=t.length;return t.some(d1)&&(s+=e3),e&&(s+=XO),t.filter(i=>!d1(i)).reduce((i,o)=>i+(YO.test(o)?WO:o===""?JO:ZO),s)}function n3(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function s3(n,e,t=!1){let{routesMeta:s}=n,i={},o="/",u=[];for(let h=0;h<s.length;++h){let f=s[h],p=h===s.length-1,g=o==="/"?e:e.slice(o.length)||"/",x=hm({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},g),b=f.route;if(!x&&p&&t&&!s[s.length-1].route.index&&(x=hm({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!x)return null;Object.assign(i,x.params),u.push({params:i,pathname:Xi([o,x.pathname]),pathnameBase:u3(Xi([o,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(o=Xi([o,x.pathnameBase]))}return u}function hm(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=r3(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],u=o.replace(/(.)\/+$/,"$1"),h=i.slice(1);return{params:s.reduce((p,{paramName:g,isOptional:x},b)=>{if(g==="*"){let w=h[b]||"";u=o.slice(0,o.length-w.length).replace(/(.)\/+$/,"$1")}const S=h[b];return x&&!S?p[g]=void 0:p[g]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:o,pathnameBase:u,pattern:n}}function r3(n,e=!1,t=!0){tr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,f)=>(s.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function i3(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Zi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var a3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,o3=n=>a3.test(n);function l3(n,e="/"){let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?Eu(n):n,o;if(t)if(o3(t))o=t;else{if(t.includes("//")){let u=t;t=t.replace(/\/\/+/g,"/"),tr(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${t}`)}t.startsWith("/")?o=h1(t.substring(1),"/"):o=h1(t,e)}else o=e;return{pathname:o,search:d3(s),hash:h3(i)}}function h1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Qv(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function c3(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function qx(n){let e=c3(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function Hx(n,e,t,s=!1){let i;typeof n=="string"?i=Eu(n):(i={...n},Gt(!i.pathname||!i.pathname.includes("?"),Qv("?","pathname","search",i)),Gt(!i.pathname||!i.pathname.includes("#"),Qv("#","pathname","hash",i)),Gt(!i.search||!i.search.includes("#"),Qv("#","search","hash",i)));let o=n===""||i.pathname==="",u=o?"/":i.pathname,h;if(u==null)h=t;else{let x=e.length-1;if(!s&&u.startsWith("..")){let b=u.split("/");for(;b[0]==="..";)b.shift(),x-=1;i.pathname=b.join("/")}h=x>=0?e[x]:"/"}let f=l3(i,h),p=u&&u!=="/"&&u.endsWith("/"),g=(o||u===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||g)&&(f.pathname+="/"),f}var Xi=n=>n.join("/").replace(/\/\/+/g,"/"),u3=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),d3=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,h3=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function f3(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function p3(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var EA=["POST","PUT","PATCH","DELETE"];new Set(EA);var m3=["GET",...EA];new Set(m3);var Tu=I.createContext(null);Tu.displayName="DataRouter";var Jm=I.createContext(null);Jm.displayName="DataRouterState";I.createContext(!1);var TA=I.createContext({isTransitioning:!1});TA.displayName="ViewTransition";var g3=I.createContext(new Map);g3.displayName="Fetchers";var y3=I.createContext(null);y3.displayName="Await";var Sr=I.createContext(null);Sr.displayName="Navigation";var Ph=I.createContext(null);Ph.displayName="Location";var Ur=I.createContext({outlet:null,matches:[],isDataRoute:!1});Ur.displayName="Route";var Gx=I.createContext(null);Gx.displayName="RouteError";function v3(n,{relative:e}={}){Gt(Au(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=I.useContext(Sr),{hash:i,pathname:o,search:u}=kh(n,{relative:e}),h=o;return t!=="/"&&(h=o==="/"?t:Xi([t,o])),s.createHref({pathname:h,search:u,hash:i})}function Au(){return I.useContext(Ph)!=null}function kn(){return Gt(Au(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Ph).location}var AA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function CA(n){I.useContext(Sr).static||I.useLayoutEffect(n)}function Nn(){let{isDataRoute:n}=I.useContext(Ur);return n?j3():x3()}function x3(){Gt(Au(),"useNavigate() may be used only in the context of a <Router> component.");let n=I.useContext(Tu),{basename:e,navigator:t}=I.useContext(Sr),{matches:s}=I.useContext(Ur),{pathname:i}=kn(),o=JSON.stringify(qx(s)),u=I.useRef(!1);return CA(()=>{u.current=!0}),I.useCallback((f,p={})=>{if(tr(u.current,AA),!u.current)return;if(typeof f=="number"){t.go(f);return}let g=Hx(f,JSON.parse(o),i,p.relative==="path");n==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Xi([e,g.pathname])),(p.replace?t.replace:t.push)(g,p.state,p)},[e,t,o,i,n])}I.createContext(null);function NA(){let{matches:n}=I.useContext(Ur),e=n[n.length-1];return e?e.params:{}}function kh(n,{relative:e}={}){let{matches:t}=I.useContext(Ur),{pathname:s}=kn(),i=JSON.stringify(qx(t));return I.useMemo(()=>Hx(n,JSON.parse(i),s,e==="path"),[n,i,s,e])}function b3(n,e){return IA(n,e)}function IA(n,e,t,s,i){Gt(Au(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=I.useContext(Sr),{matches:u}=I.useContext(Ur),h=u[u.length-1],f=h?h.params:{},p=h?h.pathname:"/",g=h?h.pathnameBase:"/",x=h&&h.route;{let z=x&&x.path||"";RA(p,!x||z.endsWith("*")||z.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${z}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${z}"> to <Route path="${z==="/"?"*":`${z}/*`}">.`)}let b=kn(),S;if(e){let z=typeof e=="string"?Eu(e):e;Gt(g==="/"||z.pathname?.startsWith(g),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${z.pathname}" was given in the \`location\` prop.`),S=z}else S=b;let w=S.pathname||"/",A=w;if(g!=="/"){let z=g.replace(/^\//,"").split("/");A="/"+w.replace(/^\//,"").split("/").slice(z.length).join("/")}let C=_A(n,{pathname:A});tr(x||C!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),tr(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let L=T3(C&&C.map(z=>Object.assign({},z,{params:Object.assign({},f,z.params),pathname:Xi([g,o.encodeLocation?o.encodeLocation(z.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?g:Xi([g,o.encodeLocation?o.encodeLocation(z.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:z.pathnameBase])})),u,t,s,i);return e&&L?I.createElement(Ph.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},L):L}function _3(){let n=R3(),e=f3(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",n),u=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:o},"ErrorBoundary")," or"," ",I.createElement("code",{style:o},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),t?I.createElement("pre",{style:i},t):null,u)}var S3=I.createElement(_3,null),w3=class extends I.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?I.createElement(Ur.Provider,{value:this.props.routeContext},I.createElement(Gx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function E3({routeContext:n,match:e,children:t}){let s=I.useContext(Tu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),I.createElement(Ur.Provider,{value:n},t)}function T3(n,e=[],t=null,s=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,u=t?.errors;if(u!=null){let g=o.findIndex(x=>x.route.id&&u?.[x.route.id]!==void 0);Gt(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),o=o.slice(0,Math.min(o.length,g+1))}let h=!1,f=-1;if(t)for(let g=0;g<o.length;g++){let x=o[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=g),x.route.id){let{loaderData:b,errors:S}=t,w=x.route.loader&&!b.hasOwnProperty(x.route.id)&&(!S||S[x.route.id]===void 0);if(x.route.lazy||w){h=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}let p=t&&s?(g,x)=>{s(g,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:p3(t.matches),errorInfo:x})}:void 0;return o.reduceRight((g,x,b)=>{let S,w=!1,A=null,C=null;t&&(S=u&&x.route.id?u[x.route.id]:void 0,A=x.route.errorElement||S3,h&&(f<0&&b===0?(RA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,C=null):f===b&&(w=!0,C=x.route.hydrateFallbackElement||null)));let L=e.concat(o.slice(0,b+1)),z=()=>{let U;return S?U=A:w?U=C:x.route.Component?U=I.createElement(x.route.Component,null):x.route.element?U=x.route.element:U=g,I.createElement(E3,{match:x,routeContext:{outlet:g,matches:L,isDataRoute:t!=null},children:U})};return t&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?I.createElement(w3,{location:t.location,revalidation:t.revalidation,component:A,error:S,children:z(),routeContext:{outlet:null,matches:L,isDataRoute:!0},onError:p}):z()},null)}function $x(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A3(n){let e=I.useContext(Tu);return Gt(e,$x(n)),e}function C3(n){let e=I.useContext(Jm);return Gt(e,$x(n)),e}function N3(n){let e=I.useContext(Ur);return Gt(e,$x(n)),e}function Kx(n){let e=N3(n),t=e.matches[e.matches.length-1];return Gt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function I3(){return Kx("useRouteId")}function R3(){let n=I.useContext(Gx),e=C3("useRouteError"),t=Kx("useRouteError");return n!==void 0?n:e.errors?.[t]}function j3(){let{router:n}=A3("useNavigate"),e=Kx("useNavigate"),t=I.useRef(!1);return CA(()=>{t.current=!0}),I.useCallback(async(i,o={})=>{tr(t.current,AA),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...o}))},[n,e])}var f1={};function RA(n,e,t){!e&&!f1[n]&&(f1[n]=!0,tr(!1,t))}I.memo(D3);function D3({routes:n,future:e,state:t,unstable_onError:s}){return IA(n,void 0,t,s,e)}function dl({to:n,replace:e,state:t,relative:s}){Gt(Au(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=I.useContext(Sr);tr(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=I.useContext(Ur),{pathname:u}=kn(),h=Nn(),f=Hx(n,qx(o),u,s==="path"),p=JSON.stringify(f);return I.useEffect(()=>{h(JSON.parse(p),{replace:e,state:t,relative:s})},[h,p,s,e,t]),null}function Nt(n){Gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function O3({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:i,static:o=!1,unstable_useTransitions:u}){Gt(!Au(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=n.replace(/^\/*/,"/"),f=I.useMemo(()=>({basename:h,navigator:i,static:o,unstable_useTransitions:u,future:{}}),[h,i,o,u]);typeof t=="string"&&(t=Eu(t));let{pathname:p="/",search:g="",hash:x="",state:b=null,key:S="default"}=t,w=I.useMemo(()=>{let A=Zi(p,h);return A==null?null:{location:{pathname:A,search:g,hash:x,state:b,key:S},navigationType:s}},[h,p,g,x,b,S,s]);return tr(w!=null,`<Router basename="${h}"> is not able to match the URL "${p}${g}${x}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:I.createElement(Sr.Provider,{value:f},I.createElement(Ph.Provider,{children:e,value:w}))}function P3({children:n,location:e}){return b3(I0(n),e)}function I0(n,e=[]){let t=[];return I.Children.forEach(n,(s,i)=>{if(!I.isValidElement(s))return;let o=[...e,i];if(s.type===I.Fragment){t.push.apply(t,I0(s.props.children,o));return}Gt(s.type===Nt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=I0(s.props.children,o)),t.push(u)}),t}var Hp="get",Gp="application/x-www-form-urlencoded";function Zm(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function k3(n){return Zm(n)&&n.tagName.toLowerCase()==="button"}function M3(n){return Zm(n)&&n.tagName.toLowerCase()==="form"}function L3(n){return Zm(n)&&n.tagName.toLowerCase()==="input"}function V3(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function U3(n,e){return n.button===0&&(!e||e==="_self")&&!V3(n)}function R0(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(i=>[t,i]):[[t,s]])},[]))}function B3(n,e){let t=R0(n);return e&&e.forEach((s,i)=>{t.has(i)||e.getAll(i).forEach(o=>{t.append(i,o)})}),t}var Np=null;function F3(){if(Np===null)try{new FormData(document.createElement("form"),0),Np=!1}catch{Np=!0}return Np}var z3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Yv(n){return n!=null&&!z3.has(n)?(tr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Gp}"`),null):n}function q3(n,e){let t,s,i,o,u;if(M3(n)){let h=n.getAttribute("action");s=h?Zi(h,e):null,t=n.getAttribute("method")||Hp,i=Yv(n.getAttribute("enctype"))||Gp,o=new FormData(n)}else if(k3(n)||L3(n)&&(n.type==="submit"||n.type==="image")){let h=n.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||h.getAttribute("action");if(s=f?Zi(f,e):null,t=n.getAttribute("formmethod")||h.getAttribute("method")||Hp,i=Yv(n.getAttribute("formenctype"))||Yv(h.getAttribute("enctype"))||Gp,o=new FormData(h,n),!F3()){let{name:p,type:g,value:x}=n;if(g==="image"){let b=p?`${p}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else p&&o.append(p,x)}}else{if(Zm(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Hp,s=null,i=Gp,u=n}return o&&i==="text/plain"&&(u=o,o=void 0),{action:s,method:t.toLowerCase(),encType:i,formData:o,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qx(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function H3(n,e,t){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return s.pathname==="/"?s.pathname=`_root.${t}`:e&&Zi(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function G3(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $3(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function K3(n,e,t){let s=await Promise.all(n.map(async i=>{let o=e.routes[i.route.id];if(o){let u=await G3(o,t);return u.links?u.links():[]}return[]}));return X3(s.flat(1).filter($3).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function p1(n,e,t,s,i,o){let u=(f,p)=>t[p]?f.route.id!==t[p].route.id:!0,h=(f,p)=>t[p].pathname!==f.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==f.params["*"];return o==="assets"?e.filter((f,p)=>u(f,p)||h(f,p)):o==="data"?e.filter((f,p)=>{let g=s.routes[f.route.id];if(!g||!g.hasLoader)return!1;if(u(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function Q3(n,e,{includeHydrateFallback:t}={}){return Y3(n.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function Y3(n){return[...new Set(n)]}function W3(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function X3(n,e){let t=new Set;return new Set(e),n.reduce((s,i)=>{let o=JSON.stringify(W3(i));return t.has(o)||(t.add(o),s.push({key:o,link:i})),s},[])}function jA(){let n=I.useContext(Tu);return Qx(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function J3(){let n=I.useContext(Jm);return Qx(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Yx=I.createContext(void 0);Yx.displayName="FrameworkContext";function DA(){let n=I.useContext(Yx);return Qx(n,"You must render this element inside a <HydratedRouter> element"),n}function Z3(n,e){let t=I.useContext(Yx),[s,i]=I.useState(!1),[o,u]=I.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:g,onTouchStart:x}=e,b=I.useRef(null);I.useEffect(()=>{if(n==="render"&&u(!0),n==="viewport"){let A=L=>{L.forEach(z=>{u(z.isIntersecting)})},C=new IntersectionObserver(A,{threshold:.5});return b.current&&C.observe(b.current),()=>{C.disconnect()}}},[n]),I.useEffect(()=>{if(s){let A=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(A)}}},[s]);let S=()=>{i(!0)},w=()=>{i(!1),u(!1)};return t?n!=="intent"?[o,b,{}]:[o,b,{onFocus:Ud(h,S),onBlur:Ud(f,w),onMouseEnter:Ud(p,S),onMouseLeave:Ud(g,w),onTouchStart:Ud(x,S)}]:[!1,b,{}]}function Ud(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function eP({page:n,...e}){let{router:t}=jA(),s=I.useMemo(()=>_A(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?I.createElement(nP,{page:n,matches:s,...e}):null}function tP(n){let{manifest:e,routeModules:t}=DA(),[s,i]=I.useState([]);return I.useEffect(()=>{let o=!1;return K3(n,e,t).then(u=>{o||i(u)}),()=>{o=!0}},[n,e,t]),s}function nP({page:n,matches:e,...t}){let s=kn(),{manifest:i,routeModules:o}=DA(),{basename:u}=jA(),{loaderData:h,matches:f}=J3(),p=I.useMemo(()=>p1(n,e,f,i,s,"data"),[n,e,f,i,s]),g=I.useMemo(()=>p1(n,e,f,i,s,"assets"),[n,e,f,i,s]),x=I.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let w=new Set,A=!1;if(e.forEach(L=>{let z=i.routes[L.route.id];!z||!z.hasLoader||(!p.some(U=>U.route.id===L.route.id)&&L.route.id in h&&o[L.route.id]?.shouldRevalidate||z.hasClientLoader?A=!0:w.add(L.route.id))}),w.size===0)return[];let C=H3(n,u,"data");return A&&w.size>0&&C.searchParams.set("_routes",e.filter(L=>w.has(L.route.id)).map(L=>L.route.id).join(",")),[C.pathname+C.search]},[u,h,s,i,p,e,n,o]),b=I.useMemo(()=>Q3(g,i),[g,i]),S=tP(g);return I.createElement(I.Fragment,null,x.map(w=>I.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...t})),b.map(w=>I.createElement("link",{key:w,rel:"modulepreload",href:w,...t})),S.map(({key:w,link:A})=>I.createElement("link",{key:w,nonce:t.nonce,...A})))}function sP(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var OA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{OA&&(window.__reactRouterVersion="7.10.1")}catch{}function rP({basename:n,children:e,unstable_useTransitions:t,window:s}){let i=I.useRef();i.current==null&&(i.current=qO({window:s,v5Compat:!0}));let o=i.current,[u,h]=I.useState({action:o.action,location:o.location}),f=I.useCallback(p=>{t===!1?h(p):I.startTransition(()=>h(p))},[t]);return I.useLayoutEffect(()=>o.listen(f),[o,f]),I.createElement(O3,{basename:n,children:e,location:u.location,navigationType:u.action,navigator:o,unstable_useTransitions:t===!0})}var PA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kA=I.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:i,reloadDocument:o,replace:u,state:h,target:f,to:p,preventScrollReset:g,viewTransition:x,...b},S){let{basename:w,unstable_useTransitions:A}=I.useContext(Sr),C=typeof p=="string"&&PA.test(p),L,z=!1;if(typeof p=="string"&&C&&(L=p,OA))try{let O=new URL(window.location.href),V=p.startsWith("//")?new URL(O.protocol+p):new URL(p),B=Zi(V.pathname,w);V.origin===O.origin&&B!=null?p=B+V.search+V.hash:z=!0}catch{tr(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let U=v3(p,{relative:i}),[F,K,Z]=Z3(s,b),j=lP(p,{replace:u,state:h,target:f,preventScrollReset:g,relative:i,viewTransition:x,unstable_useTransitions:A});function N(O){e&&e(O),O.defaultPrevented||j(O)}let R=I.createElement("a",{...b,...Z,href:L||U,onClick:z||o?e:N,ref:sP(S,K),target:f,"data-discover":!C&&t==="render"?"true":void 0});return F&&!C?I.createElement(I.Fragment,null,R,I.createElement(eP,{page:U})):R});kA.displayName="Link";var iP=I.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:i=!1,style:o,to:u,viewTransition:h,children:f,...p},g){let x=kh(u,{relative:p.relative}),b=kn(),S=I.useContext(Jm),{navigator:w,basename:A}=I.useContext(Sr),C=S!=null&&pP(x)&&h===!0,L=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,z=b.pathname,U=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(z=z.toLowerCase(),U=U?U.toLowerCase():null,L=L.toLowerCase()),U&&A&&(U=Zi(U,A)||U);const F=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let K=z===L||!i&&z.startsWith(L)&&z.charAt(F)==="/",Z=U!=null&&(U===L||!i&&U.startsWith(L)&&U.charAt(L.length)==="/"),j={isActive:K,isPending:Z,isTransitioning:C},N=K?e:void 0,R;typeof s=="function"?R=s(j):R=[s,K?"active":null,Z?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let O=typeof o=="function"?o(j):o;return I.createElement(kA,{...p,"aria-current":N,className:R,ref:g,style:O,to:u,viewTransition:h},typeof f=="function"?f(j):f)});iP.displayName="NavLink";var aP=I.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:i,state:o,method:u=Hp,action:h,onSubmit:f,relative:p,preventScrollReset:g,viewTransition:x,...b},S)=>{let{unstable_useTransitions:w}=I.useContext(Sr),A=hP(),C=fP(h,{relative:p}),L=u.toLowerCase()==="get"?"get":"post",z=typeof h=="string"&&PA.test(h),U=F=>{if(f&&f(F),F.defaultPrevented)return;F.preventDefault();let K=F.nativeEvent.submitter,Z=K?.getAttribute("formmethod")||u,j=()=>A(K||F.currentTarget,{fetcherKey:e,method:Z,navigate:t,replace:i,state:o,relative:p,preventScrollReset:g,viewTransition:x});w&&t!==!1?I.startTransition(()=>j()):j()};return I.createElement("form",{ref:S,method:L,action:C,onSubmit:s?f:U,...b,"data-discover":!z&&n==="render"?"true":void 0})});aP.displayName="Form";function oP(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MA(n){let e=I.useContext(Tu);return Gt(e,oP(n)),e}function lP(n,{target:e,replace:t,state:s,preventScrollReset:i,relative:o,viewTransition:u,unstable_useTransitions:h}={}){let f=Nn(),p=kn(),g=kh(n,{relative:o});return I.useCallback(x=>{if(U3(x,e)){x.preventDefault();let b=t!==void 0?t:mh(p)===mh(g),S=()=>f(n,{replace:b,state:s,preventScrollReset:i,relative:o,viewTransition:u});h?I.startTransition(()=>S()):S()}},[p,f,g,t,s,e,n,i,o,u,h])}function cP(n){tr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=I.useRef(R0(n)),t=I.useRef(!1),s=kn(),i=I.useMemo(()=>B3(s.search,t.current?null:e.current),[s.search]),o=Nn(),u=I.useCallback((h,f)=>{const p=R0(typeof h=="function"?h(new URLSearchParams(i)):h);t.current=!0,o("?"+p,f)},[o,i]);return[i,u]}var uP=0,dP=()=>`__${String(++uP)}__`;function hP(){let{router:n}=MA("useSubmit"),{basename:e}=I.useContext(Sr),t=I3(),s=n.fetch,i=n.navigate;return I.useCallback(async(o,u={})=>{let{action:h,method:f,encType:p,formData:g,body:x}=q3(o,e);if(u.navigate===!1){let b=u.fetcherKey||dP();await s(b,t,u.action||h,{preventScrollReset:u.preventScrollReset,formData:g,body:x,formMethod:u.method||f,formEncType:u.encType||p,flushSync:u.flushSync})}else await i(u.action||h,{preventScrollReset:u.preventScrollReset,formData:g,body:x,formMethod:u.method||f,formEncType:u.encType||p,replace:u.replace,state:u.state,fromRouteId:t,flushSync:u.flushSync,viewTransition:u.viewTransition})},[s,i,e,t])}function fP(n,{relative:e}={}){let{basename:t}=I.useContext(Sr),s=I.useContext(Ur);Gt(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),o={...kh(n||".",{relative:e})},u=kn();if(n==null){o.search=u.search;let h=new URLSearchParams(o.search),f=h.getAll("index");if(f.some(g=>g==="")){h.delete("index"),f.filter(x=>x).forEach(x=>h.append("index",x));let g=h.toString();o.search=g?`?${g}`:""}}return(!n||n===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Xi([t,o.pathname])),mh(o)}function pP(n,{relative:e}={}){let t=I.useContext(TA);Gt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=MA("useViewTransitionState"),i=kh(n,{relative:e});if(!t.isTransitioning)return!1;let o=Zi(t.currentLocation.pathname,s)||t.currentLocation.pathname,u=Zi(t.nextLocation.pathname,s)||t.nextLocation.pathname;return hm(i.pathname,u)!=null||hm(i.pathname,o)!=null}var Mh=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mP={setTimeout:(n,e)=>setTimeout(n,e),clearTimeout:n=>clearTimeout(n),setInterval:(n,e)=>setInterval(n,e),clearInterval:n=>clearInterval(n)},gP=class{#e=mP;#t=!1;setTimeoutProvider(n){this.#e=n}setTimeout(n,e){return this.#e.setTimeout(n,e)}clearTimeout(n){this.#e.clearTimeout(n)}setInterval(n,e){return this.#e.setInterval(n,e)}clearInterval(n){this.#e.clearInterval(n)}},hl=new gP;function yP(n){setTimeout(n,0)}var El=typeof window>"u"||"Deno"in globalThis;function js(){}function vP(n,e){return typeof n=="function"?n(e):n}function j0(n){return typeof n=="number"&&n>=0&&n!==1/0}function LA(n,e){return Math.max(n+(e||0)-Date.now(),0)}function so(n,e){return typeof n=="function"?n(e):n}function br(n,e){return typeof n=="function"?n(e):n}function m1(n,e){const{type:t="all",exact:s,fetchStatus:i,predicate:o,queryKey:u,stale:h}=n;if(u){if(s){if(e.queryHash!==Wx(u,e.options))return!1}else if(!yh(e.queryKey,u))return!1}if(t!=="all"){const f=e.isActive();if(t==="active"&&!f||t==="inactive"&&f)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||i&&i!==e.state.fetchStatus||o&&!o(e))}function g1(n,e){const{exact:t,status:s,predicate:i,mutationKey:o}=n;if(o){if(!e.options.mutationKey)return!1;if(t){if(gh(e.options.mutationKey)!==gh(o))return!1}else if(!yh(e.options.mutationKey,o))return!1}return!(s&&e.state.status!==s||i&&!i(e))}function Wx(n,e){return(e?.queryKeyHashFn||gh)(n)}function gh(n){return JSON.stringify(n,(e,t)=>O0(t)?Object.keys(t).sort().reduce((s,i)=>(s[i]=t[i],s),{}):t)}function yh(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>yh(n[t],e[t])):!1}var xP=Object.prototype.hasOwnProperty;function VA(n,e){if(n===e)return n;const t=y1(n)&&y1(e);if(!t&&!(O0(n)&&O0(e)))return e;const i=(t?n:Object.keys(n)).length,o=t?e:Object.keys(e),u=o.length,h=t?new Array(u):{};let f=0;for(let p=0;p<u;p++){const g=t?p:o[p],x=n[g],b=e[g];if(x===b){h[g]=x,(t?p<i:xP.call(n,g))&&f++;continue}if(x===null||b===null||typeof x!="object"||typeof b!="object"){h[g]=b;continue}const S=VA(x,b);h[g]=S,S===x&&f++}return i===u&&f===i?n:h}function D0(n,e){if(!e||Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(n[t]!==e[t])return!1;return!0}function y1(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function O0(n){if(!v1(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!v1(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function v1(n){return Object.prototype.toString.call(n)==="[object Object]"}function bP(n){return new Promise(e=>{hl.setTimeout(e,n)})}function P0(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?VA(n,e):e}function _P(n,e,t=0){const s=[...n,e];return t&&s.length>t?s.slice(1):s}function SP(n,e,t=0){const s=[e,...n];return t&&s.length>t?s.slice(0,-1):s}var Xx=Symbol();function UA(n,e){return!n.queryFn&&e?.initialPromise?()=>e.initialPromise:!n.queryFn||n.queryFn===Xx?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}function BA(n,e){return typeof n=="function"?n(...e):!!n}function wP(n,e,t){let s=!1,i;return Object.defineProperty(n,"signal",{enumerable:!0,get:()=>(i??=e(),s||(s=!0,i.aborted?t():i.addEventListener("abort",t,{once:!0})),i)}),n}var EP=class extends Mh{#e;#t;#n;constructor(){super(),this.#n=n=>{if(!El&&window.addEventListener){const e=()=>n();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(n){this.#n=n,this.#t?.(),this.#t=n(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(n){this.#e!==n&&(this.#e=n,this.onFocus())}onFocus(){const n=this.isFocused();this.listeners.forEach(e=>{e(n)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Jx=new EP;function k0(){let n,e;const t=new Promise((i,o)=>{n=i,e=o});t.status="pending",t.catch(()=>{});function s(i){Object.assign(t,i),delete t.resolve,delete t.reject}return t.resolve=i=>{s({status:"fulfilled",value:i}),n(i)},t.reject=i=>{s({status:"rejected",reason:i}),e(i)},t}var TP=yP;function AP(){let n=[],e=0,t=h=>{h()},s=h=>{h()},i=TP;const o=h=>{e?n.push(h):i(()=>{t(h)})},u=()=>{const h=n;n=[],h.length&&i(()=>{s(()=>{h.forEach(f=>{t(f)})})})};return{batch:h=>{let f;e++;try{f=h()}finally{e--,e||u()}return f},batchCalls:h=>(...f)=>{o(()=>{h(...f)})},schedule:o,setNotifyFunction:h=>{t=h},setBatchNotifyFunction:h=>{s=h},setScheduler:h=>{i=h}}}var Wn=AP(),CP=class extends Mh{#e=!0;#t;#n;constructor(){super(),this.#n=n=>{if(!El&&window.addEventListener){const e=()=>n(!0),t=()=>n(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(n){this.#n=n,this.#t?.(),this.#t=n(this.setOnline.bind(this))}setOnline(n){this.#e!==n&&(this.#e=n,this.listeners.forEach(t=>{t(n)}))}isOnline(){return this.#e}},fm=new CP;function NP(n){return Math.min(1e3*2**n,3e4)}function FA(n){return(n??"online")==="online"?fm.isOnline():!0}var M0=class extends Error{constructor(n){super("CancelledError"),this.revert=n?.revert,this.silent=n?.silent}};function zA(n){let e=!1,t=0,s;const i=k0(),o=()=>i.status!=="pending",u=A=>{if(!o()){const C=new M0(A);b(C),n.onCancel?.(C)}},h=()=>{e=!0},f=()=>{e=!1},p=()=>Jx.isFocused()&&(n.networkMode==="always"||fm.isOnline())&&n.canRun(),g=()=>FA(n.networkMode)&&n.canRun(),x=A=>{o()||(s?.(),i.resolve(A))},b=A=>{o()||(s?.(),i.reject(A))},S=()=>new Promise(A=>{s=C=>{(o()||p())&&A(C)},n.onPause?.()}).then(()=>{s=void 0,o()||n.onContinue?.()}),w=()=>{if(o())return;let A;const C=t===0?n.initialPromise:void 0;try{A=C??n.fn()}catch(L){A=Promise.reject(L)}Promise.resolve(A).then(x).catch(L=>{if(o())return;const z=n.retry??(El?0:3),U=n.retryDelay??NP,F=typeof U=="function"?U(t,L):U,K=z===!0||typeof z=="number"&&t<z||typeof z=="function"&&z(t,L);if(e||!K){b(L);return}t++,n.onFail?.(t,L),bP(F).then(()=>p()?void 0:S()).then(()=>{e?b(L):w()})})};return{promise:i,status:()=>i.status,cancel:u,continue:()=>(s?.(),i),cancelRetry:h,continueRetry:f,canStart:g,start:()=>(g()?w():S().then(w),i)}}var qA=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),j0(this.gcTime)&&(this.#e=hl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(El?1/0:300*1e3))}clearGcTimeout(){this.#e&&(hl.clearTimeout(this.#e),this.#e=void 0)}},IP=class extends qA{#e;#t;#n;#r;#s;#o;#a;constructor(e){super(),this.#a=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#r=e.client,this.#n=this.#r.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=b1(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(e){if(this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=b1(this.options);t.data!==void 0&&(this.setState(x1(t.data,t.dataUpdatedAt)),this.#e=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,t){const s=P0(this.state.data,e,this.options);return this.#i({data:s,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),s}setState(e,t){this.#i({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#s?.promise;return this.#s?.cancel(e),t?t.then(js).catch(js):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>br(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>so(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!LA(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#s&&(this.#a?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#i({type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const s=new AbortController,i=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#a=!0,s.signal)})},o=()=>{const f=UA(this.options,t),g=(()=>{const x={client:this.#r,queryKey:this.queryKey,meta:this.meta};return i(x),x})();return this.#a=!1,this.options.persister?this.options.persister(f,g,this):f(g)},h=(()=>{const f={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:o};return i(f),f})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#i({type:"fetch",meta:h.fetchOptions?.meta}),this.#s=zA({initialPromise:t?.initialPromise,fn:h.fetchFn,onCancel:f=>{f instanceof M0&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),s.abort()},onFail:(f,p)=>{this.#i({type:"failed",failureCount:f,error:p})},onPause:()=>{this.#i({type:"pause"})},onContinue:()=>{this.#i({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const f=await this.#s.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof M0){if(f.silent)return this.#s.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#i({type:"error",error:f}),this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#i(e){const t=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...HA(s.data,this.options),fetchMeta:e.meta??null};case"success":const i={...s,...x1(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?i:void 0,i;case"error":const o=e.error;return{...s,error:o,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=t(this.state),Wn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function HA(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:FA(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function x1(n,e){return{data:n,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function b1(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,s=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var RP=class extends Mh{constructor(n,e){super(),this.options=e,this.#e=n,this.#i=null,this.#a=k0(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#r=void 0;#s;#o;#a;#i;#m;#h;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),_1(this.#t,this.options)?this.#d():this.updateResult(),this.#x())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return L0(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return L0(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#_(),this.#t.removeObserver(this)}setOptions(n){const e=this.options,t=this.#t;if(this.options=this.#e.defaultQueryOptions(n),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof br(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),e._defaulted&&!D0(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const s=this.hasListeners();s&&S1(this.#t,t,this.options,e)&&this.#d(),this.updateResult(),s&&(this.#t!==t||br(this.options.enabled,this.#t)!==br(e.enabled,this.#t)||so(this.options.staleTime,this.#t)!==so(e.staleTime,this.#t))&&this.#g();const i=this.#y();s&&(this.#t!==t||br(this.options.enabled,this.#t)!==br(e.enabled,this.#t)||i!==this.#l)&&this.#v(i)}getOptimisticResult(n){const e=this.#e.getQueryCache().build(this.#e,n),t=this.createResult(e,n);return DP(this,t)&&(this.#r=t,this.#o=this.options,this.#s=this.#t.state),t}getCurrentResult(){return this.#r}trackResult(n,e){return new Proxy(n,{get:(t,s)=>(this.trackProp(s),e?.(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(t,s))})}trackProp(n){this.#p.add(n)}getCurrentQuery(){return this.#t}refetch({...n}={}){return this.fetch({...n})}fetchOptimistic(n){const e=this.#e.defaultQueryOptions(n),t=this.#e.getQueryCache().build(this.#e,e);return t.fetch().then(()=>this.createResult(t,e))}fetch(n){return this.#d({...n,cancelRefetch:n.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(n){this.#S();let e=this.#t.fetch(this.options,n);return n?.throwOnError||(e=e.catch(js)),e}#g(){this.#b();const n=so(this.options.staleTime,this.#t);if(El||this.#r.isStale||!j0(n))return;const t=LA(this.#r.dataUpdatedAt,n)+1;this.#c=hl.setTimeout(()=>{this.#r.isStale||this.updateResult()},t)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(n){this.#_(),this.#l=n,!(El||br(this.options.enabled,this.#t)===!1||!j0(this.#l)||this.#l===0)&&(this.#u=hl.setInterval(()=>{(this.options.refetchIntervalInBackground||Jx.isFocused())&&this.#d()},this.#l))}#x(){this.#g(),this.#v(this.#y())}#b(){this.#c&&(hl.clearTimeout(this.#c),this.#c=void 0)}#_(){this.#u&&(hl.clearInterval(this.#u),this.#u=void 0)}createResult(n,e){const t=this.#t,s=this.options,i=this.#r,o=this.#s,u=this.#o,f=n!==t?n.state:this.#n,{state:p}=n;let g={...p},x=!1,b;if(e._optimisticResults){const N=this.hasListeners(),R=!N&&_1(n,e),O=N&&S1(n,t,e,s);(R||O)&&(g={...g,...HA(p.data,n.options)}),e._optimisticResults==="isRestoring"&&(g.fetchStatus="idle")}let{error:S,errorUpdatedAt:w,status:A}=g;b=g.data;let C=!1;if(e.placeholderData!==void 0&&b===void 0&&A==="pending"){let N;i?.isPlaceholderData&&e.placeholderData===u?.placeholderData?(N=i.data,C=!0):N=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,N!==void 0&&(A="success",b=P0(i?.data,N,e),x=!0)}if(e.select&&b!==void 0&&!C)if(i&&b===o?.data&&e.select===this.#m)b=this.#h;else try{this.#m=e.select,b=e.select(b),b=P0(i?.data,b,e),this.#h=b,this.#i=null}catch(N){this.#i=N}this.#i&&(S=this.#i,b=this.#h,w=Date.now(),A="error");const L=g.fetchStatus==="fetching",z=A==="pending",U=A==="error",F=z&&L,K=b!==void 0,j={status:A,fetchStatus:g.fetchStatus,isPending:z,isSuccess:A==="success",isError:U,isInitialLoading:F,isLoading:F,data:b,dataUpdatedAt:g.dataUpdatedAt,error:S,errorUpdatedAt:w,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>f.dataUpdateCount||g.errorUpdateCount>f.errorUpdateCount,isFetching:L,isRefetching:L&&!z,isLoadingError:U&&!K,isPaused:g.fetchStatus==="paused",isPlaceholderData:x,isRefetchError:U&&K,isStale:Zx(n,e),refetch:this.refetch,promise:this.#a,isEnabled:br(e.enabled,n)!==!1};if(this.options.experimental_prefetchInRender){const N=V=>{j.status==="error"?V.reject(j.error):j.data!==void 0&&V.resolve(j.data)},R=()=>{const V=this.#a=j.promise=k0();N(V)},O=this.#a;switch(O.status){case"pending":n.queryHash===t.queryHash&&N(O);break;case"fulfilled":(j.status==="error"||j.data!==O.value)&&R();break;case"rejected":(j.status!=="error"||j.error!==O.reason)&&R();break}}return j}updateResult(){const n=this.#r,e=this.createResult(this.#t,this.options);if(this.#s=this.#t.state,this.#o=this.options,this.#s.data!==void 0&&(this.#f=this.#t),D0(e,n))return;this.#r=e;const t=()=>{if(!n)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!this.#p.size)return!0;const o=new Set(i??this.#p);return this.options.throwOnError&&o.add("error"),Object.keys(this.#r).some(u=>{const h=u;return this.#r[h]!==n[h]&&o.has(h)})};this.#w({listeners:t()})}#S(){const n=this.#e.getQueryCache().build(this.#e,this.options);if(n===this.#t)return;const e=this.#t;this.#t=n,this.#n=n.state,this.hasListeners()&&(e?.removeObserver(this),n.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#x()}#w(n){Wn.batch(()=>{n.listeners&&this.listeners.forEach(e=>{e(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function jP(n,e){return br(e.enabled,n)!==!1&&n.state.data===void 0&&!(n.state.status==="error"&&e.retryOnMount===!1)}function _1(n,e){return jP(n,e)||n.state.data!==void 0&&L0(n,e,e.refetchOnMount)}function L0(n,e,t){if(br(e.enabled,n)!==!1&&so(e.staleTime,n)!=="static"){const s=typeof t=="function"?t(n):t;return s==="always"||s!==!1&&Zx(n,e)}return!1}function S1(n,e,t,s){return(n!==e||br(s.enabled,n)===!1)&&(!t.suspense||n.state.status!=="error")&&Zx(n,t)}function Zx(n,e){return br(e.enabled,n)!==!1&&n.isStaleByTime(so(e.staleTime,n))}function DP(n,e){return!D0(n.getCurrentResult(),e)}function w1(n){return{onFetch:(e,t)=>{const s=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],u=e.state.data?.pageParams||[];let h={pages:[],pageParams:[]},f=0;const p=async()=>{let g=!1;const x=w=>{wP(w,()=>e.signal,()=>g=!0)},b=UA(e.options,e.fetchOptions),S=async(w,A,C)=>{if(g)return Promise.reject();if(A==null&&w.pages.length)return Promise.resolve(w);const z=(()=>{const Z={client:e.client,queryKey:e.queryKey,pageParam:A,direction:C?"backward":"forward",meta:e.options.meta};return x(Z),Z})(),U=await b(z),{maxPages:F}=e.options,K=C?SP:_P;return{pages:K(w.pages,U,F),pageParams:K(w.pageParams,A,F)}};if(i&&o.length){const w=i==="backward",A=w?OP:E1,C={pages:o,pageParams:u},L=A(s,C);h=await S(C,L,w)}else{const w=n??o.length;do{const A=f===0?u[0]??s.initialPageParam:E1(s,h);if(f>0&&A==null)break;h=await S(h,A),f++}while(f<w)}return h};e.options.persister?e.fetchFn=()=>e.options.persister?.(p,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=p}}}function E1(n,{pages:e,pageParams:t}){const s=e.length-1;return e.length>0?n.getNextPageParam(e[s],e,t[s],t):void 0}function OP(n,{pages:e,pageParams:t}){return e.length>0?n.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var PP=class extends qA{#e;#t;#n;#r;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||kP(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(t=>t!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#s({type:"continue"})},s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#r=zA({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(u,h)=>{this.#s({type:"failed",failureCount:u,error:h})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const i=this.state.status==="pending",o=!this.#r.canStart();try{if(i)t();else{this.#s({type:"pending",variables:e,isPaused:o}),await this.#n.config.onMutate?.(e,this,s);const h=await this.options.onMutate?.(e,s);h!==this.state.context&&this.#s({type:"pending",context:h,variables:e,isPaused:o})}const u=await this.#r.start();return await this.#n.config.onSuccess?.(u,e,this.state.context,this,s),await this.options.onSuccess?.(u,e,this.state.context,s),await this.#n.config.onSettled?.(u,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(u,null,e,this.state.context,s),this.#s({type:"success",data:u}),u}catch(u){try{await this.#n.config.onError?.(u,e,this.state.context,this,s)}catch(h){Promise.reject(h)}try{await this.options.onError?.(u,e,this.state.context,s)}catch(h){Promise.reject(h)}try{await this.#n.config.onSettled?.(void 0,u,this.state.variables,this.state.context,this,s)}catch(h){Promise.reject(h)}try{await this.options.onSettled?.(void 0,u,e,this.state.context,s)}catch(h){Promise.reject(h)}throw this.#s({type:"error",error:u}),u}finally{this.#n.runNext(this)}}#s(e){const t=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Wn.batch(()=>{this.#t.forEach(s=>{s.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function kP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var MP=class extends Mh{constructor(n={}){super(),this.config=n,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(n,e,t){const s=new PP({client:n,mutationCache:this,mutationId:++this.#n,options:n.defaultMutationOptions(e),state:t});return this.add(s),s}add(n){this.#e.add(n);const e=Ip(n);if(typeof e=="string"){const t=this.#t.get(e);t?t.push(n):this.#t.set(e,[n])}this.notify({type:"added",mutation:n})}remove(n){if(this.#e.delete(n)){const e=Ip(n);if(typeof e=="string"){const t=this.#t.get(e);if(t)if(t.length>1){const s=t.indexOf(n);s!==-1&&t.splice(s,1)}else t[0]===n&&this.#t.delete(e)}}this.notify({type:"removed",mutation:n})}canRun(n){const e=Ip(n);if(typeof e=="string"){const s=this.#t.get(e)?.find(i=>i.state.status==="pending");return!s||s===n}else return!0}runNext(n){const e=Ip(n);return typeof e=="string"?this.#t.get(e)?.find(s=>s!==n&&s.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Wn.batch(()=>{this.#e.forEach(n=>{this.notify({type:"removed",mutation:n})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(n){const e={exact:!0,...n};return this.getAll().find(t=>g1(e,t))}findAll(n={}){return this.getAll().filter(e=>g1(n,e))}notify(n){Wn.batch(()=>{this.listeners.forEach(e=>{e(n)})})}resumePausedMutations(){const n=this.getAll().filter(e=>e.state.isPaused);return Wn.batch(()=>Promise.all(n.map(e=>e.continue().catch(js))))}};function Ip(n){return n.options.scope?.id}var LP=class extends Mh{constructor(n={}){super(),this.config=n,this.#e=new Map}#e;build(n,e,t){const s=e.queryKey,i=e.queryHash??Wx(s,e);let o=this.get(i);return o||(o=new IP({client:n,queryKey:s,queryHash:i,options:n.defaultQueryOptions(e),state:t,defaultOptions:n.getQueryDefaults(s)}),this.add(o)),o}add(n){this.#e.has(n.queryHash)||(this.#e.set(n.queryHash,n),this.notify({type:"added",query:n}))}remove(n){const e=this.#e.get(n.queryHash);e&&(n.destroy(),e===n&&this.#e.delete(n.queryHash),this.notify({type:"removed",query:n}))}clear(){Wn.batch(()=>{this.getAll().forEach(n=>{this.remove(n)})})}get(n){return this.#e.get(n)}getAll(){return[...this.#e.values()]}find(n){const e={exact:!0,...n};return this.getAll().find(t=>m1(e,t))}findAll(n={}){const e=this.getAll();return Object.keys(n).length>0?e.filter(t=>m1(n,t)):e}notify(n){Wn.batch(()=>{this.listeners.forEach(e=>{e(n)})})}onFocus(){Wn.batch(()=>{this.getAll().forEach(n=>{n.onFocus()})})}onOnline(){Wn.batch(()=>{this.getAll().forEach(n=>{n.onOnline()})})}},GA=class{#e;#t;#n;#r;#s;#o;#a;#i;constructor(n={}){this.#e=n.queryCache||new LP,this.#t=n.mutationCache||new MP,this.#n=n.defaultOptions||{},this.#r=new Map,this.#s=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=Jx.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#i=fm.subscribe(async n=>{n&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#i?.(),this.#i=void 0)}isFetching(n){return this.#e.findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return this.#t.findAll({...n,status:"pending"}).length}getQueryData(n){const e=this.defaultQueryOptions({queryKey:n});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=this.#e.build(this,e),s=t.state.data;return s===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(so(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(n){return this.#e.findAll(n).map(({queryKey:e,state:t})=>{const s=t.data;return[e,s]})}setQueryData(n,e,t){const s=this.defaultQueryOptions({queryKey:n}),o=this.#e.get(s.queryHash)?.state.data,u=vP(e,o);if(u!==void 0)return this.#e.build(this,s).setData(u,{...t,manual:!0})}setQueriesData(n,e,t){return Wn.batch(()=>this.#e.findAll(n).map(({queryKey:s})=>[s,this.setQueryData(s,e,t)]))}getQueryState(n){const e=this.defaultQueryOptions({queryKey:n});return this.#e.get(e.queryHash)?.state}removeQueries(n){const e=this.#e;Wn.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=this.#e;return Wn.batch(()=>(t.findAll(n).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},s=Wn.batch(()=>this.#e.findAll(n).map(i=>i.cancel(t)));return Promise.all(s).then(js).catch(js)}invalidateQueries(n,e={}){return Wn.batch(()=>(this.#e.findAll(n).forEach(t=>{t.invalidate()}),n?.refetchType==="none"?Promise.resolve():this.refetchQueries({...n,type:n?.refetchType??n?.type??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},s=Wn.batch(()=>this.#e.findAll(n).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,t);return t.throwOnError||(o=o.catch(js)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(js)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(so(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(js).catch(js)}fetchInfiniteQuery(n){return n.behavior=w1(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(js).catch(js)}ensureInfiniteQueryData(n){return n.behavior=w1(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return fm.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(n){this.#n=n}setQueryDefaults(n,e){this.#r.set(gh(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...this.#r.values()],t={};return e.forEach(s=>{yh(n,s.queryKey)&&Object.assign(t,s.defaultOptions)}),t}setMutationDefaults(n,e){this.#s.set(gh(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...this.#s.values()],t={};return e.forEach(s=>{yh(n,s.mutationKey)&&Object.assign(t,s.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...this.#n.queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=Wx(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Xx&&(e.enabled=!1),e}defaultMutationOptions(n){return n?._defaulted?n:{...this.#n.mutations,...n?.mutationKey&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},$A=I.createContext(void 0),Fl=n=>{const e=I.useContext($A);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},VP=({client:n,children:e})=>(I.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),l.jsx($A.Provider,{value:n,children:e})),KA=I.createContext(!1),UP=()=>I.useContext(KA);KA.Provider;function BP(){let n=!1;return{clearReset:()=>{n=!1},reset:()=>{n=!0},isReset:()=>n}}var FP=I.createContext(BP()),zP=()=>I.useContext(FP),qP=(n,e,t)=>{const s=t?.state.error&&typeof n.throwOnError=="function"?BA(n.throwOnError,[t.state.error,t]):n.throwOnError;(n.suspense||n.experimental_prefetchInRender||s)&&(e.isReset()||(n.retryOnMount=!1))},HP=n=>{I.useEffect(()=>{n.clearReset()},[n])},GP=({result:n,errorResetBoundary:e,throwOnError:t,query:s,suspense:i})=>n.isError&&!e.isReset()&&!n.isFetching&&s&&(i&&n.data===void 0||BA(t,[n.error,s])),$P=n=>{if(n.suspense){const t=i=>i==="static"?i:Math.max(i??1e3,1e3),s=n.staleTime;n.staleTime=typeof s=="function"?(...i)=>t(s(...i)):t(s),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}},KP=(n,e)=>n.isLoading&&n.isFetching&&!e,QP=(n,e)=>n?.suspense&&e.isPending,T1=(n,e,t)=>e.fetchOptimistic(n).catch(()=>{t.clearReset()});function YP(n,e,t){const s=UP(),i=zP(),o=Fl(),u=o.defaultQueryOptions(n);o.getDefaultOptions().queries?._experimental_beforeQuery?.(u);const h=o.getQueryCache().get(u.queryHash);u._optimisticResults=s?"isRestoring":"optimistic",$P(u),qP(u,i,h),HP(i);const f=!o.getQueryCache().get(u.queryHash),[p]=I.useState(()=>new e(o,u)),g=p.getOptimisticResult(u),x=!s&&n.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback(b=>{const S=x?p.subscribe(Wn.batchCalls(b)):js;return p.updateResult(),S},[p,x]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),I.useEffect(()=>{p.setOptions(u)},[u,p]),QP(u,g))throw T1(u,p,i);if(GP({result:g,errorResetBoundary:i,throwOnError:u.throwOnError,query:h,suspense:u.suspense}))throw g.error;return o.getDefaultOptions().queries?._experimental_afterQuery?.(u,g),u.experimental_prefetchInRender&&!El&&KP(g,s)&&(f?T1(u,p,i):h?.promise)?.catch(js).finally(()=>{p.updateResult()}),u.notifyOnChangeProps?g:p.trackResult(g)}function ls(n,e){return YP(n,RP)}const WP="modulepreload",XP=function(n){return"/"+n},A1={},$c=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(x=>Promise.resolve(x).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var u=p;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),f=h?.nonce||h?.getAttribute("nonce");i=p(t.map(g=>{if(g=XP(g),g in A1)return;A1[g]=!0;const x=g.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${b}`))return;const S=document.createElement("link");if(S.rel=x?"stylesheet":WP,x||(S.as="script"),S.crossOrigin="",S.href=g,f&&S.setAttribute("nonce",f),document.head.appendChild(S),x)return new Promise((w,A)=>{S.addEventListener("load",w),S.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${g}`)))})}))}function o(h){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=h,window.dispatchEvent(f),!f.defaultPrevented)throw h}return i.then(h=>{for(const f of h||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})},Kc={STATIC:{staleTime:1e3*60*60,cacheTime:1e3*60*60*24},SEMI_STATIC:{staleTime:1e3*60*30,cacheTime:1e3*60*60*12}},V0={services:n=>["services",n].filter(Boolean),offerings:()=>["offerings"],users:n=>["users",n].filter(Boolean),staff:()=>["staff"],teachers:()=>["teachers"],therapists:()=>["therapists"],students:()=>["students"],studentsByParent:n=>["students","byParent",n],studentsByStaff:n=>["students","byStaff",n],childrenByParent:n=>["children","byParent",n],activities:n=>["activities",n].filter(Boolean),sessions:n=>["sessions",n],assessments:n=>["assessments",n].filter(Boolean),user:n=>["user",n],student:n=>["student",n],assessment:n=>["assessment",n],metadata:n=>["metadata",n],staffSummary:()=>["metadata","staffSummary"],serviceSummary:()=>["metadata","serviceSummary"]},QA={static:{staleTime:Kc.STATIC.staleTime,cacheTime:Kc.STATIC.cacheTime,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,retry:1},semiStatic:{staleTime:Kc.SEMI_STATIC.staleTime,cacheTime:Kc.SEMI_STATIC.cacheTime,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,retry:1}},Bn=new GA({defaultOptions:{queries:{staleTime:Kc.SEMI_STATIC.staleTime,cacheTime:Kc.SEMI_STATIC.cacheTime,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,retry:1,retryDelay:n=>Math.min(1e3*2**n,3e4),networkMode:"offlineFirst"},mutations:{retry:1,networkMode:"offlineFirst"}}}),pm=async(n,e)=>{switch(n){case"student":case"child":await Bn.invalidateQueries({queryKey:["students"]}),await Bn.invalidateQueries({queryKey:["children"]}),e&&(await Bn.invalidateQueries({queryKey:["student",e]}),await Bn.invalidateQueries({queryKey:["activities",e]}));break;case"staff":case"teacher":case"therapist":await Bn.invalidateQueries({queryKey:["staff"]}),await Bn.invalidateQueries({queryKey:["teachers"]}),await Bn.invalidateQueries({queryKey:["therapists"]}),await Bn.invalidateQueries({queryKey:["metadata","staffSummary"]}),e&&await Bn.invalidateQueries({queryKey:["user",e]});break;case"service":case"offering":await Bn.invalidateQueries({queryKey:["services"]}),await Bn.invalidateQueries({queryKey:["offerings"]}),await Bn.invalidateQueries({queryKey:["metadata","serviceSummary"]});break;case"session":await Bn.invalidateQueries({queryKey:["sessions"]});break;case"activity":await Bn.invalidateQueries({queryKey:["activities"]});break;case"assessment":await Bn.invalidateQueries({queryKey:["assessments"]}),e&&await Bn.invalidateQueries({queryKey:["assessment",e]});break;default:await Bn.invalidateQueries()}},JP=()=>{};var C1={};const YA=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ZP=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const i=n[t++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[s++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],u=n[t++],h=n[t++],f=((i&7)<<18|(o&63)<<12|(u&63)<<6|h&63)-65536;e[s++]=String.fromCharCode(55296+(f>>10)),e[s++]=String.fromCharCode(56320+(f&1023))}else{const o=n[t++],u=n[t++];e[s++]=String.fromCharCode((i&15)<<12|(o&63)<<6|u&63)}}return e.join("")},WA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const o=n[i],u=i+1<n.length,h=u?n[i+1]:0,f=i+2<n.length,p=f?n[i+2]:0,g=o>>2,x=(o&3)<<4|h>>4;let b=(h&15)<<2|p>>6,S=p&63;f||(S=64,u||(b=64)),s.push(t[g],t[x],t[b],t[S])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(YA(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ZP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],h=i<n.length?t[n.charAt(i)]:0;++i;const p=i<n.length?t[n.charAt(i)]:64;++i;const x=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||h==null||p==null||x==null)throw new e4;const b=o<<2|h>>4;if(s.push(b),p!==64){const S=h<<4&240|p>>2;if(s.push(S),x!==64){const w=p<<6&192|x;s.push(w)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class e4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const t4=function(n){const e=YA(n);return WA.encodeByteArray(e,!0)},mm=function(n){return t4(n).replace(/\./g,"")},XA=function(n){try{return WA.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function JA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const n4=()=>JA().__FIREBASE_DEFAULTS__,s4=()=>{if(typeof process>"u"||typeof C1>"u")return;const n=C1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},r4=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&XA(n[1]);return e&&JSON.parse(e)},eg=()=>{try{return JP()||n4()||s4()||r4()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ZA=n=>eg()?.emulatorHosts?.[n],eC=n=>{const e=ZA(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},tC=()=>eg()?.config,nC=n=>eg()?.[`_${n}`];class i4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}function vo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tg(n){return(await fetch(n,{credentials:"include"})).ok}function sC(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[mm(JSON.stringify(t)),mm(JSON.stringify(u)),""].join(".")}const sh={};function a4(){const n={prod:[],emulator:[]};for(const e of Object.keys(sh))sh[e]?n.emulator.push(e):n.prod.push(e);return n}function o4(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let N1=!1;function eb(n,e){if(typeof window>"u"||typeof document>"u"||!vo(window.location.host)||sh[n]===e||sh[n]||N1)return;sh[n]=e;function t(b){return`__firebase__banner__${b}`}const s="__firebase__banner",o=a4().prod.length>0;function u(){const b=document.getElementById(s);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function f(b,S){b.setAttribute("width","24"),b.setAttribute("id",S),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{N1=!0,u()},b}function g(b,S){b.setAttribute("id",S),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function x(){const b=o4(s),S=t("text"),w=document.getElementById(S)||document.createElement("span"),A=t("learnmore"),C=document.getElementById(A)||document.createElement("a"),L=t("preprendIcon"),z=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const U=b.element;h(U),g(C,A);const F=p();f(z,L),U.append(z,w,C,F),document.body.appendChild(U)}o?(w.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function l4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pn())}function rC(){const n=eg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function c4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function u4(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function d4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function h4(){const n=Pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function iC(){return!rC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function aC(){return!rC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function oC(){try{return typeof indexedDB=="object"}catch{return!1}}function f4(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const p4="FirebaseError";class Br extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=p4,Object.setPrototypeOf(this,Br.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Lh.prototype.create)}}class Lh{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],u=o?m4(o,s):"Error",h=`${this.serviceName}: ${u} (${i}).`;return new Br(i,h,s)}}function m4(n,e){return n.replace(g4,(t,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const g4=/\{\$([^}]+)}/g;function y4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function _i(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const i of t){if(!s.includes(i))return!1;const o=n[i],u=e[i];if(I1(o)&&I1(u)){if(!_i(o,u))return!1}else if(o!==u)return!1}for(const i of s)if(!t.includes(i))return!1;return!0}function I1(n){return n!==null&&typeof n=="object"}function Vh(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Kd(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,o]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Qd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function v4(n,e){const t=new x4(n,e);return t.subscribe.bind(t)}class x4{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let i;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");b4(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:s},i.next===void 0&&(i.next=Wv),i.error===void 0&&(i.error=Wv),i.complete===void 0&&(i.complete=Wv);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function b4(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Wv(){}function Jt(n){return n&&n._delegate?n._delegate:n}class uo{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const rl="[DEFAULT]";class _4{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new i4;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(w4(e))try{this.getOrInitializeService({instanceIdentifier:rl})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});s.resolve(o)}catch{}}}}clearInstance(e=rl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rl){return this.instances.has(e)}getOptions(e=rl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[o,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);s===h&&u.resolve(i)}return i}onInit(e,t){const s=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(s)??new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:S4(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=rl){return this.component?this.component.multipleInstances?e:rl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function S4(n){return n===rl?void 0:n}function w4(n){return n.instantiationMode==="EAGER"}class E4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _4(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ze||(Ze={}));const T4={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},A4=Ze.INFO,C4={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},N4=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),i=C4[e];if(i)console[i](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tb{constructor(e){this.name=e,this._logLevel=A4,this._logHandler=N4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?T4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...e),this._logHandler(this,Ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...e),this._logHandler(this,Ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...e),this._logHandler(this,Ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...e),this._logHandler(this,Ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...e),this._logHandler(this,Ze.ERROR,...e)}}const I4=(n,e)=>e.some(t=>n instanceof t);let R1,j1;function R4(){return R1||(R1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function j4(){return j1||(j1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lC=new WeakMap,U0=new WeakMap,cC=new WeakMap,Xv=new WeakMap,nb=new WeakMap;function D4(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",u)},o=()=>{t(ro(n.result)),i()},u=()=>{s(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&lC.set(t,n)}).catch(()=>{}),nb.set(e,n),e}function O4(n){if(U0.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",u),n.removeEventListener("abort",u)},o=()=>{t(),i()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",u),n.addEventListener("abort",u)});U0.set(n,e)}let B0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return U0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ro(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function P4(n){B0=n(B0)}function k4(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Jv(this),e,...t);return cC.set(s,e.sort?e.sort():[e]),ro(s)}:j4().includes(n)?function(...e){return n.apply(Jv(this),e),ro(lC.get(this))}:function(...e){return ro(n.apply(Jv(this),e))}}function M4(n){return typeof n=="function"?k4(n):(n instanceof IDBTransaction&&O4(n),I4(n,R4())?new Proxy(n,B0):n)}function ro(n){if(n instanceof IDBRequest)return D4(n);if(Xv.has(n))return Xv.get(n);const e=M4(n);return e!==n&&(Xv.set(n,e),nb.set(e,n)),e}const Jv=n=>nb.get(n);function L4(n,e,{blocked:t,upgrade:s,blocking:i,terminated:o}={}){const u=indexedDB.open(n,e),h=ro(u);return s&&u.addEventListener("upgradeneeded",f=>{s(ro(u.result),f.oldVersion,f.newVersion,ro(u.transaction),f)}),t&&u.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),h.then(f=>{o&&f.addEventListener("close",()=>o()),i&&f.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const V4=["get","getKey","getAll","getAllKeys","count"],U4=["put","add","delete","clear"],Zv=new Map;function D1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Zv.get(e))return Zv.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=U4.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||V4.includes(t)))return;const o=async function(u,...h){const f=this.transaction(u,i?"readwrite":"readonly");let p=f.store;return s&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),i&&f.done]))[0]};return Zv.set(e,o),o}P4(n=>({...n,get:(e,t,s)=>D1(e,t)||n.get(e,t,s),has:(e,t)=>!!D1(e,t)||n.has(e,t)}));class B4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(F4(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function F4(n){return n.getComponent()?.type==="VERSION"}const F0="@firebase/app",O1="0.14.6";const ea=new tb("@firebase/app"),z4="@firebase/app-compat",q4="@firebase/analytics-compat",H4="@firebase/analytics",G4="@firebase/app-check-compat",$4="@firebase/app-check",K4="@firebase/auth",Q4="@firebase/auth-compat",Y4="@firebase/database",W4="@firebase/data-connect",X4="@firebase/database-compat",J4="@firebase/functions",Z4="@firebase/functions-compat",e6="@firebase/installations",t6="@firebase/installations-compat",n6="@firebase/messaging",s6="@firebase/messaging-compat",r6="@firebase/performance",i6="@firebase/performance-compat",a6="@firebase/remote-config",o6="@firebase/remote-config-compat",l6="@firebase/storage",c6="@firebase/storage-compat",u6="@firebase/firestore",d6="@firebase/ai",h6="@firebase/firestore-compat",f6="firebase",p6="12.6.0";const gm="[DEFAULT]",m6={[F0]:"fire-core",[z4]:"fire-core-compat",[H4]:"fire-analytics",[q4]:"fire-analytics-compat",[$4]:"fire-app-check",[G4]:"fire-app-check-compat",[K4]:"fire-auth",[Q4]:"fire-auth-compat",[Y4]:"fire-rtdb",[W4]:"fire-data-connect",[X4]:"fire-rtdb-compat",[J4]:"fire-fn",[Z4]:"fire-fn-compat",[e6]:"fire-iid",[t6]:"fire-iid-compat",[n6]:"fire-fcm",[s6]:"fire-fcm-compat",[r6]:"fire-perf",[i6]:"fire-perf-compat",[a6]:"fire-rc",[o6]:"fire-rc-compat",[l6]:"fire-gcs",[c6]:"fire-gcs-compat",[u6]:"fire-fst",[h6]:"fire-fst-compat",[d6]:"fire-vertex","fire-js":"fire-js",[f6]:"fire-js-all"};const Tl=new Map,ym=new Map,vm=new Map;function z0(n,e){try{n.container.addComponent(e)}catch(t){ea.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ho(n){const e=n.name;if(vm.has(e))return ea.debug(`There were multiple attempts to register component ${e}.`),!1;vm.set(e,n);for(const t of Tl.values())z0(t,n);for(const t of ym.values())z0(t,n);return!0}function Cu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ds(n){return n==null?!1:n.settings!==void 0}const g6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},io=new Lh("app","Firebase",g6);class y6{constructor(e,t,s){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new uo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw io.create("app-deleted",{appName:this._name})}}const xo=p6;function eo(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s={name:gm,automaticDataCollectionEnabled:!0,...e},i=s.name;if(typeof i!="string"||!i)throw io.create("bad-app-name",{appName:String(i)});if(t||(t=tC()),!t)throw io.create("no-options");const o=Tl.get(i);if(o){if(_i(t,o.options)&&_i(s,o.config))return o;throw io.create("duplicate-app",{appName:i})}const u=new E4(i);for(const f of vm.values())u.addComponent(f);const h=new y6(t,s,u);return Tl.set(i,h),h}function ng(n=gm){const e=Tl.get(n);if(!e&&n===gm&&tC())return eo();if(!e)throw io.create("no-app",{appName:n});return e}async function v6(n){let e=!1;const t=n.name;Tl.has(t)?(e=!0,Tl.delete(t)):ym.has(t)&&n.decRefCount()<=0&&(ym.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(s=>s.delete())),n.isDeleted=!0)}function Mr(n,e,t){let s=m6[n]??n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const u=[`Unable to register library "${s}" with version "${e}":`];i&&u.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ea.warn(u.join(" "));return}ho(new uo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const x6="firebase-heartbeat-database",b6=1,vh="firebase-heartbeat-store";let e0=null;function uC(){return e0||(e0=L4(x6,b6,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vh)}catch(t){console.warn(t)}}}}).catch(n=>{throw io.create("idb-open",{originalErrorMessage:n.message})})),e0}async function _6(n){try{const t=(await uC()).transaction(vh),s=await t.objectStore(vh).get(dC(n));return await t.done,s}catch(e){if(e instanceof Br)ea.warn(e.message);else{const t=io.create("idb-get",{originalErrorMessage:e?.message});ea.warn(t.message)}}}async function P1(n,e){try{const s=(await uC()).transaction(vh,"readwrite");await s.objectStore(vh).put(e,dC(n)),await s.done}catch(t){if(t instanceof Br)ea.warn(t.message);else{const s=io.create("idb-set",{originalErrorMessage:t?.message});ea.warn(s.message)}}}function dC(n){return`${n.name}!${n.options.appId}`}const S6=1024,w6=30;class E6{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new A6(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=k1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(i=>i.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:t}),this._heartbeatsCache.heartbeats.length>w6){const i=C6(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ea.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=k1(),{heartbeatsToSend:t,unsentEntries:s}=T6(this._heartbeatsCache.heartbeats),i=mm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ea.warn(e),""}}}function k1(){return new Date().toISOString().substring(0,10)}function T6(n,e=S6){const t=[];let s=n.slice();for(const i of n){const o=t.find(u=>u.agent===i.agent);if(o){if(o.dates.push(i.date),M1(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),M1(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class A6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oC()?f4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _6(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return P1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return P1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function M1(n){return mm(JSON.stringify({version:2,heartbeats:n})).length}function C6(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}function N6(n){ho(new uo("platform-logger",e=>new B4(e),"PRIVATE")),ho(new uo("heartbeat",e=>new E6(e),"PRIVATE")),Mr(F0,O1,n),Mr(F0,O1,"esm2020"),Mr("fire-js","")}N6("");function hC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const I6=hC,fC=new Lh("auth","Firebase",hC());const xm=new tb("@firebase/auth");function R6(n,...e){xm.logLevel<=Ze.WARN&&xm.warn(`Auth (${xo}): ${n}`,...e)}function $p(n,...e){xm.logLevel<=Ze.ERROR&&xm.error(`Auth (${xo}): ${n}`,...e)}function Lr(n,...e){throw sb(n,...e)}function mi(n,...e){return sb(n,...e)}function pC(n,e,t){const s={...I6(),[e]:t};return new Lh("auth","Firebase",s).create(e,{appName:n.name})}function Ji(n){return pC(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sb(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return fC.create(n,...e)}function Oe(n,e,...t){if(!n)throw sb(e,...t)}function Ki(n){const e="INTERNAL ASSERTION FAILED: "+n;throw $p(e),new Error(e)}function ta(n,e){n||Ki(e)}function q0(){return typeof self<"u"&&self.location?.href||""}function j6(){return L1()==="http:"||L1()==="https:"}function L1(){return typeof self<"u"&&self.location?.protocol||null}function D6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(j6()||u4()||"connection"in navigator)?navigator.onLine:!0}function O6(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Uh{constructor(e,t){this.shortDelay=e,this.longDelay=t,ta(t>e,"Short delay should be less than long delay!"),this.isMobile=l4()||d4()}get(){return D6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function rb(n,e){ta(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class mC{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ki("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ki("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ki("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const P6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const k6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],M6=new Uh(3e4,6e4);function ia(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ei(n,e,t,s,i={}){return gC(n,i,async()=>{let o={},u={};s&&(e==="GET"?u=s:o={body:JSON.stringify(s)});const h=Vh({key:n.config.apiKey,...u}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...o};return c4()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&vo(n.emulatorConfig.host)&&(p.credentials="include"),mC.fetch()(await yC(n,n.config.apiHost,t,h),p)})}async function gC(n,e,t){n._canInitEmulator=!1;const s={...P6,...e};try{const i=new V6(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const u=await o.json();if("needConfirmation"in u)throw Rp(n,"account-exists-with-different-credential",u);if(o.ok&&!("errorMessage"in u))return u;{const h=o.ok?u.errorMessage:u.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rp(n,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw Rp(n,"email-already-in-use",u);if(f==="USER_DISABLED")throw Rp(n,"user-disabled",u);const g=s[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw pC(n,g,p);Lr(n,g)}}catch(i){if(i instanceof Br)throw i;Lr(n,"network-request-failed",{message:String(i)})}}async function Bh(n,e,t,s,i={}){const o=await Ei(n,e,t,s,i);return"mfaPendingCredential"in o&&Lr(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function yC(n,e,t,s){const i=`${e}${t}?${s}`,o=n,u=o.config.emulator?rb(n.config,i):`${n.config.apiScheme}://${i}`;return k6.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(u).toString():u}function L6(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class V6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(mi(this.auth,"network-request-failed")),M6.get())})}}function Rp(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const i=mi(n,e,s);return i.customData._tokenResponse=t,i}function V1(n){return n!==void 0&&n.enterprise!==void 0}class U6{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return L6(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function B6(n,e){return Ei(n,"GET","/v2/recaptchaConfig",ia(n,e))}async function F6(n,e){return Ei(n,"POST","/v1/accounts:delete",e)}async function bm(n,e){return Ei(n,"POST","/v1/accounts:lookup",e)}function rh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function z6(n,e=!1){const t=Jt(n),s=await t.getIdToken(e),i=ib(s);Oe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,u=o?.sign_in_provider;return{claims:i,token:s,authTime:rh(t0(i.auth_time)),issuedAtTime:rh(t0(i.iat)),expirationTime:rh(t0(i.exp)),signInProvider:u||null,signInSecondFactor:o?.sign_in_second_factor||null}}function t0(n){return Number(n)*1e3}function ib(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return $p("JWT malformed, contained fewer than 3 sections"),null;try{const i=XA(t);return i?JSON.parse(i):($p("Failed to decode base64 JWT payload"),null)}catch(i){return $p("Caught error parsing JWT payload as JSON",i?.toString()),null}}function U1(n){const e=ib(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function iu(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Br&&q6(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function q6({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class H6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class H0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=rh(this.lastLoginAt),this.creationTime=rh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function _m(n){const e=n.auth,t=await n.getIdToken(),s=await iu(n,bm(e,{idToken:t}));Oe(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=i.providerUserInfo?.length?vC(i.providerUserInfo):[],u=$6(n.providerData,o),h=n.isAnonymous,f=!(n.email&&i.passwordHash)&&!u?.length,p=h?f:!1,g={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:u,metadata:new H0(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(n,g)}async function G6(n){const e=Jt(n);await _m(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $6(n,e){return[...n.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function vC(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function K6(n,e){const t=await gC(n,{},async()=>{const s=Vh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,u=await yC(n,i,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:s};return n.emulatorConfig&&vo(n.emulatorConfig.host)&&(f.credentials="include"),mC.fetch()(u,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Q6(n,e){return Ei(n,"POST","/v2/accounts:revokeToken",ia(n,e))}class Zc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):U1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=U1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:i,expiresIn:o}=await K6(e,t);this.updateTokensAndExpiration(s,i,Number(o))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:i,expirationTime:o}=t,u=new Zc;return s&&(Oe(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),i&&(Oe(typeof i=="string","internal-error",{appName:e}),u.accessToken=i),o&&(Oe(typeof o=="number","internal-error",{appName:e}),u.expirationTime=o),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zc,this.toJSON())}_performRefresh(){return Ki("not implemented")}}function qa(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Pr{constructor({uid:e,auth:t,stsTokenManager:s,...i}){this.providerId="firebase",this.proactiveRefresh=new H6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new H0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await iu(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return z6(this,e)}reload(){return G6(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Pr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await _m(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ds(this.auth.app))return Promise.reject(Ji(this.auth));const e=await this.getIdToken();return await iu(this,F6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const s=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,u=t.photoURL??void 0,h=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,g=t.lastLoginAt??void 0,{uid:x,emailVerified:b,isAnonymous:S,providerData:w,stsTokenManager:A}=t;Oe(x&&A,e,"internal-error");const C=Zc.fromJSON(this.name,A);Oe(typeof x=="string",e,"internal-error"),qa(s,e.name),qa(i,e.name),Oe(typeof b=="boolean",e,"internal-error"),Oe(typeof S=="boolean",e,"internal-error"),qa(o,e.name),qa(u,e.name),qa(h,e.name),qa(f,e.name),qa(p,e.name),qa(g,e.name);const L=new Pr({uid:x,auth:e,email:i,emailVerified:b,displayName:s,isAnonymous:S,photoURL:u,phoneNumber:o,tenantId:h,stsTokenManager:C,createdAt:p,lastLoginAt:g});return w&&Array.isArray(w)&&(L.providerData=w.map(z=>({...z}))),f&&(L._redirectEventId=f),L}static async _fromIdTokenResponse(e,t,s=!1){const i=new Zc;i.updateFromServerResponse(t);const o=new Pr({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await _m(o),o}static async _fromGetAccountInfoResponse(e,t,s){const i=t.users[0];Oe(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?vC(i.providerUserInfo):[],u=!(i.email&&i.passwordHash)&&!o?.length,h=new Zc;h.updateFromIdToken(s);const f=new Pr({uid:i.localId,auth:e,stsTokenManager:h,isAnonymous:u}),p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new H0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(f,p),f}}const B1=new Map;function Qi(n){ta(n instanceof Function,"Expected a class definition");let e=B1.get(n);return e?(ta(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,B1.set(n,e),e)}class xC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}xC.type="NONE";const F1=xC;function Kp(n,e,t){return`firebase:${n}:${e}:${t}`}class eu{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:i,name:o}=this.auth;this.fullUserKey=Kp(this.userKey,i.apiKey,o),this.fullPersistenceKey=Kp("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await bm(this.auth,{idToken:e}).catch(()=>{});return t?Pr._fromGetAccountInfoResponse(this.auth,t,e):null}return Pr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new eu(Qi(F1),e,s);const i=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=i[0]||Qi(F1);const u=Kp(s,e.config.apiKey,e.name);let h=null;for(const p of t)try{const g=await p._get(u);if(g){let x;if(typeof g=="string"){const b=await bm(e,{idToken:g}).catch(()=>{});if(!b)break;x=await Pr._fromGetAccountInfoResponse(e,b,g)}else x=Pr._fromJSON(e,g);p!==o&&(h=x),o=p;break}}catch{}const f=i.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new eu(o,e,s):(o=f[0],h&&await o._set(u,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(u)}catch{}})),new eu(o,e,s))}}function z1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TC(e))return"Blackberry";if(AC(e))return"Webos";if(_C(e))return"Safari";if((e.includes("chrome/")||SC(e))&&!e.includes("edge/"))return"Chrome";if(EC(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if(s?.length===2)return s[1]}return"Other"}function bC(n=Pn()){return/firefox\//i.test(n)}function _C(n=Pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function SC(n=Pn()){return/crios\//i.test(n)}function wC(n=Pn()){return/iemobile/i.test(n)}function EC(n=Pn()){return/android/i.test(n)}function TC(n=Pn()){return/blackberry/i.test(n)}function AC(n=Pn()){return/webos/i.test(n)}function ab(n=Pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Y6(n=Pn()){return ab(n)&&!!window.navigator?.standalone}function W6(){return h4()&&document.documentMode===10}function CC(n=Pn()){return ab(n)||EC(n)||AC(n)||TC(n)||/windows phone/i.test(n)||wC(n)}function NC(n,e=[]){let t;switch(n){case"Browser":t=z1(Pn());break;case"Worker":t=`${z1(Pn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xo}/${s}`}class X6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=o=>new Promise((u,h)=>{try{const f=e(o);u(f)}catch(f){h(f)}});s.onAbort=t,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function J6(n,e={}){return Ei(n,"GET","/v2/passwordPolicy",ia(n,e))}const Z6=6;class ek{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Z6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class tk{constructor(e,t,s,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new q1(this),this.idTokenSubscription=new q1(this),this.beforeStateQueue=new X6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Qi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await eu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await bm(this,{idToken:e}),s=await Pr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ds(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let s=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,u=s?._redirectEventId,h=await this.tryRedirectSignIn(e);(!o||o===u)&&h?.user&&(s=h.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await _m(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=O6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ds(this.app))return Promise.reject(Ji(this));const t=e?Jt(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ds(this.app)?Promise.reject(Ji(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ds(this.app)?Promise.reject(Ji(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await J6(this),t=new ek(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Lh("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await Q6(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Qi(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await eu.create(this,[Qi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(h,this,"internal-error"),h.then(()=>{u||o(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,s,i);return()=>{u=!0,f()}}else{const f=e.addObserver(t);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=NC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Ds(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&R6(`Error while retrieving App Check token: ${e.error}`),e?.token}}function bo(n){return Jt(n)}class q1{constructor(e){this.auth=e,this.observer=null,this.addObserver=v4(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let sg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nk(n){sg=n}function IC(n){return sg.loadJS(n)}function sk(){return sg.recaptchaEnterpriseScript}function rk(){return sg.gapiScript}function ik(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class ak{constructor(){this.enterprise=new ok}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class ok{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const lk="recaptcha-enterprise",RC="NO_RECAPTCHA";class ck{constructor(e){this.type=lk,this.auth=bo(e)}async verify(e="verify",t=!1){async function s(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(u,h)=>{B6(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new U6(f);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,u(p.siteKey)}}).catch(f=>{h(f)})})}function i(o,u,h){const f=window.grecaptcha;V1(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(p=>{u(p)}).catch(()=>{u(RC)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ak().execute("siteKey",{action:"verify"}):new Promise((o,u)=>{s(this.auth).then(h=>{if(!t&&V1(window.grecaptcha))i(h,o,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=sk();f.length!==0&&(f+=h),IC(f).then(()=>{i(h,o,u)}).catch(p=>{u(p)})}}).catch(h=>{u(h)})})}}async function H1(n,e,t,s=!1,i=!1){const o=new ck(n);let u;if(i)u=RC;else try{u=await o.verify(t)}catch{u=await o.verify(t,!0)}const h={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return s?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function Sm(n,e,t,s,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await H1(n,e,t,t==="getOobCode");return s(n,o)}else return s(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await H1(n,e,t,t==="getOobCode");return s(n,u)}else return Promise.reject(o)})}function uk(n,e){const t=Cu(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(_i(o,e??{}))return i;Lr(i,"already-initialized")}return t.initialize({options:e})}function dk(n,e){const t=e?.persistence||[],s=(Array.isArray(t)?t:[t]).map(Qi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e?.popupRedirectResolver)}function hk(n,e,t){const s=bo(n);Oe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,o=jC(e),{host:u,port:h}=fk(e),f=h===null?"":`:${h}`,p={url:`${o}//${u}${f}/`},g=Object.freeze({host:u,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!s._canInitEmulator){Oe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Oe(_i(p,s.config.emulator)&&_i(g,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=p,s.emulatorConfig=g,s.settings.appVerificationDisabledForTesting=!0,vo(u)?(tg(`${o}//${u}${f}`),eb("Auth",!0)):pk()}function jC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function fk(n){const e=jC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const o=i[1];return{host:o,port:G1(s.substr(o.length+1))}}else{const[o,u]=s.split(":");return{host:o,port:G1(u)}}}function G1(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function pk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class ob{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ki("not implemented")}_getIdTokenResponse(e){return Ki("not implemented")}_linkToIdToken(e,t){return Ki("not implemented")}_getReauthenticationResolver(e){return Ki("not implemented")}}async function mk(n,e){return Ei(n,"POST","/v1/accounts:update",e)}async function gk(n,e){return Ei(n,"POST","/v1/accounts:signUp",e)}async function yk(n,e){return Bh(n,"POST","/v1/accounts:signInWithPassword",ia(n,e))}async function vk(n,e){return Ei(n,"POST","/v1/accounts:sendOobCode",ia(n,e))}async function xk(n,e){return vk(n,e)}async function bk(n,e){return Bh(n,"POST","/v1/accounts:signInWithEmailLink",ia(n,e))}async function _k(n,e){return Bh(n,"POST","/v1/accounts:signInWithEmailLink",ia(n,e))}class xh extends ob{constructor(e,t,s,i=null){super("password",s),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new xh(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new xh(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sm(e,t,"signInWithPassword",yk);case"emailLink":return bk(e,{email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sm(e,s,"signUpPassword",gk);case"emailLink":return _k(e,{idToken:t,email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function tu(n,e){return Bh(n,"POST","/v1/accounts:signInWithIdp",ia(n,e))}const Sk="http://localhost";class Al extends ob{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Al(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Lr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i,...o}=t;if(!s||!i)return null;const u=new Al(s,i);return u.idToken=o.idToken||void 0,u.accessToken=o.accessToken||void 0,u.secret=o.secret,u.nonce=o.nonce,u.pendingToken=o.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return tu(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,tu(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,tu(e,t)}buildRequest(){const e={requestUri:Sk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vh(t)}return e}}function wk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Ek(n){const e=Kd(Qd(n)).link,t=e?Kd(Qd(e)).deep_link_id:null,s=Kd(Qd(n)).deep_link_id;return(s?Kd(Qd(s)).link:null)||s||t||e||n}class lb{constructor(e){const t=Kd(Qd(e)),s=t.apiKey??null,i=t.oobCode??null,o=wk(t.mode??null);Oe(s&&i&&o,"argument-error"),this.apiKey=s,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Ek(e);try{return new lb(t)}catch{return null}}}class Nu{constructor(){this.providerId=Nu.PROVIDER_ID}static credential(e,t){return xh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=lb.parseLink(t);return Oe(s,"argument-error"),xh._fromEmailAndCode(e,s.code,s.tenantId)}}Nu.PROVIDER_ID="password";Nu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Nu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class DC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Fh extends DC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qa extends Fh{constructor(){super("facebook.com")}static credential(e){return Al._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qa.credentialFromTaggedObject(e)}static credentialFromError(e){return Qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qa.credential(e.oauthAccessToken)}catch{return null}}}Qa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qa.PROVIDER_ID="facebook.com";class Ya extends Fh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Al._fromParams({providerId:Ya.PROVIDER_ID,signInMethod:Ya.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ya.credentialFromTaggedObject(e)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Ya.credential(t,s)}catch{return null}}}Ya.GOOGLE_SIGN_IN_METHOD="google.com";Ya.PROVIDER_ID="google.com";class Wa extends Fh{constructor(){super("github.com")}static credential(e){return Al._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wa.credentialFromTaggedObject(e)}static credentialFromError(e){return Wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wa.credential(e.oauthAccessToken)}catch{return null}}}Wa.GITHUB_SIGN_IN_METHOD="github.com";Wa.PROVIDER_ID="github.com";class Xa extends Fh{constructor(){super("twitter.com")}static credential(e,t){return Al._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xa.credentialFromTaggedObject(e)}static credentialFromError(e){return Xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Xa.credential(t,s)}catch{return null}}}Xa.TWITTER_SIGN_IN_METHOD="twitter.com";Xa.PROVIDER_ID="twitter.com";async function Tk(n,e){return Bh(n,"POST","/v1/accounts:signUp",ia(n,e))}class Cl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,i=!1){const o=await Pr._fromIdTokenResponse(e,s,i),u=$1(s);return new Cl({user:o,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const i=$1(s);return new Cl({user:e,providerId:i,_tokenResponse:s,operationType:t})}}function $1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class wm extends Br{constructor(e,t,s,i){super(t.code,t.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,wm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,i){return new wm(e,t,s,i)}}function OC(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?wm._fromErrorAndOperation(n,o,e,s):o})}async function Ak(n,e,t=!1){const s=await iu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Cl._forOperation(n,"link",s)}async function Ck(n,e,t=!1){const{auth:s}=n;if(Ds(s.app))return Promise.reject(Ji(s));const i="reauthenticate";try{const o=await iu(n,OC(s,i,e,n),t);Oe(o.idToken,s,"internal-error");const u=ib(o.idToken);Oe(u,s,"internal-error");const{sub:h}=u;return Oe(n.uid===h,s,"user-mismatch"),Cl._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Lr(s,"user-mismatch"),o}}async function PC(n,e,t=!1){if(Ds(n.app))return Promise.reject(Ji(n));const s="signIn",i=await OC(n,s,e),o=await Cl._fromIdTokenResponse(n,s,i);return t||await n._updateCurrentUser(o.user),o}async function Nk(n,e){return PC(bo(n),e)}function Ik(n,e,t){Oe(t.url?.length>0,n,"invalid-continue-uri"),Oe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),Oe(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Oe(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Oe(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function kC(n){const e=bo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ih(n,e,t){const s=bo(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Ik(s,i,t),await Sm(s,i,"getOobCode",xk)}async function jp(n,e,t){if(Ds(n.app))return Promise.reject(Ji(n));const s=bo(n),u=await Sm(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Tk).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&kC(n),f}),h=await Cl._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(h.user),h}function MC(n,e,t){return Ds(n.app)?Promise.reject(Ji(n)):Nk(Jt(n),Nu.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&kC(n),s})}function LC(n,e){return Rk(Jt(n),null,e)}async function Rk(n,e,t){const{auth:s}=n,o={idToken:await n.getIdToken(),returnSecureToken:!0};t&&(o.password=t);const u=await iu(n,mk(s,o));await n._updateTokensIfNecessary(u,!0)}function jk(n,e,t,s){return Jt(n).onIdTokenChanged(e,t,s)}function Dk(n,e,t){return Jt(n).beforeAuthStateChanged(e,t)}function Ok(n,e,t,s){return Jt(n).onAuthStateChanged(e,t,s)}function Pk(n){return Jt(n).signOut()}const Em="__sak";class VC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Em,"1"),this.storage.removeItem(Em),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const kk=1e3,Mk=10;class UC extends VC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=CC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),i=this.localCache[t];s!==i&&e(t,i,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,h,f)=>{this.notifyListeners(u,f)});return}const s=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},o=this.storage.getItem(s);W6()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Mk):i()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},kk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}UC.type="LOCAL";const Lk=UC;class BC extends VC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}BC.type="SESSION";const FC=BC;function Vk(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class rg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const s=new rg(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:i,data:o}=t.data,u=this.handlersMap[i];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const h=Array.from(u).map(async p=>p(t.origin,o)),f=await Vk(h);t.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rg.receivers=[];function cb(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}class Uk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,u;return new Promise((h,f)=>{const p=cb("",20);i.port1.start();const g=setTimeout(()=>{f(new Error("unsupported_event"))},s);u={messageChannel:i,onMessage(x){const b=x;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(b.data.response);break;default:clearTimeout(g),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(u),i.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[i.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function gi(){return window}function Bk(n){gi().location.href=n}function zC(){return typeof gi().WorkerGlobalScope<"u"&&typeof gi().importScripts=="function"}async function Fk(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function zk(){return navigator?.serviceWorker?.controller||null}function qk(){return zC()?self:null}const qC="firebaseLocalStorageDb",Hk=1,Tm="firebaseLocalStorage",HC="fbase_key";class zh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ig(n,e){return n.transaction([Tm],e?"readwrite":"readonly").objectStore(Tm)}function Gk(){const n=indexedDB.deleteDatabase(qC);return new zh(n).toPromise()}function G0(){const n=indexedDB.open(qC,Hk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Tm,{keyPath:HC})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Tm)?e(s):(s.close(),await Gk(),e(await G0()))})})}async function K1(n,e,t){const s=ig(n,!0).put({[HC]:e,value:t});return new zh(s).toPromise()}async function $k(n,e){const t=ig(n,!1).get(e),s=await new zh(t).toPromise();return s===void 0?null:s.value}function Q1(n,e){const t=ig(n,!0).delete(e);return new zh(t).toPromise()}const Kk=800,Qk=3;class GC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await G0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Qk)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rg._getInstance(qk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Fk(),!this.activeServiceWorker)return;this.sender=new Uk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||zk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await G0();return await K1(e,Em,"1"),await Q1(e,Em),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>K1(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>$k(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Q1(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=ig(i,!1).getAll();return new zh(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Kk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}GC.type="LOCAL";const Yk=GC;new Uh(3e4,6e4);function Wk(n,e){return e?Qi(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ub extends ob{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return tu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return tu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Xk(n){return PC(n.auth,new ub(n),n.bypassAuthState)}function Jk(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),Ck(t,new ub(n),n.bypassAuthState)}async function Zk(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),Ak(t,new ub(n),n.bypassAuthState)}class $C{constructor(e,t,s,i,o=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:i,tenantId:o,error:u,type:h}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:t,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xk;case"linkViaPopup":case"linkViaRedirect":return Zk;case"reauthViaPopup":case"reauthViaRedirect":return Jk;default:Lr(this.auth,"internal-error")}}resolve(e){ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const eM=new Uh(2e3,1e4);class Qc extends $C{constructor(e,t,s,i,o){super(e,t,i,o),this.provider=s,this.authWindow=null,this.pollId=null,Qc.currentPopupAction&&Qc.currentPopupAction.cancel(),Qc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){ta(this.filter.length===1,"Popup operations only handle one event");const e=cb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eM.get())};e()}}Qc.currentPopupAction=null;const tM="pendingRedirect",Qp=new Map;class nM extends $C{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Qp.get(this.auth._key());if(!e){try{const s=await sM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Qp.set(this.auth._key(),e)}return this.bypassAuthState||Qp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sM(n,e){const t=aM(e),s=iM(n);if(!await s._isAvailable())return!1;const i=await s._get(t)==="true";return await s._remove(t),i}function rM(n,e){Qp.set(n._key(),e)}function iM(n){return Qi(n._redirectPersistence)}function aM(n){return Kp(tM,n.config.apiKey,n.name)}async function oM(n,e,t=!1){if(Ds(n.app))return Promise.reject(Ji(n));const s=bo(n),i=Wk(s,e),u=await new nM(s,i,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}const lM=600*1e3;class cM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uM(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!KC(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";t.onError(mi(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lM&&this.cachedEventUids.clear(),this.cachedEventUids.has(Y1(e))}saveEventToCache(e){this.cachedEventUids.add(Y1(e)),this.lastProcessedEventTime=Date.now()}}function Y1(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function KC({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function uM(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return KC(n);default:return!1}}async function dM(n,e={}){return Ei(n,"GET","/v1/projects",e)}const hM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fM=/^https?/;async function pM(n){if(n.config.emulator)return;const{authorizedDomains:e}=await dM(n);for(const t of e)try{if(mM(t))return}catch{}Lr(n,"unauthorized-domain")}function mM(n){const e=q0(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!fM.test(t))return!1;if(hM.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}const gM=new Uh(3e4,6e4);function W1(){const n=gi().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function yM(n){return new Promise((e,t)=>{function s(){W1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{W1(),t(mi(n,"network-request-failed"))},timeout:gM.get()})}if(gi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(gi().gapi?.load)s();else{const i=ik("iframefcb");return gi()[i]=()=>{gapi.load?s():t(mi(n,"network-request-failed"))},IC(`${rk()}?onload=${i}`).catch(o=>t(o))}}).catch(e=>{throw Yp=null,e})}let Yp=null;function vM(n){return Yp=Yp||yM(n),Yp}const xM=new Uh(5e3,15e3),bM="__/auth/iframe",_M="emulator/auth/iframe",SM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function EM(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?rb(e,_M):`https://${n.config.authDomain}/${bM}`,s={apiKey:e.apiKey,appName:n.name,v:xo},i=wM.get(n.config.apiHost);i&&(s.eid=i);const o=n._getFrameworks();return o.length&&(s.fw=o.join(",")),`${t}?${Vh(s).slice(1)}`}async function TM(n){const e=await vM(n),t=gi().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:EM(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SM,dontclear:!0},s=>new Promise(async(i,o)=>{await s.restyle({setHideOnLeave:!1});const u=mi(n,"network-request-failed"),h=gi().setTimeout(()=>{o(u)},xM.get());function f(){gi().clearTimeout(h),i(s)}s.ping(f).then(f,()=>{o(u)})}))}const AM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CM=500,NM=600,IM="_blank",RM="http://localhost";class X1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function jM(n,e,t,s=CM,i=NM){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let h="";const f={...AM,width:s.toString(),height:i.toString(),top:o,left:u},p=Pn().toLowerCase();t&&(h=SC(p)?IM:t),bC(p)&&(e=e||RM,f.scrollbars="yes");const g=Object.entries(f).reduce((b,[S,w])=>`${b}${S}=${w},`,"");if(Y6(p)&&h!=="_self")return DM(e||"",h),new X1(null);const x=window.open(e||"",h,g);Oe(x,n,"popup-blocked");try{x.focus()}catch{}return new X1(x)}function DM(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}const OM="__/auth/handler",PM="emulator/auth/handler",kM=encodeURIComponent("fac");async function J1(n,e,t,s,i,o){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:xo,eventId:i};if(e instanceof DC){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",y4(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,x]of Object.entries({}))u[g]=x}if(e instanceof Fh){const g=e.getScopes().filter(x=>x!=="");g.length>0&&(u.scopes=g.join(","))}n.tenantId&&(u.tid=n.tenantId);const h=u;for(const g of Object.keys(h))h[g]===void 0&&delete h[g];const f=await n._getAppCheckToken(),p=f?`#${kM}=${encodeURIComponent(f)}`:"";return`${MM(n)}?${Vh(h).slice(1)}${p}`}function MM({config:n}){return n.emulator?rb(n,PM):`https://${n.authDomain}/${OM}`}const n0="webStorageSupport";class LM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=FC,this._completeRedirectFn=oM,this._overrideRedirectResult=rM}async _openPopup(e,t,s,i){ta(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await J1(e,t,s,q0(),i);return jM(e,o,cb())}async _openRedirect(e,t,s,i){await this._originValidation(e);const o=await J1(e,t,s,q0(),i);return Bk(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(ta(o,"If manager is not set, promise should be"),o)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await TM(e),s=new cM(e);return t.register("authEvent",i=>(Oe(i?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(n0,{type:n0},i=>{const o=i?.[0]?.[n0];o!==void 0&&t(!!o),Lr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pM(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return CC()||_C()||ab()}}const VM=LM;var Z1="@firebase/auth",eT="1.11.1";class UM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function BM(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FM(n){ho(new uo("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=s.options;Oe(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const f={apiKey:u,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NC(n)},p=new tk(s,i,o,f);return dk(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),ho(new uo("auth-internal",e=>{const t=bo(e.getProvider("auth").getImmediate());return(s=>new UM(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mr(Z1,eT,BM(n)),Mr(Z1,eT,"esm2020")}const zM=300,qM=nC("authIdTokenMaxAge")||zM;let tT=null;const HM=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>qM)return;const i=t?.token;tT!==i&&(tT=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function fl(n=ng()){const e=Cu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=uk(n,{popupRedirectResolver:VM,persistence:[Yk,Lk,FC]}),s=nC("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(s,location.origin);if(location.origin===o.origin){const u=HM(o.toString());Dk(t,u,()=>u(t.currentUser)),jk(t,h=>u(h))}}const i=ZA("auth");return i&&hk(t,`http://${i}`),t}function GM(){return document.getElementsByTagName("head")?.[0]??document}nk({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=i=>{const o=mi("internal-error");o.customData=i,t(o)},s.type="text/javascript",s.charset="UTF-8",GM().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FM("Browser");var $M="firebase",KM="12.6.0";Mr($M,KM,"app");const Yd=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Br,SDK_VERSION:xo,_DEFAULT_ENTRY_NAME:gm,_addComponent:z0,_apps:Tl,_components:vm,_getProvider:Cu,_isFirebaseServerApp:Ds,_registerComponent:ho,_serverApps:ym,deleteApp:v6,getApp:ng,initializeApp:eo,registerVersion:Mr},Symbol.toStringTag,{value:"Module"}));var nT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ao,QC;(function(){var n;function e(j,N){function R(){}R.prototype=N.prototype,j.F=N.prototype,j.prototype=new R,j.prototype.constructor=j,j.D=function(O,V,B){for(var k=Array(arguments.length-2),fe=2;fe<arguments.length;fe++)k[fe-2]=arguments[fe];return N.prototype[V].apply(O,k)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,t),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(j,N,R){R||(R=0);const O=Array(16);if(typeof N=="string")for(var V=0;V<16;++V)O[V]=N.charCodeAt(R++)|N.charCodeAt(R++)<<8|N.charCodeAt(R++)<<16|N.charCodeAt(R++)<<24;else for(V=0;V<16;++V)O[V]=N[R++]|N[R++]<<8|N[R++]<<16|N[R++]<<24;N=j.g[0],R=j.g[1],V=j.g[2];let B=j.g[3],k;k=N+(B^R&(V^B))+O[0]+3614090360&4294967295,N=R+(k<<7&4294967295|k>>>25),k=B+(V^N&(R^V))+O[1]+3905402710&4294967295,B=N+(k<<12&4294967295|k>>>20),k=V+(R^B&(N^R))+O[2]+606105819&4294967295,V=B+(k<<17&4294967295|k>>>15),k=R+(N^V&(B^N))+O[3]+3250441966&4294967295,R=V+(k<<22&4294967295|k>>>10),k=N+(B^R&(V^B))+O[4]+4118548399&4294967295,N=R+(k<<7&4294967295|k>>>25),k=B+(V^N&(R^V))+O[5]+1200080426&4294967295,B=N+(k<<12&4294967295|k>>>20),k=V+(R^B&(N^R))+O[6]+2821735955&4294967295,V=B+(k<<17&4294967295|k>>>15),k=R+(N^V&(B^N))+O[7]+4249261313&4294967295,R=V+(k<<22&4294967295|k>>>10),k=N+(B^R&(V^B))+O[8]+1770035416&4294967295,N=R+(k<<7&4294967295|k>>>25),k=B+(V^N&(R^V))+O[9]+2336552879&4294967295,B=N+(k<<12&4294967295|k>>>20),k=V+(R^B&(N^R))+O[10]+4294925233&4294967295,V=B+(k<<17&4294967295|k>>>15),k=R+(N^V&(B^N))+O[11]+2304563134&4294967295,R=V+(k<<22&4294967295|k>>>10),k=N+(B^R&(V^B))+O[12]+1804603682&4294967295,N=R+(k<<7&4294967295|k>>>25),k=B+(V^N&(R^V))+O[13]+4254626195&4294967295,B=N+(k<<12&4294967295|k>>>20),k=V+(R^B&(N^R))+O[14]+2792965006&4294967295,V=B+(k<<17&4294967295|k>>>15),k=R+(N^V&(B^N))+O[15]+1236535329&4294967295,R=V+(k<<22&4294967295|k>>>10),k=N+(V^B&(R^V))+O[1]+4129170786&4294967295,N=R+(k<<5&4294967295|k>>>27),k=B+(R^V&(N^R))+O[6]+3225465664&4294967295,B=N+(k<<9&4294967295|k>>>23),k=V+(N^R&(B^N))+O[11]+643717713&4294967295,V=B+(k<<14&4294967295|k>>>18),k=R+(B^N&(V^B))+O[0]+3921069994&4294967295,R=V+(k<<20&4294967295|k>>>12),k=N+(V^B&(R^V))+O[5]+3593408605&4294967295,N=R+(k<<5&4294967295|k>>>27),k=B+(R^V&(N^R))+O[10]+38016083&4294967295,B=N+(k<<9&4294967295|k>>>23),k=V+(N^R&(B^N))+O[15]+3634488961&4294967295,V=B+(k<<14&4294967295|k>>>18),k=R+(B^N&(V^B))+O[4]+3889429448&4294967295,R=V+(k<<20&4294967295|k>>>12),k=N+(V^B&(R^V))+O[9]+568446438&4294967295,N=R+(k<<5&4294967295|k>>>27),k=B+(R^V&(N^R))+O[14]+3275163606&4294967295,B=N+(k<<9&4294967295|k>>>23),k=V+(N^R&(B^N))+O[3]+4107603335&4294967295,V=B+(k<<14&4294967295|k>>>18),k=R+(B^N&(V^B))+O[8]+1163531501&4294967295,R=V+(k<<20&4294967295|k>>>12),k=N+(V^B&(R^V))+O[13]+2850285829&4294967295,N=R+(k<<5&4294967295|k>>>27),k=B+(R^V&(N^R))+O[2]+4243563512&4294967295,B=N+(k<<9&4294967295|k>>>23),k=V+(N^R&(B^N))+O[7]+1735328473&4294967295,V=B+(k<<14&4294967295|k>>>18),k=R+(B^N&(V^B))+O[12]+2368359562&4294967295,R=V+(k<<20&4294967295|k>>>12),k=N+(R^V^B)+O[5]+4294588738&4294967295,N=R+(k<<4&4294967295|k>>>28),k=B+(N^R^V)+O[8]+2272392833&4294967295,B=N+(k<<11&4294967295|k>>>21),k=V+(B^N^R)+O[11]+1839030562&4294967295,V=B+(k<<16&4294967295|k>>>16),k=R+(V^B^N)+O[14]+4259657740&4294967295,R=V+(k<<23&4294967295|k>>>9),k=N+(R^V^B)+O[1]+2763975236&4294967295,N=R+(k<<4&4294967295|k>>>28),k=B+(N^R^V)+O[4]+1272893353&4294967295,B=N+(k<<11&4294967295|k>>>21),k=V+(B^N^R)+O[7]+4139469664&4294967295,V=B+(k<<16&4294967295|k>>>16),k=R+(V^B^N)+O[10]+3200236656&4294967295,R=V+(k<<23&4294967295|k>>>9),k=N+(R^V^B)+O[13]+681279174&4294967295,N=R+(k<<4&4294967295|k>>>28),k=B+(N^R^V)+O[0]+3936430074&4294967295,B=N+(k<<11&4294967295|k>>>21),k=V+(B^N^R)+O[3]+3572445317&4294967295,V=B+(k<<16&4294967295|k>>>16),k=R+(V^B^N)+O[6]+76029189&4294967295,R=V+(k<<23&4294967295|k>>>9),k=N+(R^V^B)+O[9]+3654602809&4294967295,N=R+(k<<4&4294967295|k>>>28),k=B+(N^R^V)+O[12]+3873151461&4294967295,B=N+(k<<11&4294967295|k>>>21),k=V+(B^N^R)+O[15]+530742520&4294967295,V=B+(k<<16&4294967295|k>>>16),k=R+(V^B^N)+O[2]+3299628645&4294967295,R=V+(k<<23&4294967295|k>>>9),k=N+(V^(R|~B))+O[0]+4096336452&4294967295,N=R+(k<<6&4294967295|k>>>26),k=B+(R^(N|~V))+O[7]+1126891415&4294967295,B=N+(k<<10&4294967295|k>>>22),k=V+(N^(B|~R))+O[14]+2878612391&4294967295,V=B+(k<<15&4294967295|k>>>17),k=R+(B^(V|~N))+O[5]+4237533241&4294967295,R=V+(k<<21&4294967295|k>>>11),k=N+(V^(R|~B))+O[12]+1700485571&4294967295,N=R+(k<<6&4294967295|k>>>26),k=B+(R^(N|~V))+O[3]+2399980690&4294967295,B=N+(k<<10&4294967295|k>>>22),k=V+(N^(B|~R))+O[10]+4293915773&4294967295,V=B+(k<<15&4294967295|k>>>17),k=R+(B^(V|~N))+O[1]+2240044497&4294967295,R=V+(k<<21&4294967295|k>>>11),k=N+(V^(R|~B))+O[8]+1873313359&4294967295,N=R+(k<<6&4294967295|k>>>26),k=B+(R^(N|~V))+O[15]+4264355552&4294967295,B=N+(k<<10&4294967295|k>>>22),k=V+(N^(B|~R))+O[6]+2734768916&4294967295,V=B+(k<<15&4294967295|k>>>17),k=R+(B^(V|~N))+O[13]+1309151649&4294967295,R=V+(k<<21&4294967295|k>>>11),k=N+(V^(R|~B))+O[4]+4149444226&4294967295,N=R+(k<<6&4294967295|k>>>26),k=B+(R^(N|~V))+O[11]+3174756917&4294967295,B=N+(k<<10&4294967295|k>>>22),k=V+(N^(B|~R))+O[2]+718787259&4294967295,V=B+(k<<15&4294967295|k>>>17),k=R+(B^(V|~N))+O[9]+3951481745&4294967295,j.g[0]=j.g[0]+N&4294967295,j.g[1]=j.g[1]+(V+(k<<21&4294967295|k>>>11))&4294967295,j.g[2]=j.g[2]+V&4294967295,j.g[3]=j.g[3]+B&4294967295}s.prototype.v=function(j,N){N===void 0&&(N=j.length);const R=N-this.blockSize,O=this.C;let V=this.h,B=0;for(;B<N;){if(V==0)for(;B<=R;)i(this,j,B),B+=this.blockSize;if(typeof j=="string"){for(;B<N;)if(O[V++]=j.charCodeAt(B++),V==this.blockSize){i(this,O),V=0;break}}else for(;B<N;)if(O[V++]=j[B++],V==this.blockSize){i(this,O),V=0;break}}this.h=V,this.o+=N},s.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var N=1;N<j.length-8;++N)j[N]=0;N=this.o*8;for(var R=j.length-8;R<j.length;++R)j[R]=N&255,N/=256;for(this.v(j),j=Array(16),N=0,R=0;R<4;++R)for(let O=0;O<32;O+=8)j[N++]=this.g[R]>>>O&255;return j};function o(j,N){var R=h;return Object.prototype.hasOwnProperty.call(R,j)?R[j]:R[j]=N(j)}function u(j,N){this.h=N;const R=[];let O=!0;for(let V=j.length-1;V>=0;V--){const B=j[V]|0;O&&B==N||(R[V]=B,O=!1)}this.g=R}var h={};function f(j){return-128<=j&&j<128?o(j,function(N){return new u([N|0],N<0?-1:0)}):new u([j|0],j<0?-1:0)}function p(j){if(isNaN(j)||!isFinite(j))return x;if(j<0)return C(p(-j));const N=[];let R=1;for(let O=0;j>=R;O++)N[O]=j/R|0,R*=4294967296;return new u(N,0)}function g(j,N){if(j.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(j.charAt(0)=="-")return C(g(j.substring(1),N));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=p(Math.pow(N,8));let O=x;for(let B=0;B<j.length;B+=8){var V=Math.min(8,j.length-B);const k=parseInt(j.substring(B,B+V),N);V<8?(V=p(Math.pow(N,V)),O=O.j(V).add(p(k))):(O=O.j(R),O=O.add(p(k)))}return O}var x=f(0),b=f(1),S=f(16777216);n=u.prototype,n.m=function(){if(A(this))return-C(this).m();let j=0,N=1;for(let R=0;R<this.g.length;R++){const O=this.i(R);j+=(O>=0?O:4294967296+O)*N,N*=4294967296}return j},n.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(w(this))return"0";if(A(this))return"-"+C(this).toString(j);const N=p(Math.pow(j,6));var R=this;let O="";for(;;){const V=F(R,N).g;R=L(R,V.j(N));let B=((R.g.length>0?R.g[0]:R.h)>>>0).toString(j);if(R=V,w(R))return B+O;for(;B.length<6;)B="0"+B;O=B+O}},n.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function w(j){if(j.h!=0)return!1;for(let N=0;N<j.g.length;N++)if(j.g[N]!=0)return!1;return!0}function A(j){return j.h==-1}n.l=function(j){return j=L(this,j),A(j)?-1:w(j)?0:1};function C(j){const N=j.g.length,R=[];for(let O=0;O<N;O++)R[O]=~j.g[O];return new u(R,~j.h).add(b)}n.abs=function(){return A(this)?C(this):this},n.add=function(j){const N=Math.max(this.g.length,j.g.length),R=[];let O=0;for(let V=0;V<=N;V++){let B=O+(this.i(V)&65535)+(j.i(V)&65535),k=(B>>>16)+(this.i(V)>>>16)+(j.i(V)>>>16);O=k>>>16,B&=65535,k&=65535,R[V]=k<<16|B}return new u(R,R[R.length-1]&-2147483648?-1:0)};function L(j,N){return j.add(C(N))}n.j=function(j){if(w(this)||w(j))return x;if(A(this))return A(j)?C(this).j(C(j)):C(C(this).j(j));if(A(j))return C(this.j(C(j)));if(this.l(S)<0&&j.l(S)<0)return p(this.m()*j.m());const N=this.g.length+j.g.length,R=[];for(var O=0;O<2*N;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(let V=0;V<j.g.length;V++){const B=this.i(O)>>>16,k=this.i(O)&65535,fe=j.i(V)>>>16,me=j.i(V)&65535;R[2*O+2*V]+=k*me,z(R,2*O+2*V),R[2*O+2*V+1]+=B*me,z(R,2*O+2*V+1),R[2*O+2*V+1]+=k*fe,z(R,2*O+2*V+1),R[2*O+2*V+2]+=B*fe,z(R,2*O+2*V+2)}for(j=0;j<N;j++)R[j]=R[2*j+1]<<16|R[2*j];for(j=N;j<2*N;j++)R[j]=0;return new u(R,0)};function z(j,N){for(;(j[N]&65535)!=j[N];)j[N+1]+=j[N]>>>16,j[N]&=65535,N++}function U(j,N){this.g=j,this.h=N}function F(j,N){if(w(N))throw Error("division by zero");if(w(j))return new U(x,x);if(A(j))return N=F(C(j),N),new U(C(N.g),C(N.h));if(A(N))return N=F(j,C(N)),new U(C(N.g),N.h);if(j.g.length>30){if(A(j)||A(N))throw Error("slowDivide_ only works with positive integers.");for(var R=b,O=N;O.l(j)<=0;)R=K(R),O=K(O);var V=Z(R,1),B=Z(O,1);for(O=Z(O,2),R=Z(R,2);!w(O);){var k=B.add(O);k.l(j)<=0&&(V=V.add(R),B=k),O=Z(O,1),R=Z(R,1)}return N=L(j,V.j(N)),new U(V,N)}for(V=x;j.l(N)>=0;){for(R=Math.max(1,Math.floor(j.m()/N.m())),O=Math.ceil(Math.log(R)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),B=p(R),k=B.j(N);A(k)||k.l(j)>0;)R-=O,B=p(R),k=B.j(N);w(B)&&(B=b),V=V.add(B),j=L(j,k)}return new U(V,j)}n.B=function(j){return F(this,j).h},n.and=function(j){const N=Math.max(this.g.length,j.g.length),R=[];for(let O=0;O<N;O++)R[O]=this.i(O)&j.i(O);return new u(R,this.h&j.h)},n.or=function(j){const N=Math.max(this.g.length,j.g.length),R=[];for(let O=0;O<N;O++)R[O]=this.i(O)|j.i(O);return new u(R,this.h|j.h)},n.xor=function(j){const N=Math.max(this.g.length,j.g.length),R=[];for(let O=0;O<N;O++)R[O]=this.i(O)^j.i(O);return new u(R,this.h^j.h)};function K(j){const N=j.g.length+1,R=[];for(let O=0;O<N;O++)R[O]=j.i(O)<<1|j.i(O-1)>>>31;return new u(R,j.h)}function Z(j,N){const R=N>>5;N%=32;const O=j.g.length-R,V=[];for(let B=0;B<O;B++)V[B]=N>0?j.i(B+R)>>>N|j.i(B+R+1)<<32-N:j.i(B+R);return new u(V,j.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,QC=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=g,ao=u}).apply(typeof nT<"u"?nT:typeof self<"u"?self:typeof window<"u"?window:{});var Dp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var YC,Wd,WC,Wp,$0,XC,JC,ZC;(function(){var n,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dp=="object"&&Dp];for(var _=0;_<m.length;++_){var T=m[_];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var s=t(this);function i(m,_){if(_)e:{var T=s;m=m.split(".");for(var P=0;P<m.length-1;P++){var J=m[P];if(!(J in T))break e;T=T[J]}m=m[m.length-1],P=T[m],_=_(P),_!=P&&_!=null&&e(T,m,{configurable:!0,writable:!0,value:_})}}i("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(m){return m||function(_){var T=[],P;for(P in _)Object.prototype.hasOwnProperty.call(_,P)&&T.push([P,_[P]]);return T}});var o=o||{},u=this||self;function h(m){var _=typeof m;return _=="object"&&m!=null||_=="function"}function f(m,_,T){return m.call.apply(m.bind,arguments)}function p(m,_,T){return p=f,p.apply(null,arguments)}function g(m,_){var T=Array.prototype.slice.call(arguments,1);return function(){var P=T.slice();return P.push.apply(P,arguments),m.apply(this,P)}}function x(m,_){function T(){}T.prototype=_.prototype,m.Z=_.prototype,m.prototype=new T,m.prototype.constructor=m,m.Ob=function(P,J,re){for(var xe=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)xe[Be-2]=arguments[Be];return _.prototype[J].apply(P,xe)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function S(m){const _=m.length;if(_>0){const T=Array(_);for(let P=0;P<_;P++)T[P]=m[P];return T}return[]}function w(m,_){for(let P=1;P<arguments.length;P++){const J=arguments[P];var T=typeof J;if(T=T!="object"?T:J?Array.isArray(J)?"array":T:"null",T=="array"||T=="object"&&typeof J.length=="number"){T=m.length||0;const re=J.length||0;m.length=T+re;for(let xe=0;xe<re;xe++)m[T+xe]=J[xe]}else m.push(J)}}class A{constructor(_,T){this.i=_,this.j=T,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function C(m){u.setTimeout(()=>{throw m},0)}function L(){var m=j;let _=null;return m.g&&(_=m.g,m.g=m.g.next,m.g||(m.h=null),_.next=null),_}class z{constructor(){this.h=this.g=null}add(_,T){const P=U.get();P.set(_,T),this.h?this.h.next=P:this.g=P,this.h=P}}var U=new A(()=>new F,m=>m.reset());class F{constructor(){this.next=this.g=this.h=null}set(_,T){this.h=_,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let K,Z=!1,j=new z,N=()=>{const m=Promise.resolve(void 0);K=()=>{m.then(R)}};function R(){for(var m;m=L();){try{m.h.call(m.g)}catch(T){C(T)}var _=U;_.j(m),_.h<100&&(_.h++,m.next=_.g,_.g=m)}Z=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(m,_){this.type=m,this.g=this.target=_,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var m=!1,_=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const T=()=>{};u.addEventListener("test",T,_),u.removeEventListener("test",T,_)}catch{}return m})();function k(m){return/^[\s\xa0]*$/.test(m)}function fe(m,_){V.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,_)}x(fe,V),fe.prototype.init=function(m,_){const T=this.type=m.type,P=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=_,_=m.relatedTarget,_||(T=="mouseover"?_=m.fromElement:T=="mouseout"&&(_=m.toElement)),this.relatedTarget=_,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&fe.Z.h.call(this)},fe.prototype.h=function(){fe.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),G=0;function ne(m,_,T,P,J){this.listener=m,this.proxy=null,this.src=_,this.type=T,this.capture=!!P,this.ha=J,this.key=++G,this.da=this.fa=!1}function Y(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ge(m,_,T){for(const P in m)_.call(T,m[P],P,m)}function le(m,_){for(const T in m)_.call(void 0,m[T],T,m)}function M(m){const _={};for(const T in m)_[T]=m[T];return _}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function H(m,_){let T,P;for(let J=1;J<arguments.length;J++){P=arguments[J];for(T in P)m[T]=P[T];for(let re=0;re<W.length;re++)T=W[re],Object.prototype.hasOwnProperty.call(P,T)&&(m[T]=P[T])}}function ce(m){this.src=m,this.g={},this.h=0}ce.prototype.add=function(m,_,T,P,J){const re=m.toString();m=this.g[re],m||(m=this.g[re]=[],this.h++);const xe=we(m,_,P,J);return xe>-1?(_=m[xe],T||(_.fa=!1)):(_=new ne(_,this.src,re,!!P,J),_.fa=T,m.push(_)),_};function de(m,_){const T=_.type;if(T in m.g){var P=m.g[T],J=Array.prototype.indexOf.call(P,_,void 0),re;(re=J>=0)&&Array.prototype.splice.call(P,J,1),re&&(Y(_),m.g[T].length==0&&(delete m.g[T],m.h--))}}function we(m,_,T,P){for(let J=0;J<m.length;++J){const re=m[J];if(!re.da&&re.listener==_&&re.capture==!!T&&re.ha==P)return J}return-1}var Pe="closure_lm_"+(Math.random()*1e6|0),tt={};function He(m,_,T,P,J){if(Array.isArray(_)){for(let re=0;re<_.length;re++)He(m,_[re],T,P,J);return null}return T=zr(T),m&&m[me]?m.J(_,T,h(P)?!!P.capture:!1,J):Rn(m,_,T,!1,P,J)}function Rn(m,_,T,P,J,re){if(!_)throw Error("Invalid event type");const xe=h(J)?!!J.capture:!!J;let Be=Zt(m);if(Be||(m[Pe]=Be=new ce(m)),T=Be.add(_,T,P,xe,re),T.proxy)return T;if(P=us(),T.proxy=P,P.src=m,P.listener=T,m.addEventListener)B||(J=xe),J===void 0&&(J=!1),m.addEventListener(_.toString(),P,J);else if(m.attachEvent)m.attachEvent(ot(_.toString()),P);else if(m.addListener&&m.removeListener)m.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return T}function us(){function m(T){return _.call(m.src,m.listener,T)}const _=vs;return m}function ys(m,_,T,P,J){if(Array.isArray(_))for(var re=0;re<_.length;re++)ys(m,_[re],T,P,J);else P=h(P)?!!P.capture:!!P,T=zr(T),m&&m[me]?(m=m.i,re=String(_).toString(),re in m.g&&(_=m.g[re],T=we(_,T,P,J),T>-1&&(Y(_[T]),Array.prototype.splice.call(_,T,1),_.length==0&&(delete m.g[re],m.h--)))):m&&(m=Zt(m))&&(_=m.g[_.toString()],m=-1,_&&(m=we(_,T,P,J)),(T=m>-1?_[m]:null)&&rr(T))}function rr(m){if(typeof m!="number"&&m&&!m.da){var _=m.src;if(_&&_[me])de(_.i,m);else{var T=m.type,P=m.proxy;_.removeEventListener?_.removeEventListener(T,P,m.capture):_.detachEvent?_.detachEvent(ot(T),P):_.addListener&&_.removeListener&&_.removeListener(P),(T=Zt(_))?(de(T,m),T.h==0&&(T.src=null,_[Pe]=null)):Y(m)}}}function ot(m){return m in tt?tt[m]:tt[m]="on"+m}function vs(m,_){if(m.da)m=!0;else{_=new fe(_,this);const T=m.listener,P=m.ha||m.src;m.fa&&rr(m),m=T.call(P,_)}return m}function Zt(m){return m=m[Pe],m instanceof ce?m:null}var ir="__closure_events_fn_"+(Math.random()*1e9>>>0);function zr(m){return typeof m=="function"?m:(m[ir]||(m[ir]=function(_){return m.handleEvent(_)}),m[ir])}function Pt(){O.call(this),this.i=new ce(this),this.M=this,this.G=null}x(Pt,O),Pt.prototype[me]=!0,Pt.prototype.removeEventListener=function(m,_,T,P){ys(this,m,_,T,P)};function Kt(m,_){var T,P=m.G;if(P)for(T=[];P;P=P.G)T.push(P);if(m=m.M,P=_.type||_,typeof _=="string")_=new V(_,m);else if(_ instanceof V)_.target=_.target||m;else{var J=_;_=new V(P,m),H(_,J)}J=!0;let re,xe;if(T)for(xe=T.length-1;xe>=0;xe--)re=_.g=T[xe],J=xs(re,P,!0,_)&&J;if(re=_.g=m,J=xs(re,P,!0,_)&&J,J=xs(re,P,!1,_)&&J,T)for(xe=0;xe<T.length;xe++)re=_.g=T[xe],J=xs(re,P,!1,_)&&J}Pt.prototype.N=function(){if(Pt.Z.N.call(this),this.i){var m=this.i;for(const _ in m.g){const T=m.g[_];for(let P=0;P<T.length;P++)Y(T[P]);delete m.g[_],m.h--}}this.G=null},Pt.prototype.J=function(m,_,T,P){return this.i.add(String(m),_,!1,T,P)},Pt.prototype.K=function(m,_,T,P){return this.i.add(String(m),_,!0,T,P)};function xs(m,_,T,P){if(_=m.i.g[String(_)],!_)return!0;_=_.concat();let J=!0;for(let re=0;re<_.length;++re){const xe=_[re];if(xe&&!xe.da&&xe.capture==T){const Be=xe.listener,cn=xe.ha||xe.src;xe.fa&&de(m.i,xe),J=Be.call(cn,P)!==!1&&J}}return J&&!P.defaultPrevented}function Se(m,_){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:u.setTimeout(m,_||0)}function It(m){m.g=Se(()=>{m.g=null,m.i&&(m.i=!1,It(m))},m.l);const _=m.h;m.h=null,m.m.apply(null,_)}class Bt extends O{constructor(_,T){super(),this.m=_,this.l=T,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:It(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ln(m){O.call(this),this.h=m,this.g={}}x(Ln,O);var Vs=[];function bs(m){ge(m.g,function(_,T){this.g.hasOwnProperty(T)&&rr(_)},m),m.g={}}Ln.prototype.N=function(){Ln.Z.N.call(this),bs(this)},Ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Us=u.JSON.stringify,_s=u.JSON.parse,Io=class{stringify(m){return u.JSON.stringify(m,void 0)}parse(m){return u.JSON.parse(m,void 0)}};function Ro(){}function Kl(){}var Jn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function vn(){V.call(this,"d")}x(vn,V);function Ss(){V.call(this,"c")}x(Ss,V);var Ft={},jo=null;function qr(){return jo=jo||new Pt}Ft.Ia="serverreachability";function Ql(m){V.call(this,Ft.Ia,m)}x(Ql,V);function Bs(m){const _=qr();Kt(_,new Ql(_))}Ft.STAT_EVENT="statevent";function Ai(m,_){V.call(this,Ft.STAT_EVENT,m),this.stat=_}x(Ai,V);function Qt(m){const _=qr();Kt(_,new Ai(_,m))}Ft.Ja="timingevent";function kt(m,_){V.call(this,Ft.Ja,m),this.size=_}x(kt,V);function Mt(m,_){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){m()},_)}function Zn(){this.g=!0}Zn.prototype.ua=function(){this.g=!1};function Rt(m,_,T,P,J,re){m.info(function(){if(m.g)if(re){var xe="",Be=re.split("&");for(let ht=0;ht<Be.length;ht++){var cn=Be[ht].split("=");if(cn.length>1){const zt=cn[0];cn=cn[1];const dr=zt.split("_");xe=dr.length>=2&&dr[1]=="type"?xe+(zt+"="+cn+"&"):xe+(zt+"=redacted&")}}}else xe=null;else xe=re;return"XMLHTTP REQ ("+P+") [attempt "+J+"]: "+_+`
`+T+`
`+xe})}function ds(m,_,T,P,J,re,xe){m.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+J+"]: "+_+`
`+T+`
`+re+" "+xe})}function ar(m,_,T,P){m.info(function(){return"XMLHTTP TEXT ("+_+"): "+Yl(m,T)+(P?" "+P:"")})}function wr(m,_){m.info(function(){return"TIMEOUT: "+_})}Zn.prototype.info=function(){};function Yl(m,_){if(!m.g)return _;if(!_)return null;try{const re=JSON.parse(_);if(re){for(m=0;m<re.length;m++)if(Array.isArray(re[m])){var T=re[m];if(!(T.length<2)){var P=T[1];if(Array.isArray(P)&&!(P.length<1)){var J=P[0];if(J!="noop"&&J!="stop"&&J!="close")for(let xe=1;xe<P.length;xe++)P[xe]=""}}}}return Us(re)}catch{return _}}var Hr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ci={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Gr;function Er(){}x(Er,Ro),Er.prototype.g=function(){return new XMLHttpRequest},Gr=new Er;function Fs(m){return encodeURIComponent(String(m))}function da(m){var _=1;m=m.split(":");const T=[];for(;_>0&&m.length;)T.push(m.shift()),_--;return m.length&&T.push(m.join(":")),T}function zs(m,_,T,P){this.j=m,this.i=_,this.l=T,this.S=P||1,this.V=new Ln(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new hs}function hs(){this.i=null,this.g="",this.h=!1}var Yt={},xn={};function or(m,_,T){m.M=1,m.A=Do(_n(_)),m.u=T,m.R=!0,Ue(m,null)}function Ue(m,_){m.F=Date.now(),en(m),m.B=_n(m.A);var T=m.B,P=m.S;Array.isArray(P)||(P=[String(P)]),Jl(T.i,"t",P),m.C=0,T=m.j.L,m.h=new hs,m.g=_f(m.j,T?_:null,!m.u),m.P>0&&(m.O=new Bt(p(m.Y,m,m.g),m.P)),_=m.V,T=m.g,P=m.ba;var J="readystatechange";Array.isArray(J)||(J&&(Vs[0]=J.toString()),J=Vs);for(let re=0;re<J.length;re++){const xe=He(T,J[re],P||_.handleEvent,!1,_.h||_);if(!xe)break;_.g[xe.key]=xe}_=m.J?M(m.J):{},m.u?(m.v||(m.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,_)):(m.v="GET",m.g.ea(m.B,m.v,null,_)),Bs(),Rt(m.i,m.v,m.B,m.l,m.S,m.u)}zs.prototype.ba=function(m){m=m.target;const _=this.O;_&&Cr(m)==3?_.j():this.Y(m)},zs.prototype.Y=function(m){try{if(m==this.g)e:{const Be=Cr(this.g),cn=this.g.ya(),ht=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||qn(this.g)))){this.K||Be!=4||cn==7||(cn==8||ht<=0?Bs(3):Bs(2)),lr(this);var _=this.g.ca();this.X=_;var T=Dt(this);if(this.o=_==200,ds(this.i,this.v,this.B,this.l,this.S,Be,_),this.o){if(this.U&&!this.L){t:{if(this.g){var P,J=this.g;if((P=J.g?J.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(P)){var re=P;break t}}re=null}if(m=re)ar(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Kr(this,m);else{this.o=!1,this.m=3,Qt(12),qs(this),ws(this);break e}}if(this.R){m=!0;let zt;for(;!this.K&&this.C<T.length;)if(zt=es(this,T),zt==xn){Be==4&&(this.m=4,Qt(14),m=!1),ar(this.i,this.l,null,"[Incomplete Response]");break}else if(zt==Yt){this.m=4,Qt(15),ar(this.i,this.l,T,"[Invalid Chunk]"),m=!1;break}else ar(this.i,this.l,zt,null),Kr(this,zt);if(Lt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||T.length!=0||this.h.h||(this.m=1,Qt(16),m=!1),this.o=this.o&&m,!m)ar(this.i,this.l,T,"[Invalid Chunked Response]"),qs(this),ws(this);else if(T.length>0&&!this.W){this.W=!0;var xe=this.j;xe.g==this&&xe.aa&&!xe.P&&(xe.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),ed(xe),xe.P=!0,Qt(11))}}else ar(this.i,this.l,T,null),Kr(this,T);Be==4&&qs(this),this.o&&!this.K&&(Be==4?yf(this.j,this):(this.o=!1,en(this)))}else Ii(this.g),_==400&&T.indexOf("Unknown SID")>0?(this.m=3,Qt(12)):(this.m=0,Qt(13)),qs(this),ws(this)}}}catch{}};function Dt(m){if(!Lt(m))return m.g.la();const _=qn(m.g);if(_==="")return"";let T="";const P=_.length,J=Cr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return qs(m),ws(m),"";m.h.i=new u.TextDecoder}for(let re=0;re<P;re++)m.h.h=!0,T+=m.h.i.decode(_[re],{stream:!(J&&re==P-1)});return _.length=0,m.h.g+=T,m.C=0,m.h.g}function Lt(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function es(m,_){var T=m.C,P=_.indexOf(`
`,T);return P==-1?xn:(T=Number(_.substring(T,P)),isNaN(T)?Yt:(P+=1,P+T>_.length?xn:(_=_.slice(P,P+T),m.C=P+T,_)))}zs.prototype.cancel=function(){this.K=!0,qs(this)};function en(m){m.T=Date.now()+m.H,$r(m,m.H)}function $r(m,_){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Mt(p(m.aa,m),_)}function lr(m){m.D&&(u.clearTimeout(m.D),m.D=null)}zs.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(wr(this.i,this.B),this.M!=2&&(Bs(),Qt(17)),qs(this),this.m=2,ws(this)):$r(this,this.T-m)};function ws(m){m.j.I==0||m.K||yf(m.j,m)}function qs(m){lr(m);var _=m.O;_&&typeof _.dispose=="function"&&_.dispose(),m.O=null,bs(m.V),m.g&&(_=m.g,m.g=null,_.abort(),_.dispose())}function Kr(m,_){try{var T=m.j;if(T.I!=0&&(T.g==m||Yr(T.h,m))){if(!m.L&&Yr(T.h,m)&&T.I==3){try{var P=T.Ba.g.parse(_)}catch{P=null}if(Array.isArray(P)&&P.length==3){var J=P;if(J[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<m.F)sc(T),xa(T);else break e;Uo(T),Qt(18)}}else T.xa=J[1],0<T.xa-T.K&&J[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=Mt(p(T.Va,T),6e3));Qr(T.h)<=1&&T.ta&&(T.ta=void 0)}else ti(T,11)}else if((m.L||T.g==m)&&sc(T),!k(_))for(J=T.Ba.g.parse(_),_=0;_<J.length;_++){let ht=J[_];const zt=ht[0];if(!(zt<=T.K))if(T.K=zt,ht=ht[1],T.I==2)if(ht[0]=="c"){T.M=ht[1],T.ba=ht[2];const dr=ht[3];dr!=null&&(T.ka=dr,T.j.info("VER="+T.ka));const ni=ht[4];ni!=null&&(T.za=ni,T.j.info("SVER="+T.za));const Nr=ht[5];Nr!=null&&typeof Nr=="number"&&Nr>0&&(P=1.5*Nr,T.O=P,T.j.info("backChannelRequestTimeoutMs_="+P)),P=T;const Ir=m.g;if(Ir){const Bo=Ir.g?Ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bo){var re=P.h;re.g||Bo.indexOf("spdy")==-1&&Bo.indexOf("quic")==-1&&Bo.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(zu(re,re.h),re.h=null))}if(P.G){const rc=Ir.g?Ir.g.getResponseHeader("X-HTTP-Session-Id"):null;rc&&(P.wa=rc,mt(P.J,P.G,rc))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-m.F,T.j.info("Handshake RTT: "+T.T+"ms")),P=T;var xe=m;if(P.na=bf(P,P.L?P.ba:null,P.W),xe.L){qu(P.h,xe);var Be=xe,cn=P.O;cn&&(Be.H=cn),Be.D&&(lr(Be),en(Be)),P.g=xe}else mf(P);T.i.length>0&&ei(T)}else ht[0]!="stop"&&ht[0]!="close"||ti(T,7);else T.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?ti(T,7):Ju(T):ht[0]!="noop"&&T.l&&T.l.qa(ht),T.A=0)}}Bs(4)}catch{}}var bn=class{constructor(m,_){this.g=m,this.map=_}};function Bu(m){this.l=m||10,u.PerformanceNavigationTiming?(m=u.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Fu(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Qr(m){return m.h?1:m.g?m.g.size:0}function Yr(m,_){return m.h?m.h==_:m.g?m.g.has(_):!1}function zu(m,_){m.g?m.g.add(_):m.h=_}function qu(m,_){m.h&&m.h==_?m.h=null:m.g&&m.g.has(_)&&m.g.delete(_)}Bu.prototype.cancel=function(){if(this.i=Hu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Hu(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let _=m.i;for(const T of m.g.values())_=_.concat(T.G);return _}return S(m.i)}var cf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wl(m,_){if(m){m=m.split("&");for(let T=0;T<m.length;T++){const P=m[T].indexOf("=");let J,re=null;P>=0?(J=m[T].substring(0,P),re=m[T].substring(P+1)):J=m[T],_(J,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function Hs(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;m instanceof Hs?(this.l=m.l,Vn(this,m.j),this.o=m.o,this.g=m.g,ha(this,m.u),this.h=m.h,Gu(this,ff(m.i)),this.m=m.m):m&&(_=String(m).match(cf))?(this.l=!1,Vn(this,_[1]||"",!0),this.o=Wr(_[2]||""),this.g=Wr(_[3]||"",!0),ha(this,_[4]),this.h=Wr(_[5]||"",!0),Gu(this,_[6]||"",!0),this.m=Wr(_[7]||"")):(this.l=!1,this.i=new pa(null,this.l))}Hs.prototype.toString=function(){const m=[];var _=this.j;_&&m.push(Oo(_,Xl,!0),":");var T=this.g;return(T||_=="file")&&(m.push("//"),(_=this.o)&&m.push(Oo(_,Xl,!0),"@"),m.push(Fs(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&m.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&m.push("/"),m.push(Oo(T,T.charAt(0)=="/"?$u:uf,!0))),(T=this.i.toString())&&m.push("?",T),(T=this.m)&&m.push("#",Oo(T,df)),m.join("")},Hs.prototype.resolve=function(m){const _=_n(this);let T=!!m.j;T?Vn(_,m.j):T=!!m.o,T?_.o=m.o:T=!!m.g,T?_.g=m.g:T=m.u!=null;var P=m.h;if(T)ha(_,m.u);else if(T=!!m.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var J=_.h.lastIndexOf("/");J!=-1&&(P=_.h.slice(0,J+1)+P)}if(J=P,J==".."||J==".")P="";else if(J.indexOf("./")!=-1||J.indexOf("/.")!=-1){P=J.lastIndexOf("/",0)==0,J=J.split("/");const re=[];for(let xe=0;xe<J.length;){const Be=J[xe++];Be=="."?P&&xe==J.length&&re.push(""):Be==".."?((re.length>1||re.length==1&&re[0]!="")&&re.pop(),P&&xe==J.length&&re.push("")):(re.push(Be),P=!0)}P=re.join("/")}else P=J}return T?_.h=P:T=m.i.toString()!=="",T?Gu(_,ff(m.i)):T=!!m.m,T&&(_.m=m.m),_};function _n(m){return new Hs(m)}function Vn(m,_,T){m.j=T?Wr(_,!0):_,m.j&&(m.j=m.j.replace(/:$/,""))}function ha(m,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);m.u=_}else m.u=null}function Gu(m,_,T){_ instanceof pa?(m.i=_,Zl(m.i,m.l)):(T||(_=Oo(_,fa)),m.i=new pa(_,m.l))}function mt(m,_,T){m.i.set(_,T)}function Do(m){return mt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Wr(m,_){return m?_?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Oo(m,_,T){return typeof m=="string"?(m=encodeURI(m).replace(_,Es),T&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Es(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Xl=/[#\/\?@]/g,uf=/[#\?:]/g,$u=/[#\?]/g,fa=/[#\?@]/g,df=/#/g;function pa(m,_){this.h=this.g=null,this.i=m||null,this.j=!!_}function Ts(m){m.g||(m.g=new Map,m.h=0,m.i&&Wl(m.i,function(_,T){m.add(decodeURIComponent(_.replace(/\+/g," ")),T)}))}n=pa.prototype,n.add=function(m,_){Ts(this),this.i=null,m=ma(this,m);let T=this.g.get(m);return T||this.g.set(m,T=[]),T.push(_),this.h+=1,this};function hf(m,_){Ts(m),_=ma(m,_),m.g.has(_)&&(m.i=null,m.h-=m.g.get(_).length,m.g.delete(_))}function Ku(m,_){return Ts(m),_=ma(m,_),m.g.has(_)}n.forEach=function(m,_){Ts(this),this.g.forEach(function(T,P){T.forEach(function(J){m.call(_,J,P,this)},this)},this)};function Qu(m,_){Ts(m);let T=[];if(typeof _=="string")Ku(m,_)&&(T=T.concat(m.g.get(ma(m,_))));else for(m=Array.from(m.g.values()),_=0;_<m.length;_++)T=T.concat(m[_]);return T}n.set=function(m,_){return Ts(this),this.i=null,m=ma(this,m),Ku(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[_]),this.h+=1,this},n.get=function(m,_){return m?(m=Qu(this,m),m.length>0?String(m[0]):_):_};function Jl(m,_,T){hf(m,_),T.length>0&&(m.i=null,m.g.set(ma(m,_),S(T)),m.h+=T.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],_=Array.from(this.g.keys());for(let P=0;P<_.length;P++){var T=_[P];const J=Fs(T);T=Qu(this,T);for(let re=0;re<T.length;re++){let xe=J;T[re]!==""&&(xe+="="+Fs(T[re])),m.push(xe)}}return this.i=m.join("&")};function ff(m){const _=new pa;return _.i=m.i,m.g&&(_.g=new Map(m.g),_.h=m.h),_}function ma(m,_){return _=String(_),m.j&&(_=_.toLowerCase()),_}function Zl(m,_){_&&!m.j&&(Ts(m),m.i=null,m.g.forEach(function(T,P){const J=P.toLowerCase();P!=J&&(hf(this,P),Jl(this,J,T))},m)),m.j=_}function Tr(m,_){const T=new Zn;if(u.Image){const P=new Image;P.onload=g(cr,T,"TestLoadImage: loaded",!0,_,P),P.onerror=g(cr,T,"TestLoadImage: error",!1,_,P),P.onabort=g(cr,T,"TestLoadImage: abort",!1,_,P),P.ontimeout=g(cr,T,"TestLoadImage: timeout",!1,_,P),u.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=m}else _(!1)}function Yu(m,_){const T=new Zn,P=new AbortController,J=setTimeout(()=>{P.abort(),cr(T,"TestPingServer: timeout",!1,_)},1e4);fetch(m,{signal:P.signal}).then(re=>{clearTimeout(J),re.ok?cr(T,"TestPingServer: ok",!0,_):cr(T,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(J),cr(T,"TestPingServer: error",!1,_)})}function cr(m,_,T,P,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),P(T)}catch{}}function ga(){this.g=new Io}function Xr(m){this.i=m.Sb||null,this.h=m.ab||!1}x(Xr,Ro),Xr.prototype.g=function(){return new Po(this.i,this.h)};function Po(m,_){Pt.call(this),this.H=m,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Po,Pt),n=Po.prototype,n.open=function(m,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=_,this.readyState=1,Ar(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(_.body=m),(this.H||u).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ya(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ar(this)),this.g&&(this.readyState=3,Ar(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ec(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function ec(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var _=m.value?m.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!m.done}))&&(this.response=this.responseText+=_)}m.done?ya(this):Ar(this),this.readyState==3&&ec(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,ya(this))},n.Na=function(m){this.g&&(this.response=m,ya(this))},n.ga=function(){this.g&&ya(this)};function ya(m){m.readyState=4,m.l=null,m.j=null,m.B=null,Ar(m)}n.setRequestHeader=function(m,_){this.A.append(m,_)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],_=this.h.entries();for(var T=_.next();!T.done;)T=T.value,m.push(T[0]+": "+T[1]),T=_.next();return m.join(`\r
`)};function Ar(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Po.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function ur(m){let _="";return ge(m,function(T,P){_+=P,_+=":",_+=T,_+=`\r
`}),_}function ko(m,_,T){e:{for(P in T){var P=!1;break e}P=!0}P||(T=ur(T),typeof m=="string"?T!=null&&Fs(T):mt(m,_,T))}function Et(m){Pt.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Et,Pt);var Jr=/^https?$/i,Wu=["POST","PUT"];n=Et.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,_,T,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);_=_?_.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Gr.g(),this.g.onreadystatechange=b(p(this.Ca,this));try{this.B=!0,this.g.open(_,String(m),!0),this.B=!1}catch(re){Mo(this,re);return}if(m=T||"",T=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var J in P)T.set(J,P[J]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const re of P.keys())T.set(re,P.get(re));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(T.keys()).find(re=>re.toLowerCase()=="content-type"),J=u.FormData&&m instanceof u.FormData,!(Array.prototype.indexOf.call(Wu,_,void 0)>=0)||P||J||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,xe]of T)this.g.setRequestHeader(re,xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(re){Mo(this,re)}};function Mo(m,_){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=_,m.o=5,Xu(m),Ni(m)}function Xu(m){m.A||(m.A=!0,Kt(m,"complete"),Kt(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,Kt(this,"complete"),Kt(this,"abort"),Ni(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ni(this,!0)),Et.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Lo(this):this.Xa())},n.Xa=function(){Lo(this)};function Lo(m){if(m.h&&typeof o<"u"){if(m.v&&Cr(m)==4)setTimeout(m.Ca.bind(m),0);else if(Kt(m,"readystatechange"),Cr(m)==4){m.h=!1;try{const re=m.ca();e:switch(re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var T;if(!(T=_)){var P;if(P=re===0){let xe=String(m.D).match(cf)[1]||null;!xe&&u.self&&u.self.location&&(xe=u.self.location.protocol.slice(0,-1)),P=!Jr.test(xe?xe.toLowerCase():"")}T=P}if(T)Kt(m,"complete"),Kt(m,"success");else{m.o=6;try{var J=Cr(m)>2?m.g.statusText:""}catch{J=""}m.l=J+" ["+m.ca()+"]",Xu(m)}}finally{Ni(m)}}}}function Ni(m,_){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const T=m.g;m.g=null,_||Kt(m,"ready");try{T.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Cr(m){return m.g?m.g.readyState:0}n.ca=function(){try{return Cr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var _=this.g.responseText;return m&&_.indexOf(m)==0&&(_=_.substring(m.length)),_s(_)}};function qn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Ii(m){const _={};m=(m.g&&Cr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<m.length;P++){if(k(m[P]))continue;var T=da(m[P]);const J=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const re=_[J]||[];_[J]=re,re.push(T)}le(_,function(P){return P.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(m,_,T){return T&&T.internalChannelParams&&T.internalChannelParams[m]||_}function va(m){this.za=0,this.i=[],this.j=new Zn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Zr("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Zr("baseRetryDelayMs",5e3,m),this.Za=Zr("retryDelaySeedMs",1e4,m),this.Ta=Zr("forwardChannelMaxRetries",2,m),this.va=Zr("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Bu(m&&m.concurrentRequestLimit),this.Ba=new ga,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=va.prototype,n.ka=8,n.I=1,n.connect=function(m,_,T,P){Qt(0),this.W=m,this.H=_||{},T&&P!==void 0&&(this.H.OSID=T,this.H.OAID=P),this.F=this.X,this.J=bf(this,null,this.W),ei(this)};function Ju(m){if(tc(m),m.I==3){var _=m.V++,T=_n(m.J);if(mt(T,"SID",m.M),mt(T,"RID",_),mt(T,"TYPE","terminate"),Vo(m,T),_=new zs(m,m.j,_),_.M=2,_.A=Do(_n(T)),T=!1,u.navigator&&u.navigator.sendBeacon)try{T=u.navigator.sendBeacon(_.A.toString(),"")}catch{}!T&&u.Image&&(new Image().src=_.A,T=!0),T||(_.g=_f(_.j,null),_.g.ea(_.A)),_.F=Date.now(),en(_)}xf(m)}function xa(m){m.g&&(ed(m),m.g.cancel(),m.g=null)}function tc(m){xa(m),m.v&&(u.clearTimeout(m.v),m.v=null),sc(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&u.clearTimeout(m.m),m.m=null)}function ei(m){if(!Fu(m.h)&&!m.m){m.m=!0;var _=m.Ea;K||N(),Z||(K(),Z=!0),j.add(_,m),m.D=0}}function nc(m,_){return Qr(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=_.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Mt(p(m.Ea,m,_),vf(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const J=new zs(this,this.j,m);let re=this.o;if(this.U&&(re?(re=M(re),H(re,this.U)):re=this.U),this.u!==null||this.R||(J.J=re,re=null),this.S)e:{for(var _=0,T=0;T<this.i.length;T++){t:{var P=this.i[T];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(_+=P,_>4096){_=T;break e}if(_===4096||T===this.i.length-1){_=T+1;break e}}_=1e3}else _=1e3;_=pf(this,J,_),T=_n(this.J),mt(T,"RID",m),mt(T,"CVER",22),this.G&&mt(T,"X-HTTP-Session-Id",this.G),Vo(this,T),re&&(this.R?_="headers="+Fs(ur(re))+"&"+_:this.u&&ko(T,this.u,re)),zu(this.h,J),this.Ra&&mt(T,"TYPE","init"),this.S?(mt(T,"$req",_),mt(T,"SID","null"),J.U=!0,or(J,T,null)):or(J,T,_),this.I=2}}else this.I==3&&(m?Zu(this,m):this.i.length==0||Fu(this.h)||Zu(this))};function Zu(m,_){var T;_?T=_.l:T=m.V++;const P=_n(m.J);mt(P,"SID",m.M),mt(P,"RID",T),mt(P,"AID",m.K),Vo(m,P),m.u&&m.o&&ko(P,m.u,m.o),T=new zs(m,m.j,T,m.D+1),m.u===null&&(T.J=m.o),_&&(m.i=_.G.concat(m.i)),_=pf(m,T,1e3),T.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),zu(m.h,T),or(T,P,_)}function Vo(m,_){m.H&&ge(m.H,function(T,P){mt(_,P,T)}),m.l&&ge({},function(T,P){mt(_,P,T)})}function pf(m,_,T){T=Math.min(m.i.length,T);const P=m.l?p(m.l.Ka,m.l,m):null;e:{var J=m.i;let Be=-1;for(;;){const cn=["count="+T];Be==-1?T>0?(Be=J[0].g,cn.push("ofs="+Be)):Be=0:cn.push("ofs="+Be);let ht=!0;for(let zt=0;zt<T;zt++){var re=J[zt].g;const dr=J[zt].map;if(re-=Be,re<0)Be=Math.max(0,J[zt].g-100),ht=!1;else try{re="req"+re+"_"||"";try{var xe=dr instanceof Map?dr:Object.entries(dr);for(const[ni,Nr]of xe){let Ir=Nr;h(Nr)&&(Ir=Us(Nr)),cn.push(re+ni+"="+encodeURIComponent(Ir))}}catch(ni){throw cn.push(re+"type="+encodeURIComponent("_badmap")),ni}}catch{P&&P(dr)}}if(ht){xe=cn.join("&");break e}}xe=void 0}return m=m.i.splice(0,T),_.G=m,xe}function mf(m){if(!m.g&&!m.v){m.Y=1;var _=m.Da;K||N(),Z||(K(),Z=!0),j.add(_,m),m.A=0}}function Uo(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Mt(p(m.Da,m),vf(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,gf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Mt(p(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Qt(10),xa(this),gf(this))};function ed(m){m.B!=null&&(u.clearTimeout(m.B),m.B=null)}function gf(m){m.g=new zs(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var _=_n(m.na);mt(_,"RID","rpc"),mt(_,"SID",m.M),mt(_,"AID",m.K),mt(_,"CI",m.F?"0":"1"),!m.F&&m.ia&&mt(_,"TO",m.ia),mt(_,"TYPE","xmlhttp"),Vo(m,_),m.u&&m.o&&ko(_,m.u,m.o),m.O&&(m.g.H=m.O);var T=m.g;m=m.ba,T.M=1,T.A=Do(_n(_)),T.u=null,T.R=!0,Ue(T,m)}n.Va=function(){this.C!=null&&(this.C=null,xa(this),Uo(this),Qt(19))};function sc(m){m.C!=null&&(u.clearTimeout(m.C),m.C=null)}function yf(m,_){var T=null;if(m.g==_){sc(m),ed(m),m.g=null;var P=2}else if(Yr(m.h,_))T=_.G,qu(m.h,_),P=1;else return;if(m.I!=0){if(_.o)if(P==1){T=_.u?_.u.length:0,_=Date.now()-_.F;var J=m.D;P=qr(),Kt(P,new kt(P,T)),ei(m)}else mf(m);else if(J=_.m,J==3||J==0&&_.X>0||!(P==1&&nc(m,_)||P==2&&Uo(m)))switch(T&&T.length>0&&(_=m.h,_.i=_.i.concat(T)),J){case 1:ti(m,5);break;case 4:ti(m,10);break;case 3:ti(m,6);break;default:ti(m,2)}}}function vf(m,_){let T=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(T*=2),T*_}function ti(m,_){if(m.j.info("Error code "+_),_==2){var T=p(m.bb,m),P=m.Ua;const J=!P;P=new Hs(P||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Vn(P,"https"),Do(P),J?Tr(P.toString(),T):Yu(P.toString(),T)}else Qt(2);m.I=0,m.l&&m.l.pa(_),xf(m),tc(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function xf(m){if(m.I=0,m.ja=[],m.l){const _=Hu(m.h);(_.length!=0||m.i.length!=0)&&(w(m.ja,_),w(m.ja,m.i),m.h.i.length=0,S(m.i),m.i.length=0),m.l.oa()}}function bf(m,_,T){var P=T instanceof Hs?_n(T):new Hs(T);if(P.g!="")_&&(P.g=_+"."+P.g),ha(P,P.u);else{var J=u.location;P=J.protocol,_=_?_+"."+J.hostname:J.hostname,J=+J.port;const re=new Hs(null);P&&Vn(re,P),_&&(re.g=_),J&&ha(re,J),T&&(re.h=T),P=re}return T=m.G,_=m.wa,T&&_&&mt(P,T,_),mt(P,"VER",m.ka),Vo(m,P),P}function _f(m,_,T){if(_&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=m.Aa&&!m.ma?new Et(new Xr({ab:T})):new Et(m.ma),_.Fa(m.L),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sf(){}n=Sf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ba(){}ba.prototype.g=function(m,_){return new fs(m,_)};function fs(m,_){Pt.call(this),this.g=new va(_),this.l=m,this.h=_&&_.messageUrlParams||null,m=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(m?m["X-WebChannel-Content-Type"]=_.messageContentType:m={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(m?m["X-WebChannel-Client-Profile"]=_.sa:m={"X-WebChannel-Client-Profile":_.sa}),this.g.U=m,(m=_&&_.Qb)&&!k(m)&&(this.g.u=m),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!k(_)&&(this.g.G=_,m=this.h,m!==null&&_ in m&&(m=this.h,_ in m&&delete m[_])),this.j=new Ri(this)}x(fs,Pt),fs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fs.prototype.close=function(){Ju(this.g)},fs.prototype.o=function(m){var _=this.g;if(typeof m=="string"){var T={};T.__data__=m,m=T}else this.v&&(T={},T.__data__=Us(m),m=T);_.i.push(new bn(_.Ya++,m)),_.I==3&&ei(_)},fs.prototype.N=function(){this.g.l=null,delete this.j,Ju(this.g),delete this.g,fs.Z.N.call(this)};function wf(m){vn.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var _=m.__sm__;if(_){e:{for(const T in _){m=T;break e}m=void 0}(this.i=m)&&(m=this.i,_=_!==null&&m in _?_[m]:void 0),this.data=_}else this.data=m}x(wf,vn);function Ef(){Ss.call(this),this.status=1}x(Ef,Ss);function Ri(m){this.g=m}x(Ri,Sf),Ri.prototype.ra=function(){Kt(this.g,"a")},Ri.prototype.qa=function(m){Kt(this.g,new wf(m))},Ri.prototype.pa=function(m){Kt(this.g,new Ef)},Ri.prototype.oa=function(){Kt(this.g,"b")},ba.prototype.createWebChannel=ba.prototype.g,fs.prototype.send=fs.prototype.o,fs.prototype.open=fs.prototype.m,fs.prototype.close=fs.prototype.close,ZC=function(){return new ba},JC=function(){return qr()},XC=Ft,$0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Hr.NO_ERROR=0,Hr.TIMEOUT=8,Hr.HTTP_ERROR=6,Wp=Hr,Ci.COMPLETE="complete",WC=Ci,Kl.EventType=Jn,Jn.OPEN="a",Jn.CLOSE="b",Jn.ERROR="c",Jn.MESSAGE="d",Pt.prototype.listen=Pt.prototype.J,Wd=Kl,Et.prototype.listenOnce=Et.prototype.K,Et.prototype.getLastError=Et.prototype.Ha,Et.prototype.getLastErrorCode=Et.prototype.ya,Et.prototype.getStatus=Et.prototype.ca,Et.prototype.getResponseJson=Et.prototype.La,Et.prototype.getResponseText=Et.prototype.la,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Fa,YC=Et}).apply(typeof Dp<"u"?Dp:typeof self<"u"?self:typeof window<"u"?window:{});const sT="@firebase/firestore",rT="4.9.2";class zn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zn.UNAUTHENTICATED=new zn(null),zn.GOOGLE_CREDENTIALS=new zn("google-credentials-uid"),zn.FIRST_PARTY=new zn("first-party-uid"),zn.MOCK_USER=new zn("mock-user");let Iu="12.3.0";const Nl=new tb("@firebase/firestore");function Bc(){return Nl.logLevel}function ye(n,...e){if(Nl.logLevel<=Ze.DEBUG){const t=e.map(db);Nl.debug(`Firestore (${Iu}): ${n}`,...t)}}function pn(n,...e){if(Nl.logLevel<=Ze.ERROR){const t=e.map(db);Nl.error(`Firestore (${Iu}): ${n}`,...t)}}function Il(n,...e){if(Nl.logLevel<=Ze.WARN){const t=e.map(db);Nl.warn(`Firestore (${Iu}): ${n}`,...t)}}function db(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Te(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,eN(n,s,t)}function eN(n,e,t){let s=`FIRESTORE (${Iu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw pn(s),new Error(s)}function Ie(n,e,t,s){let i="Unexpected state";typeof t=="string"?i=t:s=t,n||eN(e,i,s)}function Ce(n,e){return n}const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ve extends Br{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class yi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class tN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(zn.UNAUTHENTICATED)))}shutdown(){}}class YM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class WM{constructor(e){this.t=e,this.currentUser=zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ie(this.o===void 0,42304);let s=this.i;const i=f=>this.i!==s?(s=this.i,t(f)):Promise.resolve();let o=new yi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new yi,e.enqueueRetryable((()=>i(this.currentUser)))};const u=()=>{const f=o;e.enqueueRetryable((async()=>{await f.promise,await i(this.currentUser)}))},h=f=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new yi)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Ie(typeof s.accessToken=="string",31837,{l:s}),new tN(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ie(e===null||typeof e=="string",2055,{h:e}),new zn(e)}}class XM{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=zn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class JM{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new XM(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(zn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class iT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZM{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ds(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ie(this.o===void 0,3512);const s=o=>{o.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,ye("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>s(o)))};const i=o=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new iT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ie(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new iT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function e5(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}class hb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=e5(40);for(let o=0;o<i.length;++o)s.length<20&&i[o]<t&&(s+=e.charAt(i[o]%62))}return s}}function Me(n,e){return n<e?-1:n>e?1:0}function K0(n,e){const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const i=n.charAt(s),o=e.charAt(s);if(i!==o)return s0(i)===s0(o)?Me(i,o):s0(i)?1:-1}return Me(n.length,e.length)}const t5=55296,n5=57343;function s0(n){const e=n.charCodeAt(0);return e>=t5&&e<=n5}function au(n,e,t){return n.length===e.length&&n.every(((s,i)=>t(s,e[i])))}function nN(n){return n+"\0"}const aT="__name__";class di{constructor(e,t,s){t===void 0?t=0:t>e.length&&Te(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Te(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return di.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof di?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++){const o=di.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Me(e.length,t.length)}static compareSegments(e,t){const s=di.isNumericId(e),i=di.isNumericId(t);return s&&!i?-1:!s&&i?1:s&&i?di.extractNumericId(e).compare(di.extractNumericId(t)):K0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ao.fromString(e.substring(4,e.length-2))}}class dt extends di{construct(e,t,s){return new dt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new ve(ae.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((i=>i.length>0)))}return new dt(t)}static emptyPath(){return new dt([])}}const s5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xt extends di{construct(e,t,s){return new Xt(e,t,s)}static isValidIdentifier(e){return s5.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aT}static keyField(){return new Xt([aT])}static fromServerFormat(e){const t=[];let s="",i=0;const o=()=>{if(s.length===0)throw new ve(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;i<e.length;){const h=e[i];if(h==="\\"){if(i+1===e.length)throw new ve(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[i+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ve(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=f,i+=2}else h==="`"?(u=!u,i++):h!=="."||u?(s+=h,i++):(o(),i++)}if(o(),u)throw new ve(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xt(t)}static emptyPath(){return new Xt([])}}class be{constructor(e){this.path=e}static fromPath(e){return new be(dt.fromString(e))}static fromName(e){return new be(dt.fromString(e).popFirst(5))}static empty(){return new be(dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&dt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return dt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new dt(e.slice()))}}function sN(n,e,t){if(!t)throw new ve(ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function r5(n,e,t,s){if(e===!0&&s===!0)throw new ve(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function oT(n){if(!be.isDocumentKey(n))throw new ve(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function lT(n){if(be.isDocumentKey(n))throw new ve(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function rN(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ag(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Te(12329,{type:typeof n})}function nr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ve(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ag(n);throw new ve(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function i5(n,e){if(e<=0)throw new ve(ae.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Cn(n,e){const t={typeString:n};return e&&(t.value=e),t}function qh(n,e){if(!rN(n))throw new ve(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const i=e[s].typeString,o="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(i&&typeof u!==i){t=`JSON field '${s}' must be a ${i}.`;break}if(o!==void 0&&u!==o.value){t=`Expected '${s}' field to equal '${o.value}'`;break}}if(t)throw new ve(ae.INVALID_ARGUMENT,t);return!0}const cT=-62135596800,uT=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*uT);return new _t(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ve(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ve(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<cT)throw new ve(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ve(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/uT}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qh(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:Cn("string",_t._jsonSchemaVersion),seconds:Cn("number"),nanoseconds:Cn("number")};class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new _t(0,0))}static max(){return new De(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ou=-1;class Am{constructor(e,t,s,i){this.indexId=e,this.collectionGroup=t,this.fields=s,this.indexState=i}}function Q0(n){return n.fields.find((e=>e.kind===2))}function il(n){return n.fields.filter((e=>e.kind!==2))}Am.UNKNOWN_ID=-1;class Xp{constructor(e,t){this.fieldPath=e,this.kind=t}}class bh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new bh(0,sr.min())}}function iN(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=De.fromTimestamp(s===1e9?new _t(t+1,0):new _t(t,s));return new sr(i,be.empty(),e)}function aN(n){return new sr(n.readTime,n.key,ou)}class sr{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new sr(De.min(),be.empty(),ou)}static max(){return new sr(De.max(),be.empty(),ou)}}function fb(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:Me(n.largestBatchId,e.largestBatchId))}const oN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function _o(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==oN)throw n;ye("LocalStore","Unexpectedly lost primary lease")}class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new X(((s,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(s,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(s,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof X?t:X.resolve(t)}catch(t){return X.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):X.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):X.reject(t)}static resolve(e){return new X(((t,s)=>{t(e)}))}static reject(e){return new X(((t,s)=>{s(e)}))}static waitFor(e){return new X(((t,s)=>{let i=0,o=0,u=!1;e.forEach((h=>{++i,h.next((()=>{++o,u&&o===i&&t()}),(f=>s(f)))})),u=!0,o===i&&t()}))}static or(e){let t=X.resolve(!1);for(const s of e)t=t.next((i=>i?X.resolve(i):s()));return t}static forEach(e,t){const s=[];return e.forEach(((i,o)=>{s.push(t.call(this,i,o))})),this.waitFor(s)}static mapArray(e,t){return new X(((s,i)=>{const o=e.length,u=new Array(o);let h=0;for(let f=0;f<o;f++){const p=f;t(e[p]).next((g=>{u[p]=g,++h,h===o&&s(u)}),(g=>i(g)))}}))}static doWhile(e,t){return new X(((s,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):s()};o()}))}}const Js="SimpleDb";class og{static open(e,t,s,i){try{return new og(t,e.transaction(i,s))}catch(o){throw new ah(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new yi,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ah(e,t.error)):this.S.resolve()},this.transaction.onerror=s=>{const i=pb(s.target.error);this.S.reject(new ah(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ye(Js,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new o5(t)}}class oo{static delete(e){return ye(Js,"Removing database:",e),ol(JA().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!oC())return!1;if(oo.F())return!0;const e=Pn(),t=oo.M(e),s=0<t&&t<10,i=cN(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||o)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(s)}constructor(e,t,s){this.name=e,this.version=t,this.N=s,this.B=null,oo.M(Pn())===12.2&&pn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ye(Js,"Opening database:",this.name),this.db=await new Promise(((t,s)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const u=o.target.result;t(u)},i.onblocked=()=>{s(new ah(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const u=o.target.error;u.name==="VersionError"?s(new ve(ae.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?s(new ve(ae.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):s(new ah(e,u))},i.onupgradeneeded=o=>{ye(Js,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const u=o.target.result;this.N.k(u,i.transaction,o.oldVersion,this.version).next((()=>{ye(Js,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,s,i){const o=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const h=og.open(this.db,e,o?"readonly":"readwrite",s),f=i(h).next((p=>(h.C(),p))).catch((p=>(h.abort(p),X.reject(p)))).toPromise();return f.catch((()=>{})),await h.D,f}catch(h){const f=h,p=f.name!=="FirebaseError"&&u<3;if(ye(Js,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function cN(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class a5{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return ol(this.U.delete())}}class ah extends ve{constructor(e,t){super(ae.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function So(n){return n.name==="IndexedDbTransactionError"}class o5{constructor(e){this.store=e}put(e,t){let s;return t!==void 0?(ye(Js,"PUT",this.store.name,e,t),s=this.store.put(t,e)):(ye(Js,"PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),ol(s)}add(e){return ye(Js,"ADD",this.store.name,e,e),ol(this.store.add(e))}get(e){return ol(this.store.get(e)).next((t=>(t===void 0&&(t=null),ye(Js,"GET",this.store.name,e,t),t)))}delete(e){return ye(Js,"DELETE",this.store.name,e),ol(this.store.delete(e))}count(){return ye(Js,"COUNT",this.store.name),ol(this.store.count())}J(e,t){const s=this.options(e,t),i=s.index?this.store.index(s.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(s.range);return new X(((u,h)=>{o.onerror=f=>{h(f.target.error)},o.onsuccess=f=>{u(f.target.result)}}))}{const o=this.cursor(s),u=[];return this.H(o,((h,f)=>{u.push(f)})).next((()=>u))}}Y(e,t){const s=this.store.getAll(e,t===null?void 0:t);return new X(((i,o)=>{s.onerror=u=>{o(u.target.error)},s.onsuccess=u=>{i(u.target.result)}}))}Z(e,t){ye(Js,"DELETE ALL",this.store.name);const s=this.options(e,t);s.X=!1;const i=this.cursor(s);return this.H(i,((o,u,h)=>h.delete()))}ee(e,t){let s;t?s=e:(s={},t=e);const i=this.cursor(s);return this.H(i,t)}te(e){const t=this.cursor({});return new X(((s,i)=>{t.onerror=o=>{const u=pb(o.target.error);i(u)},t.onsuccess=o=>{const u=o.target.result;u?e(u.primaryKey,u.value).next((h=>{h?u.continue():s()})):s()}}))}H(e,t){const s=[];return new X(((i,o)=>{e.onerror=u=>{o(u.target.error)},e.onsuccess=u=>{const h=u.target.result;if(!h)return void i();const f=new a5(h),p=t(h.primaryKey,h.value,f);if(p instanceof X){const g=p.catch((x=>(f.done(),X.reject(x))));s.push(g)}f.isDone?i():f.G===null?h.continue():h.continue(f.G)}})).next((()=>X.waitFor(s)))}options(e,t){let s;return e!==void 0&&(typeof e=="string"?s=e:t=e),{index:s,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,t):s.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ol(n){return new X(((e,t)=>{n.onsuccess=s=>{const i=s.target.result;e(i)},n.onerror=s=>{const i=pb(s.target.error);t(i)}}))}let dT=!1;function pb(n){const e=oo.M(Pn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const s=new ve("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dT||(dT=!0,setTimeout((()=>{throw s}),0)),s}}return n}const oh="IndexBackfiller";class l5{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ye(oh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ye(oh,`Documents written: ${t}`)}catch(t){So(t)?ye(oh,"Ignoring IndexedDB error during index backfill: ",t):await _o(t)}await this.re(6e4)}))}}class c5{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const s=new Set;let i=t,o=!0;return X.doWhile((()=>o===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!s.has(u))return ye(oh,`Processing collection: ${u}`),this.oe(e,u,i).next((h=>{i-=h,s.add(u)}));o=!1})))).next((()=>t-i))}oe(e,t,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,s).next((o=>{const u=o.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(i,o))).next((h=>(ye(oh,`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h)))).next((()=>u.size))}))))}_e(e,t){let s=e;return t.changes.forEach(((i,o)=>{const u=aN(o);fb(u,s)>0&&(s=u)})),new sr(s.readTime,s.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Os{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>t.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Os.ce=-1;const vl=-1;function lg(n){return n==null}function _h(n){return n===0&&1/n==-1/0}function uN(n){return typeof n=="number"&&Number.isInteger(n)&&!_h(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Cm="";function cs(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=hT(e)),e=u5(n.get(t),e);return hT(e)}function u5(n,e){let t=e;const s=n.length;for(let i=0;i<s;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case Cm:t+="";break;default:t+=o}}return t}function hT(n){return n+Cm+""}function fi(n){const e=n.length;if(Ie(e>=2,64408,{path:n}),e===2)return Ie(n.charAt(0)===Cm&&n.charAt(1)==="",56145,{path:n}),dt.emptyPath();const t=e-2,s=[];let i="";for(let o=0;o<e;){const u=n.indexOf(Cm,o);switch((u<0||u>t)&&Te(50515,{path:n}),n.charAt(u+1)){case"":const h=n.substring(o,u);let f;i.length===0?f=h:(i+=h,f=i,i=""),s.push(f);break;case"":i+=n.substring(o,u),i+="\0";break;case"":i+=n.substring(o,u+1);break;default:Te(61167,{path:n})}o=u+2}return new dt(s)}const al="remoteDocuments",Hh="owner",Pc="owner",Sh="mutationQueues",d5="userId",Or="mutations",fT="batchId",pl="userMutationsIndex",pT=["userId","batchId"];function Jp(n,e){return[n,cs(e)]}function dN(n,e,t){return[n,cs(e),t]}const h5={},lu="documentMutations",Nm="remoteDocumentsV14",f5=["prefixPath","collectionGroup","readTime","documentId"],Zp="documentKeyIndex",p5=["prefixPath","collectionGroup","documentId"],hN="collectionGroupIndex",m5=["collectionGroup","readTime","prefixPath","documentId"],wh="remoteDocumentGlobal",Y0="remoteDocumentGlobalKey",cu="targets",fN="queryTargetsIndex",g5=["canonicalId","targetId"],uu="targetDocuments",y5=["targetId","path"],mb="documentTargetsIndex",v5=["path","targetId"],Im="targetGlobalKey",xl="targetGlobal",Eh="collectionParents",x5=["collectionId","parent"],du="clientMetadata",b5="clientId",cg="bundles",_5="bundleId",ug="namedQueries",S5="name",gb="indexConfiguration",w5="indexId",W0="collectionGroupIndex",E5="collectionGroup",lh="indexState",T5=["indexId","uid"],pN="sequenceNumberIndex",A5=["uid","sequenceNumber"],ch="indexEntries",C5=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],mN="documentKeyIndex",N5=["indexId","uid","orderedDocumentKey"],dg="documentOverlays",I5=["userId","collectionPath","documentId"],X0="collectionPathOverlayIndex",R5=["userId","collectionPath","largestBatchId"],gN="collectionGroupOverlayIndex",j5=["userId","collectionGroup","largestBatchId"],yb="globals",D5="name",yN=[Sh,Or,lu,al,cu,Hh,xl,uu,du,wh,Eh,cg,ug],O5=[...yN,dg],vN=[Sh,Or,lu,Nm,cu,Hh,xl,uu,du,wh,Eh,cg,ug,dg],xN=vN,vb=[...xN,gb,lh,ch],P5=vb,bN=[...vb,yb],k5=bN;class J0 extends lN{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Mn(n,e){const t=Ce(n);return oo.O(t.le,e)}function mT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function _N(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Ot{constructor(e,t){this.comparator=e,this.root=t||Yn.EMPTY}insert(e,t){return new Ot(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Yn.BLACK,null,null))}remove(e){return new Ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Yn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return t+s.left.size;i<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Op(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Op(this.root,e,this.comparator,!1)}getReverseIterator(){return new Op(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Op(this.root,e,this.comparator,!0)}}class Op{constructor(e,t,s,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?s(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Yn{constructor(e,t,s,i,o){this.key=e,this.value=t,this.color=s??Yn.RED,this.left=i??Yn.EMPTY,this.right=o??Yn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,i,o){return new Yn(e??this.key,t??this.value,s??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const o=s(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,s),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Yn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Yn.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Yn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Yn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Te(27949);return e+(this.isRed()?0:1)}}Yn.EMPTY=null,Yn.RED=!0,Yn.BLACK=!1;Yn.EMPTY=new class{constructor(){this.size=0}get key(){throw Te(57766)}get value(){throw Te(16141)}get color(){throw Te(16727)}get left(){throw Te(29726)}get right(){throw Te(36894)}copy(e,t,s,i,o){return this}insert(e,t,s){return new Yn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class wt{constructor(e){this.comparator=e,this.data=new Ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new gT(this.data.getIterator())}getIteratorFrom(e){return new gT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof wt)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=s.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new wt(this.comparator);return t.data=e,t}}class gT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function kc(n){return n.hasNext()?n.getNext():void 0}class Ps{constructor(e){this.fields=e,e.sort(Xt.comparator)}static empty(){return new Ps([])}unionWith(e){let t=new wt(Xt.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ps(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return au(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}class SN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class yn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new SN("Invalid base64 string: "+o):o}})(e);return new yn(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let u=0;u<i.length;++u)o+=String.fromCharCode(i[u]);return o})(e);return new yn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yn.EMPTY_BYTE_STRING=new yn("");const M5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function na(n){if(Ie(!!n,39018),typeof n=="string"){let e=0;const t=M5.exec(n);if(Ie(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Ht(n.seconds),nanos:Ht(n.nanos)}}function Ht(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function sa(n){return typeof n=="string"?yn.fromBase64String(n):yn.fromUint8Array(n)}const wN="server_timestamp",EN="__type__",TN="__previous_value__",AN="__local_write_time__";function hg(n){return(n?.mapValue?.fields||{})[EN]?.stringValue===wN}function fg(n){const e=n.mapValue.fields[TN];return hg(e)?fg(e):e}function Th(n){const e=na(n.mapValue.fields[AN].timestampValue);return new _t(e.seconds,e.nanos)}class L5{constructor(e,t,s,i,o,u,h,f,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=i,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=g}}const Ah="(default)";class Rl{constructor(e,t){this.projectId=e,this.database=t||Ah}static empty(){return new Rl("","")}get isDefaultDatabase(){return this.database===Ah}isEqual(e){return e instanceof Rl&&e.projectId===this.projectId&&e.database===this.database}}const xb="__type__",CN="__max__",to={mapValue:{fields:{__type__:{stringValue:CN}}}},bb="__vector__",hu="value",em={nullValue:"NULL_VALUE"};function fo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?hg(n)?4:NN(n)?9007199254740991:pg(n)?10:11:Te(28295,{value:n})}function Si(n,e){if(n===e)return!0;const t=fo(n);if(t!==fo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Th(n).isEqual(Th(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const u=na(i.timestampValue),h=na(o.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return sa(i.bytesValue).isEqual(sa(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return Ht(i.geoPointValue.latitude)===Ht(o.geoPointValue.latitude)&&Ht(i.geoPointValue.longitude)===Ht(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return Ht(i.integerValue)===Ht(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const u=Ht(i.doubleValue),h=Ht(o.doubleValue);return u===h?_h(u)===_h(h):isNaN(u)&&isNaN(h)}return!1})(n,e);case 9:return au(n.arrayValue.values||[],e.arrayValue.values||[],Si);case 10:case 11:return(function(i,o){const u=i.mapValue.fields||{},h=o.mapValue.fields||{};if(mT(u)!==mT(h))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(h[f]===void 0||!Si(u[f],h[f])))return!1;return!0})(n,e);default:return Te(52216,{left:n})}}function Ch(n,e){return(n.values||[]).find((t=>Si(t,e)))!==void 0}function po(n,e){if(n===e)return 0;const t=fo(n),s=fo(e);if(t!==s)return Me(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Me(n.booleanValue,e.booleanValue);case 2:return(function(o,u){const h=Ht(o.integerValue||o.doubleValue),f=Ht(u.integerValue||u.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(n,e);case 3:return yT(n.timestampValue,e.timestampValue);case 4:return yT(Th(n),Th(e));case 5:return K0(n.stringValue,e.stringValue);case 6:return(function(o,u){const h=sa(o),f=sa(u);return h.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(o,u){const h=o.split("/"),f=u.split("/");for(let p=0;p<h.length&&p<f.length;p++){const g=Me(h[p],f[p]);if(g!==0)return g}return Me(h.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,u){const h=Me(Ht(o.latitude),Ht(u.latitude));return h!==0?h:Me(Ht(o.longitude),Ht(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return vT(n.arrayValue,e.arrayValue);case 10:return(function(o,u){const h=o.fields||{},f=u.fields||{},p=h[hu]?.arrayValue,g=f[hu]?.arrayValue,x=Me(p?.values?.length||0,g?.values?.length||0);return x!==0?x:vT(p,g)})(n.mapValue,e.mapValue);case 11:return(function(o,u){if(o===to.mapValue&&u===to.mapValue)return 0;if(o===to.mapValue)return 1;if(u===to.mapValue)return-1;const h=o.fields||{},f=Object.keys(h),p=u.fields||{},g=Object.keys(p);f.sort(),g.sort();for(let x=0;x<f.length&&x<g.length;++x){const b=K0(f[x],g[x]);if(b!==0)return b;const S=po(h[f[x]],p[g[x]]);if(S!==0)return S}return Me(f.length,g.length)})(n.mapValue,e.mapValue);default:throw Te(23264,{he:t})}}function yT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Me(n,e);const t=na(n),s=na(e),i=Me(t.seconds,s.seconds);return i!==0?i:Me(t.nanos,s.nanos)}function vT(n,e){const t=n.values||[],s=e.values||[];for(let i=0;i<t.length&&i<s.length;++i){const o=po(t[i],s[i]);if(o)return o}return Me(t.length,s.length)}function fu(n){return Z0(n)}function Z0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=na(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return sa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return be.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",i=!0;for(const o of t.values||[])i?i=!1:s+=",",s+=Z0(o);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const u of s)o?o=!1:i+=",",i+=`${u}:${Z0(t.fields[u])}`;return i+"}"})(n.mapValue):Te(61005,{value:n})}function tm(n){switch(fo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=fg(n);return e?16+tm(e):16;case 5:return 2*n.stringValue.length;case 6:return sa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((i,o)=>i+tm(o)),0)})(n.arrayValue);case 10:case 11:return(function(s){let i=0;return wo(s.fields,((o,u)=>{i+=o.length+tm(u)})),i})(n.mapValue);default:throw Te(13486,{value:n})}}function jl(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ex(n){return!!n&&"integerValue"in n}function Nh(n){return!!n&&"arrayValue"in n}function xT(n){return!!n&&"nullValue"in n}function bT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nm(n){return!!n&&"mapValue"in n}function pg(n){return(n?.mapValue?.fields||{})[xb]?.stringValue===bb}function uh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wo(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=uh(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=uh(n.arrayValue.values[t]);return e}return{...n}}function NN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===CN}const IN={mapValue:{fields:{[xb]:{stringValue:bb},[hu]:{arrayValue:{}}}}};function V5(n){return"nullValue"in n?em:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?jl(Rl.empty(),be.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?pg(n)?IN:{mapValue:{}}:Te(35942,{value:n})}function U5(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?jl(Rl.empty(),be.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?IN:"mapValue"in n?pg(n)?{mapValue:{}}:to:Te(61959,{value:n})}function _T(n,e){const t=po(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function ST(n,e){const t=po(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class rs{constructor(e){this.value=e}static empty(){return new rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!nm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=uh(t)}setAll(e){let t=Xt.emptyPath(),s={},i=[];e.forEach(((u,h)=>{if(!t.isImmediateParentOf(h)){const f=this.getFieldsMap(t);this.applyChanges(f,s,i),s={},i=[],t=h.popLast()}u?s[h.lastSegment()]=uh(u):i.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,s,i)}delete(e){const t=this.field(e.popLast());nm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Si(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=t.mapValue.fields[e.get(s)];nm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,s){wo(t,((i,o)=>e[i]=o));for(const i of s)delete e[i]}clone(){return new rs(uh(this.value))}}function RN(n){const e=[];return wo(n.fields,((t,s)=>{const i=new Xt([t]);if(nm(s)){const o=RN(s.mapValue).fields;if(o.length===0)e.push(i);else for(const u of o)e.push(i.child(u))}else e.push(i)})),new Ps(e)}class on{constructor(e,t,s,i,o,u,h){this.key=e,this.documentType=t,this.version=s,this.readTime=i,this.createTime=o,this.data=u,this.documentState=h}static newInvalidDocument(e){return new on(e,0,De.min(),De.min(),De.min(),rs.empty(),0)}static newFoundDocument(e,t,s,i){return new on(e,1,t,De.min(),s,i,0)}static newNoDocument(e,t){return new on(e,2,t,De.min(),De.min(),rs.empty(),0)}static newUnknownDocument(e,t){return new on(e,3,t,De.min(),De.min(),rs.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof on&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new on(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class mo{constructor(e,t){this.position=e,this.inclusive=t}}function wT(n,e,t){let s=0;for(let i=0;i<n.position.length;i++){const o=e[i],u=n.position[i];if(o.field.isKeyField()?s=be.comparator(be.fromName(u.referenceValue),t.key):s=po(u,t.data.field(o.field)),o.dir==="desc"&&(s*=-1),s!==0)break}return s}function ET(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Si(n.position[t],e.position[t]))return!1;return!0}class Ih{constructor(e,t="asc"){this.field=e,this.dir=t}}function B5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class jN{}class et extends jN{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new F5(e,t,s):t==="array-contains"?new H5(e,s):t==="in"?new LN(e,s):t==="not-in"?new G5(e,s):t==="array-contains-any"?new $5(e,s):new et(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new z5(e,s):new q5(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(po(t,this.value)):t!==null&&fo(this.value)===fo(t)&&this.matchesComparison(po(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class St extends jN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new St(e,t)}matches(e){return pu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pu(n){return n.op==="and"}function tx(n){return n.op==="or"}function _b(n){return DN(n)&&pu(n)}function DN(n){for(const e of n.filters)if(e instanceof St)return!1;return!0}function nx(n){if(n instanceof et)return n.field.canonicalString()+n.op.toString()+fu(n.value);if(_b(n))return n.filters.map((e=>nx(e))).join(",");{const e=n.filters.map((t=>nx(t))).join(",");return`${n.op}(${e})`}}function ON(n,e){return n instanceof et?(function(s,i){return i instanceof et&&s.op===i.op&&s.field.isEqual(i.field)&&Si(s.value,i.value)})(n,e):n instanceof St?(function(s,i){return i instanceof St&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce(((o,u,h)=>o&&ON(u,i.filters[h])),!0):!1})(n,e):void Te(19439)}function PN(n,e){const t=n.filters.concat(e);return St.create(t,n.op)}function kN(n){return n instanceof et?(function(t){return`${t.field.canonicalString()} ${t.op} ${fu(t.value)}`})(n):n instanceof St?(function(t){return t.op.toString()+" {"+t.getFilters().map(kN).join(" ,")+"}"})(n):"Filter"}class F5 extends et{constructor(e,t,s){super(e,t,s),this.key=be.fromName(s.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class z5 extends et{constructor(e,t){super(e,"in",t),this.keys=MN("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class q5 extends et{constructor(e,t){super(e,"not-in",t),this.keys=MN("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function MN(n,e){return(e.arrayValue?.values||[]).map((t=>be.fromName(t.referenceValue)))}class H5 extends et{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Nh(t)&&Ch(t.arrayValue,this.value)}}class LN extends et{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ch(this.value.arrayValue,t)}}class G5 extends et{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ch(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ch(this.value.arrayValue,t)}}class $5 extends et{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Nh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Ch(this.value.arrayValue,s)))}}class K5{constructor(e,t=null,s=[],i=[],o=null,u=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=i,this.limit=o,this.startAt=u,this.endAt=h,this.Te=null}}function sx(n,e=null,t=[],s=[],i=null,o=null,u=null){return new K5(n,e,t,s,i,o,u)}function Dl(n){const e=Ce(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>nx(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(o){return o.field.canonicalString()+o.dir})(s))).join(","),lg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>fu(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>fu(s))).join(",")),e.Te=t}return e.Te}function Gh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!B5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ON(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ET(n.startAt,e.startAt)&&ET(n.endAt,e.endAt)}function Rm(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function jm(n,e){return n.filters.filter((t=>t instanceof et&&t.field.isEqual(e)))}function TT(n,e,t){let s=em,i=!0;for(const o of jm(n,e)){let u=em,h=!0;switch(o.op){case"<":case"<=":u=V5(o.value);break;case"==":case"in":case">=":u=o.value;break;case">":u=o.value,h=!1;break;case"!=":case"not-in":u=em}_T({value:s,inclusive:i},{value:u,inclusive:h})<0&&(s=u,i=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];_T({value:s,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(s=u,i=t.inclusive);break}}return{value:s,inclusive:i}}function AT(n,e,t){let s=to,i=!0;for(const o of jm(n,e)){let u=to,h=!0;switch(o.op){case">=":case">":u=U5(o.value),h=!1;break;case"==":case"in":case"<=":u=o.value;break;case"<":u=o.value,h=!1;break;case"!=":case"not-in":u=to}ST({value:s,inclusive:i},{value:u,inclusive:h})>0&&(s=u,i=h)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const u=t.position[o];ST({value:s,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(s=u,i=t.inclusive);break}}return{value:s,inclusive:i}}class zl{constructor(e,t=null,s=[],i=[],o=null,u="F",h=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=i,this.limit=o,this.limitType=u,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function VN(n,e,t,s,i,o,u,h){return new zl(n,e,t,s,i,o,u,h)}function mg(n){return new zl(n)}function CT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sb(n){return n.collectionGroup!==null}function nu(n){const e=Ce(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new wt(Xt.comparator);return u.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Ih(o,s))})),t.has(Xt.keyField().canonicalString())||e.Ie.push(new Ih(Xt.keyField(),s))}return e.Ie}function er(n){const e=Ce(n);return e.Ee||(e.Ee=Q5(e,nu(n))),e.Ee}function Q5(n,e){if(n.limitType==="F")return sx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Ih(i.field,o)}));const t=n.endAt?new mo(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new mo(n.startAt.position,n.startAt.inclusive):null;return sx(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function rx(n,e){const t=n.filters.concat([e]);return new zl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Dm(n,e,t){return new zl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function gg(n,e){return Gh(er(n),er(e))&&n.limitType===e.limitType}function UN(n){return`${Dl(er(n))}|lt:${n.limitType}`}function Fc(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((i=>kN(i))).join(", ")}]`),lg(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((i=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(i))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((i=>fu(i))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((i=>fu(i))).join(",")),`Target(${s})`})(er(n))}; limitType=${n.limitType})`}function $h(n,e){return e.isFoundDocument()&&(function(s,i){const o=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(o):be.isDocumentKey(s.path)?s.path.isEqual(o):s.path.isImmediateParentOf(o)})(n,e)&&(function(s,i){for(const o of nu(s))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(s,i){for(const o of s.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(s,i){return!(s.startAt&&!(function(u,h,f){const p=wT(u,h,f);return u.inclusive?p<=0:p<0})(s.startAt,nu(s),i)||s.endAt&&!(function(u,h,f){const p=wT(u,h,f);return u.inclusive?p>=0:p>0})(s.endAt,nu(s),i))})(n,e)}function BN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function FN(n){return(e,t)=>{let s=!1;for(const i of nu(n)){const o=Y5(i,e,t);if(o!==0)return o;s=s||i.field.isKeyField()}return 0}}function Y5(n,e,t){const s=n.field.isKeyField()?be.comparator(e.key,t.key):(function(o,u,h){const f=u.data.field(o),p=h.data.field(o);return f!==null&&p!==null?po(f,p):Te(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Te(19790,{direction:n.dir})}}class aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[i,o]of s)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[t]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wo(this.inner,((t,s)=>{for(const[i,o]of s)e(i,o)}))}isEmpty(){return _N(this.inner)}size(){return this.innerSize}}const W5=new Ot(be.comparator);function Zs(){return W5}const zN=new Ot(be.comparator);function Xd(...n){let e=zN;for(const t of n)e=e.insert(t.key,t);return e}function qN(n){let e=zN;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function pi(){return dh()}function HN(){return dh()}function dh(){return new aa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const X5=new Ot(be.comparator),J5=new wt(be.comparator);function Ge(...n){let e=J5;for(const t of n)e=e.add(t);return e}const Z5=new wt(Me);function wb(){return Z5}function Eb(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_h(e)?"-0":e}}function GN(n){return{integerValue:""+n}}function eL(n,e){return uN(e)?GN(e):Eb(n,e)}class yg{constructor(){this._=void 0}}function tL(n,e,t){return n instanceof mu?(function(i,o){const u={fields:{[EN]:{stringValue:wN},[AN]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&hg(o)&&(o=fg(o)),o&&(u.fields[TN]=o),{mapValue:u}})(t,e):n instanceof Ol?KN(n,e):n instanceof Pl?QN(n,e):(function(i,o){const u=$N(i,o),h=NT(u)+NT(i.Ae);return ex(u)&&ex(i.Ae)?GN(h):Eb(i.serializer,h)})(n,e)}function nL(n,e,t){return n instanceof Ol?KN(n,e):n instanceof Pl?QN(n,e):t}function $N(n,e){return n instanceof Rh?(function(s){return ex(s)||(function(o){return!!o&&"doubleValue"in o})(s)})(e)?e:{integerValue:0}:null}class mu extends yg{}class Ol extends yg{constructor(e){super(),this.elements=e}}function KN(n,e){const t=YN(e);for(const s of n.elements)t.some((i=>Si(i,s)))||t.push(s);return{arrayValue:{values:t}}}class Pl extends yg{constructor(e){super(),this.elements=e}}function QN(n,e){let t=YN(e);for(const s of n.elements)t=t.filter((i=>!Si(i,s)));return{arrayValue:{values:t}}}class Rh extends yg{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function NT(n){return Ht(n.integerValue||n.doubleValue)}function YN(n){return Nh(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class vg{constructor(e,t){this.field=e,this.transform=t}}function sL(n,e){return n.field.isEqual(e.field)&&(function(s,i){return s instanceof Ol&&i instanceof Ol||s instanceof Pl&&i instanceof Pl?au(s.elements,i.elements,Si):s instanceof Rh&&i instanceof Rh?Si(s.Ae,i.Ae):s instanceof mu&&i instanceof mu})(n.transform,e.transform)}class rL{constructor(e,t){this.version=e,this.transformResults=t}}class On{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new On}static exists(e){return new On(void 0,e)}static updateTime(e){return new On(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class xg{}function WN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Kh(n.key,On.none()):new Ru(n.key,n.data,On.none());{const t=n.data,s=rs.empty();let i=new wt(Xt.comparator);for(let o of e.fields)if(!i.has(o)){let u=t.field(o);u===null&&o.length>1&&(o=o.popLast(),u=t.field(o)),u===null?s.delete(o):s.set(o,u),i=i.add(o)}return new oa(n.key,s,new Ps(i.toArray()),On.none())}}function iL(n,e,t){n instanceof Ru?(function(i,o,u){const h=i.value.clone(),f=RT(i.fieldTransforms,o,u.transformResults);h.setAll(f),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(n,e,t):n instanceof oa?(function(i,o,u){if(!sm(i.precondition,o))return void o.convertToUnknownDocument(u.version);const h=RT(i.fieldTransforms,o,u.transformResults),f=o.data;f.setAll(XN(i)),f.setAll(h),o.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):(function(i,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function hh(n,e,t,s){return n instanceof Ru?(function(o,u,h,f){if(!sm(o.precondition,u))return h;const p=o.value.clone(),g=jT(o.fieldTransforms,f,u);return p.setAll(g),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null})(n,e,t,s):n instanceof oa?(function(o,u,h,f){if(!sm(o.precondition,u))return h;const p=jT(o.fieldTransforms,f,u),g=u.data;return g.setAll(XN(o)),g.setAll(p),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((x=>x.field)))})(n,e,t,s):(function(o,u,h){return sm(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(n,e,t)}function aL(n,e){let t=null;for(const s of n.fieldTransforms){const i=e.data.field(s.field),o=$N(s.transform,i||null);o!=null&&(t===null&&(t=rs.empty()),t.set(s.field,o))}return t||null}function IT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&au(s,i,((o,u)=>sL(o,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ru extends xg{constructor(e,t,s,i=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class oa extends xg{constructor(e,t,s,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function XN(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function RT(n,e,t){const s=new Map;Ie(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){const o=n[i],u=o.transform,h=e.data.field(o.field);s.set(o.field,nL(u,h,t[i]))}return s}function jT(n,e,t){const s=new Map;for(const i of n){const o=i.transform,u=t.data.field(i.field);s.set(i.field,tL(o,u,e))}return s}class Kh extends xg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JN extends xg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Tb{constructor(e,t,s,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&iL(o,e,s[i])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=hh(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=hh(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=HN();return this.mutations.forEach((i=>{const o=e.get(i.key),u=o.overlayedDocument;let h=this.applyToLocalView(u,o.mutatedFields);h=t.has(i.key)?null:h;const f=WN(u,h);f!==null&&s.set(i.key,f),u.isValidDocument()||u.convertToNoDocument(De.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ge())}isEqual(e){return this.batchId===e.batchId&&au(this.mutations,e.mutations,((t,s)=>IT(t,s)))&&au(this.baseMutations,e.baseMutations,((t,s)=>IT(t,s)))}}class Ab{constructor(e,t,s,i){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=i}static from(e,t,s){Ie(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let i=(function(){return X5})();const o=e.mutations;for(let u=0;u<o.length;u++)i=i.insert(o[u].key,s[u].version);return new Ab(e,t,s,i)}}class Cb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class oL{constructor(e,t){this.count=e,this.unchangedNames=t}}var An,st;function lL(n){switch(n){case ae.OK:return Te(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Te(15467,{code:n})}}function ZN(n){if(n===void 0)return pn("GRPC error has no .code"),ae.UNKNOWN;switch(n){case An.OK:return ae.OK;case An.CANCELLED:return ae.CANCELLED;case An.UNKNOWN:return ae.UNKNOWN;case An.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case An.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case An.INTERNAL:return ae.INTERNAL;case An.UNAVAILABLE:return ae.UNAVAILABLE;case An.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case An.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case An.NOT_FOUND:return ae.NOT_FOUND;case An.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case An.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case An.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case An.ABORTED:return ae.ABORTED;case An.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case An.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case An.DATA_LOSS:return ae.DATA_LOSS;default:return Te(39323,{code:n})}}(st=An||(An={}))[st.OK=0]="OK",st[st.CANCELLED=1]="CANCELLED",st[st.UNKNOWN=2]="UNKNOWN",st[st.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",st[st.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",st[st.NOT_FOUND=5]="NOT_FOUND",st[st.ALREADY_EXISTS=6]="ALREADY_EXISTS",st[st.PERMISSION_DENIED=7]="PERMISSION_DENIED",st[st.UNAUTHENTICATED=16]="UNAUTHENTICATED",st[st.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",st[st.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",st[st.ABORTED=10]="ABORTED",st[st.OUT_OF_RANGE=11]="OUT_OF_RANGE",st[st.UNIMPLEMENTED=12]="UNIMPLEMENTED",st[st.INTERNAL=13]="INTERNAL",st[st.UNAVAILABLE=14]="UNAVAILABLE",st[st.DATA_LOSS=15]="DATA_LOSS";function cL(){return new TextEncoder}const uL=new ao([4294967295,4294967295],0);function DT(n){const e=cL().encode(n),t=new QC;return t.update(e),new Uint8Array(t.digest())}function OT(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ao([t,s],0),new ao([i,o],0)]}class Nb{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Jd(`Invalid padding: ${t}`);if(s<0)throw new Jd(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Jd(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Jd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ao.fromNumber(this.ge)}ye(e,t,s){let i=e.add(t.multiply(ao.fromNumber(s)));return i.compare(uL)===1&&(i=new ao([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=DT(e),[s,i]=OT(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(s,i,o);if(!this.we(u))return!1}return!0}static create(e,t,s){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new Nb(o,i,t);return s.forEach((h=>u.insert(h))),u}insert(e){if(this.ge===0)return;const t=DT(e),[s,i]=OT(t);for(let o=0;o<this.hashCount;o++){const u=this.ye(s,i,o);this.Se(u)}}Se(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Jd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Qh{constructor(e,t,s,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const i=new Map;return i.set(e,Yh.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Qh(De.min(),i,new Ot(Me),Zs(),Ge())}}class Yh{constructor(e,t,s,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Yh(s,t,Ge(),Ge(),Ge())}}class rm{constructor(e,t,s,i){this.be=e,this.removedTargetIds=t,this.key=s,this.De=i}}class eI{constructor(e,t){this.targetId=e,this.Ce=t}}class tI{constructor(e,t,s=yn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=i}}class PT{constructor(){this.ve=0,this.Fe=kT(),this.Me=yn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ge(),t=Ge(),s=Ge();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:s=s.add(i);break;default:Te(38017,{changeType:o})}})),new Yh(this.Me,this.xe,e,t,s)}qe(){this.Oe=!1,this.Fe=kT()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ie(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class dL{constructor(e){this.Ge=e,this.ze=new Map,this.je=Zs(),this.Je=Pp(),this.He=Pp(),this.Ye=new Ot(Me)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const s=this.nt(t);switch(e.state){case 0:this.rt(t)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),s.Le(e.resumeToken));break;default:Te(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((s,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,s=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(Rm(o))if(s===0){const u=new be(o.path);this.et(t,u,on.newNoDocument(u,De.min()))}else Ie(s===1,20013,{expectedCount:s});else{const u=this._t(t);if(u!==s){const h=this.ut(e),f=h?this.ct(h,e,u):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:o=0}=t;let u,h;try{u=sa(s).toUint8Array()}catch(f){if(f instanceof SN)return Il("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Nb(u,i,o)}catch(f){return Il(f instanceof Jd?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,t,s){return t.Ce.count===s-this.Pt(e,t.targetId)?0:2}Pt(e,t){const s=this.Ge.getRemoteKeysForTarget(t);let i=0;return s.forEach((o=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,u)=>{const h=this.ot(u);if(h){if(o.current&&Rm(h.target)){const f=new be(h.target.path);this.It(f).has(u)||this.Et(u,f)||this.et(u,f,on.newNoDocument(f,e))}o.Be&&(t.set(u,o.ke()),o.qe())}}));let s=Ge();this.He.forEach(((o,u)=>{let h=!0;u.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(s=s.add(o))})),this.je.forEach(((o,u)=>u.setReadTime(e)));const i=new Qh(e,t,this.Ye,this.je,s);return this.je=Zs(),this.Je=Pp(),this.He=Pp(),this.Ye=new Ot(Me),i}Xe(e,t){if(!this.rt(e))return;const s=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,s),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,s){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),s&&(this.je=this.je.insert(t,s))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new PT,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new wt(Me),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new wt(Me),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new PT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Pp(){return new Ot(be.comparator)}function kT(){return new Ot(be.comparator)}const hL={asc:"ASCENDING",desc:"DESCENDING"},fL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pL={and:"AND",or:"OR"};class mL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ix(n,e){return n.useProto3Json||lg(e)?e:{value:e}}function gu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gL(n,e){return gu(n,e.toTimestamp())}function gs(n){return Ie(!!n,49232),De.fromTimestamp((function(t){const s=na(t);return new _t(s.seconds,s.nanos)})(n))}function Ib(n,e){return ax(n,e).canonicalString()}function ax(n,e){const t=(function(i){return new dt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function sI(n){const e=dt.fromString(n);return Ie(hI(e),10190,{key:e.toString()}),e}function Om(n,e){return Ib(n.databaseId,e.path)}function bl(n,e){const t=sI(e);if(t.get(1)!==n.databaseId.projectId)throw new ve(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ve(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(aI(t))}function rI(n,e){return Ib(n.databaseId,e)}function iI(n){const e=sI(n);return e.length===4?dt.emptyPath():aI(e)}function ox(n){return new dt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function aI(n){return Ie(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function MT(n,e,t){return{name:Om(n,e),fields:t.value.mapValue.fields}}function yL(n,e,t){const s=bl(n,e.name),i=gs(e.updateTime),o=e.createTime?gs(e.createTime):De.min(),u=new rs({mapValue:{fields:e.fields}}),h=on.newFoundDocument(s,i,o,u);return t&&h.setHasCommittedMutations(),t?h.setHasCommittedMutations():h}function vL(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Te(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(p,g){return p.useProto3Json?(Ie(g===void 0||typeof g=="string",58123),yn.fromBase64String(g||"")):(Ie(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),yn.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&(function(p){const g=p.code===void 0?ae.UNKNOWN:ZN(p.code);return new ve(g,p.message||"")})(u);t=new tI(s,i,o,h||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=bl(n,s.document.name),o=gs(s.document.updateTime),u=s.document.createTime?gs(s.document.createTime):De.min(),h=new rs({mapValue:{fields:s.document.fields}}),f=on.newFoundDocument(i,o,u,h),p=s.targetIds||[],g=s.removedTargetIds||[];t=new rm(p,g,f.key,f)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=bl(n,s.document),o=s.readTime?gs(s.readTime):De.min(),u=on.newNoDocument(i,o),h=s.removedTargetIds||[];t=new rm([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=bl(n,s.document),o=s.removedTargetIds||[];t=new rm([],o,i,null)}else{if(!("filter"in e))return Te(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:o}=s,u=new oL(i,o),h=s.targetId;t=new eI(h,u)}}return t}function Pm(n,e){let t;if(e instanceof Ru)t={update:MT(n,e.key,e.value)};else if(e instanceof Kh)t={delete:Om(n,e.key)};else if(e instanceof oa)t={update:MT(n,e.key,e.data),updateMask:EL(e.fieldMask)};else{if(!(e instanceof JN))return Te(16599,{Vt:e.type});t={verify:Om(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(o,u){const h=u.transform;if(h instanceof mu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Ol)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Pl)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Rh)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw Te(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:gL(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Te(27497)})(n,e.precondition)),t}function lx(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?On.updateTime(gs(o.updateTime)):o.exists!==void 0?On.exists(o.exists):On.none()})(e.currentDocument):On.none(),s=e.updateTransforms?e.updateTransforms.map((i=>(function(u,h){let f=null;if("setToServerValue"in h)Ie(h.setToServerValue==="REQUEST_TIME",16630,{proto:h}),f=new mu;else if("appendMissingElements"in h){const g=h.appendMissingElements.values||[];f=new Ol(g)}else if("removeAllFromArray"in h){const g=h.removeAllFromArray.values||[];f=new Pl(g)}else"increment"in h?f=new Rh(u,h.increment):Te(16584,{proto:h});const p=Xt.fromServerFormat(h.fieldPath);return new vg(p,f)})(n,i))):[];if(e.update){e.update.name;const i=bl(n,e.update.name),o=new rs({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(f){const p=f.fieldPaths||[];return new Ps(p.map((g=>Xt.fromServerFormat(g))))})(e.updateMask);return new oa(i,o,u,t,s)}return new Ru(i,o,t,s)}if(e.delete){const i=bl(n,e.delete);return new Kh(i,t)}if(e.verify){const i=bl(n,e.verify);return new JN(i,t)}return Te(1463,{proto:e})}function xL(n,e){return n&&n.length>0?(Ie(e!==void 0,14353),n.map((t=>(function(i,o){let u=i.updateTime?gs(i.updateTime):gs(o);return u.isEqual(De.min())&&(u=gs(o)),new rL(u,i.transformResults||[])})(t,e)))):[]}function oI(n,e){return{documents:[rI(n,e.path)]}}function lI(n,e){const t={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=rI(n,i);const o=(function(p){if(p.length!==0)return dI(St.create(p,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const u=(function(p){if(p.length!==0)return p.map((g=>(function(b){return{field:zc(b.field),direction:_L(b.dir)}})(g)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const h=ix(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:i}}function cI(n){let e=iI(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let i=null;if(s>0){Ie(s===1,65062);const g=t.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let o=[];t.where&&(o=(function(x){const b=uI(x);return b instanceof St&&_b(b)?b.getFilters():[b]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((b=>(function(w){return new Ih(qc(w.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(b)))})(t.orderBy));let h=null;t.limit&&(h=(function(x){let b;return b=typeof x=="object"?x.value:x,lg(b)?null:b})(t.limit));let f=null;t.startAt&&(f=(function(x){const b=!!x.before,S=x.values||[];return new mo(S,b)})(t.startAt));let p=null;return t.endAt&&(p=(function(x){const b=!x.before,S=x.values||[];return new mo(S,b)})(t.endAt)),VN(e,i,u,o,h,"F",f,p)}function bL(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Te(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function uI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=qc(t.unaryFilter.field);return et.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=qc(t.unaryFilter.field);return et.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=qc(t.unaryFilter.field);return et.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=qc(t.unaryFilter.field);return et.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Te(61313);default:return Te(60726)}})(n):n.fieldFilter!==void 0?(function(t){return et.create(qc(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Te(58110);default:return Te(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return St.create(t.compositeFilter.filters.map((s=>uI(s))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Te(1026)}})(t.compositeFilter.op))})(n):Te(30097,{filter:n})}function _L(n){return hL[n]}function SL(n){return fL[n]}function wL(n){return pL[n]}function zc(n){return{fieldPath:n.canonicalString()}}function qc(n){return Xt.fromServerFormat(n.fieldPath)}function dI(n){return n instanceof et?(function(t){if(t.op==="=="){if(bT(t.value))return{unaryFilter:{field:zc(t.field),op:"IS_NAN"}};if(xT(t.value))return{unaryFilter:{field:zc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bT(t.value))return{unaryFilter:{field:zc(t.field),op:"IS_NOT_NAN"}};if(xT(t.value))return{unaryFilter:{field:zc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zc(t.field),op:SL(t.op),value:t.value}}})(n):n instanceof St?(function(t){const s=t.getFilters().map((i=>dI(i)));return s.length===1?s[0]:{compositeFilter:{op:wL(t.op),filters:s}}})(n):Te(54877,{filter:n})}function EL(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function hI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Yi{constructor(e,t,s,i,o=De.min(),u=De.min(),h=yn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new Yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class fI{constructor(e){this.yt=e}}function TL(n,e){let t;if(e.document)t=yL(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=be.fromSegments(e.noDocument.path),i=Ml(e.noDocument.readTime);t=on.newNoDocument(s,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Te(56709);{const s=be.fromSegments(e.unknownDocument.path),i=Ml(e.unknownDocument.version);t=on.newUnknownDocument(s,i)}}return e.readTime&&t.setReadTime((function(i){const o=new _t(i[0],i[1]);return De.fromTimestamp(o)})(e.readTime)),t}function LT(n,e){const t=e.key,s={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:km(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=(function(o,u){return{name:Om(o,u.key),fields:u.data.value.mapValue.fields,updateTime:gu(o,u.version.toTimestamp()),createTime:gu(o,u.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())s.noDocument={path:t.path.toArray(),readTime:kl(e.version)};else{if(!e.isUnknownDocument())return Te(57904,{document:e});s.unknownDocument={path:t.path.toArray(),version:kl(e.version)}}return s}function km(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function kl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ml(n){const e=new _t(n.seconds,n.nanoseconds);return De.fromTimestamp(e)}function ll(n,e){const t=(e.baseMutations||[]).map((o=>lx(n.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const u=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const h=e.mutations[o+1];u.updateTransforms=h.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const s=e.mutations.map((o=>lx(n.yt,o))),i=_t.fromMillis(e.localWriteTimeMs);return new Tb(e.batchId,i,t,s)}function Zd(n){const e=Ml(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ml(n.lastLimboFreeSnapshotVersion):De.min();let s;return s=(function(o){return o.documents!==void 0})(n.query)?(function(o){const u=o.documents.length;return Ie(u===1,1966,{count:u}),er(mg(iI(o.documents[0])))})(n.query):(function(o){return er(cI(o))})(n.query),new Yi(s,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,yn.fromBase64String(n.resumeToken))}function pI(n,e){const t=kl(e.snapshotVersion),s=kl(e.lastLimboFreeSnapshotVersion);let i;i=Rm(e.target)?oI(n.yt,e.target):lI(n.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Dl(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:i}}function mI(n){const e=cI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Dm(e,e.limit,"L"):e}function r0(n,e){return new Cb(e.largestBatchId,lx(n.yt,e.overlayMutation))}function VT(n,e){const t=e.path.lastSegment();return[n,cs(e.path.popLast()),t]}function UT(n,e,t,s){return{indexId:n,uid:e,sequenceNumber:t,readTime:kl(s.readTime),documentKey:cs(s.documentKey.path),largestBatchId:s.largestBatchId}}class AL{getBundleMetadata(e,t){return BT(e).get(t).next((s=>{if(s)return(function(o){return{id:o.bundleId,createTime:Ml(o.createTime),version:o.version}})(s)}))}saveBundleMetadata(e,t){return BT(e).put((function(i){return{bundleId:i.id,createTime:kl(gs(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return FT(e).get(t).next((s=>{if(s)return(function(o){return{name:o.name,query:mI(o.bundledQuery),readTime:Ml(o.readTime)}})(s)}))}saveNamedQuery(e,t){return FT(e).put((function(i){return{name:i.name,readTime:kl(gs(i.readTime)),bundledQuery:i.bundledQuery}})(t))}}function BT(n){return Mn(n,cg)}function FT(n){return Mn(n,ug)}class bg{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const s=t.uid||"";return new bg(e,s)}getOverlay(e,t){return Bd(e).get(VT(this.userId,t)).next((s=>s?r0(this.serializer,s):null))}getOverlays(e,t){const s=pi();return X.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&s.set(i,o)})))).next((()=>s))}saveOverlays(e,t,s){const i=[];return s.forEach(((o,u)=>{const h=new Cb(t,u);i.push(this.St(e,h))})),X.waitFor(i)}removeOverlaysForBatchId(e,t,s){const i=new Set;t.forEach((u=>i.add(cs(u.getCollectionPath()))));const o=[];return i.forEach((u=>{const h=IDBKeyRange.bound([this.userId,u,s],[this.userId,u,s+1],!1,!0);o.push(Bd(e).Z(X0,h))})),X.waitFor(o)}getOverlaysForCollection(e,t,s){const i=pi(),o=cs(t),u=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Bd(e).J(X0,u).next((h=>{for(const f of h){const p=r0(this.serializer,f);i.set(p.getKey(),p)}return i}))}getOverlaysForCollectionGroup(e,t,s,i){const o=pi();let u;const h=IDBKeyRange.bound([this.userId,t,s],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Bd(e).ee({index:gN,range:h},((f,p,g)=>{const x=r0(this.serializer,p);o.size()<i||x.largestBatchId===u?(o.set(x.getKey(),x),u=x.largestBatchId):g.done()})).next((()=>o))}St(e,t){return Bd(e).put((function(i,o,u){const[h,f,p]=VT(o,u.mutation.key);return{userId:o,collectionPath:f,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:Pm(i.yt,u.mutation)}})(this.serializer,this.userId,t))}}function Bd(n){return Mn(n,dg)}class CL{bt(e){return Mn(e,yb)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const s=t?.value;return s?yn.fromUint8Array(s):yn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class cl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Ht(e.integerValue));else if("doubleValue"in e){const s=Ht(e.doubleValue);isNaN(s)?this.Ft(t,13):(this.Ft(t,15),_h(s)?t.Mt(0):t.Mt(s))}else if("timestampValue"in e){let s=e.timestampValue;this.Ft(t,20),typeof s=="string"&&(s=na(s)),t.xt(`${s.seconds||""}`),t.Mt(s.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(sa(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const s=e.geoPointValue;this.Ft(t,45),t.Mt(s.latitude||0),t.Mt(s.longitude||0)}else"mapValue"in e?NN(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):pg(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Te(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const s=e.fields||{};this.Ft(t,55);for(const i of Object.keys(s))this.Ot(i,t),this.Ct(s[i],t)}kt(e,t){const s=e.fields||{};this.Ft(t,53);const i=hu,o=s[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Ht(o)),this.Ot(i,t),this.Ct(s[i],t)}Qt(e,t){const s=e.values||[];this.Ft(t,50);for(const i of s)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),be.fromName(e).path.forEach((s=>{this.Ft(t,60),this.Ut(s,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}cl.Kt=new cl;const Mc=255;function NL(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function zT(n){const e=64-(function(s){let i=0;for(let o=0;o<8;++o){const u=NL(255&s[o]);if(i+=u,u!==8)break}return i})(n);return Math.ceil(e/8)}class IL{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Gt(s.value),s=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let s=t.next();for(;!s.done;)this.Jt(s.value),s=t.next();this.Ht()}Yt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Gt(s);else if(s<2048)this.Gt(960|s>>>6),this.Gt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s);else{const i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const t of e){const s=t.charCodeAt(0);if(s<128)this.Jt(s);else if(s<2048)this.Jt(960|s>>>6),this.Jt(128|63&s);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const t=this.en(e),s=zT(t);this.tn(1+s),this.buffer[this.position++]=255&s;for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){const t=this.en(e),s=zT(t);this.tn(1+s),this.buffer[this.position++]=~(255&s);for(let i=t.length-s;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(Mc),this.sn(255)}_n(){this.an(Mc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,o,!1),new Uint8Array(u.buffer)})(e),s=!!(128&t[0]);t[0]^=s?255:128;for(let i=1;i<t.length;++i)t[i]^=s?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Mc?(this.sn(Mc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Mc?(this.an(Mc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let s=2*this.buffer.length;s<t&&(s=t);const i=new Uint8Array(s);i.set(this.buffer),this.buffer=i}}class RL{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class jL{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Fd{constructor(){this.cn=new IL,this.ln=new RL(this.cn),this.hn=new jL(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class ul{constructor(e,t,s,i){this.Tn=e,this.In=t,this.En=s,this.dn=i}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,s=new Uint8Array(t);return s.set(this.dn,0),t!==e?s.set([0],this.dn.length):++s[s.length-1],new ul(this.Tn,this.In,this.En,s)}Rn(e,t,s){return{indexId:this.Tn,uid:e,arrayValue:im(this.En),directionalValue:im(this.dn),orderedDocumentKey:im(t),documentKey:s.path.toArray()}}Vn(e,t,s){const i=this.Rn(e,t,s);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Ha(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=qT(n.En,e.En),t!==0?t:(t=qT(n.dn,e.dn),t!==0?t:be.comparator(n.In,e.In)))}function qT(n,e){for(let t=0;t<n.length&&t<e.length;++t){const s=n[t]-e[t];if(s!==0)return s}return n.length-e.length}function im(n){return aC()?(function(t){let s="";for(let i=0;i<t.length;i++)s+=String.fromCharCode(t[i]);return s})(n):n}function HT(n){return typeof n!="string"?n:(function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s})(n)}class GT{constructor(e){this.mn=new wt(((t,s)=>Xt.comparator(t.field,s.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const s=t;s.isInequality()?this.mn=this.mn.add(s):this.gn.push(s)}}get pn(){return this.mn.size>1}yn(e){if(Ie(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Q0(e);if(t!==void 0&&!this.wn(t))return!1;const s=il(e);let i=new Set,o=0,u=0;for(;o<s.length&&this.wn(s[o]);++o)i=i.add(s[o].fieldPath.canonicalString());if(o===s.length)return!0;if(this.mn.size>0){const h=this.mn.getIterator().getNext();if(!i.has(h.field.canonicalString())){const f=s[o];if(!this.Sn(h,f)||!this.bn(this.fn[u++],f))return!1}++o}for(;o<s.length;++o){const h=s[o];if(u>=this.fn.length||!this.bn(this.fn[u++],h))return!1}return!0}Dn(){if(this.pn)return null;let e=new wt(Xt.comparator);const t=[];for(const s of this.gn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")t.push(new Xp(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),t.push(new Xp(s.field,0))}for(const s of this.fn)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),t.push(new Xp(s.field,s.dir==="asc"?0:1)));return new Am(Am.UNKNOWN_ID,this.collectionId,t,bh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===s}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function gI(n){if(Ie(n instanceof et||n instanceof St,20012),n instanceof et){if(n instanceof LN){const t=n.value.arrayValue?.values?.map((s=>et.create(n.field,"==",s)))||[];return St.create(t,"or")}return n}const e=n.filters.map((t=>gI(t)));return St.create(e,n.op)}function DL(n){if(n.getFilters().length===0)return[];const e=dx(gI(n));return Ie(yI(e),7391),cx(e)||ux(e)?[e]:e.getFilters()}function cx(n){return n instanceof et}function ux(n){return n instanceof St&&_b(n)}function yI(n){return cx(n)||ux(n)||(function(t){if(t instanceof St&&tx(t)){for(const s of t.getFilters())if(!cx(s)&&!ux(s))return!1;return!0}return!1})(n)}function dx(n){if(Ie(n instanceof et||n instanceof St,34018),n instanceof et)return n;if(n.filters.length===1)return dx(n.filters[0]);const e=n.filters.map((s=>dx(s)));let t=St.create(e,n.op);return t=Mm(t),yI(t)?t:(Ie(t instanceof St,64498),Ie(pu(t),40251),Ie(t.filters.length>1,57927),t.filters.reduce(((s,i)=>Rb(s,i))))}function Rb(n,e){let t;return Ie(n instanceof et||n instanceof St,38388),Ie(e instanceof et||e instanceof St,25473),t=n instanceof et?e instanceof et?(function(i,o){return St.create([i,o],"and")})(n,e):$T(n,e):e instanceof et?$T(e,n):(function(i,o){if(Ie(i.filters.length>0&&o.filters.length>0,48005),pu(i)&&pu(o))return PN(i,o.getFilters());const u=tx(i)?i:o,h=tx(i)?o:i,f=u.filters.map((p=>Rb(p,h)));return St.create(f,"or")})(n,e),Mm(t)}function $T(n,e){if(pu(e))return PN(e,n.getFilters());{const t=e.filters.map((s=>Rb(n,s)));return St.create(t,"or")}}function Mm(n){if(Ie(n instanceof et||n instanceof St,11850),n instanceof et)return n;const e=n.getFilters();if(e.length===1)return Mm(e[0]);if(DN(n))return n;const t=e.map((i=>Mm(i))),s=[];return t.forEach((i=>{i instanceof et?s.push(i):i instanceof St&&(i.op===n.op?s.push(...i.filters):s.push(i))})),s.length===1?s[0]:St.create(s,n.op)}class OL{constructor(){this.Cn=new jb}addToCollectionParentIndex(e,t){return this.Cn.add(t),X.resolve()}getCollectionParents(e,t){return X.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return X.resolve()}deleteFieldIndex(e,t){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,t){return X.resolve()}getDocumentsMatchingTarget(e,t){return X.resolve(null)}getIndexType(e,t){return X.resolve(0)}getFieldIndexes(e,t){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,t){return X.resolve(sr.min())}getMinOffsetFromCollectionGroup(e,t){return X.resolve(sr.min())}updateCollectionGroup(e,t,s){return X.resolve()}updateIndexEntries(e,t){return X.resolve()}}class jb{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t]||new wt(dt.comparator),o=!i.has(s);return this.index[t]=i.add(s),o}has(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t];return i&&i.has(s)}getEntries(e){return(this.index[e]||new wt(dt.comparator)).toArray()}}const KT="IndexedDbIndexManager",kp=new Uint8Array(0);class PL{constructor(e,t){this.databaseId=t,this.vn=new jb,this.Fn=new aa((s=>Dl(s)),((s,i)=>Gh(s,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const s=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const o={collectionId:s,parent:cs(i)};return QT(e).put(o)}return X.resolve()}getCollectionParents(e,t){const s=[],i=IDBKeyRange.bound([t,""],[nN(t),""],!1,!0);return QT(e).J(i).next((o=>{for(const u of o){if(u.collectionId!==t)break;s.push(fi(u.parent))}return s}))}addFieldIndex(e,t){const s=zd(e),i=(function(h){return{indexId:h.indexId,collectionGroup:h.collectionGroup,fields:h.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete i.indexId;const o=s.add(i);if(t.indexState){const u=Vc(e);return o.next((h=>{u.put(UT(h,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const s=zd(e),i=Vc(e),o=Lc(e);return s.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=zd(e),s=Lc(e),i=Vc(e);return t.Z().next((()=>s.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return X.forEach(this.Mn(t),(s=>this.getIndexType(e,s).next((i=>{if(i===0||i===1){const o=new GT(s).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const s=Lc(e);let i=!0;const o=new Map;return X.forEach(this.Mn(t),(u=>this.xn(e,u).next((h=>{i&&(i=!!h),o.set(u,h)})))).next((()=>{if(i){let u=Ge();const h=[];return X.forEach(o,((f,p)=>{ye(KT,`Using index ${(function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map((F=>`${F.fieldPath}:${F.kind}`)).join(",")}`})(f)} to execute ${Dl(t)}`);const g=(function(U,F){const K=Q0(F);if(K===void 0)return null;for(const Z of jm(U,K.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null})(p,f),x=(function(U,F){const K=new Map;for(const Z of il(F))for(const j of jm(U,Z.fieldPath))switch(j.op){case"==":case"in":K.set(Z.fieldPath.canonicalString(),j.value);break;case"not-in":case"!=":return K.set(Z.fieldPath.canonicalString(),j.value),Array.from(K.values())}return null})(p,f),b=(function(U,F){const K=[];let Z=!0;for(const j of il(F)){const N=j.kind===0?TT(U,j.fieldPath,U.startAt):AT(U,j.fieldPath,U.startAt);K.push(N.value),Z&&(Z=N.inclusive)}return new mo(K,Z)})(p,f),S=(function(U,F){const K=[];let Z=!0;for(const j of il(F)){const N=j.kind===0?AT(U,j.fieldPath,U.endAt):TT(U,j.fieldPath,U.endAt);K.push(N.value),Z&&(Z=N.inclusive)}return new mo(K,Z)})(p,f),w=this.On(f,p,b),A=this.On(f,p,S),C=this.Nn(f,p,x),L=this.Bn(f.indexId,g,w,b.inclusive,A,S.inclusive,C);return X.forEach(L,(z=>s.Y(z,t.limit).next((U=>{U.forEach((F=>{const K=be.fromSegments(F.documentKey);u.has(K)||(u=u.add(K),h.push(K))}))}))))})).next((()=>h))}return X.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=DL(St.create(e.filters,"and")).map((s=>sx(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,s,i,o,u,h){const f=(t!=null?t.length:1)*Math.max(s.length,o.length),p=f/(t!=null?t.length:1),g=[];for(let x=0;x<f;++x){const b=t?this.Ln(t[x/p]):kp,S=this.kn(e,b,s[x%p],i),w=this.qn(e,b,o[x%p],u),A=h.map((C=>this.kn(e,b,C,!0)));g.push(...this.createRange(S,w,A))}return g}kn(e,t,s,i){const o=new ul(e,be.empty(),t,s);return i?o:o.An()}qn(e,t,s,i){const o=new ul(e,be.empty(),t,s);return i?o.An():o}xn(e,t){const s=new GT(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((o=>{let u=null;for(const h of o)s.yn(h)&&(!u||h.fields.length>u.fields.length)&&(u=h);return u}))}getIndexType(e,t){let s=2;const i=this.Mn(t);return X.forEach(i,(o=>this.xn(e,o).next((u=>{u?s!==0&&u.fields.length<(function(f){let p=new wt(Xt.comparator),g=!1;for(const x of f.filters)for(const b of x.getFlattenedFilters())b.field.isKeyField()||(b.op==="array-contains"||b.op==="array-contains-any"?g=!0:p=p.add(b.field));for(const x of f.orderBy)x.field.isKeyField()||(p=p.add(x.field));return p.size+(g?1:0)})(o)&&(s=1):s=0})))).next((()=>(function(u){return u.limit!==null})(t)&&i.length>1&&s===2?1:s))}Qn(e,t){const s=new Fd;for(const i of il(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const u=s.Pn(i.kind);cl.Kt.Dt(o,u)}return s.un()}Ln(e){const t=new Fd;return cl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const s=new Fd;return cl.Kt.Dt(jl(this.databaseId,t),s.Pn((function(o){const u=il(o);return u.length===0?0:u[u.length-1].kind})(e))),s.un()}Nn(e,t,s){if(s===null)return[];let i=[];i.push(new Fd);let o=0;for(const u of il(e)){const h=s[o++];for(const f of i)if(this.Un(t,u.fieldPath)&&Nh(h))i=this.Kn(i,u,h);else{const p=f.Pn(u.kind);cl.Kt.Dt(h,p)}}return this.Wn(i)}On(e,t,s){return this.Nn(e,t,s.position)}Wn(e){const t=[];for(let s=0;s<e.length;++s)t[s]=e[s].un();return t}Kn(e,t,s){const i=[...e],o=[];for(const u of s.arrayValue.values||[])for(const h of i){const f=new Fd;f.seed(h.un()),cl.Kt.Dt(u,f.Pn(t.kind)),o.push(f)}return o}Un(e,t){return!!e.filters.find((s=>s instanceof et&&s.field.isEqual(t)&&(s.op==="in"||s.op==="not-in")))}getFieldIndexes(e,t){const s=zd(e),i=Vc(e);return(t?s.J(W0,IDBKeyRange.bound(t,t)):s.J()).next((o=>{const u=[];return X.forEach(o,(h=>i.get([h.indexId,this.uid]).next((f=>{u.push((function(g,x){const b=x?new bh(x.sequenceNumber,new sr(Ml(x.readTime),new be(fi(x.documentKey)),x.largestBatchId)):bh.empty(),S=g.fields.map((([w,A])=>new Xp(Xt.fromServerFormat(w),A)));return new Am(g.indexId,g.collectionGroup,S,b)})(h,f))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((s,i)=>{const o=s.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:Me(s.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,s){const i=zd(e),o=Vc(e);return this.Gn(e).next((u=>i.J(W0,IDBKeyRange.bound(t,t)).next((h=>X.forEach(h,(f=>o.put(UT(f.indexId,this.uid,u,s))))))))}updateIndexEntries(e,t){const s=new Map;return X.forEach(t,((i,o)=>{const u=s.get(i.collectionGroup);return(u?X.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next((h=>(s.set(i.collectionGroup,h),X.forEach(h,(f=>this.zn(e,i,f).next((p=>{const g=this.jn(o,f);return p.isEqual(g)?X.resolve():this.Jn(e,o,f,p,g)})))))))}))}Hn(e,t,s,i){return Lc(e).put(i.Rn(this.uid,this.$n(s,t.key),t.key))}Yn(e,t,s,i){return Lc(e).delete(i.Vn(this.uid,this.$n(s,t.key),t.key))}zn(e,t,s){const i=Lc(e);let o=new wt(Ha);return i.ee({index:mN,range:IDBKeyRange.only([s.indexId,this.uid,im(this.$n(s,t))])},((u,h)=>{o=o.add(new ul(s.indexId,t,HT(h.arrayValue),HT(h.directionalValue)))})).next((()=>o))}jn(e,t){let s=new wt(Ha);const i=this.Qn(t,e);if(i==null)return s;const o=Q0(t);if(o!=null){const u=e.data.field(o.fieldPath);if(Nh(u))for(const h of u.arrayValue.values||[])s=s.add(new ul(t.indexId,e.key,this.Ln(h),i))}else s=s.add(new ul(t.indexId,e.key,kp,i));return s}Jn(e,t,s,i,o){ye(KT,"Updating index entries for document '%s'",t.key);const u=[];return(function(f,p,g,x,b){const S=f.getIterator(),w=p.getIterator();let A=kc(S),C=kc(w);for(;A||C;){let L=!1,z=!1;if(A&&C){const U=g(A,C);U<0?z=!0:U>0&&(L=!0)}else A!=null?z=!0:L=!0;L?(x(C),C=kc(w)):z?(b(A),A=kc(S)):(A=kc(S),C=kc(w))}})(i,o,Ha,(h=>{u.push(this.Hn(e,t,s,h))}),(h=>{u.push(this.Yn(e,t,s,h))})),X.waitFor(u)}Gn(e){let t=1;return Vc(e).ee({index:pN,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((s,i,o)=>{o.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,s){s=s.sort(((u,h)=>Ha(u,h))).filter(((u,h,f)=>!h||Ha(u,f[h-1])!==0));const i=[];i.push(e);for(const u of s){const h=Ha(u,e),f=Ha(u,t);if(h===0)i[0]=e.An();else if(h>0&&f<0)i.push(u),i.push(u.An());else if(f>0)break}i.push(t);const o=[];for(let u=0;u<i.length;u+=2){if(this.Zn(i[u],i[u+1]))return[];const h=i[u].Vn(this.uid,kp,be.empty()),f=i[u+1].Vn(this.uid,kp,be.empty());o.push(IDBKeyRange.bound(h,f))}return o}Zn(e,t){return Ha(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(YT)}getMinOffset(e,t){return X.mapArray(this.Mn(t),(s=>this.xn(e,s).next((i=>i||Te(44426))))).next(YT)}}function QT(n){return Mn(n,Eh)}function Lc(n){return Mn(n,ch)}function zd(n){return Mn(n,gb)}function Vc(n){return Mn(n,lh)}function YT(n){Ie(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let s=1;s<n.length;s++){const i=n[s].indexState.offset;fb(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new sr(e.readTime,e.documentKey,t)}const WT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vI=41943040;class ss{static withCacheSize(e){return new ss(e,ss.DEFAULT_COLLECTION_PERCENTILE,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}function xI(n,e,t){const s=n.store(Or),i=n.store(lu),o=[],u=IDBKeyRange.only(t.batchId);let h=0;const f=s.ee({range:u},((g,x,b)=>(h++,b.delete())));o.push(f.next((()=>{Ie(h===1,47070,{batchId:t.batchId})})));const p=[];for(const g of t.mutations){const x=dN(e,g.key.path,t.batchId);o.push(i.delete(x)),p.push(g.key)}return X.waitFor(o).next((()=>p))}function Lm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Te(14731);e=n.noDocument}return JSON.stringify(e).length}ss.DEFAULT_COLLECTION_PERCENTILE=10,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ss.DEFAULT=new ss(vI,ss.DEFAULT_COLLECTION_PERCENTILE,ss.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ss.DISABLED=new ss(-1,0,0);class _g{constructor(e,t,s,i){this.userId=e,this.serializer=t,this.indexManager=s,this.referenceDelegate=i,this.Xn={}}static wt(e,t,s,i){Ie(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new _g(o,t,s,i)}checkEmpty(e){let t=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ga(e).ee({index:pl,range:s},((i,o,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,s,i){const o=Hc(e),u=Ga(e);return u.add({}).next((h=>{Ie(typeof h=="number",49019);const f=new Tb(h,t,s,i),p=(function(S,w,A){const C=A.baseMutations.map((z=>Pm(S.yt,z))),L=A.mutations.map((z=>Pm(S.yt,z)));return{userId:w,batchId:A.batchId,localWriteTimeMs:A.localWriteTime.toMillis(),baseMutations:C,mutations:L}})(this.serializer,this.userId,f),g=[];let x=new wt(((b,S)=>Me(b.canonicalString(),S.canonicalString())));for(const b of i){const S=dN(this.userId,b.key.path,h);x=x.add(b.key.path.popLast()),g.push(u.put(p)),g.push(o.put(S,h5))}return x.forEach((b=>{g.push(this.indexManager.addToCollectionParentIndex(e,b))})),e.addOnCommittedListener((()=>{this.Xn[h]=f.keys()})),X.waitFor(g).next((()=>f))}))}lookupMutationBatch(e,t){return Ga(e).get(t).next((s=>s?(Ie(s.userId===this.userId,48,"Unexpected user for mutation batch",{userId:s.userId,batchId:t}),ll(this.serializer,s)):null))}er(e,t){return this.Xn[t]?X.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((s=>{if(s){const i=s.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=IDBKeyRange.lowerBound([this.userId,s]);let o=null;return Ga(e).ee({index:pl,range:i},((u,h,f)=>{h.userId===this.userId&&(Ie(h.batchId>=s,47524,{tr:s}),o=ll(this.serializer,h)),f.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=vl;return Ga(e).ee({index:pl,range:t,reverse:!0},((i,o,u)=>{s=o.batchId,u.done()})).next((()=>s))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,vl],[this.userId,Number.POSITIVE_INFINITY]);return Ga(e).J(pl,t).next((s=>s.map((i=>ll(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const s=Jp(this.userId,t.path),i=IDBKeyRange.lowerBound(s),o=[];return Hc(e).ee({range:i},((u,h,f)=>{const[p,g,x]=u,b=fi(g);if(p===this.userId&&t.path.isEqual(b))return Ga(e).get(x).next((S=>{if(!S)throw Te(61480,{nr:u,batchId:x});Ie(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:x}),o.push(ll(this.serializer,S))}));f.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new wt(Me);const i=[];return t.forEach((o=>{const u=Jp(this.userId,o.path),h=IDBKeyRange.lowerBound(u),f=Hc(e).ee({range:h},((p,g,x)=>{const[b,S,w]=p,A=fi(S);b===this.userId&&o.path.isEqual(A)?s=s.add(w):x.done()}));i.push(f)})),X.waitFor(i).next((()=>this.rr(e,s)))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1,o=Jp(this.userId,s),u=IDBKeyRange.lowerBound(o);let h=new wt(Me);return Hc(e).ee({range:u},((f,p,g)=>{const[x,b,S]=f,w=fi(b);x===this.userId&&s.isPrefixOf(w)?w.length===i&&(h=h.add(S)):g.done()})).next((()=>this.rr(e,h)))}rr(e,t){const s=[],i=[];return t.forEach((o=>{i.push(Ga(e).get(o).next((u=>{if(u===null)throw Te(35274,{batchId:o});Ie(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:o}),s.push(ll(this.serializer,u))})))})),X.waitFor(i).next((()=>s))}removeMutationBatch(e,t){return xI(e.le,this.userId,t).next((s=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),X.forEach(s,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return X.resolve();const s=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),i=[];return Hc(e).ee({range:s},((o,u,h)=>{if(o[0]===this.userId){const f=fi(o[1]);i.push(f)}else h.done()})).next((()=>{Ie(i.length===0,56720,{sr:i.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return bI(e,this.userId,t)}_r(e){return _I(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:vl,lastStreamToken:""}))}}function bI(n,e,t){const s=Jp(e,t.path),i=s[1],o=IDBKeyRange.lowerBound(s);let u=!1;return Hc(n).ee({range:o,X:!0},((h,f,p)=>{const[g,x,b]=h;g===e&&x===i&&(u=!0),p.done()})).next((()=>u))}function Ga(n){return Mn(n,Or)}function Hc(n){return Mn(n,lu)}function _I(n){return Mn(n,Sh)}class Ll{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ll(0)}static cr(){return new Ll(-1)}}class kL{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const s=new Ll(t.highestTargetId);return t.highestTargetId=s.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>De.fromTimestamp(new _t(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,s){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,s&&(i.lastRemoteSnapshotVersion=s.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((s=>(s.targetCount+=1,this.Tr(t,s),this.hr(e,s))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Uc(e).delete(t.targetId))).next((()=>this.lr(e))).next((s=>(Ie(s.targetCount>0,8065),s.targetCount-=1,this.hr(e,s))))}removeTargets(e,t,s){let i=0;const o=[];return Uc(e).ee(((u,h)=>{const f=Zd(h);f.sequenceNumber<=t&&s.get(f.targetId)===null&&(i++,o.push(this.removeTargetData(e,f)))})).next((()=>X.waitFor(o))).next((()=>i))}forEachTarget(e,t){return Uc(e).ee(((s,i)=>{const o=Zd(i);t(o)}))}lr(e){return XT(e).get(Im).next((t=>(Ie(t!==null,2888),t)))}hr(e,t){return XT(e).put(Im,t)}Pr(e,t){return Uc(e).put(pI(this.serializer,t))}Tr(e,t){let s=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,s=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const s=Dl(t),i=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let o=null;return Uc(e).ee({range:i,index:fN},((u,h,f)=>{const p=Zd(h);Gh(t,p.target)&&(o=p,f.done())})).next((()=>o))}addMatchingKeys(e,t,s){const i=[],o=Ja(e);return t.forEach((u=>{const h=cs(u.path);i.push(o.put({targetId:s,path:h})),i.push(this.referenceDelegate.addReference(e,s,u))})),X.waitFor(i)}removeMatchingKeys(e,t,s){const i=Ja(e);return X.forEach(t,(o=>{const u=cs(o.path);return X.waitFor([i.delete([s,u]),this.referenceDelegate.removeReference(e,s,o)])}))}removeMatchingKeysForTargetId(e,t){const s=Ja(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return s.delete(i)}getMatchingKeysForTargetId(e,t){const s=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ja(e);let o=Ge();return i.ee({range:s,X:!0},((u,h,f)=>{const p=fi(u[1]),g=new be(p);o=o.add(g)})).next((()=>o))}containsKey(e,t){const s=cs(t.path),i=IDBKeyRange.bound([s],[nN(s)],!1,!0);let o=0;return Ja(e).ee({index:mb,X:!0,range:i},(([u,h],f,p)=>{u!==0&&(o++,p.done())})).next((()=>o>0))}At(e,t){return Uc(e).get(t).next((s=>s?Zd(s):null))}}function Uc(n){return Mn(n,cu)}function XT(n){return Mn(n,xl)}function Ja(n){return Mn(n,uu)}const JT="LruGarbageCollector",SI=1048576;function ZT([n,e],[t,s]){const i=Me(n,t);return i===0?Me(e,s):i}class ML{constructor(e){this.Ir=e,this.buffer=new wt(ZT),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();ZT(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wI{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(JT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){So(t)?ye(JT,"Ignoring IndexedDB error during garbage collection: ",t):await _o(t)}await this.Vr(3e5)}))}}class LL{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return X.resolve(Os.ce);const s=new ML(t);return this.mr.forEachTarget(e,(i=>s.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>s.Ar(i))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.mr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),X.resolve(WT)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WT):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let s,i,o,u,h,f,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),i=this.params.maximumSequenceNumbersToCollect):i=x,u=Date.now(),this.nthSequenceNumber(e,i)))).next((x=>(s=x,h=Date.now(),this.removeTargets(e,s,t)))).next((x=>(o=x,f=Date.now(),this.removeOrphanedDocuments(e,s)))).next((x=>(p=Date.now(),Bc()<=Ze.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-g}ms
	Determined least recently used ${i} in `+(h-u)+`ms
	Removed ${o} targets in `+(f-h)+`ms
	Removed ${x} documents in `+(p-f)+`ms
Total Duration: ${p-g}ms`),X.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:x}))))}}function EI(n,e){return new LL(n,e)}class VL{constructor(e,t){this.db=e,this.garbageCollector=EI(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((s=>t.next((i=>s+i))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((s,i)=>t(i)))}addReference(e,t,s){return Mp(e,s)}removeReference(e,t,s){return Mp(e,s)}removeTargets(e,t,s){return this.db.getTargetCache().removeTargets(e,t,s)}markPotentiallyOrphaned(e,t){return Mp(e,t)}br(e,t){return(function(i,o){let u=!1;return _I(i).te((h=>bI(i,h,o).next((f=>(f&&(u=!0),X.resolve(!f)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.Sr(e,((u,h)=>{if(h<=t){const f=this.br(e,u).next((p=>{if(!p)return o++,s.getEntry(e,u).next((()=>(s.removeEntry(u,De.min()),Ja(e).delete((function(x){return[0,cs(x.path)]})(u)))))}));i.push(f)}})).next((()=>X.waitFor(i))).next((()=>s.apply(e))).next((()=>o))}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,t){return Mp(e,t)}Sr(e,t){const s=Ja(e);let i,o=Os.ce;return s.ee({index:mb},(([u,h],{path:f,sequenceNumber:p})=>{u===0?(o!==Os.ce&&t(new be(fi(i)),o),o=p,i=f):o=Os.ce})).next((()=>{o!==Os.ce&&t(new be(fi(i)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Mp(n,e){return Ja(n).put((function(s,i){return{targetId:0,path:cs(s.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}class TI{constructor(){this.changes=new aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,on.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?X.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class UL{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,s){return nl(e).put(s)}removeEntry(e,t,s){return nl(e).delete((function(o,u){const h=o.path.toArray();return[h.slice(0,h.length-2),h[h.length-2],km(u),h[h.length-1]]})(t,s))}updateMetadata(e,t){return this.getMetadata(e).next((s=>(s.byteSize+=t,this.Dr(e,s))))}getEntry(e,t){let s=on.newInvalidDocument(t);return nl(e).ee({index:Zp,range:IDBKeyRange.only(qd(t))},((i,o)=>{s=this.Cr(t,o)})).next((()=>s))}vr(e,t){let s={size:0,document:on.newInvalidDocument(t)};return nl(e).ee({index:Zp,range:IDBKeyRange.only(qd(t))},((i,o)=>{s={document:this.Cr(t,o),size:Lm(o)}})).next((()=>s))}getEntries(e,t){let s=Zs();return this.Fr(e,t,((i,o)=>{const u=this.Cr(i,o);s=s.insert(i,u)})).next((()=>s))}Mr(e,t){let s=Zs(),i=new Ot(be.comparator);return this.Fr(e,t,((o,u)=>{const h=this.Cr(o,u);s=s.insert(o,h),i=i.insert(o,Lm(u))})).next((()=>({documents:s,Or:i})))}Fr(e,t,s){if(t.isEmpty())return X.resolve();let i=new wt(n2);t.forEach((f=>i=i.add(f)));const o=IDBKeyRange.bound(qd(i.first()),qd(i.last())),u=i.getIterator();let h=u.getNext();return nl(e).ee({index:Zp,range:o},((f,p,g)=>{const x=be.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;h&&n2(h,x)<0;)s(h,null),h=u.getNext();h&&h.isEqual(x)&&(s(h,p),h=u.hasNext()?u.getNext():null),h?g.j(qd(h)):g.done()})).next((()=>{for(;h;)s(h,null),h=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,s,i,o){const u=t.path,h=[u.popLast().toArray(),u.lastSegment(),km(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],f=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return nl(e).J(IDBKeyRange.bound(h,f,!0)).next((p=>{o?.incrementDocumentReadCount(p.length);let g=Zs();for(const x of p){const b=this.Cr(be.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);b.isFoundDocument()&&($h(t,b)||i.has(b.key))&&(g=g.insert(b.key,b))}return g}))}getAllFromCollectionGroup(e,t,s,i){let o=Zs();const u=t2(t,s),h=t2(t,sr.max());return nl(e).ee({index:hN,range:IDBKeyRange.bound(u,h,!0)},((f,p,g)=>{const x=this.Cr(be.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(x.key,x),o.size===i&&g.done()})).next((()=>o))}newChangeBuffer(e){return new BL(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return e2(e).get(Y0).next((t=>(Ie(!!t,20021),t)))}Dr(e,t){return e2(e).put(Y0,t)}Cr(e,t){if(t){const s=TL(this.serializer,t);if(!(s.isNoDocument()&&s.version.isEqual(De.min())))return s}return on.newInvalidDocument(e)}}function AI(n){return new UL(n)}class BL extends TI{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new aa((s=>s.toString()),((s,i)=>s.isEqual(i)))}applyChanges(e){const t=[];let s=0,i=new wt(((o,u)=>Me(o.canonicalString(),u.canonicalString())));return this.changes.forEach(((o,u)=>{const h=this.Br.get(o);if(t.push(this.Nr.removeEntry(e,o,h.readTime)),u.isValidDocument()){const f=LT(this.Nr.serializer,u);i=i.add(o.path.popLast());const p=Lm(f);s+=p-h.size,t.push(this.Nr.addEntry(e,o,f))}else if(s-=h.size,this.trackRemovals){const f=LT(this.Nr.serializer,u.convertToNoDocument(De.min()));t.push(this.Nr.addEntry(e,o,f))}})),i.forEach((o=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Nr.updateMetadata(e,s)),X.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((s=>(this.Br.set(t,{size:s.size,readTime:s.document.readTime}),s.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:s,Or:i})=>(i.forEach(((o,u)=>{this.Br.set(o,{size:u,readTime:s.get(o).readTime})})),s)))}}function e2(n){return Mn(n,wh)}function nl(n){return Mn(n,Nm)}function qd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function t2(n,e){const t=e.documentKey.path.toArray();return[n,km(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function n2(n,e){const t=n.path.toArray(),s=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<s.length-2;++o)if(i=Me(t[o],s[o]),i)return i;return i=Me(t.length,s.length),i||(i=Me(t[t.length-2],s[s.length-2]),i||Me(t[t.length-1],s[s.length-1]))}class FL{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class CI{constructor(e,t,s,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(s=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(s!==null&&hh(s.mutation,i,Ps.empty(),_t.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,Ge()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=Ge()){const i=pi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,s).next((o=>{let u=Xd();return o.forEach(((h,f)=>{u=u.insert(h,f.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=pi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,Ge())))}populateOverlays(e,t,s){const i=[];return s.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((u,h)=>{t.set(u,h)}))}))}computeViews(e,t,s,i){let o=Zs();const u=dh(),h=(function(){return dh()})();return t.forEach(((f,p)=>{const g=s.get(p.key);i.has(p.key)&&(g===void 0||g.mutation instanceof oa)?o=o.insert(p.key,p):g!==void 0?(u.set(p.key,g.mutation.getFieldMask()),hh(g.mutation,p,g.mutation.getFieldMask(),_t.now())):u.set(p.key,Ps.empty())})),this.recalculateAndSaveOverlays(e,o).next((f=>(f.forEach(((p,g)=>u.set(p,g))),t.forEach(((p,g)=>h.set(p,new FL(g,u.get(p)??null)))),h)))}recalculateAndSaveOverlays(e,t){const s=dh();let i=new Ot(((u,h)=>u-h)),o=Ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const h of u)h.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let g=s.get(f)||Ps.empty();g=h.applyToLocalView(p,g),s.set(f,g);const x=(i.get(h.batchId)||Ge()).add(f);i=i.insert(h.batchId,x)}))})).next((()=>{const u=[],h=i.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,g=f.value,x=HN();g.forEach((b=>{if(!o.has(b)){const S=WN(t.get(b),s.get(b));S!==null&&x.set(b,S),o=o.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,p,x))}return X.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,i){return(function(u){return be.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,i):this.getDocumentsMatchingCollectionQuery(e,t,s,i)}getNextDocuments(e,t,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,i).next((o=>{const u=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,i-o.size):X.resolve(pi());let h=ou,f=o;return u.next((p=>X.forEach(p,((g,x)=>(h<x.largestBatchId&&(h=x.largestBatchId),o.get(g)?X.resolve():this.remoteDocumentCache.getEntry(e,g).next((b=>{f=f.insert(g,b)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,f,p,Ge()))).next((g=>({batchId:h,changes:qN(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next((s=>{let i=Xd();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,i){const o=t.collectionGroup;let u=Xd();return this.indexManager.getCollectionParents(e,o).next((h=>X.forEach(h,(f=>{const p=(function(x,b){return new zl(b,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,s,i).next((g=>{g.forEach(((x,b)=>{u=u.insert(x,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,o,i)))).next((u=>{o.forEach(((f,p)=>{const g=p.getKey();u.get(g)===null&&(u=u.insert(g,on.newInvalidDocument(g)))}));let h=Xd();return u.forEach(((f,p)=>{const g=o.get(f);g!==void 0&&hh(g.mutation,p,Ps.empty(),_t.now()),$h(t,p)&&(h=h.insert(f,p))})),h}))}}class zL{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return X.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:gs(i.createTime)}})(t)),X.resolve()}getNamedQuery(e,t){return X.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:mI(i.bundledQuery),readTime:gs(i.readTime)}})(t)),X.resolve()}}class qL{constructor(){this.overlays=new Ot(be.comparator),this.qr=new Map}getOverlay(e,t){return X.resolve(this.overlays.get(t))}getOverlays(e,t){const s=pi();return X.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&s.set(i,o)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((i,o)=>{this.St(e,t,o)})),X.resolve()}removeOverlaysForBatchId(e,t,s){const i=this.qr.get(s);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(s)),X.resolve()}getOverlaysForCollection(e,t,s){const i=pi(),o=t.length+1,u=new be(t.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&f.largestBatchId>s&&i.set(f.getKey(),f)}return X.resolve(i)}getOverlaysForCollectionGroup(e,t,s,i){let o=new Ot(((p,g)=>p-g));const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>s){let g=o.get(p.largestBatchId);g===null&&(g=pi(),o=o.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const h=pi(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,g)=>h.set(p,g))),!(h.size()>=i)););return X.resolve(h)}St(e,t,s){const i=this.overlays.get(s.key);if(i!==null){const u=this.qr.get(i.largestBatchId).delete(s.key);this.qr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new Cb(t,s));let o=this.qr.get(t);o===void 0&&(o=Ge(),this.qr.set(t,o)),this.qr.set(t,o.add(s.key))}}class HL{constructor(){this.sessionToken=yn.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,X.resolve()}}class Db{constructor(){this.Qr=new wt(Fn.$r),this.Ur=new wt(Fn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const s=new Fn(e,t);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Gr(new Fn(e,t))}zr(e,t){e.forEach((s=>this.removeReference(s,t)))}jr(e){const t=new be(new dt([])),s=new Fn(t,e),i=new Fn(t,e+1),o=[];return this.Ur.forEachInRange([s,i],(u=>{this.Gr(u),o.push(u.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new be(new dt([])),s=new Fn(t,e),i=new Fn(t,e+1);let o=Ge();return this.Ur.forEachInRange([s,i],(u=>{o=o.add(u.key)})),o}containsKey(e){const t=new Fn(e,0),s=this.Qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Fn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return be.comparator(e.key,t.key)||Me(e.Yr,t.Yr)}static Kr(e,t){return Me(e.Yr,t.Yr)||be.comparator(e.key,t.key)}}class GL{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new wt(Fn.$r)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Tb(o,t,s,i);this.mutationQueue.push(u);for(const h of i)this.Zr=this.Zr.add(new Fn(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return X.resolve(u)}lookupMutationBatch(e,t){return X.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=this.ei(s),o=i<0?0:i;return X.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?vl:this.tr-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Fn(t,0),i=new Fn(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([s,i],(u=>{const h=this.Xr(u.Yr);o.push(h)})),X.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new wt(Me);return t.forEach((i=>{const o=new Fn(i,0),u=new Fn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,u],(h=>{s=s.add(h.Yr)}))})),X.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1;let o=s;be.isDocumentKey(o)||(o=o.child(""));const u=new Fn(new be(o),0);let h=new wt(Me);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!s.isPrefixOf(p)&&(p.length===i&&(h=h.add(f.Yr)),!0)}),u),X.resolve(this.ti(h))}ti(e){const t=[];return e.forEach((s=>{const i=this.Xr(s);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Ie(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return X.forEach(t.mutations,(i=>{const o=new Fn(i.key,t.batchId);return s=s.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,t){const s=new Fn(t,0),i=this.Zr.firstAfterOrEqual(s);return X.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $L{constructor(e){this.ri=e,this.docs=(function(){return new Ot(be.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,i=this.docs.get(s),o=i?i.size:0,u=this.ri(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return X.resolve(s?s.document.mutableCopy():on.newInvalidDocument(t))}getEntries(e,t){let s=Zs();return t.forEach((i=>{const o=this.docs.get(i);s=s.insert(i,o?o.document.mutableCopy():on.newInvalidDocument(i))})),X.resolve(s)}getDocumentsMatchingQuery(e,t,s,i){let o=Zs();const u=t.path,h=new be(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:g}}=f.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||fb(aN(g),s)<=0||(i.has(g.key)||$h(t,g))&&(o=o.insert(g.key,g.mutableCopy()))}return X.resolve(o)}getAllFromCollectionGroup(e,t,s,i){Te(9500)}ii(e,t){return X.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new KL(this)}getSize(e){return X.resolve(this.size)}}class KL extends TI{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((s,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(s)})),X.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class QL{constructor(e){this.persistence=e,this.si=new aa((t=>Dl(t)),Gh),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.oi=0,this._i=new Db,this.targetCount=0,this.ai=Ll.ur()}forEachTarget(e,t){return this.si.forEach(((s,i)=>t(i))),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.oi&&(this.oi=t),X.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ll(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,X.resolve()}updateTargetData(e,t){return this.Pr(t),X.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,t,s){let i=0;const o=[];return this.si.forEach(((u,h)=>{h.sequenceNumber<=t&&s.get(h.targetId)===null&&(this.si.delete(u),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)})),X.waitFor(o).next((()=>i))}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,t){const s=this.si.get(t)||null;return X.resolve(s)}addMatchingKeys(e,t,s){return this._i.Wr(t,s),X.resolve()}removeMatchingKeys(e,t,s){this._i.zr(t,s);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((u=>{o.push(i.markPotentiallyOrphaned(e,u))})),X.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),X.resolve()}getMatchingKeysForTargetId(e,t){const s=this._i.Hr(t);return X.resolve(s)}containsKey(e,t){return X.resolve(this._i.containsKey(t))}}class Ob{constructor(e,t){this.ui={},this.overlays={},this.ci=new Os(0),this.li=!1,this.li=!0,this.hi=new HL,this.referenceDelegate=e(this),this.Pi=new QL(this),this.indexManager=new OL,this.remoteDocumentCache=(function(i){return new $L(i)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new fI(t),this.Ii=new zL(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qL,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ui[e.toKey()];return s||(s=new GL(t,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,s){ye("MemoryPersistence","Starting transaction:",e);const i=new YL(this.ci.next());return this.referenceDelegate.Ei(),s(i).next((o=>this.referenceDelegate.di(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ai(e,t){return X.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,t))))}}class YL extends lN{constructor(e){super(),this.currentSequenceNumber=e}}class Sg{constructor(e){this.persistence=e,this.Ri=new Db,this.Vi=null}static mi(e){return new Sg(e)}get fi(){if(this.Vi)return this.Vi;throw Te(60996)}addReference(e,t,s){return this.Ri.addReference(s,t),this.fi.delete(s.toString()),X.resolve()}removeReference(e,t,s){return this.Ri.removeReference(s,t),this.fi.add(s.toString()),X.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),X.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.fi.add(o.toString())))})).next((()=>s.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.fi,(s=>{const i=be.fromPath(s);return this.gi(e,i).next((o=>{o||t.removeEntry(i,De.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((s=>{s?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return X.or([()=>X.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Vm{constructor(e,t){this.persistence=e,this.pi=new aa((s=>cs(s.path)),((s,i)=>s.isEqual(i))),this.garbageCollector=EI(this,t)}static mi(e,t){return new Vm(e,t)}Ei(){}di(e){return X.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((i=>s+i))))}wr(e){let t=0;return this.pr(e,(s=>{t++})).next((()=>t))}pr(e,t){return X.forEach(this.pi,((s,i)=>this.br(e,s,i).next((o=>o?X.resolve():t(i)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,(u=>this.br(e,u,t).next((h=>{h||(s++,o.removeEntry(u,De.min()))})))).next((()=>o.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),X.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),X.resolve()}removeReference(e,t,s){return this.pi.set(s,e.currentSequenceNumber),X.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),X.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=tm(e.data.value)),t}br(e,t,s){return X.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return X.resolve(i!==void 0&&i>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class WL{constructor(e){this.serializer=e}k(e,t,s,i){const o=new og("createOrUpgrade",t);s<1&&i>=1&&((function(f){f.createObjectStore(Hh)})(e),(function(f){f.createObjectStore(Sh,{keyPath:d5}),f.createObjectStore(Or,{keyPath:fT,autoIncrement:!0}).createIndex(pl,pT,{unique:!0}),f.createObjectStore(lu)})(e),s2(e),(function(f){f.createObjectStore(al)})(e));let u=X.resolve();return s<3&&i>=3&&(s!==0&&((function(f){f.deleteObjectStore(uu),f.deleteObjectStore(cu),f.deleteObjectStore(xl)})(e),s2(e)),u=u.next((()=>(function(f){const p=f.store(xl),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return p.put(Im,g)})(o)))),s<4&&i>=4&&(s!==0&&(u=u.next((()=>(function(f,p){return p.store(Or).J().next((x=>{f.deleteObjectStore(Or),f.createObjectStore(Or,{keyPath:fT,autoIncrement:!0}).createIndex(pl,pT,{unique:!0});const b=p.store(Or),S=x.map((w=>b.put(w)));return X.waitFor(S)}))})(e,o)))),u=u.next((()=>{(function(f){f.createObjectStore(du,{keyPath:b5})})(e)}))),s<5&&i>=5&&(u=u.next((()=>this.yi(o)))),s<6&&i>=6&&(u=u.next((()=>((function(f){f.createObjectStore(wh)})(e),this.wi(o))))),s<7&&i>=7&&(u=u.next((()=>this.Si(o)))),s<8&&i>=8&&(u=u.next((()=>this.bi(e,o)))),s<9&&i>=9&&(u=u.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),s<10&&i>=10&&(u=u.next((()=>this.Di(o)))),s<11&&i>=11&&(u=u.next((()=>{(function(f){f.createObjectStore(cg,{keyPath:_5})})(e),(function(f){f.createObjectStore(ug,{keyPath:S5})})(e)}))),s<12&&i>=12&&(u=u.next((()=>{(function(f){const p=f.createObjectStore(dg,{keyPath:I5});p.createIndex(X0,R5,{unique:!1}),p.createIndex(gN,j5,{unique:!1})})(e)}))),s<13&&i>=13&&(u=u.next((()=>(function(f){const p=f.createObjectStore(Nm,{keyPath:f5});p.createIndex(Zp,p5),p.createIndex(hN,m5)})(e))).next((()=>this.Ci(e,o))).next((()=>e.deleteObjectStore(al)))),s<14&&i>=14&&(u=u.next((()=>this.Fi(e,o)))),s<15&&i>=15&&(u=u.next((()=>(function(f){f.createObjectStore(gb,{keyPath:w5,autoIncrement:!0}).createIndex(W0,E5,{unique:!1}),f.createObjectStore(lh,{keyPath:T5}).createIndex(pN,A5,{unique:!1}),f.createObjectStore(ch,{keyPath:C5}).createIndex(mN,N5,{unique:!1})})(e)))),s<16&&i>=16&&(u=u.next((()=>{t.objectStore(lh).clear()})).next((()=>{t.objectStore(ch).clear()}))),s<17&&i>=17&&(u=u.next((()=>{(function(f){f.createObjectStore(yb,{keyPath:D5})})(e)}))),s<18&&i>=18&&aC()&&(u=u.next((()=>{t.objectStore(lh).clear()})).next((()=>{t.objectStore(ch).clear()}))),u}wi(e){let t=0;return e.store(al).ee(((s,i)=>{t+=Lm(i)})).next((()=>{const s={byteSize:t};return e.store(wh).put(Y0,s)}))}yi(e){const t=e.store(Sh),s=e.store(Or);return t.J().next((i=>X.forEach(i,(o=>{const u=IDBKeyRange.bound([o.userId,vl],[o.userId,o.lastAcknowledgedBatchId]);return s.J(pl,u).next((h=>X.forEach(h,(f=>{Ie(f.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=ll(this.serializer,f);return xI(e,o.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(uu),s=e.store(al);return e.store(xl).get(Im).next((i=>{const o=[];return s.ee(((u,h)=>{const f=new dt(u),p=(function(x){return[0,cs(x)]})(f);o.push(t.get(p).next((g=>g?X.resolve():(x=>t.put({targetId:0,path:cs(x),sequenceNumber:i.highestListenSequenceNumber}))(f))))})).next((()=>X.waitFor(o)))}))}bi(e,t){e.createObjectStore(Eh,{keyPath:x5});const s=t.store(Eh),i=new jb,o=u=>{if(i.add(u)){const h=u.lastSegment(),f=u.popLast();return s.put({collectionId:h,parent:cs(f)})}};return t.store(al).ee({X:!0},((u,h)=>{const f=new dt(u);return o(f.popLast())})).next((()=>t.store(lu).ee({X:!0},(([u,h,f],p)=>{const g=fi(h);return o(g.popLast())}))))}Di(e){const t=e.store(cu);return t.ee(((s,i)=>{const o=Zd(i),u=pI(this.serializer,o);return t.put(u)}))}Ci(e,t){const s=t.store(al),i=[];return s.ee(((o,u)=>{const h=t.store(Nm),f=(function(x){return x.document?new be(dt.fromString(x.document.name).popFirst(5)):x.noDocument?be.fromSegments(x.noDocument.path):x.unknownDocument?be.fromSegments(x.unknownDocument.path):Te(36783)})(u).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(h.put(p))})).next((()=>X.waitFor(i)))}Fi(e,t){const s=t.store(Or),i=AI(this.serializer),o=new Ob(Sg.mi,this.serializer.yt);return s.J().next((u=>{const h=new Map;return u.forEach((f=>{let p=h.get(f.userId)??Ge();ll(this.serializer,f).keys().forEach((g=>p=p.add(g))),h.set(f.userId,p)})),X.forEach(h,((f,p)=>{const g=new zn(p),x=bg.wt(this.serializer,g),b=o.getIndexManager(g),S=_g.wt(g,this.serializer,b,o.referenceDelegate);return new CI(i,S,x,b).recalculateAndSaveOverlaysForDocumentKeys(new J0(t,Os.ce),f).next()}))}))}}function s2(n){n.createObjectStore(uu,{keyPath:y5}).createIndex(mb,v5,{unique:!0}),n.createObjectStore(cu,{keyPath:"targetId"}).createIndex(fN,g5,{unique:!0}),n.createObjectStore(xl)}const $a="IndexedDbPersistence",i0=18e5,a0=5e3,o0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",XL="main";class Pb{constructor(e,t,s,i,o,u,h,f,p,g,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=s,this.Mi=o,this.window=u,this.document=h,this.xi=p,this.Oi=g,this.Ni=x,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=b=>Promise.resolve(),!Pb.v())throw new ve(ae.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new VL(this,i),this.$i=t+XL,this.serializer=new fI(f),this.Ui=new oo(this.$i,this.Ni,new WL(this.serializer)),this.hi=new CL,this.Pi=new kL(this.referenceDelegate,this.serializer),this.remoteDocumentCache=AI(this.serializer),this.Ii=new AL,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,g===!1&&pn($a,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ve(ae.FAILED_PRECONDITION,o0);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Os(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Lp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(So(e))return ye($a,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ye($a,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Hd(e).get(Pc).next((t=>X.resolve(this.es(t))))}ts(e){return Lp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,i0)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const s=Mn(t,du);return s.J().next((i=>{const o=this.ss(i,i0),u=i.filter((h=>o.indexOf(h)===-1));return X.forEach(u,(h=>s.delete(h.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?X.resolve(!0):Hd(e).get(Pc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,a0)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ve(ae.FAILED_PRECONDITION,o0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lp(e).J().next((s=>this.ss(s,a0).find((i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,u=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(o||u&&h)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ye($a,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Hh,du],(e=>{const t=new J0(e,Os.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((s=>this.rs(s.updateTimeMs,t)&&!this.us(s.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Lp(e).J().next((t=>this.ss(t,i0).map((s=>s.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return _g.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new PL(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return bg.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,s){ye($a,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=(function(f){return f===18?k5:f===17?bN:f===16?P5:f===15?vb:f===14?xN:f===13?vN:f===12?O5:f===11?yN:void Te(60245)})(this.Ni);let u;return this.Ui.runTransaction(e,i,o,(h=>(u=new J0(h,this.ci?this.ci.next():Os.ce),t==="readwrite-primary"?this.Hi(u).next((f=>!!f||this.Yi(u))).next((f=>{if(!f)throw pn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ve(ae.FAILED_PRECONDITION,oN);return s(u)})).next((f=>this.Xi(u).next((()=>f)))):this.Is(u).next((()=>s(u)))))).then((h=>(u.raiseOnCommittedEvent(),h)))}Is(e){return Hd(e).get(Pc).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,a0)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ve(ae.FAILED_PRECONDITION,o0)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Hd(e).put(Pc,t)}static v(){return oo.v()}Zi(e){const t=Hd(e);return t.get(Pc).next((s=>this.es(s)?(ye($a,"Releasing primary lease."),t.delete(Pc)):X.resolve()))}rs(e,t){const s=Date.now();return!(e<s-t)&&(!(e>s)||(pn(`Detected an update time that is in the future: ${e} > ${s}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;iC()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const t=this.Ki?.getItem(this._s(e))!==null;return ye($a,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return pn($a,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){pn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Hd(n){return Mn(n,Hh)}function Lp(n){return Mn(n,du)}function NI(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class kb{constructor(e,t,s,i){this.targetId=e,this.fromCache=t,this.Es=s,this.ds=i}static As(e,t){let s=Ge(),i=Ge();for(const o of t.docChanges)switch(o.type){case 0:s=s.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new kb(e,t.fromCache,s,i)}}class JL{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class II{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return iC()?8:cN(Pn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,s,i){const o={result:null};return this.ys(e,t).next((u=>{o.result=u})).next((()=>{if(!o.result)return this.ws(e,t,i,s).next((u=>{o.result=u}))})).next((()=>{if(o.result)return;const u=new JL;return this.Ss(e,t,u).next((h=>{if(o.result=h,this.Vs)return this.bs(e,t,u,h.size)}))})).next((()=>o.result))}bs(e,t,s,i){return s.documentReadCount<this.fs?(Bc()<=Ze.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Fc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),X.resolve()):(Bc()<=Ze.DEBUG&&ye("QueryEngine","Query:",Fc(t),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.gs*i?(Bc()<=Ze.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Fc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,er(t))):X.resolve())}ys(e,t){if(CT(t))return X.resolve(null);let s=er(t);return this.indexManager.getIndexType(e,s).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Dm(t,null,"F"),s=er(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((o=>{const u=Ge(...o);return this.ps.getDocuments(e,u).next((h=>this.indexManager.getMinOffset(e,s).next((f=>{const p=this.Ds(t,h);return this.Cs(t,p,u,f.readTime)?this.ys(e,Dm(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,s,i){return CT(t)||i.isEqual(De.min())?X.resolve(null):this.ps.getDocuments(e,s).next((o=>{const u=this.Ds(t,o);return this.Cs(t,u,s,i)?X.resolve(null):(Bc()<=Ze.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fc(t)),this.vs(e,u,t,iN(i,ou)).next((h=>h)))}))}Ds(e,t){let s=new wt(FN(e));return t.forEach(((i,o)=>{$h(e,o)&&(s=s.add(o))})),s}Cs(e,t,s,i){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,t,s){return Bc()<=Ze.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Fc(t)),this.ps.getDocumentsMatchingQuery(e,t,sr.min(),s)}vs(e,t,s,i){return this.ps.getDocumentsMatchingQuery(e,s,i).next((o=>(t.forEach((u=>{o=o.insert(u.key,u)})),o)))}}const Mb="LocalStore",ZL=3e8;class e8{constructor(e,t,s,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Ot(Me),this.xs=new aa((o=>Dl(o)),Gh),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function RI(n,e,t,s){return new e8(n,e,t,s)}async function jI(n,e){const t=Ce(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let i;return t.mutationQueue.getAllMutationBatches(s).next((o=>(i=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(s)))).next((o=>{const u=[],h=[];let f=Ge();for(const p of i){u.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}for(const p of o){h.push(p.batchId);for(const g of p.mutations)f=f.add(g.key)}return t.localDocuments.getDocuments(s,f).next((p=>({Ls:p,removedBatchIds:u,addedBatchIds:h})))}))}))}function t8(n,e){const t=Ce(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const i=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,f,p,g){const x=p.batch,b=x.keys();let S=X.resolve();return b.forEach((w=>{S=S.next((()=>g.getEntry(f,w))).next((A=>{const C=p.docVersions.get(w);Ie(C!==null,48541),A.version.compareTo(C)<0&&(x.applyToRemoteDocument(A,p),A.isValidDocument()&&(A.setReadTime(p.commitVersion),g.addEntry(A)))}))})),S.next((()=>h.mutationQueue.removeMutationBatch(f,x)))})(t,s,e,o).next((()=>o.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(h){let f=Ge();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(s,i)))}))}function DI(n){const e=Ce(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function n8(n,e){const t=Ce(n),s=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const h=[];e.targetChanges.forEach(((g,x)=>{const b=i.get(x);if(!b)return;h.push(t.Pi.removeMatchingKeys(o,g.removedDocuments,x).next((()=>t.Pi.addMatchingKeys(o,g.addedDocuments,x))));let S=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(x)!==null?S=S.withResumeToken(yn.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):g.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(g.resumeToken,s)),i=i.insert(x,S),(function(A,C,L){return A.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=ZL?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(b,S,g)&&h.push(t.Pi.updateTargetData(o,S))}));let f=Zs(),p=Ge();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,g))})),h.push(s8(o,u,e.documentUpdates).next((g=>{f=g.ks,p=g.qs}))),!s.isEqual(De.min())){const g=t.Pi.getLastRemoteSnapshotVersion(o).next((x=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,s)));h.push(g)}return X.waitFor(h).next((()=>u.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,f,p))).next((()=>f))})).then((o=>(t.Ms=i,o)))}function s8(n,e,t){let s=Ge(),i=Ge();return t.forEach((o=>s=s.add(o))),e.getEntries(n,s).next((o=>{let u=Zs();return t.forEach(((h,f)=>{const p=o.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(h)),f.isNoDocument()&&f.version.isEqual(De.min())?(e.removeEntry(h,f.readTime),u=u.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),u=u.insert(h,f)):ye(Mb,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)})),{ks:u,qs:i}}))}function r8(n,e){const t=Ce(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=vl),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function Um(n,e){const t=Ce(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let i;return t.Pi.getTargetData(s,e).next((o=>o?(i=o,X.resolve(i)):t.Pi.allocateTargetId(s).next((u=>(i=new Yi(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.Pi.addTargetData(s,i).next((()=>i)))))))})).then((s=>{const i=t.Ms.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(s.targetId,s),t.xs.set(e,s.targetId)),s}))}async function yu(n,e,t){const s=Ce(n),i=s.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",o,(u=>s.persistence.referenceDelegate.removeTarget(u,i)))}catch(u){if(!So(u))throw u;ye(Mb,`Failed to update sequence numbers for target ${e}: ${u}`)}s.Ms=s.Ms.remove(e),s.xs.delete(i.target)}function hx(n,e,t){const s=Ce(n);let i=De.min(),o=Ge();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(f,p,g){const x=Ce(f),b=x.xs.get(g);return b!==void 0?X.resolve(x.Ms.get(b)):x.Pi.getTargetData(p,g)})(s,u,er(e)).next((h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(u,h.targetId).next((f=>{o=f}))})).next((()=>s.Fs.getDocumentsMatchingQuery(u,e,t?i:De.min(),t?o:Ge()))).next((h=>(kI(s,BN(e),h),{documents:h,Qs:o})))))}function OI(n,e){const t=Ce(n),s=Ce(t.Pi),i=t.Ms.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",(o=>s.At(o,e).next((u=>u?u.target:null))))}function PI(n,e){const t=Ce(n),s=t.Os.get(e)||De.min();return t.persistence.runTransaction("Get new document changes","readonly",(i=>t.Ns.getAllFromCollectionGroup(i,e,iN(s,ou),Number.MAX_SAFE_INTEGER))).then((i=>(kI(t,e,i),i)))}function kI(n,e,t){let s=n.Os.get(e)||De.min();t.forEach(((i,o)=>{o.readTime.compareTo(s)>0&&(s=o.readTime)})),n.Os.set(e,s)}const MI="firestore_clients";function r2(n,e){return`${MI}_${n}_${e}`}const LI="firestore_mutations";function i2(n,e,t){let s=`${LI}_${n}_${t}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}const VI="firestore_targets";function l0(n,e){return`${VI}_${n}_${e}`}const hi="SharedClientState";class Bm{constructor(e,t,s,i){this.user=e,this.batchId=t,this.state=s,this.error=i}static Ws(e,t,s){const i=JSON.parse(s);let o,u=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return u&&i.error&&(u=typeof i.error.message=="string"&&typeof i.error.code=="string",u&&(o=new ve(i.error.code,i.error.message))),u?new Bm(e,t,i.state,o):(pn(hi,`Failed to parse mutation state for ID '${t}': ${s}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class fh{constructor(e,t,s){this.targetId=e,this.state=t,this.error=s}static Ws(e,t){const s=JSON.parse(t);let i,o=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new ve(s.error.code,s.error.message))),o?new fh(e,s.state,i):(pn(hi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Fm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const s=JSON.parse(t);let i=typeof s=="object"&&s.activeTargetIds instanceof Array,o=wb();for(let u=0;i&&u<s.activeTargetIds.length;++u)i=uN(s.activeTargetIds[u]),o=o.add(s.activeTargetIds[u]);return i?new Fm(e,o):(pn(hi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Lb{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Lb(t.clientId,t.onlineState):(pn(hi,`Failed to parse online state: ${e}`),null)}}class fx{constructor(){this.activeTargetIds=wb()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class c0{constructor(e,t,s,i,o){this.window=e,this.Mi=t,this.persistenceKey=s,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Ot(Me),this.started=!1,this.Xs=[];const u=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.eo=r2(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new fx),this.ro=new RegExp(`^${MI}_${u}_([^_]*)$`),this.io=new RegExp(`^${LI}_${u}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${VI}_${u}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const s of e){if(s===this.Js)continue;const i=this.getItem(r2(this.persistenceKey,s));if(i){const o=Fm.Ws(s,i);o&&(this.Zs=this.Zs.insert(o.clientId,o))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const s=this.uo(t);s&&this.co(s)}for(const s of this.Xs)this.Ys(s);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((s,i)=>{i.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,s){this.ho(e,t,s),this.Po(e)}addLocalQueryTarget(e,t=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(l0(this.persistenceKey,e));if(i){const o=fh.Ws(e,i);o&&(s=o.state)}}return t&&this.To.zs(e),this.ao(),s}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(l0(this.persistenceKey,e))}updateQueryState(e,t,s){this.Io(e,t,s)}handleUserChange(e,t,s){t.forEach((i=>{this.Po(i)})),this.currentUser=e,s.forEach((i=>{this.addPendingMutation(i)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ye(hi,"READ",e,t),t}setItem(e,t){ye(hi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ye(hi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ye(hi,"EVENT",t.key,t.newValue),t.key===this.eo)return void pn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const s=this.Ro(t.key);return this.Vo(s,null)}{const s=this.mo(t.key,t.newValue);if(s)return this.Vo(s.clientId,s)}}else if(this.io.test(t.key)){if(t.newValue!==null){const s=this.fo(t.key,t.newValue);if(s)return this.po(s)}}else if(this.so.test(t.key)){if(t.newValue!==null){const s=this.yo(t.key,t.newValue);if(s)return this.wo(s)}}else if(t.key===this.oo){if(t.newValue!==null){const s=this.uo(t.newValue);if(s)return this.co(s)}}else if(t.key===this.no){const s=(function(o){let u=Os.ce;if(o!=null)try{const h=JSON.parse(o);Ie(typeof h=="number",30636,{So:o}),u=h}catch(h){pn(hi,"Failed to read sequence number from WebStorage",h)}return u})(t.newValue);s!==Os.ce&&this.sequenceNumberHandler(s)}else if(t.key===this._o){const s=this.bo(t.newValue);await Promise.all(s.map((i=>this.syncEngine.Do(i))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,s){const i=new Bm(this.currentUser,e,t,s),o=i2(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Gs())}Po(e){const t=i2(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,s){const i=l0(this.persistenceKey,e),o=new fh(e,t,s);this.setItem(i,o.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const s=this.Ro(e);return Fm.Ws(s,t)}fo(e,t){const s=this.io.exec(e),i=Number(s[1]),o=s[2]!==void 0?s[2]:null;return Bm.Ws(new zn(o),i,t)}yo(e,t){const s=this.so.exec(e),i=Number(s[1]);return fh.Ws(i,t)}uo(e){return Lb.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ye(hi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const s=t?this.Zs.insert(e,t):this.Zs.remove(e),i=this.lo(this.Zs),o=this.lo(s),u=[],h=[];return o.forEach((f=>{i.has(f)||u.push(f)})),i.forEach((f=>{o.has(f)||h.push(f)})),this.syncEngine.Fo(u,h).then((()=>{this.Zs=s}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=wb();return e.forEach(((s,i)=>{t=t.unionWith(i.activeTargetIds)})),t}}class UI{constructor(){this.Mo=new fx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,s){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fx,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class i8{Oo(e){}shutdown(){}}const a2="ConnectivityMonitor";class o2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(a2,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(a2,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Vp=null;function px(){return Vp===null?Vp=(function(){return 268435456+Math.round(2147483648*Math.random())})():Vp++,"0x"+Vp.toString(16)}const u0="RestConnection",a8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class o8{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${s}/databases/${i}`,this.Wo=this.databaseId.database===Ah?`project_id=${s}`:`project_id=${s}&database_id=${i}`}Go(e,t,s,i,o){const u=px(),h=this.zo(e,t.toUriEncodedString());ye(u0,`Sending RPC '${e}' ${u}:`,h,s);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,i,o);const{host:p}=new URL(h),g=vo(p);return this.Jo(e,h,f,s,g).then((x=>(ye(u0,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw Il(u0,`RPC '${e}' ${u} failed with error: `,x,"url: ",h,"request:",s),x}))}Ho(e,t,s,i,o,u){return this.Go(e,t,s,i,o)}jo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Iu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),s&&s.headers.forEach(((i,o)=>e[o]=i))}zo(e,t){const s=a8[e];return`${this.Uo}/v1/${t}:${s}`}terminate(){}}class l8{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ns="WebChannelConnection";class c8 extends o8{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,s,i,o){const u=px();return new Promise(((h,f)=>{const p=new YC;p.setWithCredentials(!0),p.listenOnce(WC.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Wp.NO_ERROR:const x=p.getResponseJson();ye(ns,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),h(x);break;case Wp.TIMEOUT:ye(ns,`RPC '${e}' ${u} timed out`),f(new ve(ae.DEADLINE_EXCEEDED,"Request time out"));break;case Wp.HTTP_ERROR:const b=p.getStatus();if(ye(ns,`RPC '${e}' ${u} failed with status:`,b,"response text:",p.getResponseText()),b>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const w=S?.error;if(w&&w.status&&w.message){const A=(function(L){const z=L.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(z)>=0?z:ae.UNKNOWN})(w.status);f(new ve(A,w.message))}else f(new ve(ae.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new ve(ae.UNAVAILABLE,"Connection failed."));break;default:Te(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{ye(ns,`RPC '${e}' ${u} completed.`)}}));const g=JSON.stringify(i);ye(ns,`RPC '${e}' ${u} sending request:`,i),p.send(t,"POST",g,s,15)}))}T_(e,t,s){const i=px(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=ZC(),h=JC(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,s),f.encodeInitMessageHeaders=!0;const g=o.join("");ye(ns,`Creating RPC '${e}' stream ${i}: ${g}`,f);const x=u.createWebChannel(g,f);this.I_(x);let b=!1,S=!1;const w=new l8({Yo:C=>{S?ye(ns,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(b||(ye(ns,`Opening RPC '${e}' stream ${i} transport.`),x.open(),b=!0),ye(ns,`RPC '${e}' stream ${i} sending:`,C),x.send(C))},Zo:()=>x.close()}),A=(C,L,z)=>{C.listen(L,(U=>{try{z(U)}catch(F){setTimeout((()=>{throw F}),0)}}))};return A(x,Wd.EventType.OPEN,(()=>{S||(ye(ns,`RPC '${e}' stream ${i} transport opened.`),w.o_())})),A(x,Wd.EventType.CLOSE,(()=>{S||(S=!0,ye(ns,`RPC '${e}' stream ${i} transport closed`),w.a_(),this.E_(x))})),A(x,Wd.EventType.ERROR,(C=>{S||(S=!0,Il(ns,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),w.a_(new ve(ae.UNAVAILABLE,"The operation could not be completed")))})),A(x,Wd.EventType.MESSAGE,(C=>{if(!S){const L=C.data[0];Ie(!!L,16349);const z=L,U=z?.error||z[0]?.error;if(U){ye(ns,`RPC '${e}' stream ${i} received error:`,U);const F=U.status;let K=(function(N){const R=An[N];if(R!==void 0)return ZN(R)})(F),Z=U.message;K===void 0&&(K=ae.INTERNAL,Z="Unknown error status: "+F+" with message "+U.message),S=!0,w.a_(new ve(K,Z)),x.close()}else ye(ns,`RPC '${e}' stream ${i} received:`,L),w.u_(L)}})),A(h,XC.STAT_EVENT,(C=>{C.stat===$0.PROXY?ye(ns,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===$0.NOPROXY&&ye(ns,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function BI(){return typeof window<"u"?window:null}function am(){return typeof document<"u"?document:null}function wg(n){return new mL(n,!0)}class FI{constructor(e,t,s=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=s,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-s);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const l2="PersistentStream";class zI{constructor(e,t,s,i,o,u,h,f){this.Mi=e,this.S_=s,this.b_=i,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new FI(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(pn(t.toString()),pn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,i])=>{this.D_===t&&this.G_(s,i)}),(s=>{e((()=>{const i=new ve(ae.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(i)}))}))}G_(e,t){const s=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{s((()=>this.z_(i)))})),this.stream.onMessage((i=>{s((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ye(l2,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ye(l2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class u8 extends zI{constructor(e,t,s,i,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,i,u),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=vL(this.serializer,e),s=(function(o){if(!("targetChange"in o))return De.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?De.min():u.readTime?gs(u.readTime):De.min()})(e);return this.listener.H_(t,s)}Y_(e){const t={};t.database=ox(this.serializer),t.addTarget=(function(o,u){let h;const f=u.target;if(h=Rm(f)?{documents:oI(o,f)}:{query:lI(o,f).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=nI(o,u.resumeToken);const p=ix(o,u.expectedCount);p!==null&&(h.expectedCount=p)}else if(u.snapshotVersion.compareTo(De.min())>0){h.readTime=gu(o,u.snapshotVersion.toTimestamp());const p=ix(o,u.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const s=bL(this.serializer,e);s&&(t.labels=s),this.q_(t)}Z_(e){const t={};t.database=ox(this.serializer),t.removeTarget=e,this.q_(t)}}class d8 extends zI{constructor(e,t,s,i,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,i,u),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ie(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ie(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ie(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=xL(e.writeResults,e.commitTime),s=gs(e.commitTime);return this.listener.na(s,t)}ra(){const e={};e.database=ox(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>Pm(this.serializer,s)))};this.q_(t)}}class h8{}class f8 extends h8{constructor(e,t,s,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ve(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Go(e,ax(t,s),i,o,u))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ve(ae.UNKNOWN,o.toString())}))}Ho(e,t,s,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Ho(e,ax(t,s),i,u,h,o))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ve(ae.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class p8{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(pn(t),this.aa=!1):ye("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Vl="RemoteStore";class m8{constructor(e,t,s,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((u=>{s.enqueueAndForget((async()=>{ql(this)&&(ye(Vl,"Restarting streams for network reachability change."),await(async function(f){const p=Ce(f);p.Ea.add(4),await Wh(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Eg(p)})(this))}))})),this.Ra=new p8(s,i)}}async function Eg(n){if(ql(n))for(const e of n.da)await e(!0)}async function Wh(n){for(const e of n.da)await e(!1)}function Tg(n,e){const t=Ce(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Bb(t)?Ub(t):Du(t).O_()&&Vb(t,e))}function vu(n,e){const t=Ce(n),s=Du(t);t.Ia.delete(e),s.O_()&&qI(t,e),t.Ia.size===0&&(s.O_()?s.L_():ql(t)&&t.Ra.set("Unknown"))}function Vb(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Du(n).Y_(e)}function qI(n,e){n.Va.Ue(e),Du(n).Z_(e)}function Ub(n){n.Va=new dL({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Du(n).start(),n.Ra.ua()}function Bb(n){return ql(n)&&!Du(n).x_()&&n.Ia.size>0}function ql(n){return Ce(n).Ea.size===0}function HI(n){n.Va=void 0}async function g8(n){n.Ra.set("Online")}async function y8(n){n.Ia.forEach(((e,t)=>{Vb(n,e)}))}async function v8(n,e){HI(n),Bb(n)?(n.Ra.ha(e),Ub(n)):n.Ra.set("Unknown")}async function x8(n,e,t){if(n.Ra.set("Online"),e instanceof tI&&e.state===2&&e.cause)try{await(async function(i,o){const u=o.cause;for(const h of o.targetIds)i.Ia.has(h)&&(await i.remoteSyncer.rejectListen(h,u),i.Ia.delete(h),i.Va.removeTarget(h))})(n,e)}catch(s){ye(Vl,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await zm(n,s)}else if(e instanceof rm?n.Va.Ze(e):e instanceof eI?n.Va.st(e):n.Va.tt(e),!t.isEqual(De.min()))try{const s=await DI(n.localStore);t.compareTo(s)>=0&&await(function(o,u){const h=o.Va.Tt(u);return h.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const g=o.Ia.get(p);g&&o.Ia.set(p,g.withResumeToken(f.resumeToken,u))}})),h.targetMismatches.forEach(((f,p)=>{const g=o.Ia.get(f);if(!g)return;o.Ia.set(f,g.withResumeToken(yn.EMPTY_BYTE_STRING,g.snapshotVersion)),qI(o,f);const x=new Yi(g.target,f,p,g.sequenceNumber);Vb(o,x)})),o.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(s){ye(Vl,"Failed to raise snapshot:",s),await zm(n,s)}}async function zm(n,e,t){if(!So(e))throw e;n.Ea.add(1),await Wh(n),n.Ra.set("Offline"),t||(t=()=>DI(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ye(Vl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Eg(n)}))}function GI(n,e){return e().catch((t=>zm(n,t,e)))}async function ju(n){const e=Ce(n),t=go(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vl;for(;b8(e);)try{const i=await r8(e.localStore,s);if(i===null){e.Ta.length===0&&t.L_();break}s=i.batchId,_8(e,i)}catch(i){await zm(e,i)}$I(e)&&KI(e)}function b8(n){return ql(n)&&n.Ta.length<10}function _8(n,e){n.Ta.push(e);const t=go(n);t.O_()&&t.X_&&t.ea(e.mutations)}function $I(n){return ql(n)&&!go(n).x_()&&n.Ta.length>0}function KI(n){go(n).start()}async function S8(n){go(n).ra()}async function w8(n){const e=go(n);for(const t of n.Ta)e.ea(t.mutations)}async function E8(n,e,t){const s=n.Ta.shift(),i=Ab.from(s,e,t);await GI(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await ju(n)}async function T8(n,e){e&&go(n).X_&&await(async function(s,i){if((function(u){return lL(u)&&u!==ae.ABORTED})(i.code)){const o=s.Ta.shift();go(s).B_(),await GI(s,(()=>s.remoteSyncer.rejectFailedWrite(o.batchId,i))),await ju(s)}})(n,e),$I(n)&&KI(n)}async function c2(n,e){const t=Ce(n);t.asyncQueue.verifyOperationInProgress(),ye(Vl,"RemoteStore received new credentials");const s=ql(t);t.Ea.add(3),await Wh(t),s&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Eg(t)}async function mx(n,e){const t=Ce(n);e?(t.Ea.delete(2),await Eg(t)):e||(t.Ea.add(2),await Wh(t),t.Ra.set("Unknown"))}function Du(n){return n.ma||(n.ma=(function(t,s,i){const o=Ce(t);return o.sa(),new u8(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:g8.bind(null,n),t_:y8.bind(null,n),r_:v8.bind(null,n),H_:x8.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Bb(n)?Ub(n):n.Ra.set("Unknown")):(await n.ma.stop(),HI(n))}))),n.ma}function go(n){return n.fa||(n.fa=(function(t,s,i){const o=Ce(t);return o.sa(),new d8(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:S8.bind(null,n),r_:T8.bind(null,n),ta:w8.bind(null,n),na:E8.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await ju(n)):(await n.fa.stop(),n.Ta.length>0&&(ye(Vl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Fb{constructor(e,t,s,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=i,this.removalCallback=o,this.deferred=new yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,i,o){const u=Date.now()+s,h=new Fb(e,t,u,i,o);return h.start(s),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ve(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zb(n,e){if(pn("AsyncQueue",`${e}: ${n}`),So(n))return new ve(ae.UNAVAILABLE,`${e}: ${n}`);throw n}class su{static emptySet(e){return new su(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||be.comparator(t.key,s.key):(t,s)=>be.comparator(t.key,s.key),this.keyedMap=Xd(),this.sortedSet=new Ot(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof su)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=s.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new su;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}class u2{constructor(){this.ga=new Ot(be.comparator)}track(e){const t=e.doc.key,s=this.ga.get(t);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(t,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(t):e.type===1&&s.type===2?this.ga=this.ga.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Te(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,s)=>{e.push(s)})),e}}class xu{constructor(e,t,s,i,o,u,h,f,p){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,s,i,o){const u=[];return t.forEach((h=>{u.push({type:0,doc:h})})),new xu(e,t,su.emptySet(t),u,s,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==s[i].type||!t[i].doc.isEqual(s[i].doc))return!1;return!0}}class A8{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class C8{constructor(){this.queries=d2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,s){const i=Ce(t),o=i.queries;i.queries=d2(),o.forEach(((u,h)=>{for(const f of h.Sa)f.onError(s)}))})(this,new ve(ae.ABORTED,"Firestore shutting down"))}}function d2(){return new aa((n=>UN(n)),gg)}async function QI(n,e){const t=Ce(n);let s=3;const i=e.query;let o=t.queries.get(i);o?!o.ba()&&e.Da()&&(s=2):(o=new A8,s=e.Da()?0:1);try{switch(s){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(u){const h=zb(u,`Initialization of query '${Fc(e.query)}' failed`);return void e.onError(h)}t.queries.set(i,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&qb(t)}async function YI(n,e){const t=Ce(n),s=e.query;let i=3;const o=t.queries.get(s);if(o){const u=o.Sa.indexOf(e);u>=0&&(o.Sa.splice(u,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function N8(n,e){const t=Ce(n);let s=!1;for(const i of e){const o=i.query,u=t.queries.get(o);if(u){for(const h of u.Sa)h.Fa(i)&&(s=!0);u.wa=i}}s&&qb(t)}function I8(n,e,t){const s=Ce(n),i=s.queries.get(e);if(i)for(const o of i.Sa)o.onError(t);s.queries.delete(e)}function qb(n){n.Ca.forEach((e=>{e.next()}))}var gx,h2;(h2=gx||(gx={})).Ma="default",h2.Cache="cache";class WI{constructor(e,t,s){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new xu(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const s=t!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=xu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gx.Cache}}class XI{constructor(e){this.key=e}}class JI{constructor(e){this.key=e}}class R8{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ge(),this.mutatedKeys=Ge(),this.eu=FN(e),this.tu=new su(this.eu)}get nu(){return this.Ya}ru(e,t){const s=t?t.iu:new u2,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,u=i,h=!1;const f=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((g,x)=>{const b=i.get(g),S=$h(this.query,x)?x:null,w=!!b&&this.mutatedKeys.has(b.key),A=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let C=!1;b&&S?b.data.isEqual(S.data)?w!==A&&(s.track({type:3,doc:S}),C=!0):this.su(b,S)||(s.track({type:2,doc:S}),C=!0,(f&&this.eu(S,f)>0||p&&this.eu(S,p)<0)&&(h=!0)):!b&&S?(s.track({type:0,doc:S}),C=!0):b&&!S&&(s.track({type:1,doc:b}),C=!0,(f||p)&&(h=!0)),C&&(S?(u=u.add(S),o=A?o.add(g):o.delete(g)):(u=u.delete(g),o=o.delete(g)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const g=this.query.limitType==="F"?u.last():u.first();u=u.delete(g.key),o=o.delete(g.key),s.track({type:1,doc:g})}return{tu:u,iu:s,Cs:h,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((g,x)=>(function(S,w){const A=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Te(20277,{Rt:C})}};return A(S)-A(w)})(g.type,x.type)||this.eu(g.doc,x.doc))),this.ou(s),i=i??!1;const h=t&&!i?this._u():[],f=this.Xa.size===0&&this.current&&!i?1:0,p=f!==this.Za;return this.Za=f,u.length!==0||p?{snapshot:new xu(this.query,e.tu,o,u,e.mutatedKeys,f===0,p,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new u2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ge(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const t=[];return e.forEach((s=>{this.Xa.has(s)||t.push(new JI(s))})),this.Xa.forEach((s=>{e.has(s)||t.push(new XI(s))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ge();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return xu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ou="SyncEngine";class j8{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class D8{constructor(e){this.key=e,this.hu=!1}}class O8{constructor(e,t,s,i,o,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new aa((h=>UN(h)),gg),this.Iu=new Map,this.Eu=new Set,this.du=new Ot(be.comparator),this.Au=new Map,this.Ru=new Db,this.Vu={},this.mu=new Map,this.fu=Ll.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function P8(n,e,t=!0){const s=Ag(n);let i;const o=s.Tu.get(e);return o?(s.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await ZI(s,e,t,!0),i}async function k8(n,e){const t=Ag(n);await ZI(t,e,!0,!1)}async function ZI(n,e,t,s){const i=await Um(n.localStore,er(e)),o=i.targetId,u=n.sharedClientState.addLocalQueryTarget(o,t);let h;return s&&(h=await Hb(n,e,o,u==="current",i.resumeToken)),n.isPrimaryClient&&t&&Tg(n.remoteStore,i),h}async function Hb(n,e,t,s,i){n.pu=(x,b,S)=>(async function(A,C,L,z){let U=C.view.ru(L);U.Cs&&(U=await hx(A.localStore,C.query,!1).then((({documents:j})=>C.view.ru(j,U))));const F=z&&z.targetChanges.get(C.targetId),K=z&&z.targetMismatches.get(C.targetId)!=null,Z=C.view.applyChanges(U,A.isPrimaryClient,F,K);return yx(A,C.targetId,Z.au),Z.snapshot})(n,x,b,S);const o=await hx(n.localStore,e,!0),u=new R8(e,o.Qs),h=u.ru(o.documents),f=Yh.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",i),p=u.applyChanges(h,n.isPrimaryClient,f);yx(n,t,p.au);const g=new j8(e,t,u);return n.Tu.set(e,g),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function M8(n,e,t){const s=Ce(n),i=s.Tu.get(e),o=s.Iu.get(i.targetId);if(o.length>1)return s.Iu.set(i.targetId,o.filter((u=>!gg(u,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await yu(s.localStore,i.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(i.targetId),t&&vu(s.remoteStore,i.targetId),bu(s,i.targetId)})).catch(_o)):(bu(s,i.targetId),await yu(s.localStore,i.targetId,!0))}async function L8(n,e){const t=Ce(n),s=t.Tu.get(e),i=t.Iu.get(s.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),vu(t.remoteStore,s.targetId))}async function V8(n,e,t){const s=Qb(n);try{const i=await(function(u,h){const f=Ce(u),p=_t.now(),g=h.reduce(((S,w)=>S.add(w.key)),Ge());let x,b;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let w=Zs(),A=Ge();return f.Ns.getEntries(S,g).next((C=>{w=C,w.forEach(((L,z)=>{z.isValidDocument()||(A=A.add(L))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,w))).next((C=>{x=C;const L=[];for(const z of h){const U=aL(z,x.get(z.key).overlayedDocument);U!=null&&L.push(new oa(z.key,U,RN(U.value.mapValue),On.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,L,h)})).next((C=>{b=C;const L=C.applyToLocalDocumentSet(x,A);return f.documentOverlayCache.saveOverlays(S,C.batchId,L)}))})).then((()=>({batchId:b.batchId,changes:qN(x)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),(function(u,h,f){let p=u.Vu[u.currentUser.toKey()];p||(p=new Ot(Me)),p=p.insert(h,f),u.Vu[u.currentUser.toKey()]=p})(s,i.batchId,t),await Eo(s,i.changes),await ju(s.remoteStore)}catch(i){const o=zb(i,"Failed to persist write");t.reject(o)}}async function eR(n,e){const t=Ce(n);try{const s=await n8(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const u=t.Au.get(o);u&&(Ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?u.hu=!0:i.modifiedDocuments.size>0?Ie(u.hu,14607):i.removedDocuments.size>0&&(Ie(u.hu,42227),u.hu=!1))})),await Eo(t,s,e)}catch(s){await _o(s)}}function f2(n,e,t){const s=Ce(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const i=[];s.Tu.forEach(((o,u)=>{const h=u.view.va(e);h.snapshot&&i.push(h.snapshot)})),(function(u,h){const f=Ce(u);f.onlineState=h;let p=!1;f.queries.forEach(((g,x)=>{for(const b of x.Sa)b.va(h)&&(p=!0)})),p&&qb(f)})(s.eventManager,e),i.length&&s.Pu.H_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function U8(n,e,t){const s=Ce(n);s.sharedClientState.updateQueryState(e,"rejected",t);const i=s.Au.get(e),o=i&&i.key;if(o){let u=new Ot(be.comparator);u=u.insert(o,on.newNoDocument(o,De.min()));const h=Ge().add(o),f=new Qh(De.min(),new Map,new Ot(Me),u,h);await eR(s,f),s.du=s.du.remove(o),s.Au.delete(e),Kb(s)}else await yu(s.localStore,e,!1).then((()=>bu(s,e,t))).catch(_o)}async function B8(n,e){const t=Ce(n),s=e.batch.batchId;try{const i=await t8(t.localStore,e);$b(t,s,null),Gb(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Eo(t,i)}catch(i){await _o(i)}}async function F8(n,e,t){const s=Ce(n);try{const i=await(function(u,h){const f=Ce(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return f.mutationQueue.lookupMutationBatch(p,h).next((x=>(Ie(x!==null,37113),g=x.keys(),f.mutationQueue.removeMutationBatch(p,x)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,g,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>f.localDocuments.getDocuments(p,g)))}))})(s.localStore,e);$b(s,e,t),Gb(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Eo(s,i)}catch(i){await _o(i)}}function Gb(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function $b(n,e,t){const s=Ce(n);let i=s.Vu[s.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),s.Vu[s.currentUser.toKey()]=i}}function bu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Iu.get(e))n.Tu.delete(s),t&&n.Pu.yu(s,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((s=>{n.Ru.containsKey(s)||tR(n,s)}))}function tR(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(vu(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),Kb(n))}function yx(n,e,t){for(const s of t)s instanceof XI?(n.Ru.addReference(s.key,e),z8(n,s)):s instanceof JI?(ye(Ou,"Document no longer in limbo: "+s.key),n.Ru.removeReference(s.key,e),n.Ru.containsKey(s.key)||tR(n,s.key)):Te(19791,{wu:s})}function z8(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Eu.has(s)||(ye(Ou,"New document in limbo: "+t),n.Eu.add(s),Kb(n))}function Kb(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new be(dt.fromString(e)),s=n.fu.next();n.Au.set(s,new D8(t)),n.du=n.du.insert(t,s),Tg(n.remoteStore,new Yi(er(mg(t.path)),s,"TargetPurposeLimboResolution",Os.ce))}}async function Eo(n,e,t){const s=Ce(n),i=[],o=[],u=[];s.Tu.isEmpty()||(s.Tu.forEach(((h,f)=>{u.push(s.pu(f,e,t).then((p=>{if((p||t)&&s.isPrimaryClient){const g=p?!p.fromCache:t?.targetChanges.get(f.targetId)?.current;s.sharedClientState.updateQueryState(f.targetId,g?"current":"not-current")}if(p){i.push(p);const g=kb.As(f.targetId,p);o.push(g)}})))})),await Promise.all(u),s.Pu.H_(i),await(async function(f,p){const g=Ce(f);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>X.forEach(p,(b=>X.forEach(b.Es,(S=>g.persistence.referenceDelegate.addReference(x,b.targetId,S))).next((()=>X.forEach(b.ds,(S=>g.persistence.referenceDelegate.removeReference(x,b.targetId,S)))))))))}catch(x){if(!So(x))throw x;ye(Mb,"Failed to update sequence numbers: "+x)}for(const x of p){const b=x.targetId;if(!x.fromCache){const S=g.Ms.get(b),w=S.snapshotVersion,A=S.withLastLimboFreeSnapshotVersion(w);g.Ms=g.Ms.insert(b,A)}}})(s.localStore,o))}async function q8(n,e){const t=Ce(n);if(!t.currentUser.isEqual(e)){ye(Ou,"User change. New user:",e.toKey());const s=await jI(t.localStore,e);t.currentUser=e,(function(o,u){o.mu.forEach((h=>{h.forEach((f=>{f.reject(new ve(ae.CANCELLED,u))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Eo(t,s.Ls)}}function H8(n,e){const t=Ce(n),s=t.Au.get(e);if(s&&s.hu)return Ge().add(s.key);{let i=Ge();const o=t.Iu.get(e);if(!o)return i;for(const u of o){const h=t.Tu.get(u);i=i.unionWith(h.view.nu)}return i}}async function G8(n,e){const t=Ce(n),s=await hx(t.localStore,e.query,!0),i=e.view.cu(s);return t.isPrimaryClient&&yx(t,e.targetId,i.au),i}async function $8(n,e){const t=Ce(n);return PI(t.localStore,e).then((s=>Eo(t,s)))}async function K8(n,e,t,s){const i=Ce(n),o=await(function(h,f){const p=Ce(h),g=Ce(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(x=>g.er(x,f).next((b=>b?p.localDocuments.getDocuments(x,b):X.resolve(null)))))})(i.localStore,e);o!==null?(t==="pending"?await ju(i.remoteStore):t==="acknowledged"||t==="rejected"?($b(i,e,s||null),Gb(i,e),(function(h,f){Ce(Ce(h).mutationQueue).ir(f)})(i.localStore,e)):Te(6720,"Unknown batchState",{Su:t}),await Eo(i,o)):ye(Ou,"Cannot apply mutation batch with id: "+e)}async function Q8(n,e){const t=Ce(n);if(Ag(t),Qb(t),e===!0&&t.gu!==!0){const s=t.sharedClientState.getAllActiveQueryTargets(),i=await p2(t,s.toArray());t.gu=!0,await mx(t.remoteStore,!0);for(const o of i)Tg(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const s=[];let i=Promise.resolve();t.Iu.forEach(((o,u)=>{t.sharedClientState.isLocalQueryTarget(u)?s.push(u):i=i.then((()=>(bu(t,u),yu(t.localStore,u,!0)))),vu(t.remoteStore,u)})),await i,await p2(t,s),(function(u){const h=Ce(u);h.Au.forEach(((f,p)=>{vu(h.remoteStore,p)})),h.Ru.Jr(),h.Au=new Map,h.du=new Ot(be.comparator)})(t),t.gu=!1,await mx(t.remoteStore,!1)}}async function p2(n,e,t){const s=Ce(n),i=[],o=[];for(const u of e){let h;const f=s.Iu.get(u);if(f&&f.length!==0){h=await Um(s.localStore,er(f[0]));for(const p of f){const g=s.Tu.get(p),x=await G8(s,g);x.snapshot&&o.push(x.snapshot)}}else{const p=await OI(s.localStore,u);h=await Um(s.localStore,p),await Hb(s,nR(p),u,!1,h.resumeToken)}i.push(h)}return s.Pu.H_(o),i}function nR(n){return VN(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Y8(n){return(function(t){return Ce(Ce(t).persistence).Ts()})(Ce(n).localStore)}async function W8(n,e,t,s){const i=Ce(n);if(i.gu)return void ye(Ou,"Ignoring unexpected query state notification.");const o=i.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const u=await PI(i.localStore,BN(o[0])),h=Qh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",yn.EMPTY_BYTE_STRING);await Eo(i,u,h);break}case"rejected":await yu(i.localStore,e,!0),bu(i,e,s);break;default:Te(64155,t)}}async function X8(n,e,t){const s=Ag(n);if(s.gu){for(const i of e){if(s.Iu.has(i)&&s.sharedClientState.isActiveQueryTarget(i)){ye(Ou,"Adding an already active target "+i);continue}const o=await OI(s.localStore,i),u=await Um(s.localStore,o);await Hb(s,nR(o),u.targetId,!1,u.resumeToken),Tg(s.remoteStore,u)}for(const i of t)s.Iu.has(i)&&await yu(s.localStore,i,!1).then((()=>{vu(s.remoteStore,i),bu(s,i)})).catch(_o)}}function Ag(n){const e=Ce(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=eR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=H8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=U8.bind(null,e),e.Pu.H_=N8.bind(null,e.eventManager),e.Pu.yu=I8.bind(null,e.eventManager),e}function Qb(n){const e=Ce(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=B8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=F8.bind(null,e),e}class jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wg(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return RI(this.persistence,new II,e.initialUser,this.serializer)}Cu(e){return new Ob(Sg.mi,this.serializer)}Du(e){return new UI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jh.provider={build:()=>new jh};class J8 extends jh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ie(this.persistence.referenceDelegate instanceof Vm,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new wI(s,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ss.withCacheSize(this.cacheSizeBytes):ss.DEFAULT;return new Ob((s=>Vm.mi(s,t)),this.serializer)}}class Yb extends jh{constructor(e,t,s){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Qb(this.xu.syncEngine),await ju(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return RI(this.persistence,new II,e.initialUser,this.serializer)}Fu(e,t){const s=this.persistence.referenceDelegate.garbageCollector;return new wI(s,e.asyncQueue,t)}Mu(e,t){const s=new c5(t,this.persistence);return new l5(e.asyncQueue,s)}Cu(e){const t=NI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?ss.withCacheSize(this.cacheSizeBytes):ss.DEFAULT;return new Pb(this.synchronizeTabs,t,e.clientId,s,e.asyncQueue,BI(),am(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new UI}}class Z8 extends Yb{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof c0&&(this.sharedClientState.syncEngine={Co:K8.bind(null,t),vo:W8.bind(null,t),Fo:X8.bind(null,t),Ts:Y8.bind(null,t),Do:$8.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async s=>{await Q8(this.xu.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())}))}Du(e){const t=BI();if(!c0.v(t))throw new ve(ae.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=NI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new c0(t,e.asyncQueue,s,e.clientId,e.initialUser)}}class _u{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>f2(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=q8.bind(null,this.syncEngine),await mx(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new C8})()}createDatastore(e){const t=wg(e.databaseInfo.databaseId),s=(function(o){return new c8(o)})(e.databaseInfo);return(function(o,u,h,f){return new f8(o,u,h,f)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,i,o,u,h){return new m8(s,i,o,u,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>f2(this.syncEngine,t,0)),(function(){return o2.v()?new o2:new i8})())}createSyncEngine(e,t){return(function(i,o,u,h,f,p,g){const x=new O8(i,o,u,h,f,p);return g&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const s=Ce(t);ye(Vl,"RemoteStore shutting down."),s.Ea.add(5),await Wh(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_u.provider={build:()=>new _u};class sR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):pn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const yo="FirestoreClient";class eV{constructor(e,t,s,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=i,this.user=zn.UNAUTHENTICATED,this.clientId=hb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(s,(async u=>{ye(yo,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(ye(yo,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=zb(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function d0(n,e){n.asyncQueue.verifyOperationInProgress(),ye(yo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async i=>{s.isEqual(i)||(await jI(e.localStore,i),s=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function m2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await tV(n);ye(yo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>c2(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,i)=>c2(e.remoteStore,i))),n._onlineComponents=e}async function tV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye(yo,"Using user provided OfflineComponentProvider");try{await d0(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ae.FAILED_PRECONDITION||i.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Il("Error using user provided cache. Falling back to memory cache: "+t),await d0(n,new jh)}}else ye(yo,"Using default OfflineComponentProvider"),await d0(n,new J8(void 0));return n._offlineComponents}async function rR(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye(yo,"Using user provided OnlineComponentProvider"),await m2(n,n._uninitializedComponentsProvider._online)):(ye(yo,"Using default OnlineComponentProvider"),await m2(n,new _u))),n._onlineComponents}function nV(n){return rR(n).then((e=>e.syncEngine))}async function iR(n){const e=await rR(n),t=e.eventManager;return t.onListen=P8.bind(null,e.syncEngine),t.onUnlisten=M8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=k8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=L8.bind(null,e.syncEngine),t}function sV(n,e,t={}){const s=new yi;return n.asyncQueue.enqueueAndForget((async()=>(function(o,u,h,f,p){const g=new sR({next:b=>{g.Nu(),u.enqueueAndForget((()=>YI(o,x)));const S=b.docs.has(h);!S&&b.fromCache?p.reject(new ve(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&b.fromCache&&f&&f.source==="server"?p.reject(new ve(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(b)},error:b=>p.reject(b)}),x=new WI(mg(h.path),g,{includeMetadataChanges:!0,qa:!0});return QI(o,x)})(await iR(n),n.asyncQueue,e,t,s))),s.promise}function rV(n,e,t={}){const s=new yi;return n.asyncQueue.enqueueAndForget((async()=>(function(o,u,h,f,p){const g=new sR({next:b=>{g.Nu(),u.enqueueAndForget((()=>YI(o,x))),b.fromCache&&f.source==="server"?p.reject(new ve(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),x=new WI(h,g,{includeMetadataChanges:!0,qa:!0});return QI(o,x)})(await iR(n),n.asyncQueue,e,t,s))),s.promise}function aR(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const g2=new Map;const oR="firestore.googleapis.com",y2=!0;class v2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ve(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=oR,this.ssl=y2}else this.host=e.host,this.ssl=e.ssl??y2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SI)throw new ve(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}r5("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aR(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ve(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ve(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ve(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,i){return s.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cg{constructor(e,t,s,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new v2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ve(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ve(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new v2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new QM;switch(s.type){case"firstParty":return new JM(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ve(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=g2.get(t);s&&(ye("ComponentProvider","Removing Datastore"),g2.delete(t),s.terminate())})(this),Promise.resolve()}}function iV(n,e,t,s={}){n=nr(n,Cg);const i=vo(e),o=n._getSettings(),u={...o,emulatorOptions:n._getEmulatorOptions()},h=`${e}:${t}`;i&&(tg(`https://${h}`),eb("Firestore",!0)),o.host!==oR&&o.host!==h&&Il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...o,host:h,ssl:i,emulatorOptions:s};if(!_i(f,u)&&(n._setSettings(f),s.mockUserToken)){let p,g;if(typeof s.mockUserToken=="string")p=s.mockUserToken,g=zn.MOCK_USER;else{p=sC(s.mockUserToken,n._app?.options.projectId);const x=s.mockUserToken.sub||s.mockUserToken.user_id;if(!x)throw new ve(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new zn(x)}n._authCredentials=new YM(new tN(p,g))}}class la{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new la(this.firestore,e,this._query)}}class gn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gn(this.firestore,e,this._key)}toJSON(){return{type:gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(qh(t,gn._jsonSchema))return new gn(e,s||null,new be(dt.fromString(t.referencePath)))}}gn._jsonSchemaVersion="firestore/documentReference/1.0",gn._jsonSchema={type:Cn("string",gn._jsonSchemaVersion),referencePath:Cn("string")};class lo extends la{constructor(e,t,s){super(e,t,mg(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gn(this.firestore,null,new be(e))}withConverter(e){return new lo(this.firestore,e,this._path)}}function bt(n,e,...t){if(n=Jt(n),sN("collection","path",e),n instanceof Cg){const s=dt.fromString(e,...t);return lT(s),new lo(n,null,s)}{if(!(n instanceof gn||n instanceof lo))throw new ve(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(dt.fromString(e,...t));return lT(s),new lo(n.firestore,null,s)}}function at(n,e,...t){if(n=Jt(n),arguments.length===1&&(e=hb.newId()),sN("doc","path",e),n instanceof Cg){const s=dt.fromString(e,...t);return oT(s),new gn(n,null,new be(s))}{if(!(n instanceof gn||n instanceof lo))throw new ve(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(dt.fromString(e,...t));return oT(s),new gn(n.firestore,n instanceof lo?n.converter:null,new be(s))}}const x2="AsyncQueue";class b2{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new FI(this,"async_queue_retry"),this._c=()=>{const s=am();s&&ye(x2,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const t=am();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=am();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new yi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!So(e))throw e;ye(x2,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,pn("INTERNAL UNHANDLED ERROR: ",_2(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=t,t}enqueueAfterDelay(e,t,s){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Fb.createAndSchedule(this,e,t,s,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&Te(47125,{Pc:_2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function _2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class ca extends Cg{constructor(e,t,s,i){super(e,t,s,i),this.type="firestore",this._queue=new b2,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new b2(e),this._firestoreClient=void 0,await e}}}function aV(n,e,t){t||(t=Ah);const s=Cu(n,"firestore");if(s.isInitialized(t)){const i=s.getImmediate({identifier:t}),o=s.getOptions(t);if(_i(o,e))return i;throw new ve(ae.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ve(ae.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SI)throw new ve(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&vo(e.host)&&tg(e.host),s.initialize({options:e,instanceIdentifier:t})}function h0(n,e){const t=typeof n=="object"?n:ng(),s=typeof n=="string"?n:Ah,i=Cu(t,"firestore").getImmediate({identifier:s});if(!i._initialized){const o=eC("firestore");o&&iV(i,...o)}return i}function Ng(n){if(n._terminated)throw new ve(ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||lR(n),n._firestoreClient}function lR(n){const e=n._freezeSettings(),t=(function(i,o,u,h){return new L5(i,o,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,aR(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new eV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}function oV(n,e){Il("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return lV(n,_u.provider,{build:s=>new Yb(s,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function lV(n,e,t){if((n=nr(n,ca))._firestoreClient||n._terminated)throw new ve(ae.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ve(ae.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},lR(n)}class _r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _r(yn.fromBase64String(e))}catch(t){throw new ve(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new _r(yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:_r._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qh(e,_r._jsonSchema))return _r.fromBase64String(e.bytes)}}_r._jsonSchemaVersion="firestore/bytes/1.0",_r._jsonSchema={type:Cn("string",_r._jsonSchemaVersion),bytes:Cn("string")};class Xh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ve(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Pu{constructor(e){this._methodName=e}}class vi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ve(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ve(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vi._jsonSchemaVersion}}static fromJSON(e){if(qh(e,vi._jsonSchema))return new vi(e.latitude,e.longitude)}}vi._jsonSchemaVersion="firestore/geoPoint/1.0",vi._jsonSchema={type:Cn("string",vi._jsonSchemaVersion),latitude:Cn("number"),longitude:Cn("number")};class xi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,i){if(s.length!==i.length)return!1;for(let o=0;o<s.length;++o)if(s[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qh(e,xi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xi(e.vectorValues);throw new ve(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xi._jsonSchemaVersion="firestore/vectorValue/1.0",xi._jsonSchema={type:Cn("string",xi._jsonSchemaVersion),vectorValues:Cn("object")};const cV=/^__.*__$/;class uV{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new oa(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ru(e,this.data,t,this.fieldTransforms)}}class cR{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new oa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function uR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Te(40011,{Ac:n})}}class Ig{constructor(e,t,s,i,o,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ig({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.gc(e),s}yc(e){const t=this.path?.child(e),s=this.Vc({path:t,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return qm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(uR(this.Ac)&&cV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class dV{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||wg(e)}Cc(e,t,s,i=!1){return new Ig({Ac:e,methodName:t,Dc:s,path:Xt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ku(n){const e=n._freezeSettings(),t=wg(n._databaseId);return new dV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Wb(n,e,t,s,i,o={}){const u=n.Cc(o.merge||o.mergeFields?2:0,e,t,i);e_("Data must be an object, but it was:",u,s);const h=mR(s,u);let f,p;if(o.merge)f=new Ps(u.fieldMask),p=u.fieldTransforms;else if(o.mergeFields){const g=[];for(const x of o.mergeFields){const b=vx(e,x,t);if(!u.contains(b))throw new ve(ae.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);yR(g,b)||g.push(b)}f=new Ps(g),p=u.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,p=u.fieldTransforms;return new uV(new rs(h),f,p)}class Jh extends Pu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jh}}function dR(n,e,t){return new Ig({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Xb extends Pu{_toFieldTransform(e){return new vg(e.path,new mu)}isEqual(e){return e instanceof Xb}}class Jb extends Pu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=dR(this,e,!0),s=this.vc.map((o=>Hl(o,t))),i=new Ol(s);return new vg(e.path,i)}isEqual(e){return e instanceof Jb&&_i(this.vc,e.vc)}}class Zb extends Pu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=dR(this,e,!0),s=this.vc.map((o=>Hl(o,t))),i=new Pl(s);return new vg(e.path,i)}isEqual(e){return e instanceof Zb&&_i(this.vc,e.vc)}}function hR(n,e,t,s){const i=n.Cc(1,e,t);e_("Data must be an object, but it was:",i,s);const o=[],u=rs.empty();wo(s,((f,p)=>{const g=t_(e,f,t);p=Jt(p);const x=i.yc(g);if(p instanceof Jh)o.push(g);else{const b=Hl(p,x);b!=null&&(o.push(g),u.set(g,b))}}));const h=new Ps(o);return new cR(u,h,i.fieldTransforms)}function fR(n,e,t,s,i,o){const u=n.Cc(1,e,t),h=[vx(e,s,t)],f=[i];if(o.length%2!=0)throw new ve(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)h.push(vx(e,o[b])),f.push(o[b+1]);const p=[],g=rs.empty();for(let b=h.length-1;b>=0;--b)if(!yR(p,h[b])){const S=h[b];let w=f[b];w=Jt(w);const A=u.yc(S);if(w instanceof Jh)p.push(S);else{const C=Hl(w,A);C!=null&&(p.push(S),g.set(S,C))}}const x=new Ps(p);return new cR(g,x,u.fieldTransforms)}function pR(n,e,t,s=!1){return Hl(t,n.Cc(s?4:3,e))}function Hl(n,e){if(gR(n=Jt(n)))return e_("Unsupported field value:",e,n),mR(n,e);if(n instanceof Pu)return(function(s,i){if(!uR(i.Ac))throw i.Sc(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${s._methodName}() is not currently supported inside arrays`);const o=s._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,i){const o=[];let u=0;for(const h of s){let f=Hl(h,i.wc(u));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),u++}return{arrayValue:{values:o}}})(n,e)}return(function(s,i){if((s=Jt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return eL(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const o=_t.fromDate(s);return{timestampValue:gu(i.serializer,o)}}if(s instanceof _t){const o=new _t(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:gu(i.serializer,o)}}if(s instanceof vi)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof _r)return{bytesValue:nI(i.serializer,s._byteString)};if(s instanceof gn){const o=i.databaseId,u=s.firestore._databaseId;if(!u.isEqual(o))throw i.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ib(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof xi)return(function(u,h){return{mapValue:{fields:{[xb]:{stringValue:bb},[hu]:{arrayValue:{values:u.toArray().map((p=>{if(typeof p!="number")throw h.Sc("VectorValues must only contain numeric values.");return Eb(h.serializer,p)}))}}}}}})(s,i);throw i.Sc(`Unsupported field value: ${ag(s)}`)})(n,e)}function mR(n,e){const t={};return _N(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wo(n,((s,i)=>{const o=Hl(i,e.mc(s));o!=null&&(t[s]=o)})),{mapValue:{fields:t}}}function gR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof vi||n instanceof _r||n instanceof gn||n instanceof Pu||n instanceof xi)}function e_(n,e,t){if(!gR(t)||!rN(t)){const s=ag(t);throw s==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+s)}}function vx(n,e,t){if((e=Jt(e))instanceof Xh)return e._internalPath;if(typeof e=="string")return t_(n,e);throw qm("Field path arguments must be of type string or ",n,!1,void 0,t)}const hV=new RegExp("[~\\*/\\[\\]]");function t_(n,e,t){if(e.search(hV)>=0)throw qm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Xh(...e.split("."))._internalPath}catch{throw qm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qm(n,e,t,s,i){const o=s&&!s.isEmpty(),u=i!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(o||u)&&(f+=" (found",o&&(f+=` in field ${s}`),u&&(f+=` in document ${i}`),f+=")"),new ve(ae.INVALID_ARGUMENT,h+n+f)}function yR(n,e){return n.some((t=>t.isEqual(e)))}class n_{constructor(e,t,s,i,o){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new fV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Rg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class fV extends n_{data(){return super.data()}}function Rg(n,e){return typeof e=="string"?t_(n,e):e instanceof Xh?e._internalPath:e._delegate._internalPath}function pV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ve(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class s_{}class jg extends s_{}function an(n,e,...t){let s=[];e instanceof s_&&s.push(e),s=s.concat(t),(function(o){const u=o.filter((f=>f instanceof r_)).length,h=o.filter((f=>f instanceof Dg)).length;if(u>1||u>0&&h>0)throw new ve(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const i of s)n=i._apply(n);return n}class Dg extends jg{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Dg(e,t,s)}_apply(e){const t=this._parse(e);return vR(e._query,t),new la(e.firestore,e.converter,rx(e._query,t))}_parse(e){const t=ku(e.firestore);return(function(o,u,h,f,p,g,x){let b;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ve(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){T2(x,g);const w=[];for(const A of x)w.push(E2(f,o,A));b={arrayValue:{values:w}}}else b=E2(f,o,x)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||T2(x,g),b=pR(h,u,x,g==="in"||g==="not-in");return et.create(p,g,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mn(n,e,t){const s=e,i=Rg("where",n);return Dg._create(i,s,t)}class r_ extends s_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new r_(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:St.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let u=i;const h=o.getFlattenedFilters();for(const f of h)vR(u,f),u=rx(u,f)})(e._query,t),new la(e.firestore,e.converter,rx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class i_ extends jg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new i_(e,t)}_apply(e){const t=(function(i,o,u){if(i.startAt!==null)throw new ve(ae.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ve(ae.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ih(o,u)})(e._query,this._field,this._direction);return new la(e.firestore,e.converter,(function(i,o){const u=i.explicitOrderBy.concat([o]);return new zl(i.path,i.collectionGroup,u,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}}function S2(n,e="asc"){const t=e,s=Rg("orderBy",n);return i_._create(s,t)}class a_ extends jg{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new a_(e,t,s)}_apply(e){return new la(e.firestore,e.converter,Dm(e._query,this._limit,this._limitType))}}function w2(n){return i5("limit",n),a_._create("limit",n,"F")}class o_ extends jg{constructor(e,t,s){super(),this.type=e,this._docOrFields=t,this._inclusive=s}static _create(e,t,s){return new o_(e,t,s)}_apply(e){const t=gV(e,this.type,this._docOrFields,this._inclusive);return new la(e.firestore,e.converter,(function(i,o){return new zl(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)})(e._query,t))}}function mV(...n){return o_._create("startAfter",n,!1)}function gV(n,e,t,s){if(t[0]=Jt(t[0]),t[0]instanceof n_)return(function(o,u,h,f,p){if(!f)throw new ve(ae.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${h}().`);const g=[];for(const x of nu(o))if(x.field.isKeyField())g.push(jl(u,f.key));else{const b=f.data.field(x.field);if(hg(b))throw new ve(ae.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(b===null){const S=x.field.canonicalString();throw new ve(ae.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}g.push(b)}return new mo(g,p)})(n._query,n.firestore._databaseId,e,t[0]._document,s);{const i=ku(n.firestore);return(function(u,h,f,p,g,x){const b=u.explicitOrderBy;if(g.length>b.length)throw new ve(ae.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let w=0;w<g.length;w++){const A=g[w];if(b[w].field.isKeyField()){if(typeof A!="string")throw new ve(ae.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof A}`);if(!Sb(u)&&A.indexOf("/")!==-1)throw new ve(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${A}' contains a slash.`);const C=u.path.child(dt.fromString(A));if(!be.isDocumentKey(C))throw new ve(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${C}' is not because it contains an odd number of segments.`);const L=new be(C);S.push(jl(h,L))}else{const C=pR(f,p,A);S.push(C)}}return new mo(S,x)})(n._query,n.firestore._databaseId,i,e,t,s)}}function E2(n,e,t){if(typeof(t=Jt(t))=="string"){if(t==="")throw new ve(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sb(e)&&t.indexOf("/")!==-1)throw new ve(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(dt.fromString(t));if(!be.isDocumentKey(s))throw new ve(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return jl(n,new be(s))}if(t instanceof gn)return jl(n,t._key);throw new ve(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ag(t)}.`)}function T2(n,e){if(!Array.isArray(n)||n.length===0)throw new ve(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vR(n,e){const t=(function(i,o){for(const u of i)for(const h of u.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ve(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ve(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class yV{convertValue(e,t="none"){switch(fo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(sa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Te(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return wo(e,((i,o)=>{s[i]=this.convertValue(o,t)})),s}convertVectorValue(e){const t=e.fields?.[hu].arrayValue?.values?.map((s=>Ht(s.doubleValue)));return new xi(t)}convertGeoPoint(e){return new vi(Ht(e.latitude),Ht(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=fg(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Th(e));default:return null}}convertTimestamp(e){const t=na(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=dt.fromString(e);Ie(hI(s),9688,{name:e});const i=new Rl(s.get(1),s.get(3)),o=new be(s.popFirst(5));return i.isEqual(t)||pn(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function l_(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class eh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _l extends n_{constructor(e,t,s,i,o,u){super(e,t,s,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new om(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Rg("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ve(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=_l._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}_l._jsonSchemaVersion="firestore/documentSnapshot/1.0",_l._jsonSchema={type:Cn("string",_l._jsonSchemaVersion),bundleSource:Cn("string","DocumentSnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class om extends _l{data(e={}){return super.data(e)}}class ru{constructor(e,t,s,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new eh(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new om(this._firestore,this._userDataWriter,s.key,s,new eh(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ve(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let u=0;return i._snapshot.docChanges.map((h=>{const f=new om(i._firestore,i._userDataWriter,h.doc.key,h.doc,new eh(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}}))}{let u=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const f=new om(i._firestore,i._userDataWriter,h.doc.key,h.doc,new eh(i._snapshot.mutatedKeys.has(h.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,g=-1;return h.type!==0&&(p=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),g=u.indexOf(h.doc.key)),{type:vV(h.type),doc:f,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ve(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ru._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hb.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),s.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Te(61501,{type:n})}}function ra(n){n=nr(n,gn);const e=nr(n.firestore,ca);return sV(Ng(e),n._key).then((t=>bV(e,n,t)))}ru._jsonSchemaVersion="firestore/querySnapshot/1.0",ru._jsonSchema={type:Cn("string",ru._jsonSchemaVersion),bundleSource:Cn("string","QuerySnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class xR extends yV{constructor(e){super(),this.firestore=e}convertBytes(e){return new _r(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gn(this.firestore,null,t)}}function Wt(n){n=nr(n,la);const e=nr(n.firestore,ca),t=Ng(e),s=new xR(e);return pV(n._query),rV(t,n._query).then((i=>new ru(e,s,n,i)))}function ml(n,e,t){n=nr(n,gn);const s=nr(n.firestore,ca),i=l_(n.converter,e,t);return Zh(s,[Wb(ku(s),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,On.none())])}function is(n,e,t,...s){n=nr(n,gn);const i=nr(n.firestore,ca),o=ku(i);let u;return u=typeof(e=Jt(e))=="string"||e instanceof Xh?fR(o,"updateDoc",n._key,e,t,s):hR(o,"updateDoc",n._key,e),Zh(i,[u.toMutation(n._key,On.exists(!0))])}function xV(n){return Zh(nr(n.firestore,ca),[new Kh(n._key,On.none())])}function Su(n,e){const t=nr(n.firestore,ca),s=at(n),i=l_(n.converter,e);return Zh(t,[Wb(ku(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,On.exists(!1))]).then((()=>s))}function Zh(n,e){return(function(s,i){const o=new yi;return s.asyncQueue.enqueueAndForget((async()=>V8(await nV(s),i,o))),o.promise})(Ng(n),e)}function bV(n,e,t){const s=t.docs.get(e._key),i=new xR(n);return new _l(n,i,e._key,s,new eh(t.hasPendingWrites,t.fromCache),e.converter)}class _V{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=TV(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function SV(n){return new _V(n)}class wV{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=_u.provider,this._offlineComponentProvider={build:t=>new Yb(t,e?.cacheSizeBytes,this.forceOwnership)}}}class EV{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=_u.provider,this._offlineComponentProvider={build:t=>new Z8(t,e?.cacheSizeBytes)}}}function TV(n){return new wV(n?.forceOwnership)}function AV(){return new EV}class CV{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ku(e)}set(e,t,s){this._verifyNotCommitted();const i=f0(e,this._firestore),o=l_(i.converter,t,s),u=Wb(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,s);return this._mutations.push(u.toMutation(i._key,On.none())),this}update(e,t,s,...i){this._verifyNotCommitted();const o=f0(e,this._firestore);let u;return u=typeof(t=Jt(t))=="string"||t instanceof Xh?fR(this._dataReader,"WriteBatch.update",o._key,t,s,i):hR(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(u.toMutation(o._key,On.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=f0(e,this._firestore);return this._mutations=this._mutations.concat(new Kh(t._key,On.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ve(ae.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function f0(n,e){if((n=Jt(n)).firestore!==e)throw new ve(ae.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function oi(){return new Jh("deleteField")}function as(){return new Xb("serverTimestamp")}function Hm(...n){return new Jb("arrayUnion",n)}function NV(...n){return new Zb("arrayRemove",n)}function bR(n){return Ng(n=nr(n,ca)),new CV(n,(e=>Zh(n,e)))}(function(e,t=!0){(function(i){Iu=i})(xo),ho(new uo("firestore",((s,{instanceIdentifier:i,options:o})=>{const u=s.getProvider("app").getImmediate(),h=new ca(new WM(s.getProvider("auth-internal")),new ZM(u,s.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ve(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rl(p.options.projectId,g)})(u,i),u);return o={useFetchStreams:t,...o},h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),Mr(sT,rT,e),Mr(sT,rT,"esm2020")})();const _R="firebasestorage.googleapis.com",IV="storageBucket",RV=120*1e3,jV=600*1e3;class Ti extends Br{constructor(e,t,s=0){super(p0(e),`Firebase Storage: ${t} (${p0(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ti.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return p0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var wi;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(wi||(wi={}));function p0(n){return"storage/"+n}function DV(){const n="An unknown error occurred, please check the error payload for server response.";return new Ti(wi.UNKNOWN,n)}function OV(){return new Ti(wi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function PV(){return new Ti(wi.CANCELED,"User canceled the upload/download.")}function kV(n){return new Ti(wi.INVALID_URL,"Invalid URL '"+n+"'.")}function MV(n){return new Ti(wi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function A2(n){return new Ti(wi.INVALID_ARGUMENT,n)}function SR(){return new Ti(wi.APP_DELETED,"The Firebase app was deleted.")}function LV(n){return new Ti(wi.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class kr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=kr.makeFromUrl(e,t)}catch{return new kr(e,"")}if(s.path==="")return s;throw MV(e)}static makeFromUrl(e,t){let s=null;const i="([A-Za-z0-9.\\-_]+)";function o(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const u="(/(.*))?$",h=new RegExp("^gs://"+i+u,"i"),f={bucket:1,path:3};function p(F){F.path_=decodeURIComponent(F.path)}const g="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),b="(/([^?#]*).*)?$",S=new RegExp(`^https?://${x}/${g}/b/${i}/o${b}`,"i"),w={bucket:1,path:3},A=t===_R?"(?:storage.googleapis.com|storage.cloud.google.com)":t,C="([^?#]*)",L=new RegExp(`^https?://${A}/${i}/${C}`,"i"),U=[{regex:h,indices:f,postModify:o},{regex:S,indices:w,postModify:p},{regex:L,indices:{bucket:1,path:2},postModify:p}];for(let F=0;F<U.length;F++){const K=U[F],Z=K.regex.exec(e);if(Z){const j=Z[K.indices.bucket];let N=Z[K.indices.path];N||(N=""),s=new kr(j,N),K.postModify(s);break}}if(s==null)throw kV(e);return s}}class VV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function UV(n,e,t){let s=1,i=null,o=null,u=!1,h=0;function f(){return h===2}let p=!1;function g(...C){p||(p=!0,e.apply(null,C))}function x(C){i=setTimeout(()=>{i=null,n(S,f())},C)}function b(){o&&clearTimeout(o)}function S(C,...L){if(p){b();return}if(C){b(),g.call(null,C,...L);return}if(f()||u){b(),g.call(null,C,...L);return}s<64&&(s*=2);let U;h===1?(h=2,U=0):U=(s+Math.random())*1e3,x(U)}let w=!1;function A(C){w||(w=!0,b(),!p&&(i!==null?(C||(h=2),clearTimeout(i),x(0)):C||(h=1)))}return x(0),o=setTimeout(()=>{u=!0,A(!0)},t),A}function BV(n){n(!1)}function FV(n){return n!==void 0}function C2(n,e,t,s){if(s<e)throw A2(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw A2(`Invalid value for '${n}'. Expected ${t} or less.`)}function zV(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const i=e(s)+"="+e(n[s]);t=t+i+"&"}return t=t.slice(0,-1),t}var Gm;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Gm||(Gm={}));function qV(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}class HV{constructor(e,t,s,i,o,u,h,f,p,g,x,b=!0,S=!1){this.url_=e,this.method_=t,this.headers_=s,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=u,this.callback_=h,this.errorCallback_=f,this.timeout_=p,this.progressCallback_=g,this.connectionFactory_=x,this.retry=b,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,A)=>{this.resolve_=w,this.reject_=A,this.start_()})}start_(){const e=(s,i)=>{if(i){s(!1,new Up(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const u=h=>{const f=h.loaded,p=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(f,p)};this.progressCallback_!==null&&o.addUploadProgressListener(u),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(u),this.pendingConnection_=null;const h=o.getErrorCode()===Gm.NO_ERROR,f=o.getStatus();if(!h||qV(f,this.additionalRetryCodes_)&&this.retry){const g=o.getErrorCode()===Gm.ABORT;s(!1,new Up(!1,null,g));return}const p=this.successCodes_.indexOf(f)!==-1;s(!0,new Up(p,o))})},t=(s,i)=>{const o=this.resolve_,u=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const f=this.callback_(h,h.getResponse());FV(f)?o(f):o()}catch(f){u(f)}else if(h!==null){const f=DV();f.serverResponse=h.getErrorText(),this.errorCallback_?u(this.errorCallback_(h,f)):u(f)}else if(i.canceled){const f=this.appDelete_?SR():PV();u(f)}else{const f=OV();u(f)}};this.canceled_?t(!1,new Up(!1,null,!0)):this.backoffId_=UV(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&BV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Up{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function GV(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function $V(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function KV(n,e){e&&(n["X-Firebase-GMPID"]=e)}function QV(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function YV(n,e,t,s,i,o,u=!0,h=!1){const f=zV(n.urlParams),p=n.url+f,g=Object.assign({},n.headers);return KV(g,e),GV(g,t),$V(g,o),QV(g,s),new HV(p,n.method,g,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,u,h)}function WV(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function XV(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}class $m{constructor(e,t){this._service=e,t instanceof kr?this._location=t:this._location=kr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $m(e,t)}get root(){const e=new kr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return XV(this._location.path)}get storage(){return this._service}get parent(){const e=WV(this._location.path);if(e===null)return null;const t=new kr(this._location.bucket,e);return new $m(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw LV(e)}}function N2(n,e){const t=e?.[IV];return t==null?null:kr.makeFromBucketSpec(t,n)}function JV(n,e,t,s={}){n.host=`${e}:${t}`;const i=vo(e);i&&(tg(`https://${n.host}/b`),eb("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:o}=s;o&&(n._overrideAuthToken=typeof o=="string"?o:sC(o,n.app.options.projectId))}class ZV{constructor(e,t,s,i,o,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=u,this._bucket=null,this._host=_R,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=RV,this._maxUploadRetryTime=jV,this._requests=new Set,i!=null?this._bucket=kr.makeFromBucketSpec(i,this._host):this._bucket=N2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=kr.makeFromBucketSpec(this._url,e):this._bucket=N2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){C2("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){C2("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ds(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $m(this,e)}_makeRequest(e,t,s,i,o=!0){if(this._deleted)return new VV(SR());{const u=YV(e,this._appId,s,i,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[s,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,i).getPromise()}}const I2="@firebase/storage",R2="0.14.0";const wR="storage";function e9(n=ng(),e){n=Jt(n);const s=Cu(n,wR).getImmediate({identifier:e}),i=eC("storage");return i&&t9(s,...i),s}function t9(n,e,t,s={}){JV(n,e,t,s)}function n9(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new ZV(t,s,i,e,xo)}function s9(){ho(new uo(wR,n9,"PUBLIC").setMultipleInstances(!0)),Mr(I2,R2,""),Mr(I2,R2,"esm2020")}s9();const gl={apiKey:"AIzaSyBg7o5TWmKdELQq53Ji8cA5z9z6h_kbI7g",authDomain:"little-lions-2cae7.firebaseapp.com",projectId:"little-lions-2cae7",storageBucket:"little-lions-2cae7.firebasestorage.app",messagingSenderId:"1033644878508",appId:"1:1033644878508:web:448b1c68247e9136410d09"},r9=()=>{const e=["apiKey","authDomain","projectId"].filter(t=>!gl[t]);e.length>0&&(console.error(" Missing Firebase config fields:",e),console.error("Please check your environment variables."))};r9();const Yc=eo(gl),no=fl(Yc);let Ee;try{Ee=aV(Yc,{localCache:SV({tabManager:AV()})}),console.log(" Firestore initialized with persistent cache (multi-tab)")}catch(n){n.code==="failed-precondition"?(Ee=h0(Yc),console.warn(" Firestore persistence limited - multiple tabs detected")):n.code==="unimplemented"?(Ee=h0(Yc),console.warn(" Firestore persistence not supported in this browser")):(Ee=h0(Yc),oV(Ee,{forceOwnership:!1}).then(()=>console.log(" Firestore offline persistence enabled (legacy)")).catch(e=>{e.code==="failed-precondition"?console.warn(" Persistence failed: Multiple tabs open"):e.code==="unimplemented"?console.warn(" Persistence not supported in this browser"):console.error(" Persistence error:",e)}))}e9(Yc);const j2=["STAR","BLUE","MOON","RAIN","ROSE","TREE","BIRD","FISH","BEAR","LION","WOLF","FROG","DUCK","LEAF","SNOW","WIND","GOLD","RUBY","JADE","FIRE","WAVE","ROCK","SAND","PINE","DOVE","HAWK","DEER","LAKE","HILL","PEAR","LIME","MINT","SAGE","IRIS","LILY","PALM","FERN","VINE","DAWN","DUSK","GLOW","RAYS","PEAK","COVE","GLEN","VALE","WOOD","REEF"],D2="ABCDEFGHJKMNPQRSTUVWXYZ23456789";function ER(){const n=j2[Math.floor(Math.random()*j2.length)],e=String(Math.floor(1e3+Math.random()*9e3));return`${n}-${e}`}function TR(){let n="";for(let e=0;e<9;e++)n+=D2[Math.floor(Math.random()*D2.length)];return`${n.slice(0,3)}-${n.slice(3,6)}-${n.slice(6,9)}`}function xx(n){return n?n.replace(/-/g,"").toUpperCase().trim():""}function th(n=24){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let t="";const s=new Uint8Array(n);crypto.getRandomValues(s);for(let i=0;i<n;i++)t+=e[s[i]%e.length];return t}const i9=Object.freeze(Object.defineProperty({__proto__:null,generateActivationCode:ER,generateAdminAssistCode:TR,generateSecurePassword:th,normalizeCode:xx},Symbol.toStringTag,{value:"Module"})),a9=14,o9=10;class l9{generateActivationData(e){const t=Date.now(),s=a9*24*60*60*1e3;return{accountStatus:"pending_setup",activationCode:ER(),activationExpiry:t+s,activationCreatedAt:t,_tempKey:btoa(e)}}async validateActivationCode(e){try{const t=xx(e),s=bt(Ee,"users"),i=an(s,mn("activationCode","==",this.formatStoredCode(t))),o=await Wt(i);if(o.empty){const h=an(s,mn("activationCode","==",e.toUpperCase())),f=await Wt(h);if(f.empty)return{valid:!1,error:"Invalid activation code"};const p=f.docs[0];return this.checkUserActivationStatus(p)}const u=o.docs[0];return this.checkUserActivationStatus(u)}catch(t){return console.error("Error validating activation code:",t),{valid:!1,error:"Failed to validate code"}}}formatStoredCode(e){return e.length===8?`${e.slice(0,4)}-${e.slice(4)}`:e}checkUserActivationStatus(e){const t=e.data();return t.accountStatus==="active"?{valid:!1,error:"already_active",user:{uid:e.id,...t}}:Date.now()>t.activationExpiry?{valid:!1,error:"expired",user:{uid:e.id,...t}}:{valid:!0,user:{uid:e.id,...t}}}async getChildrenForParent(e){try{const t=bt(Ee,"children"),s=an(t,mn("parentId","==",e));return(await Wt(s)).docs.map(o=>({id:o.id,...o.data()}))}catch(t){return console.error("Error fetching children:",t),[]}}async completeActivation(e,t,s,i="self"){let o=null;try{const u=await ra(at(Ee,"users",e));if(!u.exists())return{success:!1,error:"User not found"};const f=u.data()._tempKey;if(!f)return console.warn("No temp key found, falling back to email reset"),await ih(no,t,{url:`${window.location.origin}/login?activated=true`}),await this.markAccountAsActive(e,i),{success:!0,method:"email_reset"};const p=atob(f);o=eo(gl,"activationApp-"+Date.now());const g=fl(o),x=await MC(g,t,p);return await LC(x.user,s),await g.signOut(),await this.markAccountAsActive(e,i),{success:!0,method:"direct"}}catch(u){if(console.error("Error completing activation:",u),u.code==="auth/wrong-password"||u.code==="auth/invalid-credential")try{return await ih(no,t,{url:`${window.location.origin}/login?activated=true`}),await this.markAccountAsActive(e,i),{success:!0,method:"email_reset",fallback:!0}}catch{return{success:!1,error:"Failed to set password. Please contact support."}}return{success:!1,error:u.message}}finally{if(o)try{const{deleteApp:u}=await $c(async()=>{const{deleteApp:h}=await Promise.resolve().then(()=>Yd);return{deleteApp:h}},[]);await u(o)}catch(u){console.warn("Failed to delete temp app:",u)}}}async markAccountAsActive(e,t="self"){const s=at(Ee,"users",e);await is(s,{accountStatus:"active",activatedAt:new Date().toISOString(),activatedBy:t,updatedAt:as()}),await is(s,{activationCode:oi(),activationExpiry:oi(),activationCreatedAt:oi(),_tempKey:oi(),mustChangePassword:oi(),password:oi(),adminAssistCode:oi(),adminAssistExpiry:oi()})}async regenerateActivationCode(e,t){try{const{generateSecurePassword:s}=await $c(async()=>{const{generateSecurePassword:h}=await Promise.resolve().then(()=>i9);return{generateSecurePassword:h}},void 0),i=s(24),o=this.generateActivationData(i),u=at(Ee,"users",e);return await is(u,{...o,updatedAt:as()}),await ih(no,t),{success:!0,newCode:o.activationCode}}catch(s){return console.error("Error regenerating code:",s),{success:!1,error:s.message}}}async generateAdminAssistCodeForUser(e){try{const t=TR(),s=Date.now()+o9*60*1e3,i=at(Ee,"users",e);return await is(i,{adminAssistCode:t,adminAssistExpiry:s,updatedAt:as()}),{success:!0,code:t,expiry:s}}catch(t){return console.error("Error generating admin assist code:",t),{success:!1,error:t.message}}}async validateAdminAssistCode(e){try{const t=xx(e),s=`${t.slice(0,3)}-${t.slice(3,6)}-${t.slice(6,9)}`,i=bt(Ee,"users"),o=an(i,mn("adminAssistCode","==",s)),u=await Wt(o);if(u.empty)return{valid:!1,error:"Invalid admin code"};const h=u.docs[0],f=h.data();return Date.now()>f.adminAssistExpiry?{valid:!1,error:"Admin code has expired"}:f.accountStatus==="active"?{valid:!1,error:"Account is already activated"}:{valid:!0,user:{uid:h.id,...f}}}catch(t){return console.error("Error validating admin code:",t),{valid:!1,error:"Failed to validate code"}}}async clearAdminAssistCode(e){try{const t=at(Ee,"users",e);await is(t,{adminAssistCode:oi(),adminAssistExpiry:oi()})}catch(t){console.error("Error clearing admin code:",t)}}async getPendingAccounts(){try{const e=bt(Ee,"users"),t=an(e,mn("accountStatus","==","pending_setup")),i=(await Wt(t)).docs.map(o=>({uid:o.id,...o.data()}));return i.sort((o,u)=>(u.activationCreatedAt||0)-(o.activationCreatedAt||0)),i}catch(e){return console.error("Error fetching pending accounts:",e),[]}}async getUserById(e){try{const t=await ra(at(Ee,"users",e));return t.exists()?{uid:t.id,...t.data()}:null}catch(t){return console.error("Error fetching user:",t),null}}}const ms=new l9;class c9{async signIn(e,t){try{const i=(await MC(no,e,t)).user,o=await this.getUserData(i.uid);return{uid:i.uid,email:i.email,...o}}catch(s){throw this.handleAuthError(s)}}async createParentAccount(e,t){let s=null;try{const i=th(24);s=eo(gl,"tempApp-"+Date.now());const o=fl(s),h=(await jp(o,e,i)).user,f=ms.generateActivationData(i);return await ml(at(Ee,"users",h.uid),{...t,uid:h.uid,email:e,role:"parent",childrenIds:[],active:!0,...f,createdAt:new Date().toISOString()}),{uid:h.uid,email:e,...t,activationCode:f.activationCode}}catch(i){throw this.handleAuthError(i)}finally{if(s){const{deleteApp:i}=await $c(async()=>{const{deleteApp:o}=await Promise.resolve().then(()=>Yd);return{deleteApp:o}},void 0);await i(s)}}}async createTherapistAccount(e,t){let s=null;try{const i=th(24);s=eo(gl,"tempApp-Therapist-"+Date.now());const o=fl(s),h=(await jp(o,e,i)).user,f=ms.generateActivationData(i);return await ml(at(Ee,"users",h.uid),{...t,uid:h.uid,email:e,role:"therapist",specializations:t.specializations||[],active:!0,profileCompleted:!1,...f,createdAt:new Date().toISOString()}),{uid:h.uid,email:e,...t,activationCode:f.activationCode}}catch(i){throw this.handleAuthError(i)}finally{if(s){const{deleteApp:i}=await $c(async()=>{const{deleteApp:o}=await Promise.resolve().then(()=>Yd);return{deleteApp:o}},void 0);await i(s)}}}async createTeacherAccount(e,t){let s=null;try{const i=th(24);s=eo(gl,"tempApp-"+Date.now());const o=fl(s),h=(await jp(o,e,i)).user,f=ms.generateActivationData(i);return await ml(at(Ee,"users",h.uid),{...t,uid:h.uid,email:e,role:"teacher",specializations:t.specializations||[],active:!0,...f,createdAt:new Date().toISOString()}),{uid:h.uid,email:e,...t,activationCode:f.activationCode}}catch(i){throw this.handleAuthError(i)}finally{if(s){const{deleteApp:i}=await $c(async()=>{const{deleteApp:o}=await Promise.resolve().then(()=>Yd);return{deleteApp:o}},void 0);await i(s)}}}async createAdminAccount(e,t){let s=null;try{const i=th(24);s=eo(gl,"tempApp-Admin-"+Date.now());const o=fl(s),h=(await jp(o,e,i)).user,f=ms.generateActivationData(i);return await ml(at(Ee,"users",h.uid),{...t,uid:h.uid,email:e,role:"admin",active:!0,...f,createdAt:new Date().toISOString()}),{uid:h.uid,email:e,...t,activationCode:f.activationCode}}catch(i){throw this.handleAuthError(i)}finally{if(s){const{deleteApp:i}=await $c(async()=>{const{deleteApp:o}=await Promise.resolve().then(()=>Yd);return{deleteApp:o}},void 0);await i(s)}}}async getUserData(e){try{const t=await ra(at(Ee,"users",e));if(!t.exists())throw new Error("User data not found");return t.data()}catch(t){throw new Error("Failed to fetch user data: "+t.message)}}async signOut(){try{await Pk(no)}catch(e){throw new Error("Sign out failed: "+e.message)}}async resetPassword(e){try{await ih(no,e)}catch(t){throw this.handleAuthError(t)}}onAuthStateChanged(e){return Ok(no,e)}handleAuthError(e){switch(console.error("Auth Error:",e),e.code){case"auth/email-already-in-use":return new Error("This email is already registered.");case"auth/weak-password":return new Error("Password should be at least 6 characters.");case"auth/invalid-email":return new Error("Invalid email address.");case"auth/user-not-found":return new Error("No account found with this email.");case"auth/wrong-password":return new Error("Incorrect password.");case"auth/invalid-credential":return new Error("Invalid email or password.");default:return new Error(e.message||"Authentication failed")}}}const Wi=new c9,AR=I.createContext(),u9=({children:n})=>{const[e,t]=I.useState(null),[s,i]=I.useState(!0);I.useEffect(()=>Wi.onAuthStateChanged(async p=>{if(p)try{const g=await Wi.getUserData(p.uid);t({uid:p.uid,email:p.email,...g})}catch(g){console.error("Error fetching user data:",g),t(null)}else t(null);i(!1)}),[]);const h={currentUser:e,loading:s,login:async(f,p)=>await Wi.signIn(f,p),logout:async()=>{await Wi.signOut(),t(null)}};return l.jsx(AR.Provider,{value:h,children:!s&&n})},In=()=>{const n=I.useContext(AR);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},bx=({message:n})=>n?l.jsx("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"12px",borderRadius:"4px",marginBottom:"16px",border:"1px solid #f5c6cb"},children:n}):null;const d9=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),h9=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),O2=n=>{const e=h9(n);return e.charAt(0).toUpperCase()+e.slice(1)},CR=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),f9=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var p9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const m9=I.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:o,iconNode:u,...h},f)=>I.createElement("svg",{ref:f,...p9,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:CR("lucide",i),...!o&&!f9(h)&&{"aria-hidden":"true"},...h},[...u.map(([p,g])=>I.createElement(p,g)),...Array.isArray(o)?o:[o]]));const c_=(n,e)=>{const t=I.forwardRef(({className:s,...i},o)=>I.createElement(m9,{ref:o,iconNode:e,className:CR(`lucide-${d9(O2(n))}`,`lucide-${n}`,s),...i}));return t.displayName=O2(n),t};const g9=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],y9=c_("chevron-down",g9);const v9=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],x9=c_("mail",v9);const b9=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],_9=c_("phone",b9),P2="/assets/logo-BusWSrDp.png",S9="/assets/child-DtdaQdTc.png",k2=()=>{const[n,e]=I.useState(""),[t,s]=I.useState(""),[i,o]=I.useState(!1),[u,h]=I.useState(""),{login:f}=In(),p=Nn(),g=I.useRef(null),x=()=>{g.current?.scrollIntoView({behavior:"smooth"})},b=async()=>{if(!n||!t){h("Please enter both email and password");return}h(""),o(!0);try{const A=await f(n,t);if(A.mustChangePassword){p("/change-password");return}switch(A.role){case"super_admin":case"admin":p("/admin/dashboard");break;case"teacher":p("/teacher/dashboard");break;case"parent":p("/parent/dashboard");break;case"therapist":p("/therapist/dashboard");break;default:p("/")}}catch(A){h(A.message)}finally{o(!1)}},S=A=>{A.key==="Enter"&&!i&&b()},w=async()=>{const A=prompt("Please enter your email address:");if(A)try{await Wi.resetPassword(A),alert("Password reset email sent!")}catch(C){alert("Error: "+C.message)}};return l.jsxs("div",{className:"landing-page",children:[l.jsx("header",{className:"landing-header",children:l.jsxs("div",{className:"header-content",children:[l.jsx("div",{className:"logo-circle",children:l.jsx("img",{src:P2,alt:"Little Lions Logo",className:"logo-img"})}),l.jsx("h1",{className:"header-title",children:"Little Lions Learning and Development Center"})]})}),l.jsx("div",{className:"hero-section",children:l.jsx("div",{className:"hero-overlay",children:l.jsxs("div",{className:"hero-content",children:[l.jsx("div",{className:"welcome-text",children:l.jsx("p",{className:"welcome-subtitle",children:"Welcome to the"})}),l.jsxs("svg",{viewBox:"0 0 800 180",className:"portal-curved-svg",children:[l.jsx("defs",{children:l.jsx("path",{id:"curvedPath",d:"M 40,160 Q 400,10 760,160",fill:"transparent"})}),l.jsx("text",{children:l.jsx("textPath",{xlinkHref:"#curvedPath",startOffset:"50%",textAnchor:"middle",className:"curved-portal-title",children:"LITTLE LIONS TEAM PORTAL"})})]})]})})}),l.jsx("div",{className:"thanks-login-section",children:l.jsxs("div",{className:"thanks-section",children:[l.jsxs("div",{className:"thanks-content",children:[l.jsx("p",{className:"arrow-guide-text",children:"Click the Arrow to Login"}),l.jsx("button",{className:"scroll-arrow-btn",onClick:x,"aria-label":"Scroll to Login",children:l.jsx(y9,{size:48,strokeWidth:2.5})}),l.jsx("h3",{className:"thanks-title",children:"THANKS TEAM"}),l.jsx("p",{className:"thanks-message",children:"It's your energy, kindness, and creativity that make every day special. Thanks for everything you do to keep our kids happy, safe and nurtured with learnings  we couldn't do it without you."})]}),l.jsxs("div",{className:"login-card",ref:g,children:[l.jsx("div",{className:"login-image",children:l.jsx("img",{src:S9,alt:"Child Learning",className:"child-img"})}),l.jsxs("div",{className:"login-form-wrapper",children:[l.jsx("h2",{className:"login-welcome-title",children:"WELCOME"}),u&&l.jsx(bx,{message:u}),l.jsxs("div",{className:"login-form",children:[l.jsxs("div",{className:"form-group",children:[l.jsx("label",{className:"login-label",children:"Email"}),l.jsxs("div",{className:"input-with-icon",children:[l.jsxs("svg",{className:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),l.jsx("polyline",{points:"22,6 12,13 2,6"})]}),l.jsx("input",{type:"email",value:n,onChange:A=>e(A.target.value),onKeyPress:S,disabled:i,className:"login-input",placeholder:"@gmail.com"})]})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{className:"login-label",children:"Password"}),l.jsxs("div",{className:"input-with-icon",children:[l.jsxs("svg",{className:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),l.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),l.jsx("input",{type:"password",value:t,onChange:A=>s(A.target.value),onKeyPress:S,disabled:i,className:"login-input",placeholder:""})]})]}),l.jsx("div",{className:"forgot-password-link",children:l.jsx("button",{onClick:w,className:"forgot-password-button",disabled:i,children:"Forgot your password?"})}),l.jsx("button",{onClick:b,disabled:i,className:"login-button",children:i?"LOGGING IN...":"LOGIN"})]})]})]})]})}),l.jsx("footer",{className:"landing-footer",children:l.jsxs("div",{className:"footer-content",children:[l.jsxs("div",{className:"footer-info-item",children:[l.jsx("div",{className:"footer-logo-circle",children:l.jsx("img",{src:P2,alt:"Little Lions",className:"footer-logo-img"})}),l.jsx("span",{children:"Little Lions Learning and Development Center"})]}),l.jsx("span",{className:"footer-divider",children:""}),l.jsxs("div",{className:"footer-info-item",children:[l.jsx(x9,{size:18,className:"footer-icon"}),l.jsx("span",{children:"littlelionsldc@gmail.com"})]}),l.jsx("span",{className:"footer-divider",children:""}),l.jsxs("div",{className:"footer-info-item",children:[l.jsx(_9,{size:18,className:"footer-icon"}),l.jsx("span",{children:"(+63) 9677900930"})]})]})})]})},w9=()=>{const[n,e]=I.useState(""),[t,s]=I.useState(""),[i,o]=I.useState(!1),[u,h]=I.useState(""),{currentUser:f}=In(),p=fl(),g=async x=>{if(x.preventDefault(),n!==t)return h("Passwords do not match");if(n.length<6)return h("Password must be at least 6 characters");o(!0);try{const b=p.currentUser;await LC(b,n);const S=at(Ee,"users",f.uid);await is(S,{mustChangePassword:!1}),alert("Password updated successfully!"),window.location.href="/"}catch(b){console.error(b),h("Failed to update password. Please try again.")}finally{o(!1)}};return l.jsx("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},children:l.jsxs("div",{style:{padding:"40px",background:"white",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",width:"100%",maxWidth:"400px"},children:[l.jsx("h2",{style:{textAlign:"center",marginBottom:"20px",color:"#2c3e50"},children:"Change Password"}),l.jsx("p",{style:{textAlign:"center",color:"#666",marginBottom:"30px",fontSize:"14px"},children:"Please update your default password to continue using the system."}),l.jsxs("form",{onSubmit:g,style:{display:"flex",flexDirection:"column",gap:"15px"},children:[l.jsx("input",{type:"password",placeholder:"New Password",value:n,onChange:x=>e(x.target.value),required:!0,style:{padding:"12px",border:"1px solid #ddd",borderRadius:"4px"}}),l.jsx("input",{type:"password",placeholder:"Confirm New Password",value:t,onChange:x=>s(x.target.value),required:!0,style:{padding:"12px",border:"1px solid #ddd",borderRadius:"4px"}}),u&&l.jsx("div",{style:{color:"red",fontSize:"14px",textAlign:"center"},children:u}),l.jsx("button",{type:"submit",disabled:i,style:{padding:"12px",background:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",opacity:i?.7:1},children:i?"Updating...":"Set New Password"})]})]})})},_e={container:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif"},card:{backgroundColor:"white",padding:"32px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",maxWidth:"400px",width:"100%"},title:{fontSize:"24px",fontWeight:"600",marginBottom:"8px",textAlign:"center"},subtitle:{color:"#666",marginBottom:"24px",textAlign:"center",fontSize:"14px"},inputGroup:{marginBottom:"16px"},label:{display:"block",marginBottom:"4px",fontWeight:"500",fontSize:"14px"},input:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxSizing:"border-box"},inputDisabled:{width:"100%",padding:"10px 12px",border:"1px solid #eee",borderRadius:"6px",fontSize:"16px",backgroundColor:"#f9f9f9",color:"#666",boxSizing:"border-box"},button:{width:"100%",padding:"12px",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:"pointer",marginTop:"8px"},buttonDisabled:{width:"100%",padding:"12px",backgroundColor:"#93c5fd",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:"not-allowed",marginTop:"8px"},secondaryButton:{width:"100%",padding:"10px",backgroundColor:"transparent",color:"#2563eb",border:"1px solid #2563eb",borderRadius:"6px",fontSize:"14px",cursor:"pointer",marginTop:"12px"},linkButton:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",fontSize:"14px",textDecoration:"underline",padding:"0"},error:{color:"#dc2626",backgroundColor:"#fef2f2",padding:"12px",borderRadius:"6px",marginBottom:"16px",fontSize:"14px"},success:{color:"#059669",backgroundColor:"#ecfdf5",padding:"12px",borderRadius:"6px",marginBottom:"16px",fontSize:"14px"},stepIndicator:{display:"flex",justifyContent:"center",gap:"8px",marginBottom:"24px"},stepDot:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"#ddd"},stepDotActive:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"#2563eb"},infoBox:{backgroundColor:"#f0f9ff",border:"1px solid #bae6fd",padding:"12px",borderRadius:"6px",marginBottom:"16px",fontSize:"14px"},checkItem:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 0",fontSize:"14px"},passwordToggle:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#666"},inputWrapper:{position:"relative"},hint:{fontSize:"12px",color:"#666",marginTop:"4px"},divider:{borderTop:"1px solid #eee",margin:"20px 0"}};function E9(){const[n]=cP(),e=Nn(),t=n.get("code")||"",[s,i]=I.useState(t?"validating":"enter_code"),[o,u]=I.useState(t),[h,f]=I.useState(null),[p,g]=I.useState([]),[x,b]=I.useState(""),[S,w]=I.useState(""),[A,C]=I.useState(!1),[L,z]=I.useState(!1),[U,F]=I.useState(""),[K,Z]=I.useState("");I.useEffect(()=>{t&&j(t)},[t]),I.useEffect(()=>{if(s==="success"){const B=setTimeout(()=>{window.history.replaceState({},"","/activate"),e("/login")},5e3);return()=>clearTimeout(B)}},[s,e]);const j=async B=>{i("validating"),F("");const k=await ms.validateActivationCode(B);if(k.valid){if(f(k.user),k.user.role==="parent"){const fe=await ms.getChildrenForParent(k.user.uid);g(fe)}i("welcome")}else Z(k.error),f(k.user||null),i("error")},N=B=>{if(B.preventDefault(),!o.trim()){F("Please enter your activation code");return}j(o)},R=async B=>{if(B.preventDefault(),F(""),x.length<8){F("Password must be at least 8 characters");return}if(x!==S){F("Passwords do not match");return}if(["password","12345678","qwerty123","password123"].includes(x.toLowerCase())){F("Please choose a stronger password");return}z(!0);try{const fe=await ms.completeActivation(h.uid,h.email,x,"self");fe.success?i("success"):F(fe.error||"Failed to set password. Please try again.")}catch(fe){console.error("Activation error:",fe),F("Something went wrong. Please try again.")}finally{z(!1)}},O=async()=>{if(h){z(!0);try{const B=await ms.regenerateActivationCode(h.uid,h.email);B.success?(alert(`New activation code: ${B.newCode}

Please use this code to activate your account.`),u(B.newCode),i("enter_code"),F(""),Z("")):F("Failed to generate new code. Please contact support.")}catch{F("Failed to generate new code")}finally{z(!1)}}},V=()=>{switch(s){case"enter_code":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:_e.title,children:"Activate Your Account"}),l.jsx("p",{style:_e.subtitle,children:"Enter the activation code from your QR code or the code given by the admin"}),U&&l.jsx("div",{style:_e.error,children:U}),l.jsxs("form",{onSubmit:N,children:[l.jsxs("div",{style:_e.inputGroup,children:[l.jsx("label",{style:_e.label,children:"Activation Code"}),l.jsx("input",{type:"text",value:o,onChange:B=>u(B.target.value.toUpperCase()),placeholder:"e.g., STAR-7842",style:_e.input,autoFocus:!0}),l.jsx("p",{style:_e.hint,children:"Format: XXXX-XXXX (e.g., STAR-7842)"})]}),l.jsx("button",{type:"submit",style:_e.button,children:"Continue "})]}),l.jsx("div",{style:_e.divider}),l.jsx("p",{style:{textAlign:"center",fontSize:"14px",color:"#666"},children:"Don't have a code? Contact the school admin"})]});case"validating":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:{..._e.title,fontSize:"32px"},children:""}),l.jsx("h1",{style:_e.title,children:"Verifying..."}),l.jsx("p",{style:_e.subtitle,children:"Please wait while we verify your code"})]});case"welcome":return l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:_e.stepIndicator,children:[l.jsx("div",{style:_e.stepDotActive}),l.jsx("div",{style:_e.stepDot}),l.jsx("div",{style:_e.stepDot})]}),l.jsx("h1",{style:_e.title,children:"Welcome!"}),l.jsx("p",{style:_e.subtitle,children:"We're setting up your account so you can monitor your child's progress"}),l.jsx("div",{style:_e.infoBox,children:l.jsx("p",{style:{margin:0},children:"This will only take 2 minutes"})}),l.jsx("button",{onClick:()=>i("verify"),style:_e.button,children:"Let's Start "}),l.jsx("div",{style:_e.divider}),l.jsx("p",{style:{textAlign:"center",fontSize:"14px",color:"#666"},children:"Need help? Ask the admin or call the school"})]});case"verify":return l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:_e.stepIndicator,children:[l.jsx("div",{style:_e.stepDotActive}),l.jsx("div",{style:_e.stepDotActive}),l.jsx("div",{style:_e.stepDot})]}),l.jsx("h1",{style:_e.title,children:"Confirm Your Details"}),l.jsx("p",{style:_e.subtitle,children:"Please verify this information is correct"}),l.jsxs("div",{style:_e.infoBox,children:[l.jsxs("div",{style:_e.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Name:"})," ",h?.firstName," ",h?.lastName]})]}),l.jsxs("div",{style:_e.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Email:"})," ",h?.email]})]}),p.length>0&&l.jsxs("div",{style:_e.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Child:"})," ",p.map(B=>`${B.firstName} ${B.lastName}`).join(", ")]})]}),l.jsxs("div",{style:_e.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Role:"})," ",h?.role]})]})]}),l.jsx("button",{onClick:()=>i("password"),style:_e.button,children:"Yes, this is me "}),l.jsx("button",{onClick:()=>{F("Please contact the school admin to correct your information"),i("enter_code")},style:_e.secondaryButton,children:"This is not correct"})]});case"password":return l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:_e.stepIndicator,children:[l.jsx("div",{style:_e.stepDotActive}),l.jsx("div",{style:_e.stepDotActive}),l.jsx("div",{style:_e.stepDotActive})]}),l.jsx("h1",{style:_e.title,children:"Create Password"}),l.jsx("p",{style:_e.subtitle,children:"Choose a password you'll remember"}),U&&l.jsx("div",{style:_e.error,children:U}),l.jsxs("form",{onSubmit:R,children:[l.jsxs("div",{style:_e.inputGroup,children:[l.jsx("label",{style:_e.label,children:"Email"}),l.jsx("input",{type:"email",value:h?.email||"",disabled:!0,style:_e.inputDisabled})]}),l.jsxs("div",{style:_e.inputGroup,children:[l.jsx("label",{style:_e.label,children:"New Password"}),l.jsxs("div",{style:_e.inputWrapper,children:[l.jsx("input",{type:A?"text":"password",value:x,onChange:B=>b(B.target.value),placeholder:"At least 8 characters",style:{..._e.input,paddingRight:"40px"}}),l.jsx("button",{type:"button",onClick:()=>C(!A),style:_e.passwordToggle,children:A?"":""})]})]}),l.jsxs("div",{style:_e.inputGroup,children:[l.jsx("label",{style:_e.label,children:"Confirm Password"}),l.jsx("input",{type:A?"text":"password",value:S,onChange:B=>w(B.target.value),placeholder:"Re-enter password",style:_e.input}),S&&x===S&&l.jsx("p",{style:{..._e.hint,color:"#059669"},children:" Passwords match"})]}),l.jsx("div",{style:_e.infoBox,children:l.jsx("p",{style:{margin:0,fontSize:"13px"},children:' Tip: Use something memorable like "ILoveJuan2024!"'})}),l.jsx("button",{type:"submit",disabled:L,style:L?_e.buttonDisabled:_e.button,children:L?"Setting up...":"Complete Setup"})]}),l.jsx("button",{onClick:()=>i("verify"),style:{..._e.linkButton,marginTop:"16px",display:"block",textAlign:"center",width:"100%"},children:" Back"})]});case"success":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:{..._e.title,fontSize:"48px"},children:""}),l.jsx("h1",{style:_e.title,children:"You're All Set!"}),l.jsx("p",{style:_e.subtitle,children:"Your account is now active"}),l.jsx("div",{style:_e.success,children:l.jsx("p",{style:{margin:0},children:"Your password has been set successfully!"})}),l.jsxs("div",{style:_e.infoBox,children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"500"},children:"You can now log in with:"}),l.jsxs("p",{style:{margin:"0 0 4px 0"},children:[" ",l.jsx("strong",{children:"Email:"})," ",h?.email]}),l.jsxs("p",{style:{margin:0},children:[" ",l.jsx("strong",{children:"Password:"})," The one you just created"]})]}),l.jsx("button",{onClick:()=>{window.history.replaceState({},"","/activate"),e("/login")},style:_e.button,children:"Go to Login "}),l.jsx("p",{style:{textAlign:"center",fontSize:"12px",color:"#999",marginTop:"16px"},children:"Redirecting to login in 5 seconds..."})]});case"error":return l.jsx(l.Fragment,{children:K==="already_active"?l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:{..._e.title,color:"#059669"},children:" Already Active"}),l.jsx("p",{style:_e.subtitle,children:"This account has already been set up"}),l.jsx("button",{onClick:()=>e("/login"),style:_e.button,children:"Go to Login"})]}):K==="expired"?l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:{..._e.title,color:"#f59e0b"},children:" Code Expired"}),l.jsx("p",{style:_e.subtitle,children:"Your activation code has expired"}),h&&l.jsx("button",{onClick:O,disabled:L,style:L?_e.buttonDisabled:_e.button,children:L?"Sending...":"Get New Code"}),l.jsx("div",{style:_e.divider}),l.jsx("p",{style:{textAlign:"center",fontSize:"14px",color:"#666"},children:"Or contact the school admin for help"})]}):l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:{..._e.title,color:"#dc2626"},children:" Invalid Code"}),l.jsx("p",{style:_e.subtitle,children:"This activation code is not valid"}),l.jsx("button",{onClick:()=>{i("enter_code"),F(""),u("")},style:_e.button,children:"Try Again"}),l.jsx("div",{style:_e.divider}),l.jsx("p",{style:{textAlign:"center",fontSize:"14px",color:"#666"},children:"Contact the school admin if you need help"})]})});default:return null}};return l.jsx("div",{style:_e.container,children:l.jsx("div",{style:_e.card,children:V()})})}const Qe={container:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif"},card:{backgroundColor:"white",padding:"32px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",maxWidth:"400px",width:"100%"},title:{fontSize:"24px",fontWeight:"600",marginBottom:"8px",textAlign:"center"},subtitle:{color:"#666",marginBottom:"24px",textAlign:"center",fontSize:"14px"},inputGroup:{marginBottom:"16px"},label:{display:"block",marginBottom:"4px",fontWeight:"500",fontSize:"14px"},input:{width:"100%",padding:"10px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"16px",boxSizing:"border-box"},codeInput:{width:"100%",padding:"14px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"20px",textAlign:"center",letterSpacing:"4px",fontFamily:"monospace",boxSizing:"border-box"},button:{width:"100%",padding:"12px",backgroundColor:"#2563eb",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:"pointer",marginTop:"8px"},buttonDisabled:{width:"100%",padding:"12px",backgroundColor:"#93c5fd",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:"not-allowed",marginTop:"8px"},error:{color:"#dc2626",backgroundColor:"#fef2f2",padding:"12px",borderRadius:"6px",marginBottom:"16px",fontSize:"14px"},success:{color:"#059669",backgroundColor:"#ecfdf5",padding:"12px",borderRadius:"6px",marginBottom:"16px",fontSize:"14px"},infoBox:{backgroundColor:"#fef3c7",border:"1px solid #fcd34d",padding:"12px",borderRadius:"6px",marginBottom:"16px",fontSize:"14px"},inputWrapper:{position:"relative"},passwordToggle:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#666"},hint:{fontSize:"12px",color:"#666",marginTop:"4px"},checkItem:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 0",fontSize:"14px"}};function T9(){const n=Nn(),[e,t]=I.useState("enter_code"),[s,i]=I.useState(""),[o,u]=I.useState(null),[h,f]=I.useState(""),[p,g]=I.useState(""),[x,b]=I.useState(!1),[S,w]=I.useState(!1),[A,C]=I.useState(""),L=async F=>{if(F.preventDefault(),C(""),!s.trim()){C("Please enter the admin code");return}w(!0);const K=await ms.validateAdminAssistCode(s);K.valid?(u(K.user),t("verify")):C(K.error||"Invalid or expired code"),w(!1)},z=async F=>{if(F.preventDefault(),C(""),h.length<8){C("Password must be at least 8 characters");return}if(h!==p){C("Passwords do not match");return}if(["password","12345678","qwerty123","password123"].includes(h.toLowerCase())){C("Please choose a stronger password");return}w(!0);try{await ih(no,o.email,{url:`${window.location.origin}/login?activated=true`}),await ms.markAccountAsActive(o.uid,"admin"),await ms.clearAdminAssistCode(o.uid),t("success")}catch(Z){C(Z.message||"Failed to complete activation")}finally{w(!1)}},U=()=>{switch(e){case"enter_code":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:Qe.title,children:"Staff-Assisted Setup"}),l.jsx("p",{style:Qe.subtitle,children:"Enter the code given by the staff member"}),l.jsx("div",{style:Qe.infoBox,children:l.jsx("p",{style:{margin:0},children:" This code expires in 10 minutes"})}),A&&l.jsx("div",{style:Qe.error,children:A}),l.jsxs("form",{onSubmit:L,children:[l.jsxs("div",{style:Qe.inputGroup,children:[l.jsx("label",{style:Qe.label,children:"Admin Code"}),l.jsx("input",{type:"text",value:s,onChange:F=>i(F.target.value.toUpperCase()),placeholder:"A7X-9K2-B4M",style:Qe.codeInput,maxLength:11,autoFocus:!0})]}),l.jsx("button",{type:"submit",disabled:S,style:S?Qe.buttonDisabled:Qe.button,children:S?"Verifying...":"Verify Code"})]})]});case"verify":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:Qe.title,children:"Confirm Your Details"}),l.jsx("p",{style:Qe.subtitle,children:"Please verify this is your information"}),l.jsxs("div",{style:{...Qe.infoBox,backgroundColor:"#f0f9ff",borderColor:"#bae6fd"},children:[l.jsxs("div",{style:Qe.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Name:"})," ",o?.firstName," ",o?.lastName]})]}),l.jsxs("div",{style:Qe.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Email:"})," ",o?.email]})]}),l.jsxs("div",{style:Qe.checkItem,children:[l.jsx("span",{children:""}),l.jsxs("span",{children:[l.jsx("strong",{children:"Role:"})," ",o?.role]})]})]}),l.jsx("button",{onClick:()=>t("password"),style:Qe.button,children:"Yes, continue"})]});case"password":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:Qe.title,children:"Create Password"}),l.jsxs("p",{style:Qe.subtitle,children:["Choose a password for ",o?.firstName]}),A&&l.jsx("div",{style:Qe.error,children:A}),l.jsxs("form",{onSubmit:z,children:[l.jsxs("div",{style:Qe.inputGroup,children:[l.jsx("label",{style:Qe.label,children:"New Password"}),l.jsxs("div",{style:Qe.inputWrapper,children:[l.jsx("input",{type:x?"text":"password",value:h,onChange:F=>f(F.target.value),placeholder:"At least 8 characters",style:{...Qe.input,paddingRight:"40px"}}),l.jsx("button",{type:"button",onClick:()=>b(!x),style:Qe.passwordToggle,children:x?"":""})]})]}),l.jsxs("div",{style:Qe.inputGroup,children:[l.jsx("label",{style:Qe.label,children:"Confirm Password"}),l.jsx("input",{type:x?"text":"password",value:p,onChange:F=>g(F.target.value),placeholder:"Re-enter password",style:Qe.input}),p&&h===p&&l.jsx("p",{style:{...Qe.hint,color:"#059669"},children:" Passwords match"})]}),l.jsx("button",{type:"submit",disabled:S,style:S?Qe.buttonDisabled:Qe.button,children:S?"Setting up...":"Complete Setup"})]})]});case"success":return l.jsxs(l.Fragment,{children:[l.jsx("h1",{style:{...Qe.title,fontSize:"48px"},children:""}),l.jsx("h1",{style:Qe.title,children:"All Done!"}),l.jsx("div",{style:Qe.success,children:l.jsxs("p",{style:{margin:0},children:["Account for ",l.jsx("strong",{children:o?.firstName})," is now active!"]})}),l.jsxs("div",{style:{...Qe.infoBox,backgroundColor:"#f0f9ff",borderColor:"#bae6fd"},children:[l.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"500"},children:"Next steps:"}),l.jsxs("p",{style:{margin:"0 0 4px 0"},children:["1. Check email: ",l.jsx("strong",{children:o?.email})]}),l.jsx("p",{style:{margin:"0 0 4px 0"},children:"2. Click the password setup link"}),l.jsx("p",{style:{margin:0},children:"3. Set your final password and login"})]}),l.jsx("button",{onClick:()=>n("/login"),style:Qe.button,children:"Go to Login"})]});default:return null}};return l.jsx("div",{style:Qe.container,children:l.jsx("div",{style:Qe.card,children:U()})})}const A9="data:image/svg+xml,%3csvg%20width='35'%20height='35'%20viewBox='0%200%2035%2035'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9.58333%207.66667C9.58333%205.63334%2010.3911%203.68329%2011.8288%202.24551C13.2666%200.807735%2015.2167%200%2017.25%200C19.2833%200%2021.2334%200.807735%2022.6712%202.24551C24.1089%203.68329%2024.9167%205.63334%2024.9167%207.66667C24.9167%209.69999%2024.1089%2011.65%2022.6712%2013.0878C21.2334%2014.5256%2019.2833%2015.3333%2017.25%2015.3333C15.2167%2015.3333%2013.2666%2014.5256%2011.8288%2013.0878C10.3911%2011.65%209.58333%209.69999%209.58333%207.66667ZM9.58333%2019.1667C7.04168%2019.1667%204.60412%2020.1763%202.80689%2021.9736C1.00967%2023.7708%200%2026.2083%200%2028.75C0%2030.275%200.605802%2031.7375%201.68414%2032.8159C2.76247%2033.8942%204.22501%2034.5%205.75%2034.5H28.75C30.275%2034.5%2031.7375%2033.8942%2032.8159%2032.8159C33.8942%2031.7375%2034.5%2030.275%2034.5%2028.75C34.5%2026.2083%2033.4903%2023.7708%2031.6931%2021.9736C29.8959%2020.1763%2027.4583%2019.1667%2024.9167%2019.1667H9.58333Z'%20fill='%230052A1'/%3e%3c/svg%3e",C9="data:image/svg+xml,%3csvg%20width='46'%20height='46'%20viewBox='0%200%2046%2046'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M43.8913%2040.6334L36.033%2032.7751C36.7997%2030.8584%2036.4163%2028.3667%2034.6913%2026.8334C32.9663%2025.1084%2030.4747%2024.7251%2028.3663%2025.6834L32.008%2029.3251L29.3247%2032.0084L25.4913%2028.1751C24.533%2030.2834%2024.9163%2032.7751%2026.6413%2034.6917C28.3663%2036.4167%2030.6663%2036.8001%2032.583%2036.0334L40.4413%2043.8918C40.8247%2044.2751%2041.3997%2044.2751%2041.5913%2043.8918L43.508%2041.9751C44.083%2041.4001%2044.083%2040.8251%2043.8913%2040.6334ZM24.9163%2038.3334H3.83301V34.5001C3.83301%2030.2834%2010.733%2026.8334%2019.1663%2026.8334C20.1247%2026.8334%2021.083%2026.8334%2021.8497%2027.0251C21.2747%2028.1751%2021.083%2029.3251%2021.083%2030.6667C21.083%2033.7334%2022.6163%2036.6084%2024.9163%2038.3334ZM19.1663%207.66675C14.9497%207.66675%2011.4997%2011.1167%2011.4997%2015.3334C11.4997%2019.5501%2014.9497%2023.0001%2019.1663%2023.0001C23.383%2023.0001%2026.833%2019.5501%2026.833%2015.3334C26.833%2011.1167%2023.383%207.66675%2019.1663%207.66675Z'%20fill='%230052A1'/%3e%3c/svg%3e",N9="data:image/svg+xml,%3csvg%20width='41'%20height='33'%20viewBox='0%200%2041%2033'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M20.5%2019.3978C22.9618%2019.3978%2025.19%2018.3116%2026.8033%2016.5561C28.4148%2014.8025%2029.413%2012.3778%2029.413%209.69892C29.413%207.02008%2028.4148%204.59535%2026.8033%202.84178C25.19%201.08628%2022.9618%200%2020.5%200C18.0382%200%2015.81%201.08628%2014.1967%202.84178C12.5852%204.59535%2011.587%207.02008%2011.587%209.69892C11.587%2012.3778%2012.5852%2014.8025%2014.1967%2016.5561C15.0244%2017.457%2016.007%2018.1716%2017.0886%2018.6592C18.1701%2019.1468%2019.3293%2019.3978%2020.5%2019.3978ZM34.7609%2021.3376C35.3464%2021.3389%2035.9265%2021.2143%2036.4677%2020.9711C37.0089%2020.7278%2037.5007%2020.3707%2037.9147%2019.9201C38.3288%2019.4695%2038.657%2018.9344%2038.8806%2018.3455C39.1041%2017.7565%2039.2186%2017.1254%2039.2174%2016.4882C39.2174%2015.1497%2038.72%2013.9373%2037.9125%2013.0586C37.4986%2012.6083%2037.0072%2012.2512%2036.4665%2012.0076C35.9257%2011.7639%2035.3461%2011.6386%2034.7609%2011.6387C34.1753%2011.6374%2033.5953%2011.762%2033.054%2012.0052C32.5128%2012.2485%2032.0211%2012.6057%2031.607%2013.0562C31.193%2013.5068%2030.8647%2014.0419%2030.6412%2014.6308C30.4176%2015.2198%2030.3032%2015.851%2030.3043%2016.4882C30.3034%2017.1253%2030.418%2017.7564%2030.6417%2018.3452C30.8653%2018.934%2031.1935%2019.469%2031.6075%2019.9195C32.0216%2020.37%2032.5132%2020.7272%2033.0543%2020.9706C33.5954%2021.2139%2034.1754%2021.3386%2034.7609%2021.3376ZM34.7609%2022.4821C32.3882%2022.4821%2030.6038%2023.2696%2029.561%2024.3598C27.5734%2022.581%2024.4307%2021.3376%2020.5%2021.3376C16.4606%2021.3376%2013.3785%2022.5946%2011.423%2024.3714C10.3605%2023.2755%208.55652%2022.4821%206.23913%2022.4821C2.33878%2022.4821%200%2024.5965%200%2026.7147C0%2027.7719%202.33878%2028.8329%206.23913%2028.8329C7.31583%2028.8329%208.282%2028.734%209.13231%2028.575L9.061%2029.0987C9.061%2031.0385%2013.35%2032.9783%2020.5%2032.9783C27.2062%2032.9783%2031.939%2031.0385%2031.939%2029.0987L31.9033%2028.604C32.7287%2028.7457%2033.677%2028.8329%2034.7609%2028.8329C38.417%2028.8329%2041%2027.7719%2041%2026.7147C41%2024.5965%2038.5525%2022.4821%2034.7609%2022.4821ZM6.23913%2021.3376C7.46913%2021.3376%208.58326%2020.7964%209.39078%2019.9177C9.80458%2019.4673%2010.1328%2018.9326%2010.3567%2018.3442C10.5806%2017.7557%2010.6958%2017.125%2010.6957%2016.4882C10.6968%2015.851%2010.5824%2015.2198%2010.3588%2014.6308C10.1353%2014.0419%209.80705%2013.5068%209.39299%2013.0562C8.97893%2012.6057%208.48718%2012.2485%207.94596%2012.0052C7.40474%2011.762%206.8247%2011.6374%206.23913%2011.6387C5.65363%2011.6377%205.0737%2011.7624%204.53258%2012.0058C3.99147%2012.2491%203.49981%2012.6063%203.0858%2013.0568C2.67179%2013.5073%202.34356%2014.0423%202.11993%2014.6311C1.8963%2015.22%201.78167%2015.851%201.78261%2016.4882C1.78143%2017.1254%201.8959%2017.7565%202.11945%2018.3455C2.34299%2018.9344%202.67121%2019.4695%203.08527%2019.9201C3.49933%2020.3707%203.99108%2020.7278%204.5323%2020.9711C5.07353%2021.2143%205.65356%2021.3389%206.23913%2021.3376Z'%20fill='%230052A1'/%3e%3c/svg%3e",I9="data:image/svg+xml,%3csvg%20width='35'%20height='36'%20viewBox='0%200%2035%2036'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M33.1256%200.873428L34.0844%201.83218C35.4055%203.15493%2035.2056%205.4998%2033.6343%207.06955L13.8629%2026.8409L7.45713%2029.1842C6.65275%2029.4799%205.8695%2029.0964%205.71025%2028.3311C5.65661%2028.0534%205.68194%2027.7663%205.78337%2027.5023L8.17213%2021.0413L27.8883%201.32355C29.4596%20-0.246198%2031.8045%20-0.449322%2033.1256%200.873428ZM13%202.83968C13.2134%202.83968%2013.4247%202.88171%2013.6219%202.96337C13.819%203.04504%2013.9982%203.16473%2014.149%203.31563C14.2999%203.46652%2014.4196%203.64566%2014.5013%203.84282C14.583%204.03997%2014.625%204.25128%2014.625%204.46468C14.625%204.67808%2014.583%204.88938%2014.5013%205.08654C14.4196%205.28369%2014.2999%205.46283%2014.149%205.61373C13.9982%205.76462%2013.819%205.88432%2013.6219%205.96598C13.4247%206.04765%2013.2134%206.08968%2013%206.08968H6.5C5.63805%206.08968%204.8114%206.43209%204.2019%207.04158C3.59241%207.65107%203.25%208.47772%203.25%209.33968V28.8397C3.25%2029.7016%203.59241%2030.5283%204.2019%2031.1378C4.8114%2031.7473%205.63805%2032.0897%206.5%2032.0897H26C26.862%2032.0897%2027.6886%2031.7473%2028.2981%2031.1378C28.9076%2030.5283%2029.25%2029.7016%2029.25%2028.8397V22.3397C29.25%2021.9087%2029.4212%2021.4954%2029.726%2021.1906C30.0307%2020.8859%2030.444%2020.7147%2030.875%2020.7147C31.306%2020.7147%2031.7193%2020.8859%2032.024%2021.1906C32.3288%2021.4954%2032.5%2021.9087%2032.5%2022.3397V28.8397C32.5%2030.5636%2031.8152%2032.2169%2030.5962%2033.4359C29.3772%2034.6549%2027.7239%2035.3397%2026%2035.3397H6.5C4.77609%2035.3397%203.12279%2034.6549%201.90381%2033.4359C0.68482%2032.2169%200%2030.5636%200%2028.8397V9.33968C0%207.61577%200.68482%205.96247%201.90381%204.74348C3.12279%203.5245%204.77609%202.83968%206.5%202.83968H13Z'%20fill='%230052A1'/%3e%3c/svg%3e",R9="data:image/svg+xml,%3csvg%20width='35'%20height='43'%20viewBox='0%200%2035%2043'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17.25%200L0%207.66667V19.1667C0%2029.8042%207.36%2039.7517%2017.25%2042.1667C27.14%2039.7517%2034.5%2029.8042%2034.5%2019.1667V7.66667L17.25%200ZM17.25%207.475C18.3872%207.475%2019.4989%207.81223%2020.4445%208.44405C21.3901%209.07587%2022.1271%209.9739%2022.5623%2011.0246C22.9975%2012.0752%2023.1114%2013.2314%2022.8895%2014.3468C22.6677%2015.4622%2022.12%2016.4867%2021.3159%2017.2909C20.5117%2018.095%2019.4872%2018.6427%2018.3718%2018.8645C17.2564%2019.0864%2016.1002%2018.9725%2015.0496%2018.5373C13.9989%2018.1021%2013.1009%2017.3651%2012.469%2016.4195C11.8372%2015.4739%2011.5%2014.3622%2011.5%2013.225C11.5%2011.7%2012.1058%2010.2375%2013.1841%209.15914C14.2625%208.0808%2015.725%207.475%2017.25%207.475ZM17.25%2022.6167C21.0833%2022.6167%2028.75%2024.7058%2028.75%2028.52C27.4912%2030.4177%2025.7823%2031.9744%2023.7757%2033.0513C21.7692%2034.1282%2019.5273%2034.6918%2017.25%2034.6918C14.9727%2034.6918%2012.7308%2034.1282%2010.7243%2033.0513C8.7177%2031.9744%207.00881%2030.4177%205.75%2028.52C5.75%2024.7058%2013.4167%2022.6167%2017.25%2022.6167Z'%20fill='%230052A1'/%3e%3c/svg%3e",j9="data:image/svg+xml,%3csvg%20width='40'%20height='39'%20viewBox='0%200%2040%2039'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M35.4583%2028.75C36.475%2028.75%2037.45%2028.3461%2038.1689%2027.6272C38.8878%2026.9084%2039.2917%2025.9333%2039.2917%2024.9167V3.83333C39.2917%202.81667%2038.8878%201.84165%2038.1689%201.12276C37.45%200.403868%2036.475%200%2035.4583%200H15.2567C15.9275%201.16917%2016.2917%202.49167%2016.2917%203.83333H35.4583V24.9167H18.2083V28.75M25.875%209.58333V13.4167H14.375V38.3333H10.5417V26.8333H6.70833V38.3333H2.875V23H0V13.4167C0%2012.4%200.403868%2011.425%201.12276%2010.7061C1.84165%209.9872%202.81667%209.58333%203.83333%209.58333H25.875ZM12.4583%203.83333C12.4583%204.85%2012.0545%205.82502%2011.3356%206.54391C10.6167%207.2628%209.64166%207.66667%208.625%207.66667C7.60834%207.66667%206.63331%207.2628%205.91442%206.54391C5.19553%205.82502%204.79167%204.85%204.79167%203.83333C4.79167%202.81667%205.19553%201.84165%205.91442%201.12276C6.63331%200.403868%207.60834%200%208.625%200C9.64166%200%2010.6167%200.403868%2011.3356%201.12276C12.0545%201.84165%2012.4583%202.81667%2012.4583%203.83333Z'%20fill='%230052A1'/%3e%3c/svg%3e",D9="data:image/svg+xml,%3csvg%20width='19'%20height='22'%20viewBox='0%200%2019%2022'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9.12364%200C6.43456%200%203.14556%200.98325%201.20397%201.65887C0.25714%201.98854%20-0.217235%203.01683%200.0961401%203.96846L2.15464%2010.2178C1.61908%2011.3858%201.38568%2012.6696%201.47589%2013.9514C1.56609%2015.2332%201.97702%2016.4717%202.67088%2017.5532C3.36475%2018.6347%204.31931%2019.5244%205.44684%2020.1407C6.57437%2020.7569%207.8387%2021.0799%209.12364%2021.0799C10.4086%2021.0799%2011.6729%2020.7569%2012.8004%2020.1407C13.928%2019.5244%2014.8825%2018.6347%2015.5764%2017.5532C16.2703%2016.4717%2016.6812%2015.2332%2016.7714%2013.9514C16.8616%2012.6696%2016.6282%2011.3858%2016.0926%2010.2178L18.1511%203.96942C18.4645%203.01683%2017.9901%201.98854%2017.0433%201.65983C15.1008%200.982292%2011.8127%200%209.12364%200ZM3.73781%2011.9073C7.33826%2010.4286%2010.909%2010.4286%2014.5095%2011.9073C14.567%2011.9309%2014.6264%2011.9488%2014.6877%2011.961C14.909%2012.8111%2014.9326%2013.7007%2014.7566%2014.5614C14.5806%2015.4221%2014.2097%2016.231%2013.6724%2016.9261C13.1351%2017.6212%2012.4457%2018.1839%2011.6571%2018.571C10.8685%2018.9582%2010.0017%2019.1595%209.12316%2019.1595C8.24465%2019.1595%207.37782%2018.9582%206.58922%2018.571C5.80061%2018.1839%205.1112%2017.6212%204.57391%2016.9261C4.03662%2016.231%203.66574%2015.4221%203.48974%2014.5614C3.31373%2013.7007%203.33729%2012.8111%203.5586%2011.961C3.61993%2011.9488%203.67967%2011.9309%203.73781%2011.9073ZM10.082%204.79167H11.9986V6.70833H10.082V8.625H8.16531V6.70833H6.24864V4.79167H8.16531V2.875H10.082V4.79167Z'%20fill='%230052A1'/%3e%3c/svg%3e",sl={SP:A9,OOO:C9,Group:N9,Enroll:I9,Admin:R9,Teacher:j9,Therapist:D9},To=({forceActive:n})=>{const{currentUser:e,logout:t}=In(),s=Nn(),i=kn(),[o,u]=I.useState(!1),[h,f]=I.useState(window.innerWidth>=768),p=async()=>{await t(),s("/login")},g=b=>n?b===n:i.pathname===b,x=e?.role==="super_admin";return I.useEffect(()=>{const b=()=>{window.innerWidth>=768?(f(!0),u(!0)):(f(!1),u(!1))};return window.addEventListener("resize",b),b(),()=>window.removeEventListener("resize",b)},[]),l.jsxs(l.Fragment,{children:[!h&&l.jsx("button",{className:"open-btn",onClick:()=>u(b=>!b),children:o?"":""}),l.jsxs("div",{className:`sidebar ${o?"open":"closed"}`,children:[l.jsxs("div",{className:"profile-section",children:[l.jsx("div",{className:"avatar",children:""}),l.jsxs("div",{children:[l.jsx("div",{className:"role-label",children:x?"SUPER ADMIN":"ADMINISTRATOR"}),l.jsx("div",{className:"profile-name",children:e?.firstName||"Admin"})]})]}),l.jsxs("div",{className:"menu-section",children:[l.jsx("div",{className:"section-title",children:"MAIN"}),l.jsxs("div",{className:`menu-item ${g("/admin/StudentProfile")?"active":""}`,onClick:()=>s("/admin/StudentProfile"),children:[l.jsx("img",{src:sl.SP,className:"menu-icon",alt:"SP"}),l.jsx("span",{className:"menu-label",children:"STUDENT PROFILE"})]}),l.jsxs("div",{className:`menu-item ${g("/admin/one-on-one")?"active":""}`,onClick:()=>s("/admin/one-on-one"),children:[l.jsx("img",{src:sl.OOO,className:"menu-icon",alt:"One On One"}),l.jsx("span",{className:"menu-label",children:"1 on 1 SERVICES"})]}),l.jsxs("div",{className:`menu-item ${g("/admin/play-group")?"active":""}`,onClick:()=>s("/admin/play-group"),children:[l.jsx("img",{src:sl.Group,className:"menu-icon",alt:"Group class"}),l.jsx("span",{className:"menu-label",children:"GROUP CLASSES"})]}),x&&l.jsxs("div",{className:`menu-item ${g("/admin/enrollment")?"active":""}`,onClick:()=>s("/admin/enrollment"),children:[l.jsx("img",{src:sl.Enroll,className:"menu-icon",alt:"Enroll"}),l.jsx("span",{className:"menu-label",children:"ENROLL STUDENT"})]})]}),l.jsxs("div",{className:"menu-section",children:[l.jsx("div",{className:"section-title",children:"USER MANAGEMENT"}),x&&l.jsxs("div",{className:`menu-item ${g("/admin/manage-admins")?"active":""}`,onClick:()=>s("/admin/manage-admins"),children:[l.jsx("img",{src:sl.Admin,className:"menu-icon",alt:"Admin"}),l.jsx("span",{className:"menu-label",children:"ADMIN"})]}),l.jsxs("div",{className:`menu-item ${g("/admin/manage-teachers")?"active":""}`,onClick:()=>s("/admin/manage-teachers"),children:[l.jsx("img",{src:sl.Teacher,className:"menu-icon",alt:"Teacher"}),l.jsx("span",{className:"menu-label",children:"TEACHER"})]}),l.jsxs("div",{className:`menu-item ${g("/admin/manage-therapists")?"active":""}`,onClick:()=>s("/admin/manage-therapists"),children:[l.jsx("img",{src:sl.Therapist,className:"menu-icon",alt:"Therapist"}),l.jsx("span",{className:"menu-label",children:"THERAPIST"})]}),l.jsxs("div",{className:`menu-item ${g("/admin/pending-accounts")?"active":""}`,onClick:()=>s("/admin/pending-accounts"),children:[l.jsx("svg",{width:"25",height:"25",viewBox:"0 0 24 24",fill:"currentColor",className:"menu-icon",style:{color:"#374151"},children:l.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67V7z"})}),l.jsx("span",{className:"menu-label",children:"PENDING ACCOUNTS"})]})]}),l.jsx("button",{className:"logout-btn",onClick:p,children:"LOG OUT"})]})]})},Og=({pageLabel:n=""})=>l.jsx("footer",{className:"app-footer",children:l.jsxs("div",{className:"app-footer-inner",children:[l.jsx("span",{children:"Little Lions Learning and Development Center"}),l.jsx("span",{children:"littlelionsldc@gmail.com"}),l.jsx("span",{children:"(+63) 9677900903"}),n&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"app-footer-sep",children:""}),l.jsx("span",{children:n})]})]})});const hn="children",O9=20;class P9{async getChildrenPaginated(e={}){const{limit:t=O9,startAfter:s=null,orderByField:i="lastName",orderDirection:o="asc",status:u=null}=e;try{let h=an(bt(Ee,hn),S2(i,o),w2(t));u&&(h=an(bt(Ee,hn),mn("status","==",u),S2(i,o),w2(t))),s&&(h=an(h,mV(s)));const f=await Wt(h);return f.docs.length,{students:f.docs.map(g=>({id:g.id,...g.data()})),lastDoc:f.docs[f.docs.length-1]||null,hasMore:f.docs.length===t,total:null}}catch(h){throw console.error("Error fetching paginated children:",h),h}}async getChildrenByParentId(e){if(!e)return console.warn("getChildrenByParentId called without parentId"),[];try{const t=an(bt(Ee,hn),mn("parentId","==",e)),s=await Wt(t);return s.docs.length,s.docs.map(o=>({id:o.id,...o.data()})).sort((o,u)=>(o.lastName||"").localeCompare(u.lastName||""))}catch(t){throw console.error("Error fetching children by parent:",t),t}}async getChildrenByStaffId(e){if(!e)return console.warn("getChildrenByStaffId called without staffId"),[];try{const t=an(bt(Ee,hn),mn("assignedStaffIds","array-contains",e)),s=await Wt(t);if(s.docs.length,s.empty){console.log("Optimized query found 0 students. Checking fallback for legacy data...");const o=await this.getChildrenByStaffIdFallback(e);if(o.length>0)return o}return s.docs.map(o=>({id:o.id,...o.data()})).sort((o,u)=>(o.lastName||"").localeCompare(u.lastName||""))}catch(t){return console.warn("Falling back to service-based staff query:",t.message),this.getChildrenByStaffIdFallback(e)}}async getChildrenByStaffIdFallback(e){try{const t=an(bt(Ee,hn),mn("status","==","ENROLLED")),s=await Wt(t);return s.docs.length,s.docs.map(i=>({id:i.id,...i.data()})).filter(i=>{const o=i.oneOnOneServices||[],u=i.groupClassServices||[],h=i.enrolledServices||[];return[...o,...u,...h].some(f=>f.staffId===e)}).sort((i,o)=>(i.lastName||"").localeCompare(o.lastName||""))}catch(t){throw console.error("Error in fallback staff query:",t),t}}async getChildrenByTherapistId(e){return this.getChildrenByStaffId(e)}async getChildrenByTeacherId(e){return this.getChildrenByStaffId(e)}async getChildrenByService(e){if(!e)return[];try{const t=an(bt(Ee,hn),mn("status","==","ENROLLED")),s=await Wt(t);return s.docs.length,s.docs.map(i=>({id:i.id,...i.data()})).filter(i=>[...i.oneOnOneServices||[],...i.groupClassServices||[],...i.enrolledServices||[]].some(u=>u.serviceName===e))}catch(t){throw console.error("Error fetching children by service:",t),t}}async getChildById(e){if(!e)return null;try{const t=at(Ee,hn,e),s=await ra(t);return s.exists()?{id:s.id,...s.data()}:null}catch(t){throw console.error("Error fetching child:",t),t}}async createOrUpdateChild(e,t){try{const s=t.childId||t.id||at(bt(Ee,hn)).id,i=at(Ee,hn,s),o=this.extractStaffIds(t),u={...t,id:s,parentId:e,assignedStaffIds:o,updatedAt:as()};Object.keys(u).forEach(f=>{u[f]===void 0&&delete u[f]});const h=await ra(i);return h.exists()?await is(i,u):(u.createdAt=as(),await ml(i,u)),{id:s,...u}}catch(s){throw console.error("Error saving child:",s),s}}extractStaffIds(e){const t=new Set;return[e.oneOnOneServices,e.groupClassServices,e.enrolledServices].forEach(i=>{Array.isArray(i)&&i.forEach(o=>{o.staffId&&t.add(o.staffId)})}),Array.from(t)}async addServiceToChild(e,t){try{const s=at(Ee,hn,e),i=t.serviceType==="Therapy"?"oneOnOneServices":t.serviceType==="Class"?"groupClassServices":"enrolledServices";return await is(s,{[i]:Hm(t),assignedStaffIds:Hm(t.staffId),updatedAt:as()}),!0}catch(s){throw console.error("Error adding service to child:",s),s}}async removeServiceFromChild(e,t){try{const s=at(Ee,hn,e),i=t.serviceType==="Therapy"?"oneOnOneServices":t.serviceType==="Class"?"groupClassServices":"enrolledServices";await is(s,{[i]:NV(t),updatedAt:as()});const o=await this.getChildById(e),u=this.extractStaffIds(o);return await is(s,{assignedStaffIds:u}),!0}catch(s){throw console.error("Error removing service from child:",s),s}}async getAllChildren(){console.warn(" getAllChildren() is deprecated and expensive. Use getChildrenPaginated() or role-specific methods instead.");try{const e=await Wt(bt(Ee,hn));return e.docs.length,e.docs.map(s=>({id:s.id,...s.data()})).sort((s,i)=>(s.lastName||"").localeCompare(i.lastName||""))}catch(e){throw console.error("Error fetching all children:",e),e}}async batchUpdateChildren(e){if(!(!e||e.length===0))try{const t=bR(Ee);e.forEach(({id:s,data:i})=>{const o=at(Ee,hn,s);t.update(o,{...i,updatedAt:as()})}),await t.commit(),console.log(`Batch updated ${e.length} children`)}catch(t){throw console.error("Error in batch update:",t),t}}}const Vr=new P9;class k9{async createService(e){try{const s=["Therapy","Class"].includes(e.type)?e.type:"Therapy";return(await Su(bt(Ee,"services"),{...e,type:s,createdAt:new Date().toISOString(),active:!0})).id}catch(t){throw new Error("Failed to create service: "+t.message)}}async getAllServices(){try{return(await Wt(bt(Ee,"services"))).docs.map(t=>({id:t.id,...t.data()}))}catch(e){throw new Error("Failed to fetch services: "+e.message)}}async getActiveServices(){try{const e=an(bt(Ee,"services"),mn("active","==",!0));return(await Wt(e)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw new Error("Failed to fetch active services: "+e.message)}}async getServicesByType(e){try{const t=an(bt(Ee,"services"),mn("active","==",!0),mn("type","==",e));return(await Wt(t)).docs.map(i=>({id:i.id,...i.data()}))}catch(t){throw new Error(`Failed to fetch ${e} services: `+t.message)}}async getServiceById(e){try{const t=await ra(at(Ee,"services",e));if(!t.exists())throw new Error("Service not found");return{id:t.id,...t.data()}}catch(t){throw new Error("Failed to fetch service: "+t.message)}}async updateService(e,t){try{await is(at(Ee,"services",e),{...t,updatedAt:new Date().toISOString()})}catch(s){throw new Error("Failed to update service: "+s.message)}}async deactivateService(e){try{await is(at(Ee,"services",e),{active:!1,deactivatedAt:new Date().toISOString()})}catch(t){throw new Error("Failed to deactivate service: "+t.message)}}async deleteService(e){try{await xV(at(Ee,"services",e))}catch(t){throw new Error("Failed to delete service: "+t.message)}}async getServicesWithStats(){try{const e=await this.getAllServices(),s=(await Wt(bt(Ee,"children"))).docs.map(i=>({id:i.id,...i.data()}));return e.map(i=>{const o=s.filter(u=>u.services&&u.services.some(h=>h.serviceName===i.name));return{...i,enrolledCount:o.length,enrolledChildren:o}})}catch(e){throw new Error("Failed to fetch services with stats: "+e.message)}}}const bi=new k9;function NR(n,e){return function(){return n.apply(e,arguments)}}const{toString:M9}=Object.prototype,{getPrototypeOf:u_}=Object,{iterator:Pg,toStringTag:IR}=Symbol,kg=(n=>e=>{const t=M9.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Fr=n=>(n=n.toLowerCase(),e=>kg(e)===n),Mg=n=>e=>typeof e===n,{isArray:Mu}=Array,wu=Mg("undefined");function ef(n){return n!==null&&!wu(n)&&n.constructor!==null&&!wu(n.constructor)&&ks(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const RR=Fr("ArrayBuffer");function L9(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&RR(n.buffer),e}const V9=Mg("string"),ks=Mg("function"),jR=Mg("number"),tf=n=>n!==null&&typeof n=="object",U9=n=>n===!0||n===!1,lm=n=>{if(kg(n)!=="object")return!1;const e=u_(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(IR in n)&&!(Pg in n)},B9=n=>{if(!tf(n)||ef(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},F9=Fr("Date"),z9=Fr("File"),q9=Fr("Blob"),H9=Fr("FileList"),G9=n=>tf(n)&&ks(n.pipe),$9=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ks(n.append)&&((e=kg(n))==="formdata"||e==="object"&&ks(n.toString)&&n.toString()==="[object FormData]"))},K9=Fr("URLSearchParams"),[Q9,Y9,W9,X9]=["ReadableStream","Request","Response","Headers"].map(Fr),J9=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function nf(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let s,i;if(typeof n!="object"&&(n=[n]),Mu(n))for(s=0,i=n.length;s<i;s++)e.call(null,n[s],s,n);else{if(ef(n))return;const o=t?Object.getOwnPropertyNames(n):Object.keys(n),u=o.length;let h;for(s=0;s<u;s++)h=o[s],e.call(null,n[h],h,n)}}function DR(n,e){if(ef(n))return null;e=e.toLowerCase();const t=Object.keys(n);let s=t.length,i;for(;s-- >0;)if(i=t[s],e===i.toLowerCase())return i;return null}const yl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,OR=n=>!wu(n)&&n!==yl;function _x(){const{caseless:n,skipUndefined:e}=OR(this)&&this||{},t={},s=(i,o)=>{const u=n&&DR(t,o)||o;lm(t[u])&&lm(i)?t[u]=_x(t[u],i):lm(i)?t[u]=_x({},i):Mu(i)?t[u]=i.slice():(!e||!wu(i))&&(t[u]=i)};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&nf(arguments[i],s);return t}const Z9=(n,e,t,{allOwnKeys:s}={})=>(nf(e,(i,o)=>{t&&ks(i)?n[o]=NR(i,t):n[o]=i},{allOwnKeys:s}),n),eU=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),tU=(n,e,t,s)=>{n.prototype=Object.create(e.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},nU=(n,e,t,s)=>{let i,o,u;const h={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),o=i.length;o-- >0;)u=i[o],(!s||s(u,n,e))&&!h[u]&&(e[u]=n[u],h[u]=!0);n=t!==!1&&u_(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},sU=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const s=n.indexOf(e,t);return s!==-1&&s===t},rU=n=>{if(!n)return null;if(Mu(n))return n;let e=n.length;if(!jR(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},iU=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&u_(Uint8Array)),aU=(n,e)=>{const s=(n&&n[Pg]).call(n);let i;for(;(i=s.next())&&!i.done;){const o=i.value;e.call(n,o[0],o[1])}},oU=(n,e)=>{let t;const s=[];for(;(t=n.exec(e))!==null;)s.push(t);return s},lU=Fr("HTMLFormElement"),cU=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,i){return s.toUpperCase()+i}),M2=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),uU=Fr("RegExp"),PR=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),s={};nf(t,(i,o)=>{let u;(u=e(i,o,n))!==!1&&(s[o]=u||i)}),Object.defineProperties(n,s)},dU=n=>{PR(n,(e,t)=>{if(ks(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=n[t];if(ks(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},hU=(n,e)=>{const t={},s=i=>{i.forEach(o=>{t[o]=!0})};return Mu(n)?s(n):s(String(n).split(e)),t},fU=()=>{},pU=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function mU(n){return!!(n&&ks(n.append)&&n[IR]==="FormData"&&n[Pg])}const gU=n=>{const e=new Array(10),t=(s,i)=>{if(tf(s)){if(e.indexOf(s)>=0)return;if(ef(s))return s;if(!("toJSON"in s)){e[i]=s;const o=Mu(s)?[]:{};return nf(s,(u,h)=>{const f=t(u,i+1);!wu(f)&&(o[h]=f)}),e[i]=void 0,o}}return s};return t(n,0)},yU=Fr("AsyncFunction"),vU=n=>n&&(tf(n)||ks(n))&&ks(n.then)&&ks(n.catch),kR=((n,e)=>n?setImmediate:e?((t,s)=>(yl.addEventListener("message",({source:i,data:o})=>{i===yl&&o===t&&s.length&&s.shift()()},!1),i=>{s.push(i),yl.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ks(yl.postMessage)),xU=typeof queueMicrotask<"u"?queueMicrotask.bind(yl):typeof process<"u"&&process.nextTick||kR,bU=n=>n!=null&&ks(n[Pg]),ie={isArray:Mu,isArrayBuffer:RR,isBuffer:ef,isFormData:$9,isArrayBufferView:L9,isString:V9,isNumber:jR,isBoolean:U9,isObject:tf,isPlainObject:lm,isEmptyObject:B9,isReadableStream:Q9,isRequest:Y9,isResponse:W9,isHeaders:X9,isUndefined:wu,isDate:F9,isFile:z9,isBlob:q9,isRegExp:uU,isFunction:ks,isStream:G9,isURLSearchParams:K9,isTypedArray:iU,isFileList:H9,forEach:nf,merge:_x,extend:Z9,trim:J9,stripBOM:eU,inherits:tU,toFlatObject:nU,kindOf:kg,kindOfTest:Fr,endsWith:sU,toArray:rU,forEachEntry:aU,matchAll:oU,isHTMLForm:lU,hasOwnProperty:M2,hasOwnProp:M2,reduceDescriptors:PR,freezeMethods:dU,toObjectSet:hU,toCamelCase:cU,noop:fU,toFiniteNumber:pU,findKey:DR,global:yl,isContextDefined:OR,isSpecCompliantForm:mU,toJSONObject:gU,isAsyncFn:yU,isThenable:vU,setImmediate:kR,asap:xU,isIterable:bU};function ze(n,e,t,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}ie.inherits(ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ie.toJSONObject(this.config),code:this.code,status:this.status}}});const MR=ze.prototype,LR={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{LR[n]={value:n}});Object.defineProperties(ze,LR);Object.defineProperty(MR,"isAxiosError",{value:!0});ze.from=(n,e,t,s,i,o)=>{const u=Object.create(MR);ie.toFlatObject(n,u,function(g){return g!==Error.prototype},p=>p!=="isAxiosError");const h=n&&n.message?n.message:"Error",f=e==null&&n?n.code:e;return ze.call(u,h,f,t,s,i),n&&u.cause==null&&Object.defineProperty(u,"cause",{value:n,configurable:!0}),u.name=n&&n.name||"Error",o&&Object.assign(u,o),u};const _U=null;function Sx(n){return ie.isPlainObject(n)||ie.isArray(n)}function VR(n){return ie.endsWith(n,"[]")?n.slice(0,-2):n}function L2(n,e,t){return n?n.concat(e).map(function(i,o){return i=VR(i),!t&&o?"["+i+"]":i}).join(t?".":""):e}function SU(n){return ie.isArray(n)&&!n.some(Sx)}const wU=ie.toFlatObject(ie,{},null,function(e){return/^is[A-Z]/.test(e)});function Lg(n,e,t){if(!ie.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=ie.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,C){return!ie.isUndefined(C[A])});const s=t.metaTokens,i=t.visitor||g,o=t.dots,u=t.indexes,f=(t.Blob||typeof Blob<"u"&&Blob)&&ie.isSpecCompliantForm(e);if(!ie.isFunction(i))throw new TypeError("visitor must be a function");function p(w){if(w===null)return"";if(ie.isDate(w))return w.toISOString();if(ie.isBoolean(w))return w.toString();if(!f&&ie.isBlob(w))throw new ze("Blob is not supported. Use a Buffer instead.");return ie.isArrayBuffer(w)||ie.isTypedArray(w)?f&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function g(w,A,C){let L=w;if(w&&!C&&typeof w=="object"){if(ie.endsWith(A,"{}"))A=s?A:A.slice(0,-2),w=JSON.stringify(w);else if(ie.isArray(w)&&SU(w)||(ie.isFileList(w)||ie.endsWith(A,"[]"))&&(L=ie.toArray(w)))return A=VR(A),L.forEach(function(U,F){!(ie.isUndefined(U)||U===null)&&e.append(u===!0?L2([A],F,o):u===null?A:A+"[]",p(U))}),!1}return Sx(w)?!0:(e.append(L2(C,A,o),p(w)),!1)}const x=[],b=Object.assign(wU,{defaultVisitor:g,convertValue:p,isVisitable:Sx});function S(w,A){if(!ie.isUndefined(w)){if(x.indexOf(w)!==-1)throw Error("Circular reference detected in "+A.join("."));x.push(w),ie.forEach(w,function(L,z){(!(ie.isUndefined(L)||L===null)&&i.call(e,L,ie.isString(z)?z.trim():z,A,b))===!0&&S(L,A?A.concat(z):[z])}),x.pop()}}if(!ie.isObject(n))throw new TypeError("data must be an object");return S(n),e}function V2(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function d_(n,e){this._pairs=[],n&&Lg(n,this,e)}const UR=d_.prototype;UR.append=function(e,t){this._pairs.push([e,t])};UR.toString=function(e){const t=e?function(s){return e.call(this,s,V2)}:V2;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function EU(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function BR(n,e,t){if(!e)return n;const s=t&&t.encode||EU;ie.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let o;if(i?o=i(e,t):o=ie.isURLSearchParams(e)?e.toString():new d_(e,t).toString(s),o){const u=n.indexOf("#");u!==-1&&(n=n.slice(0,u)),n+=(n.indexOf("?")===-1?"?":"&")+o}return n}class U2{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ie.forEach(this.handlers,function(s){s!==null&&e(s)})}}const FR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},TU=typeof URLSearchParams<"u"?URLSearchParams:d_,AU=typeof FormData<"u"?FormData:null,CU=typeof Blob<"u"?Blob:null,NU={isBrowser:!0,classes:{URLSearchParams:TU,FormData:AU,Blob:CU},protocols:["http","https","file","blob","url","data"]},h_=typeof window<"u"&&typeof document<"u",wx=typeof navigator=="object"&&navigator||void 0,IU=h_&&(!wx||["ReactNative","NativeScript","NS"].indexOf(wx.product)<0),RU=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",jU=h_&&window.location.href||"http://localhost",DU=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:h_,hasStandardBrowserEnv:IU,hasStandardBrowserWebWorkerEnv:RU,navigator:wx,origin:jU},Symbol.toStringTag,{value:"Module"})),os={...DU,...NU};function OU(n,e){return Lg(n,new os.classes.URLSearchParams,{visitor:function(t,s,i,o){return os.isNode&&ie.isBuffer(t)?(this.append(s,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function PU(n){return ie.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function kU(n){const e={},t=Object.keys(n);let s;const i=t.length;let o;for(s=0;s<i;s++)o=t[s],e[o]=n[o];return e}function zR(n){function e(t,s,i,o){let u=t[o++];if(u==="__proto__")return!0;const h=Number.isFinite(+u),f=o>=t.length;return u=!u&&ie.isArray(i)?i.length:u,f?(ie.hasOwnProp(i,u)?i[u]=[i[u],s]:i[u]=s,!h):((!i[u]||!ie.isObject(i[u]))&&(i[u]=[]),e(t,s,i[u],o)&&ie.isArray(i[u])&&(i[u]=kU(i[u])),!h)}if(ie.isFormData(n)&&ie.isFunction(n.entries)){const t={};return ie.forEachEntry(n,(s,i)=>{e(PU(s),i,t,0)}),t}return null}function MU(n,e,t){if(ie.isString(n))try{return(e||JSON.parse)(n),ie.trim(n)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(n)}const sf={transitional:FR,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,o=ie.isObject(e);if(o&&ie.isHTMLForm(e)&&(e=new FormData(e)),ie.isFormData(e))return i?JSON.stringify(zR(e)):e;if(ie.isArrayBuffer(e)||ie.isBuffer(e)||ie.isStream(e)||ie.isFile(e)||ie.isBlob(e)||ie.isReadableStream(e))return e;if(ie.isArrayBufferView(e))return e.buffer;if(ie.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let h;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return OU(e,this.formSerializer).toString();if((h=ie.isFileList(e))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Lg(h?{"files[]":e}:e,f&&new f,this.formSerializer)}}return o||i?(t.setContentType("application/json",!1),MU(e)):e}],transformResponse:[function(e){const t=this.transitional||sf.transitional,s=t&&t.forcedJSONParsing,i=this.responseType==="json";if(ie.isResponse(e)||ie.isReadableStream(e))return e;if(e&&ie.isString(e)&&(s&&!this.responseType||i)){const u=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(h){if(u)throw h.name==="SyntaxError"?ze.from(h,ze.ERR_BAD_RESPONSE,this,null,this.response):h}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:os.classes.FormData,Blob:os.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ie.forEach(["delete","get","head","post","put","patch"],n=>{sf.headers[n]={}});const LU=ie.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),VU=n=>{const e={};let t,s,i;return n&&n.split(`
`).forEach(function(u){i=u.indexOf(":"),t=u.substring(0,i).trim().toLowerCase(),s=u.substring(i+1).trim(),!(!t||e[t]&&LU[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},B2=Symbol("internals");function Gd(n){return n&&String(n).trim().toLowerCase()}function cm(n){return n===!1||n==null?n:ie.isArray(n)?n.map(cm):String(n)}function UU(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(n);)e[s[1]]=s[2];return e}const BU=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function m0(n,e,t,s,i){if(ie.isFunction(s))return s.call(this,e,t);if(i&&(e=t),!!ie.isString(e)){if(ie.isString(s))return e.indexOf(s)!==-1;if(ie.isRegExp(s))return s.test(e)}}function FU(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function zU(n,e){const t=ie.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(n,s+t,{value:function(i,o,u){return this[s].call(this,e,i,o,u)},configurable:!0})})}let Ms=class{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function o(h,f,p){const g=Gd(f);if(!g)throw new Error("header name must be a non-empty string");const x=ie.findKey(i,g);(!x||i[x]===void 0||p===!0||p===void 0&&i[x]!==!1)&&(i[x||f]=cm(h))}const u=(h,f)=>ie.forEach(h,(p,g)=>o(p,g,f));if(ie.isPlainObject(e)||e instanceof this.constructor)u(e,t);else if(ie.isString(e)&&(e=e.trim())&&!BU(e))u(VU(e),t);else if(ie.isObject(e)&&ie.isIterable(e)){let h={},f,p;for(const g of e){if(!ie.isArray(g))throw TypeError("Object iterator must return a key-value pair");h[p=g[0]]=(f=h[p])?ie.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}u(h,t)}else e!=null&&o(t,e,s);return this}get(e,t){if(e=Gd(e),e){const s=ie.findKey(this,e);if(s){const i=this[s];if(!t)return i;if(t===!0)return UU(i);if(ie.isFunction(t))return t.call(this,i,s);if(ie.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Gd(e),e){const s=ie.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||m0(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let i=!1;function o(u){if(u=Gd(u),u){const h=ie.findKey(s,u);h&&(!t||m0(s,s[h],h,t))&&(delete s[h],i=!0)}}return ie.isArray(e)?e.forEach(o):o(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;for(;s--;){const o=t[s];(!e||m0(this,this[o],o,e,!0))&&(delete this[o],i=!0)}return i}normalize(e){const t=this,s={};return ie.forEach(this,(i,o)=>{const u=ie.findKey(s,o);if(u){t[u]=cm(i),delete t[o];return}const h=e?FU(o):String(o).trim();h!==o&&delete t[o],t[h]=cm(i),s[h]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ie.forEach(this,(s,i)=>{s!=null&&s!==!1&&(t[i]=e&&ie.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(i=>s.set(i)),s}static accessor(e){const s=(this[B2]=this[B2]={accessors:{}}).accessors,i=this.prototype;function o(u){const h=Gd(u);s[h]||(zU(i,u),s[h]=!0)}return ie.isArray(e)?e.forEach(o):o(e),this}};Ms.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ie.reduceDescriptors(Ms.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(s){this[t]=s}}});ie.freezeMethods(Ms);function g0(n,e){const t=this||sf,s=e||t,i=Ms.from(s.headers);let o=s.data;return ie.forEach(n,function(h){o=h.call(t,o,i.normalize(),e?e.status:void 0)}),i.normalize(),o}function qR(n){return!!(n&&n.__CANCEL__)}function Lu(n,e,t){ze.call(this,n??"canceled",ze.ERR_CANCELED,e,t),this.name="CanceledError"}ie.inherits(Lu,ze,{__CANCEL__:!0});function HR(n,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?n(t):e(new ze("Request failed with status code "+t.status,[ze.ERR_BAD_REQUEST,ze.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function qU(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function HU(n,e){n=n||10;const t=new Array(n),s=new Array(n);let i=0,o=0,u;return e=e!==void 0?e:1e3,function(f){const p=Date.now(),g=s[o];u||(u=p),t[i]=f,s[i]=p;let x=o,b=0;for(;x!==i;)b+=t[x++],x=x%n;if(i=(i+1)%n,i===o&&(o=(o+1)%n),p-u<e)return;const S=g&&p-g;return S?Math.round(b*1e3/S):void 0}}function GU(n,e){let t=0,s=1e3/e,i,o;const u=(p,g=Date.now())=>{t=g,i=null,o&&(clearTimeout(o),o=null),n(...p)};return[(...p)=>{const g=Date.now(),x=g-t;x>=s?u(p,g):(i=p,o||(o=setTimeout(()=>{o=null,u(i)},s-x)))},()=>i&&u(i)]}const Km=(n,e,t=3)=>{let s=0;const i=HU(50,250);return GU(o=>{const u=o.loaded,h=o.lengthComputable?o.total:void 0,f=u-s,p=i(f),g=u<=h;s=u;const x={loaded:u,total:h,progress:h?u/h:void 0,bytes:f,rate:p||void 0,estimated:p&&h&&g?(h-u)/p:void 0,event:o,lengthComputable:h!=null,[e?"download":"upload"]:!0};n(x)},t)},F2=(n,e)=>{const t=n!=null;return[s=>e[0]({lengthComputable:t,total:n,loaded:s}),e[1]]},z2=n=>(...e)=>ie.asap(()=>n(...e)),$U=os.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,os.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(os.origin),os.navigator&&/(msie|trident)/i.test(os.navigator.userAgent)):()=>!0,KU=os.hasStandardBrowserEnv?{write(n,e,t,s,i,o,u){if(typeof document>"u")return;const h=[`${n}=${encodeURIComponent(e)}`];ie.isNumber(t)&&h.push(`expires=${new Date(t).toUTCString()}`),ie.isString(s)&&h.push(`path=${s}`),ie.isString(i)&&h.push(`domain=${i}`),o===!0&&h.push("secure"),ie.isString(u)&&h.push(`SameSite=${u}`),document.cookie=h.join("; ")},read(n){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+n+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(n){this.write(n,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function QU(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function YU(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function GR(n,e,t){let s=!QU(e);return n&&(s||t==!1)?YU(n,e):e}const q2=n=>n instanceof Ms?{...n}:n;function Ul(n,e){e=e||{};const t={};function s(p,g,x,b){return ie.isPlainObject(p)&&ie.isPlainObject(g)?ie.merge.call({caseless:b},p,g):ie.isPlainObject(g)?ie.merge({},g):ie.isArray(g)?g.slice():g}function i(p,g,x,b){if(ie.isUndefined(g)){if(!ie.isUndefined(p))return s(void 0,p,x,b)}else return s(p,g,x,b)}function o(p,g){if(!ie.isUndefined(g))return s(void 0,g)}function u(p,g){if(ie.isUndefined(g)){if(!ie.isUndefined(p))return s(void 0,p)}else return s(void 0,g)}function h(p,g,x){if(x in e)return s(p,g);if(x in n)return s(void 0,p)}const f={url:o,method:o,data:o,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:h,headers:(p,g,x)=>i(q2(p),q2(g),x,!0)};return ie.forEach(Object.keys({...n,...e}),function(g){const x=f[g]||i,b=x(n[g],e[g],g);ie.isUndefined(b)&&x!==h||(t[g]=b)}),t}const $R=n=>{const e=Ul({},n);let{data:t,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:o,headers:u,auth:h}=e;if(e.headers=u=Ms.from(u),e.url=BR(GR(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),h&&u.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):""))),ie.isFormData(t)){if(os.hasStandardBrowserEnv||os.hasStandardBrowserWebWorkerEnv)u.setContentType(void 0);else if(ie.isFunction(t.getHeaders)){const f=t.getHeaders(),p=["content-type","content-length"];Object.entries(f).forEach(([g,x])=>{p.includes(g.toLowerCase())&&u.set(g,x)})}}if(os.hasStandardBrowserEnv&&(s&&ie.isFunction(s)&&(s=s(e)),s||s!==!1&&$U(e.url))){const f=i&&o&&KU.read(o);f&&u.set(i,f)}return e},WU=typeof XMLHttpRequest<"u",XU=WU&&function(n){return new Promise(function(t,s){const i=$R(n);let o=i.data;const u=Ms.from(i.headers).normalize();let{responseType:h,onUploadProgress:f,onDownloadProgress:p}=i,g,x,b,S,w;function A(){S&&S(),w&&w(),i.cancelToken&&i.cancelToken.unsubscribe(g),i.signal&&i.signal.removeEventListener("abort",g)}let C=new XMLHttpRequest;C.open(i.method.toUpperCase(),i.url,!0),C.timeout=i.timeout;function L(){if(!C)return;const U=Ms.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),K={data:!h||h==="text"||h==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:U,config:n,request:C};HR(function(j){t(j),A()},function(j){s(j),A()},K),C=null}"onloadend"in C?C.onloadend=L:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(L)},C.onabort=function(){C&&(s(new ze("Request aborted",ze.ECONNABORTED,n,C)),C=null)},C.onerror=function(F){const K=F&&F.message?F.message:"Network Error",Z=new ze(K,ze.ERR_NETWORK,n,C);Z.event=F||null,s(Z),C=null},C.ontimeout=function(){let F=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const K=i.transitional||FR;i.timeoutErrorMessage&&(F=i.timeoutErrorMessage),s(new ze(F,K.clarifyTimeoutError?ze.ETIMEDOUT:ze.ECONNABORTED,n,C)),C=null},o===void 0&&u.setContentType(null),"setRequestHeader"in C&&ie.forEach(u.toJSON(),function(F,K){C.setRequestHeader(K,F)}),ie.isUndefined(i.withCredentials)||(C.withCredentials=!!i.withCredentials),h&&h!=="json"&&(C.responseType=i.responseType),p&&([b,w]=Km(p,!0),C.addEventListener("progress",b)),f&&C.upload&&([x,S]=Km(f),C.upload.addEventListener("progress",x),C.upload.addEventListener("loadend",S)),(i.cancelToken||i.signal)&&(g=U=>{C&&(s(!U||U.type?new Lu(null,n,C):U),C.abort(),C=null)},i.cancelToken&&i.cancelToken.subscribe(g),i.signal&&(i.signal.aborted?g():i.signal.addEventListener("abort",g)));const z=qU(i.url);if(z&&os.protocols.indexOf(z)===-1){s(new ze("Unsupported protocol "+z+":",ze.ERR_BAD_REQUEST,n));return}C.send(o||null)})},JU=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let s=new AbortController,i;const o=function(p){if(!i){i=!0,h();const g=p instanceof Error?p:this.reason;s.abort(g instanceof ze?g:new Lu(g instanceof Error?g.message:g))}};let u=e&&setTimeout(()=>{u=null,o(new ze(`timeout ${e} of ms exceeded`,ze.ETIMEDOUT))},e);const h=()=>{n&&(u&&clearTimeout(u),u=null,n.forEach(p=>{p.unsubscribe?p.unsubscribe(o):p.removeEventListener("abort",o)}),n=null)};n.forEach(p=>p.addEventListener("abort",o));const{signal:f}=s;return f.unsubscribe=()=>ie.asap(h),f}},ZU=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let s=0,i;for(;s<t;)i=s+e,yield n.slice(s,i),s=i},e7=async function*(n,e){for await(const t of t7(n))yield*ZU(t,e)},t7=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},H2=(n,e,t,s)=>{const i=e7(n,e);let o=0,u,h=f=>{u||(u=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:p,value:g}=await i.next();if(p){h(),f.close();return}let x=g.byteLength;if(t){let b=o+=x;t(b)}f.enqueue(new Uint8Array(g))}catch(p){throw h(p),p}},cancel(f){return h(f),i.return()}},{highWaterMark:2})},G2=64*1024,{isFunction:Bp}=ie,n7=(({Request:n,Response:e})=>({Request:n,Response:e}))(ie.global),{ReadableStream:$2,TextEncoder:K2}=ie.global,Q2=(n,...e)=>{try{return!!n(...e)}catch{return!1}},s7=n=>{n=ie.merge.call({skipUndefined:!0},n7,n);const{fetch:e,Request:t,Response:s}=n,i=e?Bp(e):typeof fetch=="function",o=Bp(t),u=Bp(s);if(!i)return!1;const h=i&&Bp($2),f=i&&(typeof K2=="function"?(w=>A=>w.encode(A))(new K2):async w=>new Uint8Array(await new t(w).arrayBuffer())),p=o&&h&&Q2(()=>{let w=!1;const A=new t(os.origin,{body:new $2,method:"POST",get duplex(){return w=!0,"half"}}).headers.has("Content-Type");return w&&!A}),g=u&&h&&Q2(()=>ie.isReadableStream(new s("").body)),x={stream:g&&(w=>w.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(w=>{!x[w]&&(x[w]=(A,C)=>{let L=A&&A[w];if(L)return L.call(A);throw new ze(`Response type '${w}' is not supported`,ze.ERR_NOT_SUPPORT,C)})});const b=async w=>{if(w==null)return 0;if(ie.isBlob(w))return w.size;if(ie.isSpecCompliantForm(w))return(await new t(os.origin,{method:"POST",body:w}).arrayBuffer()).byteLength;if(ie.isArrayBufferView(w)||ie.isArrayBuffer(w))return w.byteLength;if(ie.isURLSearchParams(w)&&(w=w+""),ie.isString(w))return(await f(w)).byteLength},S=async(w,A)=>{const C=ie.toFiniteNumber(w.getContentLength());return C??b(A)};return async w=>{let{url:A,method:C,data:L,signal:z,cancelToken:U,timeout:F,onDownloadProgress:K,onUploadProgress:Z,responseType:j,headers:N,withCredentials:R="same-origin",fetchOptions:O}=$R(w),V=e||fetch;j=j?(j+"").toLowerCase():"text";let B=JU([z,U&&U.toAbortSignal()],F),k=null;const fe=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let me;try{if(Z&&p&&C!=="get"&&C!=="head"&&(me=await S(N,L))!==0){let M=new t(A,{method:"POST",body:L,duplex:"half"}),W;if(ie.isFormData(L)&&(W=M.headers.get("content-type"))&&N.setContentType(W),M.body){const[H,ce]=F2(me,Km(z2(Z)));L=H2(M.body,G2,H,ce)}}ie.isString(R)||(R=R?"include":"omit");const G=o&&"credentials"in t.prototype,ne={...O,signal:B,method:C.toUpperCase(),headers:N.normalize().toJSON(),body:L,duplex:"half",credentials:G?R:void 0};k=o&&new t(A,ne);let Y=await(o?V(k,O):V(A,ne));const ge=g&&(j==="stream"||j==="response");if(g&&(K||ge&&fe)){const M={};["status","statusText","headers"].forEach(de=>{M[de]=Y[de]});const W=ie.toFiniteNumber(Y.headers.get("content-length")),[H,ce]=K&&F2(W,Km(z2(K),!0))||[];Y=new s(H2(Y.body,G2,H,()=>{ce&&ce(),fe&&fe()}),M)}j=j||"text";let le=await x[ie.findKey(x,j)||"text"](Y,w);return!ge&&fe&&fe(),await new Promise((M,W)=>{HR(M,W,{data:le,headers:Ms.from(Y.headers),status:Y.status,statusText:Y.statusText,config:w,request:k})})}catch(G){throw fe&&fe(),G&&G.name==="TypeError"&&/Load failed|fetch/i.test(G.message)?Object.assign(new ze("Network Error",ze.ERR_NETWORK,w,k),{cause:G.cause||G}):ze.from(G,G&&G.code,w,k)}}},r7=new Map,KR=n=>{let e=n&&n.env||{};const{fetch:t,Request:s,Response:i}=e,o=[s,i,t];let u=o.length,h=u,f,p,g=r7;for(;h--;)f=o[h],p=g.get(f),p===void 0&&g.set(f,p=h?new Map:s7(e)),g=p;return p};KR();const f_={http:_U,xhr:XU,fetch:{get:KR}};ie.forEach(f_,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Y2=n=>`- ${n}`,i7=n=>ie.isFunction(n)||n===null||n===!1;function a7(n,e){n=ie.isArray(n)?n:[n];const{length:t}=n;let s,i;const o={};for(let u=0;u<t;u++){s=n[u];let h;if(i=s,!i7(s)&&(i=f_[(h=String(s)).toLowerCase()],i===void 0))throw new ze(`Unknown adapter '${h}'`);if(i&&(ie.isFunction(i)||(i=i.get(e))))break;o[h||"#"+u]=i}if(!i){const u=Object.entries(o).map(([f,p])=>`adapter ${f} `+(p===!1?"is not supported by the environment":"is not available in the build"));let h=t?u.length>1?`since :
`+u.map(Y2).join(`
`):" "+Y2(u[0]):"as no adapter specified";throw new ze("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return i}const QR={getAdapter:a7,adapters:f_};function y0(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Lu(null,n)}function W2(n){return y0(n),n.headers=Ms.from(n.headers),n.data=g0.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),QR.getAdapter(n.adapter||sf.adapter,n)(n).then(function(s){return y0(n),s.data=g0.call(n,n.transformResponse,s),s.headers=Ms.from(s.headers),s},function(s){return qR(s)||(y0(n),s&&s.response&&(s.response.data=g0.call(n,n.transformResponse,s.response),s.response.headers=Ms.from(s.response.headers))),Promise.reject(s)})}const YR="1.13.2",Vg={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Vg[n]=function(s){return typeof s===n||"a"+(e<1?"n ":" ")+n}});const X2={};Vg.transitional=function(e,t,s){function i(o,u){return"[Axios v"+YR+"] Transitional option '"+o+"'"+u+(s?". "+s:"")}return(o,u,h)=>{if(e===!1)throw new ze(i(u," has been removed"+(t?" in "+t:"")),ze.ERR_DEPRECATED);return t&&!X2[u]&&(X2[u]=!0,console.warn(i(u," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,u,h):!0}};Vg.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function o7(n,e,t){if(typeof n!="object")throw new ze("options must be an object",ze.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let i=s.length;for(;i-- >0;){const o=s[i],u=e[o];if(u){const h=n[o],f=h===void 0||u(h,o,n);if(f!==!0)throw new ze("option "+o+" must be "+f,ze.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ze("Unknown option "+o,ze.ERR_BAD_OPTION)}}const um={assertOptions:o7,validators:Vg},li=um.validators;let Sl=class{constructor(e){this.defaults=e||{},this.interceptors={request:new U2,response:new U2}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ul(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:o}=t;s!==void 0&&um.assertOptions(s,{silentJSONParsing:li.transitional(li.boolean),forcedJSONParsing:li.transitional(li.boolean),clarifyTimeoutError:li.transitional(li.boolean)},!1),i!=null&&(ie.isFunction(i)?t.paramsSerializer={serialize:i}:um.assertOptions(i,{encode:li.function,serialize:li.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),um.assertOptions(t,{baseUrl:li.spelling("baseURL"),withXsrfToken:li.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let u=o&&ie.merge(o.common,o[t.method]);o&&ie.forEach(["delete","get","head","post","put","patch","common"],w=>{delete o[w]}),t.headers=Ms.concat(u,o);const h=[];let f=!0;this.interceptors.request.forEach(function(A){typeof A.runWhen=="function"&&A.runWhen(t)===!1||(f=f&&A.synchronous,h.unshift(A.fulfilled,A.rejected))});const p=[];this.interceptors.response.forEach(function(A){p.push(A.fulfilled,A.rejected)});let g,x=0,b;if(!f){const w=[W2.bind(this),void 0];for(w.unshift(...h),w.push(...p),b=w.length,g=Promise.resolve(t);x<b;)g=g.then(w[x++],w[x++]);return g}b=h.length;let S=t;for(;x<b;){const w=h[x++],A=h[x++];try{S=w(S)}catch(C){A.call(this,C);break}}try{g=W2.call(this,S)}catch(w){return Promise.reject(w)}for(x=0,b=p.length;x<b;)g=g.then(p[x++],p[x++]);return g}getUri(e){e=Ul(this.defaults,e);const t=GR(e.baseURL,e.url,e.allowAbsoluteUrls);return BR(t,e.params,e.paramsSerializer)}};ie.forEach(["delete","get","head","options"],function(e){Sl.prototype[e]=function(t,s){return this.request(Ul(s||{},{method:e,url:t,data:(s||{}).data}))}});ie.forEach(["post","put","patch"],function(e){function t(s){return function(o,u,h){return this.request(Ul(h||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:u}))}}Sl.prototype[e]=t(),Sl.prototype[e+"Form"]=t(!0)});let l7=class WR{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const s=this;this.promise.then(i=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](i);s._listeners=null}),this.promise.then=i=>{let o;const u=new Promise(h=>{s.subscribe(h),o=h}).then(i);return u.cancel=function(){s.unsubscribe(o)},u},e(function(o,u,h){s.reason||(s.reason=new Lu(o,u,h),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new WR(function(i){e=i}),cancel:e}}};function c7(n){return function(t){return n.apply(null,t)}}function u7(n){return ie.isObject(n)&&n.isAxiosError===!0}const Ex={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ex).forEach(([n,e])=>{Ex[e]=n});function XR(n){const e=new Sl(n),t=NR(Sl.prototype.request,e);return ie.extend(t,Sl.prototype,e,{allOwnKeys:!0}),ie.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return XR(Ul(n,i))},t}const ln=XR(sf);ln.Axios=Sl;ln.CanceledError=Lu;ln.CancelToken=l7;ln.isCancel=qR;ln.VERSION=YR;ln.toFormData=Lg;ln.AxiosError=ze;ln.Cancel=ln.CanceledError;ln.all=function(e){return Promise.all(e)};ln.spread=c7;ln.isAxiosError=u7;ln.mergeConfig=Ul;ln.AxiosHeaders=Ms;ln.formToJSON=n=>zR(ie.isHTMLForm(n)?new FormData(n):n);ln.getAdapter=QR.getAdapter;ln.HttpStatusCode=Ex;ln.default=ln;const{Axios:Iz,AxiosError:Rz,CanceledError:jz,isCancel:Dz,CancelToken:Oz,VERSION:Pz,all:kz,Cancel:Mz,isAxiosError:Lz,spread:Vz,toFormData:Uz,AxiosHeaders:Bz,HttpStatusCode:Fz,formToJSON:zz,getAdapter:qz,mergeConfig:Hz}=ln,J2="dlfjnz8xq",Z2="little-lions";class d7{async uploadImage(e,t="little-lions/general"){const s=new FormData;s.append("file",e),s.append("upload_preset",Z2),s.append("folder",t);try{return(await ln.post(`https://api.cloudinary.com/v1_1/${J2}/image/upload`,s)).data.secure_url}catch(i){throw console.error("Cloudinary Image Upload Error:",i),i}}async uploadFile(e,t="little-lions/documents"){const s=new FormData;s.append("file",e),s.append("upload_preset",Z2),s.append("folder",t);try{return(await ln.post(`https://api.cloudinary.com/v1_1/${J2}/auto/upload`,s)).data.secure_url}catch(i){throw console.error("Cloudinary File Upload Error:",i),i}}}const co=new d7,$i="users",v0="metadata";class h7{async getAllStaff(){try{const e=an(bt(Ee,$i),mn("role","in",["teacher","therapist"])),t=await Wt(e);return t.docs.length,t.docs.map(i=>({id:i.id,uid:i.id,...i.data()})).sort((i,o)=>(i.lastName||"").localeCompare(o.lastName||""))}catch(e){throw console.error("Error fetching staff:",e),e}}async getUsersByRole(e){try{const t=an(bt(Ee,$i),mn("role","==",e)),s=await Wt(t);return s.docs.length,s.docs.map(o=>({id:o.id,uid:o.id,...o.data()})).sort((o,u)=>(o.lastName||"").localeCompare(u.lastName||""))}catch(t){throw console.error(`Error fetching ${e}s:`,t),t}}async getUserById(e){if(!e)return null;try{const t=at(Ee,$i,e),s=await ra(t);return s.exists()?{id:s.id,uid:s.id,...s.data()}:null}catch(t){throw console.error("Error fetching user:",t),t}}async updateUser(e,t){try{const s=at(Ee,$i,e);return await is(s,{...t,updatedAt:as()}),!0}catch(s){throw console.error("Error updating user:",s),s}}async addChildToParent(e,t){try{const s=at(Ee,$i,e);return await is(s,{childrenIds:Hm(t),updatedAt:as()}),!0}catch(s){throw console.error("Error adding child to parent:",s),s}}async getStaffSummary(){try{const e=at(Ee,v0,"staffSummary"),t=await ra(e);if(!t.exists())return console.log("Staff summary not found, generating..."),this.generateAndSaveStaffSummary();const s=t.data();return{teachers:s.teachers||[],therapists:s.therapists||[],allStaff:[...s.teachers||[],...s.therapists||[]],lastUpdated:s.lastUpdated?.toDate()}}catch(e){return console.error("Error fetching staff summary:",e),this.generateStaffSummaryFromQuery()}}async generateAndSaveStaffSummary(){const e=await this.generateStaffSummaryFromQuery();try{const t=at(Ee,v0,"staffSummary");await ml(t,{teachers:e.teachers,therapists:e.therapists,lastUpdated:as()})}catch(t){console.error("Error saving staff summary:",t)}return e}async generateStaffSummaryFromQuery(){const e=await this.getAllStaff(),t=e.filter(i=>i.role==="teacher").map(i=>({id:i.id,uid:i.uid,name:`${i.firstName||""} ${i.lastName||""}`.trim(),firstName:i.firstName,lastName:i.lastName,specializations:i.specializations||[],photo:i.profilePhoto||i.photoUrl||null,email:i.email})),s=e.filter(i=>i.role==="therapist").map(i=>({id:i.id,uid:i.uid,name:`${i.firstName||""} ${i.lastName||""}`.trim(),firstName:i.firstName,lastName:i.lastName,specializations:i.specializations||[],photo:i.profilePhoto||i.photoUrl||null,email:i.email,licenseType:i.licenseType}));return{teachers:t,therapists:s,allStaff:[...t,...s],lastUpdated:new Date}}async getStaffBySpecialization(e){try{return(await this.getStaffSummary()).allStaff.filter(s=>s.specializations?.includes(e))}catch(t){throw console.error("Error fetching staff by specialization:",t),t}}async batchUpdateUsers(e){if(!(!e||e.length===0))try{const t=bR(Ee);e.forEach(({id:s,data:i})=>{const o=at(Ee,$i,s);t.update(o,{...i,updatedAt:as()})}),await t.commit(),console.log(`Batch updated ${e.length} users`)}catch(t){throw console.error("Error in batch update:",t),t}}}const Ls=new h7;class f7{async createTherapySession(e){try{return(await Su(bt(Ee,"activities"),{...e,type:"therapy_session",createdAt:new Date().toISOString()})).id}catch(t){throw new Error("Failed to save therapy session: "+t.message)}}async createGroupActivity(e){try{return(await Su(bt(Ee,"activities"),{...e,type:"group_activity",createdAt:new Date().toISOString()})).id}catch(t){throw new Error("Failed to save group activity: "+t.message)}}async getActivitiesByChild(e){try{const t=bt(Ee,"activities"),s=an(t,mn("studentId","==",e)),i=an(t,mn("participatingStudentIds","array-contains",e)),o=bt(Ee,"therapy_sessions"),u=an(o,mn("childId","==",e)),[h,f,p]=await Promise.all([Wt(s),Wt(i),Wt(u)]),g=[],x=new Set,b=(S,w)=>{if(!x.has(S.id)){x.add(S.id);const A=S.data();g.push({id:S.id,...A,type:w==="therapy_sessions"?"therapy_session":A.type,_collection:w})}};return h.forEach(S=>b(S,"activities")),f.forEach(S=>b(S,"activities")),p.forEach(S=>b(S,"therapy_sessions")),g.sort((S,w)=>new Date(w.date)-new Date(S.date))}catch(t){throw console.error("Error fetching activities:",t),new Error("Failed to fetch activities: "+t.message)}}async getAllPlayGroupActivities(){try{const e=an(bt(Ee,"activities"),mn("type","==","group_activity"));return(await Wt(e)).docs.map(i=>({id:i.id,...i.data()})).sort((i,o)=>new Date(o.date)-new Date(i.date))}catch(e){throw new Error("Failed to fetch group activities: "+e.message)}}}const JR=async n=>{try{const e={...n,type:"therapy_session",sessionType:n.type,title:n.title||`${n.serviceName} Session`,createdAt:as(),updatedAt:as()};return(await Su(bt(Ee,"therapy_sessions"),e)).id}catch(e){throw console.error("Error adding session document: ",e),e}},Ug=new f7;function ZR(n={}){const{currentUser:e}=In(),{role:t,enabled:s=!0}=n;return ls({queryKey:t?V0.users(t):V0.staff(),queryFn:async()=>t?Ls.getUsersByRole(t):Ls.getAllStaff(),enabled:s&&!!e,...QA.semiStatic})}function ej(n={}){const{type:e,enabled:t=!0}=n;return ls({queryKey:V0.services(e),queryFn:async()=>e?bi.getServicesByType(e):bi.getAllServices(),enabled:t,...QA.static})}const p_=()=>{Fl();const[n,e]=I.useState(null),{data:t=[],isLoading:s}=ZR({role:"therapist"}),{data:i=[],isLoading:o}=ej({type:"Therapy"}),u=s||o,[h,f]=I.useState({firstName:"",lastName:"",middleName:"",email:"",phone:"",specializations:[]});return{therapists:t,services:i,loading:u,error:n,newTherapist:h,handleInputChange:S=>{const{name:w,value:A}=S.target;f(C=>({...C,[w]:A}))},toggleSpecialization:S=>{f(w=>{const A=w.specializations.includes(S)?w.specializations.filter(C=>C!==S):[...w.specializations,S];return{...w,specializations:A}})},createTherapist:async S=>{S&&S.preventDefault(),e(null);try{const w=await Wi.createTherapistAccount(h.email,h);return f({firstName:"",lastName:"",middleName:"",email:"",phone:"",specializations:[]}),await pm("therapist"),{success:!0,user:w}}catch(w){return e(w.message),{success:!1,error:w.message}}},updateTherapist:async(S,w)=>{try{return await Ls.updateUser(S,w),await pm("therapist",S),{success:!0}}catch(A){return e(A.message),{success:!1,error:A.message}}}}},p7=({description:n,maxLength:e=38})=>{const[t,s]=I.useState(!1);return!n||n.length<=e?l.jsx("p",{children:n||"No description provided."}):l.jsxs("p",{children:[t?n:`${n.slice(0,e)}... `,l.jsx("span",{className:"ooo-see-more",onClick:i=>{i.stopPropagation(),s(!t)},children:t?"See less":"See more"})]})},m7=()=>{const n=Nn(),e=kn(),t=Fl(),{therapists:s}=p_(),[i,o]=I.useState("services"),[u,h]=I.useState(null),[f,p]=I.useState(!1),[g,x]=I.useState({name:"",description:"",type:"Therapy"}),[b,S]=I.useState(null),[w,A]=I.useState(!1),[C,L]=I.useState(!1),[z,U]=I.useState({id:null,name:"",description:"",type:"Therapy",imageUrl:""}),[F,K]=I.useState(null),[Z,j]=I.useState(!1),{data:N=[],isLoading:R}=ls({queryKey:["students"],queryFn:()=>Vr.getAllChildren(),staleTime:1e3*60*5}),{data:O=[],isLoading:V}=ls({queryKey:["services"],queryFn:()=>bi.getAllServices(),staleTime:1e3*60*5}),B=O.filter(M=>M.type!=="Class"),k=R||V;I.useEffect(()=>{e.state?.returnToService&&(h(e.state.returnToService),o("students"))},[e.state]);const fe=u?N.filter(M=>[...M.oneOnOneServices||[],...M.groupClassServices||[]].some(H=>H.serviceName?.trim().toLowerCase()===u.name?.trim().toLowerCase())):[],me=M=>h(M)||o("students"),G=M=>{n("/admin/studentprofile",{state:{student:M,therapists:s,selectedService:u,selectedServiceFromOneOnOne:u,fromOneOnOne:!0,scrollToCalendar:!0}})},ne=()=>{i==="students"&&(h(null),o("services"))},Y=M=>{const{name:W,value:H}=M.target;x(ce=>({...ce,[W]:H}))},ge=async M=>{M.preventDefault(),A(!0);try{let W="";b&&(W=await co.uploadImage(b,"one-on-one/services")),await Su(bt(Ee,"services"),{...g,imageUrl:W,active:!0,createdAt:new Date}),t.invalidateQueries({queryKey:["services"]}),p(!1),x({name:"",description:"",type:"Therapy"}),S(null),alert("Service added successfully!")}catch(W){console.error(W),alert("Failed to add service.")}finally{A(!1)}},le=async M=>{M.preventDefault(),j(!0);try{let W=z.imageUrl;F&&(W=await co.uploadImage(F,"one-on-one/services")),await bi.updateService(z.id,{...z,imageUrl:W}),t.invalidateQueries({queryKey:["services"]}),L(!1)}catch(W){console.error(W),alert("Failed to update service.")}finally{j(!1)}};return k?l.jsx("div",{className:"loading-container",children:"Loading..."}):l.jsxs("div",{className:"ooo-container",children:[l.jsx(To,{forceActive:"/admin/one-on-one"}),l.jsx("div",{className:"ooo-main",children:l.jsxs("div",{className:"ooo-page",children:[l.jsxs("div",{className:"ooo-content",children:[i==="services"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"ooo-header",children:l.jsxs("div",{className:"ooo-title",children:[l.jsx("h1",{children:"ONE-ON-ONE SERVICES"}),l.jsx("p",{className:"ooo-subtitle",children:"Manage parent accounts and student registration"})]})}),l.jsxs("div",{className:"ooo-grid",children:[l.jsx("button",{className:"floating-add-btn",onClick:()=>p(!0),children:"+ ONE-ON-ONE SERVICE"}),B.map(M=>l.jsxs("div",{className:"ooo-card",onClick:()=>me(M),children:[M.imageUrl?l.jsx("div",{className:"ooo-card-image-box",children:l.jsx("img",{src:M.imageUrl,alt:M.name})}):l.jsx("div",{className:"ooo-card-icon",children:""}),l.jsxs("div",{className:"ooo-card-info",children:[l.jsx("h3",{children:M.name}),l.jsx(p7,{description:M.description})]}),l.jsx("button",{className:"ooo-edit-btn",onClick:W=>{W.stopPropagation(),U({id:M.id,name:M.name,description:M.description||"",type:M.type,imageUrl:M.imageUrl||""}),K(null),L(!0)},children:""})]},M.id))]})]}),i==="students"&&u&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"ooo-header",children:[l.jsx("span",{className:"back-arrow",onClick:ne,children:""}),l.jsx("h1",{className:"service-name",children:u.name})]}),l.jsx("div",{className:"ooo-grid",children:fe.length===0?l.jsx("p",{style:{color:"#888",fontStyle:"italic"},children:"No students enrolled for this service yet."}):fe.map(M=>{const H=[...M.oneOnOneServices||[],...M.groupClassServices||[]].find(ce=>ce.serviceName?.trim().toLowerCase()===u.name?.trim().toLowerCase());return l.jsxs("div",{className:"ooo-card",onClick:()=>G(M),children:[l.jsx("div",{className:"ooo-photo-area",children:M.photoUrl?l.jsx("img",{src:M.photoUrl,alt:""}):l.jsx("span",{children:""})}),l.jsxs("div",{className:"ooo-card-info",children:[l.jsxs("p",{className:"ooo-name",children:[M.lastName,", ",M.firstName]}),l.jsxs("p",{className:"ooo-sub",children:["Therapist: ",H?.staffName||"Not assigned"]})]})]},M.id)})})]}),f&&l.jsx("div",{className:"modal-overlay",onClick:()=>!w&&p(!1),children:l.jsxs("div",{className:"modal-box",onClick:M=>M.stopPropagation(),children:[l.jsx("h2",{children:"Add New Service"}),l.jsxs("form",{onSubmit:ge,className:"modal-form",children:[l.jsx("input",{name:"name",placeholder:"Service Name",value:g.name,onChange:Y,required:!0}),l.jsx("textarea",{name:"description",placeholder:"Description",value:g.description,onChange:Y}),l.jsxs("div",{style:{margin:"10px 0"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Service Type:"}),l.jsxs("select",{name:"type",value:g.type,onChange:Y,style:{width:"100%",padding:"8px"},children:[l.jsx("option",{value:"Therapy",children:"Therapy"}),l.jsx("option",{value:"Assessment",children:"Assessment"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsx("label",{children:"Service Image (Optional)"}),l.jsx("input",{type:"file",accept:"image/*",onChange:M=>S(M.target.files[0])}),b&&l.jsxs("span",{children:["Selected: ",b.name]})]}),l.jsxs("div",{className:"modal-actions",children:[l.jsx("button",{type:"button",onClick:()=>p(!1),disabled:w,children:"Cancel"}),l.jsx("button",{type:"submit",disabled:w,children:w?"Uploading...":"Add Service"})]})]})]})}),C&&l.jsx("div",{className:"modal-overlay",onClick:()=>!Z&&L(!1),children:l.jsxs("div",{className:"modal-box",onClick:M=>M.stopPropagation(),children:[l.jsx("h2",{children:"Edit Service"}),l.jsxs("form",{onSubmit:le,className:"modal-form",children:[l.jsx("input",{name:"name",value:z.name,onChange:M=>U({...z,name:M.target.value}),required:!0,autoFocus:!0,disabled:Z}),l.jsx("textarea",{name:"description",value:z.description,onChange:M=>U({...z,description:M.target.value}),disabled:Z}),l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsx("label",{children:"Service Type:"}),l.jsxs("select",{value:z.type,onChange:M=>U({...z,type:M.target.value}),disabled:Z,style:{width:"100%",padding:"8px"},children:[l.jsx("option",{value:"Therapy",children:"Therapy"}),l.jsx("option",{value:"Assessment",children:"Assessment"}),l.jsx("option",{value:"Other",children:"Other"})]})]}),l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsx("label",{children:"Service Image (Optional)"}),l.jsx("input",{type:"file",accept:"image/*",onChange:M=>K(M.target.files[0]),disabled:Z}),F?l.jsxs("span",{children:["Selected: ",F.name]}):z.imageUrl?l.jsxs("span",{children:["Current: ",z.imageUrl.split("/").pop()]}):null]}),l.jsxs("div",{className:"modal-actions",children:[l.jsx("button",{type:"button",onClick:()=>L(!1),disabled:Z,children:"Cancel"}),l.jsx("button",{type:"submit",disabled:Z,children:Z?"Saving...":"Save Changes"})]})]})]})})]}),l.jsx(Og,{pageLabel:"OneOnOne"})]})})]})};function tj(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=tj(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function Bg(){for(var n,e,t=0,s="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=tj(n))&&(s&&(s+=" "),s+=e);return s}const g7=(n,e,t,s)=>{if(t==="length"||t==="prototype"||t==="arguments"||t==="caller")return;const i=Object.getOwnPropertyDescriptor(n,t),o=Object.getOwnPropertyDescriptor(e,t);!y7(i,o)&&s||Object.defineProperty(n,t,o)},y7=function(n,e){return n===void 0||n.configurable||n.writable===e.writable&&n.enumerable===e.enumerable&&n.configurable===e.configurable&&(n.writable||n.value===e.value)},v7=(n,e)=>{const t=Object.getPrototypeOf(e);t!==Object.getPrototypeOf(n)&&Object.setPrototypeOf(n,t)},x7=(n,e)=>`/* Wrapped ${n}*/
${e}`,b7=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),_7=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),S7=(n,e,t)=>{const s=t===""?"":`with ${t.trim()}() `,i=x7.bind(null,s,e.toString());Object.defineProperty(i,"name",_7);const{writable:o,enumerable:u,configurable:h}=b7;Object.defineProperty(n,"toString",{value:i,writable:o,enumerable:u,configurable:h})};function w7(n,e,{ignoreNonConfigurable:t=!1}={}){const{name:s}=n;for(const i of Reflect.ownKeys(e))g7(n,e,i,t);return v7(n,e),S7(n,e,s),n}const Fp=2147483647,E7=new WeakMap,x0=new WeakMap,T7=new WeakMap;function A7(n,e){const t=n.get(e);if(t){if(t.maxAge<=Date.now()){n.delete(e);return}return t}}function nj(n,{cacheKey:e,cache:t=new Map,maxAge:s}={}){if(s===0)return n;if(typeof s=="number"&&Number.isFinite(s)){if(s>Fp)throw new TypeError(`The \`maxAge\` option cannot exceed ${Fp}.`);if(s<0)throw new TypeError("The `maxAge` option should not be a negative number.")}const i=function(...o){const u=e?e(o):o[0],h=A7(t,u);if(h)return h.data;const f=n.apply(this,o),p=typeof s=="function"?s(...o):s;if(p!==void 0&&p!==Number.POSITIVE_INFINITY){if(!Number.isFinite(p))throw new TypeError("The `maxAge` function must return a finite number, `0`, or `Infinity`.");if(p<=0)return f;if(p>Fp)throw new TypeError(`The \`maxAge\` function result cannot exceed ${Fp}.`)}if(t.set(u,{data:f,maxAge:p===void 0||p===Number.POSITIVE_INFINITY?Number.POSITIVE_INFINITY:Date.now()+p}),p!==void 0&&p!==Number.POSITIVE_INFINITY){const g=setTimeout(()=>{t.delete(u),x0.get(i)?.delete(g)},p);g.unref?.();const x=x0.get(i)??new Set;x.add(g),x0.set(i,x)}return f};return w7(i,n,{ignoreNonConfigurable:!0}),E7.set(i,t),T7.set(i,e??(o=>o[0])),i}function C7(n){return typeof n=="string"}function N7(n,e,t){return t.indexOf(n)===e}function I7(n){return n.toLowerCase()===n}function eA(n){return n.indexOf(",")===-1?n:n.split(",")}function Tx(n){if(!n)return n;if(n==="C"||n==="posix"||n==="POSIX")return"en-US";if(n.indexOf(".")!==-1){var e=n.split(".")[0],t=e===void 0?"":e;return Tx(t)}if(n.indexOf("@")!==-1){var s=n.split("@")[0],t=s===void 0?"":s;return Tx(t)}if(n.indexOf("-")===-1||!I7(n))return n;var i=n.split("-"),o=i[0],u=i[1],h=u===void 0?"":u;return"".concat(o,"-").concat(h.toUpperCase())}function R7(n){var e=n===void 0?{}:n,t=e.useFallbackLocale,s=t===void 0?!0:t,i=e.fallbackLocale,o=i===void 0?"en-US":i,u=[];if(typeof navigator<"u"){for(var h=navigator.languages||[],f=[],p=0,g=h;p<g.length;p++){var x=g[p];f=f.concat(eA(x))}var b=navigator.language,S=b&&eA(b);u=u.concat(f,S)}return s&&u.push(o),u.filter(C7).map(Tx).filter(N7)}var j7=nj(R7,{cacheKey:JSON.stringify});function D7(n){return j7(n)[0]||null}var sj=nj(D7,{cacheKey:JSON.stringify});function ua(n,e,t){return function(i,o=t){const u=n(i)+o;return e(u)}}function rf(n){return function(t){return new Date(n(t).getTime()-1)}}function af(n,e){return function(s){return[n(s),e(s)]}}function $t(n){if(n instanceof Date)return n.getFullYear();if(typeof n=="number")return n;const e=Number.parseInt(n,10);if(typeof n=="string"&&!Number.isNaN(e))return e;throw new Error(`Failed to get year from date: ${n}.`)}function Ao(n){if(n instanceof Date)return n.getMonth();throw new Error(`Failed to get month from date: ${n}.`)}function Fg(n){if(n instanceof Date)return n.getDate();throw new Error(`Failed to get year from date: ${n}.`)}function Vu(n){const e=$t(n),t=e+(-e+1)%100,s=new Date;return s.setFullYear(t,0,1),s.setHours(0,0,0,0),s}const O7=ua($t,Vu,-100),rj=ua($t,Vu,100),m_=rf(rj),P7=ua($t,m_,-100),ij=af(Vu,m_);function Co(n){const e=$t(n),t=e+(-e+1)%10,s=new Date;return s.setFullYear(t,0,1),s.setHours(0,0,0,0),s}const aj=ua($t,Co,-10),g_=ua($t,Co,10),zg=rf(g_),oj=ua($t,zg,-10),lj=af(Co,zg);function Uu(n){const e=$t(n),t=new Date;return t.setFullYear(e,0,1),t.setHours(0,0,0,0),t}const cj=ua($t,Uu,-1),y_=ua($t,Uu,1),qg=rf(y_),uj=ua($t,qg,-1),k7=af(Uu,qg);function v_(n,e){return function(s,i=e){const o=$t(s),u=Ao(s)+i,h=new Date;return h.setFullYear(o,u,1),h.setHours(0,0,0,0),n(h)}}function Gl(n){const e=$t(n),t=Ao(n),s=new Date;return s.setFullYear(e,t,1),s.setHours(0,0,0,0),s}const dj=v_(Gl,-1),x_=v_(Gl,1),of=rf(x_),hj=v_(of,-1),M7=af(Gl,of);function L7(n,e){return function(s,i=e){const o=$t(s),u=Ao(s),h=Fg(s)+i,f=new Date;return f.setFullYear(o,u,h),f.setHours(0,0,0,0),n(f)}}function lf(n){const e=$t(n),t=Ao(n),s=Fg(n),i=new Date;return i.setFullYear(e,t,s),i.setHours(0,0,0,0),i}const V7=L7(lf,1),b_=rf(V7),U7=af(lf,b_);function fj(n){return Fg(of(n))}var Xn={GREGORY:"gregory",HEBREW:"hebrew",ISLAMIC:"islamic",ISO_8601:"iso8601"},B7={gregory:["en-CA","en-US","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-SV","es-VE","pt-BR"],hebrew:["he","he-IL"],islamic:["ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LY","ar-OM","ar-QA","ar-SA","ar-SD","ar-SY","ar-YE","dv","dv-MV","ps","ps-AR"]},__=[0,1,2,3,4,5,6],b0=new Map;function F7(n){return function(t,s){var i=t||sj();b0.has(i)||b0.set(i,new Map);var o=b0.get(i);return o.has(n)||o.set(n,new Intl.DateTimeFormat(i||void 0,n).format),o.get(n)(s)}}function z7(n){var e=new Date(n);return new Date(e.setHours(12))}function $l(n){return function(e,t){return F7(n)(e,z7(t))}}var q7={day:"numeric"},H7={day:"numeric",month:"long",year:"numeric"},G7={month:"long"},$7={month:"long",year:"numeric"},K7={weekday:"short"},Q7={weekday:"long"},Y7={year:"numeric"},W7=$l(q7),X7=$l(H7),J7=$l(G7),pj=$l($7),Z7=$l(K7),eB=$l(Q7),Hg=$l(Y7),tB=__[0],nB=__[5],tA=__[6];function Dh(n,e){e===void 0&&(e=Xn.ISO_8601);var t=n.getDay();switch(e){case Xn.ISO_8601:return(t+6)%7;case Xn.ISLAMIC:return(t+1)%7;case Xn.HEBREW:case Xn.GREGORY:return t;default:throw new Error("Unsupported calendar type.")}}function sB(n){var e=Vu(n);return $t(e)}function rB(n){var e=Co(n);return $t(e)}function Ax(n,e){e===void 0&&(e=Xn.ISO_8601);var t=$t(n),s=Ao(n),i=n.getDate()-Dh(n,e);return new Date(t,s,i)}function iB(n,e){e===void 0&&(e=Xn.ISO_8601);var t=e===Xn.GREGORY?Xn.GREGORY:Xn.ISO_8601,s=Ax(n,e),i=$t(n)+1,o,u;do o=new Date(i,0,t===Xn.ISO_8601?4:1),u=Ax(o,e),i-=1;while(n<u);return Math.round((s.getTime()-u.getTime())/(864e5*7))+1}function wl(n,e){switch(n){case"century":return Vu(e);case"decade":return Co(e);case"year":return Uu(e);case"month":return Gl(e);case"day":return lf(e);default:throw new Error("Invalid rangeType: ".concat(n))}}function aB(n,e){switch(n){case"century":return O7(e);case"decade":return aj(e);case"year":return cj(e);case"month":return dj(e);default:throw new Error("Invalid rangeType: ".concat(n))}}function mj(n,e){switch(n){case"century":return rj(e);case"decade":return g_(e);case"year":return y_(e);case"month":return x_(e);default:throw new Error("Invalid rangeType: ".concat(n))}}function oB(n,e){switch(n){case"decade":return aj(e,-100);case"year":return cj(e,-10);case"month":return dj(e,-12);default:throw new Error("Invalid rangeType: ".concat(n))}}function lB(n,e){switch(n){case"decade":return g_(e,100);case"year":return y_(e,10);case"month":return x_(e,12);default:throw new Error("Invalid rangeType: ".concat(n))}}function gj(n,e){switch(n){case"century":return m_(e);case"decade":return zg(e);case"year":return qg(e);case"month":return of(e);case"day":return b_(e);default:throw new Error("Invalid rangeType: ".concat(n))}}function cB(n,e){switch(n){case"century":return P7(e);case"decade":return oj(e);case"year":return uj(e);case"month":return hj(e);default:throw new Error("Invalid rangeType: ".concat(n))}}function uB(n,e){switch(n){case"decade":return oj(e,-100);case"year":return uj(e,-10);case"month":return hj(e,-12);default:throw new Error("Invalid rangeType: ".concat(n))}}function nA(n,e){switch(n){case"century":return ij(e);case"decade":return lj(e);case"year":return k7(e);case"month":return M7(e);case"day":return U7(e);default:throw new Error("Invalid rangeType: ".concat(n))}}function dB(n,e,t){var s=[e,t].sort(function(i,o){return i.getTime()-o.getTime()});return[wl(n,s[0]),gj(n,s[1])]}function yj(n,e,t){return t.map(function(s){return(e||Hg)(n,s)}).join("  ")}function hB(n,e,t){return yj(n,e,ij(t))}function vj(n,e,t){return yj(n,e,lj(t))}function fB(n){return n.getDay()===new Date().getDay()}function xj(n,e){e===void 0&&(e=Xn.ISO_8601);var t=n.getDay();switch(e){case Xn.ISLAMIC:case Xn.HEBREW:return t===nB||t===tA;case Xn.ISO_8601:case Xn.GREGORY:return t===tA||t===tB;default:throw new Error("Unsupported calendar type.")}}var ci="react-calendar__navigation";function pB(n){var e=n.activeStartDate,t=n.drillUp,s=n.formatMonthYear,i=s===void 0?pj:s,o=n.formatYear,u=o===void 0?Hg:o,h=n.locale,f=n.maxDate,p=n.minDate,g=n.navigationAriaLabel,x=g===void 0?"":g,b=n.navigationAriaLive,S=n.navigationLabel,w=n.next2AriaLabel,A=w===void 0?"":w,C=n.next2Label,L=C===void 0?"":C,z=n.nextAriaLabel,U=z===void 0?"":z,F=n.nextLabel,K=F===void 0?"":F,Z=n.prev2AriaLabel,j=Z===void 0?"":Z,N=n.prev2Label,R=N===void 0?"":N,O=n.prevAriaLabel,V=O===void 0?"":O,B=n.prevLabel,k=B===void 0?"":B,fe=n.setActiveStartDate,me=n.showDoubleView,G=n.view,ne=n.views,Y=ne.indexOf(G)>0,ge=G!=="century",le=aB(G,e),M=ge?oB(G,e):void 0,W=mj(G,e),H=ge?lB(G,e):void 0,ce=(function(){if(le.getFullYear()<0)return!0;var ot=cB(G,e);return p&&p>=ot})(),de=ge&&(function(){if(M.getFullYear()<0)return!0;var ot=uB(G,e);return p&&p>=ot})(),we=f&&f<W,Pe=ge&&f&&f<H;function tt(){fe(le,"prev")}function He(){fe(M,"prev2")}function Rn(){fe(W,"next")}function us(){fe(H,"next2")}function ys(ot){var vs=(function(){switch(G){case"century":return hB(h,u,ot);case"decade":return vj(h,u,ot);case"year":return u(h,ot);case"month":return i(h,ot);default:throw new Error("Invalid view: ".concat(G,"."))}})();return S?S({date:ot,label:vs,locale:h||sj()||void 0,view:G}):vs}function rr(){var ot="".concat(ci,"__label");return l.jsxs("button",{"aria-label":x,"aria-live":b,className:ot,disabled:!Y,onClick:t,style:{flexGrow:1},type:"button",children:[l.jsx("span",{className:"".concat(ot,"__labelText ").concat(ot,"__labelText--from"),children:ys(e)}),me?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"".concat(ot,"__divider"),children:"  "}),l.jsx("span",{className:"".concat(ot,"__labelText ").concat(ot,"__labelText--to"),children:ys(W)})]}):null]})}return l.jsxs("div",{className:ci,children:[R!==null&&ge?l.jsx("button",{"aria-label":j,className:"".concat(ci,"__arrow ").concat(ci,"__prev2-button"),disabled:de,onClick:He,type:"button",children:R}):null,k!==null&&l.jsx("button",{"aria-label":V,className:"".concat(ci,"__arrow ").concat(ci,"__prev-button"),disabled:ce,onClick:tt,type:"button",children:k}),rr(),K!==null&&l.jsx("button",{"aria-label":U,className:"".concat(ci,"__arrow ").concat(ci,"__next-button"),disabled:we,onClick:Rn,type:"button",children:K}),L!==null&&ge?l.jsx("button",{"aria-label":A,className:"".concat(ci,"__arrow ").concat(ci,"__next2-button"),disabled:Pe,onClick:us,type:"button",children:L}):null]})}var Wc=function(){return Wc=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Wc.apply(this,arguments)},mB=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};function sA(n){return"".concat(n,"%")}function S_(n){var e=n.children,t=n.className,s=n.count,i=n.direction,o=n.offset,u=n.style,h=n.wrap,f=mB(n,["children","className","count","direction","offset","style","wrap"]);return l.jsx("div",Wc({className:t,style:Wc({display:"flex",flexDirection:i,flexWrap:h?"wrap":"nowrap"},u)},f,{children:I.Children.map(e,function(p,g){var x=o&&g===0?sA(100*o/s):null;return I.cloneElement(p,Wc(Wc({},p.props),{style:{flexBasis:sA(100/s),flexShrink:0,flexGrow:0,overflow:"hidden",marginLeft:x,marginInlineStart:x,marginInlineEnd:0}}))})}))}function gB(n,e,t){return e&&e>n?e:t&&t<n?t:n}function Oh(n,e){return e[0]<=n&&e[1]>=n}function yB(n,e){return n[0]<=e[0]&&n[1]>=e[1]}function bj(n,e){return Oh(n[0],e)||Oh(n[1],e)}function rA(n,e,t){var s=bj(e,n),i=[];if(s){i.push(t);var o=Oh(n[0],e),u=Oh(n[1],e);o&&i.push("".concat(t,"Start")),u&&i.push("".concat(t,"End")),o&&u&&i.push("".concat(t,"BothEnds"))}return i}function vB(n){return Array.isArray(n)?n[0]!==null&&n[1]!==null:n!==null}function xB(n){if(!n)throw new Error("args is required");var e=n.value,t=n.date,s=n.hover,i="react-calendar__tile",o=[i];if(!t)return o;var u=new Date,h=(function(){if(Array.isArray(t))return t;var S=n.dateType;if(!S)throw new Error("dateType is required when date is not an array of two dates");return nA(S,t)})();if(Oh(u,h)&&o.push("".concat(i,"--now")),!e||!vB(e))return o;var f=(function(){if(Array.isArray(e))return e;var S=n.valueType;if(!S)throw new Error("valueType is required when value is not an array of two dates");return nA(S,e)})();yB(f,h)?o.push("".concat(i,"--active")):bj(f,h)&&o.push("".concat(i,"--hasActive"));var p=rA(f,h,"".concat(i,"--range"));o.push.apply(o,p);var g=Array.isArray(e)?e:[e];if(s&&g.length===1){var x=s>f[0]?[f[0],s]:[s,f[0]],b=rA(x,h,"".concat(i,"--hover"));o.push.apply(o,b)}return o}function Gg(n){for(var e=n.className,t=n.count,s=t===void 0?3:t,i=n.dateTransform,o=n.dateType,u=n.end,h=n.hover,f=n.offset,p=n.renderTile,g=n.start,x=n.step,b=x===void 0?1:x,S=n.value,w=n.valueType,A=[],C=g;C<=u;C+=b){var L=i(C);A.push(p({classes:xB({date:L,dateType:o,hover:h,value:S,valueType:w}),date:L}))}return l.jsx(S_,{className:e,count:s,offset:f,wrap:!0,children:A})}function $g(n){var e=n.activeStartDate,t=n.children,s=n.classes,i=n.date,o=n.formatAbbr,u=n.locale,h=n.maxDate,f=n.maxDateTransform,p=n.minDate,g=n.minDateTransform,x=n.onClick,b=n.onMouseOver,S=n.style,w=n.tileClassName,A=n.tileContent,C=n.tileDisabled,L=n.view,z=I.useMemo(function(){var F={activeStartDate:e,date:i,view:L};return typeof w=="function"?w(F):w},[e,i,w,L]),U=I.useMemo(function(){var F={activeStartDate:e,date:i,view:L};return typeof A=="function"?A(F):A},[e,i,A,L]);return l.jsxs("button",{className:Bg(s,z),disabled:p&&g(p)>i||h&&f(h)<i||C?.({activeStartDate:e,date:i,view:L}),onClick:x?function(F){return x(i,F)}:void 0,onFocus:b?function(){return b(i)}:void 0,onMouseOver:b?function(){return b(i)}:void 0,style:S,type:"button",children:[o?l.jsx("abbr",{"aria-label":o(u,i),children:t}):t,U]})}var Cx=function(){return Cx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Cx.apply(this,arguments)},bB=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t},iA="react-calendar__century-view__decades__decade";function _B(n){var e=n.classes,t=e===void 0?[]:e,s=n.currentCentury,i=n.formatYear,o=i===void 0?Hg:i,u=bB(n,["classes","currentCentury","formatYear"]),h=u.date,f=u.locale,p=[];return t&&p.push.apply(p,t),p.push(iA),Vu(h).getFullYear()!==s&&p.push("".concat(iA,"--neighboringCentury")),l.jsx($g,Cx({},u,{classes:p,maxDateTransform:zg,minDateTransform:Co,view:"century",children:vj(f,o,h)}))}var Nx=function(){return Nx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Nx.apply(this,arguments)},aA=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};function SB(n){var e=n.activeStartDate,t=n.hover,s=n.showNeighboringCentury,i=n.value,o=n.valueType,u=aA(n,["activeStartDate","hover","showNeighboringCentury","value","valueType"]),h=sB(e),f=h+(s?119:99);return l.jsx(Gg,{className:"react-calendar__century-view__decades",dateTransform:Co,dateType:"decade",end:f,hover:t,renderTile:function(p){var g=p.date,x=aA(p,["date"]);return l.jsx(_B,Nx({},u,x,{activeStartDate:e,currentCentury:h,date:g}),g.getTime())},start:h,step:10,value:i,valueType:o})}var Ix=function(){return Ix=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Ix.apply(this,arguments)};function wB(n){function e(){return l.jsx(SB,Ix({},n))}return l.jsx("div",{className:"react-calendar__century-view",children:e()})}var Rx=function(){return Rx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Rx.apply(this,arguments)},EB=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t},oA="react-calendar__decade-view__years__year";function TB(n){var e=n.classes,t=e===void 0?[]:e,s=n.currentDecade,i=n.formatYear,o=i===void 0?Hg:i,u=EB(n,["classes","currentDecade","formatYear"]),h=u.date,f=u.locale,p=[];return t&&p.push.apply(p,t),p.push(oA),Co(h).getFullYear()!==s&&p.push("".concat(oA,"--neighboringDecade")),l.jsx($g,Rx({},u,{classes:p,maxDateTransform:qg,minDateTransform:Uu,view:"decade",children:o(f,h)}))}var jx=function(){return jx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},jx.apply(this,arguments)},lA=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};function AB(n){var e=n.activeStartDate,t=n.hover,s=n.showNeighboringDecade,i=n.value,o=n.valueType,u=lA(n,["activeStartDate","hover","showNeighboringDecade","value","valueType"]),h=rB(e),f=h+(s?11:9);return l.jsx(Gg,{className:"react-calendar__decade-view__years",dateTransform:Uu,dateType:"year",end:f,hover:t,renderTile:function(p){var g=p.date,x=lA(p,["date"]);return l.jsx(TB,jx({},u,x,{activeStartDate:e,currentDecade:h,date:g}),g.getTime())},start:h,value:i,valueType:o})}var Dx=function(){return Dx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Dx.apply(this,arguments)};function CB(n){function e(){return l.jsx(AB,Dx({},n))}return l.jsx("div",{className:"react-calendar__decade-view",children:e()})}var Ox=function(){return Ox=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Ox.apply(this,arguments)},NB=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t},cA=function(n,e,t){if(t||arguments.length===2)for(var s=0,i=e.length,o;s<i;s++)(o||!(s in e))&&(o||(o=Array.prototype.slice.call(e,0,s)),o[s]=e[s]);return n.concat(o||Array.prototype.slice.call(e))},IB="react-calendar__year-view__months__month";function RB(n){var e=n.classes,t=e===void 0?[]:e,s=n.formatMonth,i=s===void 0?J7:s,o=n.formatMonthYear,u=o===void 0?pj:o,h=NB(n,["classes","formatMonth","formatMonthYear"]),f=h.date,p=h.locale;return l.jsx($g,Ox({},h,{classes:cA(cA([],t,!0),[IB],!1),formatAbbr:u,maxDateTransform:of,minDateTransform:Gl,view:"year",children:i(p,f)}))}var Px=function(){return Px=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Px.apply(this,arguments)},uA=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};function jB(n){var e=n.activeStartDate,t=n.hover,s=n.value,i=n.valueType,o=uA(n,["activeStartDate","hover","value","valueType"]),u=0,h=11,f=$t(e);return l.jsx(Gg,{className:"react-calendar__year-view__months",dateTransform:function(p){var g=new Date;return g.setFullYear(f,p,1),Gl(g)},dateType:"month",end:h,hover:t,renderTile:function(p){var g=p.date,x=uA(p,["date"]);return l.jsx(RB,Px({},o,x,{activeStartDate:e,date:g}),g.getTime())},start:u,value:s,valueType:i})}var kx=function(){return kx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},kx.apply(this,arguments)};function DB(n){function e(){return l.jsx(jB,kx({},n))}return l.jsx("div",{className:"react-calendar__year-view",children:e()})}var Mx=function(){return Mx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Mx.apply(this,arguments)},OB=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t},_0="react-calendar__month-view__days__day";function PB(n){var e=n.calendarType,t=n.classes,s=t===void 0?[]:t,i=n.currentMonthIndex,o=n.formatDay,u=o===void 0?W7:o,h=n.formatLongDate,f=h===void 0?X7:h,p=OB(n,["calendarType","classes","currentMonthIndex","formatDay","formatLongDate"]),g=p.date,x=p.locale,b=[];return s&&b.push.apply(b,s),b.push(_0),xj(g,e)&&b.push("".concat(_0,"--weekend")),g.getMonth()!==i&&b.push("".concat(_0,"--neighboringMonth")),l.jsx($g,Mx({},p,{classes:b,formatAbbr:f,maxDateTransform:b_,minDateTransform:lf,view:"month",children:u(x,g)}))}var Lx=function(){return Lx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Lx.apply(this,arguments)},dA=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};function kB(n){var e=n.activeStartDate,t=n.calendarType,s=n.hover,i=n.showFixedNumberOfWeeks,o=n.showNeighboringMonth,u=n.value,h=n.valueType,f=dA(n,["activeStartDate","calendarType","hover","showFixedNumberOfWeeks","showNeighboringMonth","value","valueType"]),p=$t(e),g=Ao(e),x=i||o,b=Dh(e,t),S=x?0:b,w=(x?-b:0)+1,A=(function(){if(i)return w+42-1;var C=fj(e);if(o){var L=new Date;L.setFullYear(p,g,C),L.setHours(0,0,0,0);var z=7-Dh(L,t)-1;return C+z}return C})();return l.jsx(Gg,{className:"react-calendar__month-view__days",count:7,dateTransform:function(C){var L=new Date;return L.setFullYear(p,g,C),lf(L)},dateType:"day",hover:s,end:A,renderTile:function(C){var L=C.date,z=dA(C,["date"]);return l.jsx(PB,Lx({},f,z,{activeStartDate:e,calendarType:t,currentMonthIndex:g,date:L}),L.getTime())},offset:S,start:w,value:u,valueType:h})}var _j="react-calendar__month-view__weekdays",S0="".concat(_j,"__weekday");function MB(n){for(var e=n.calendarType,t=n.formatShortWeekday,s=t===void 0?Z7:t,i=n.formatWeekday,o=i===void 0?eB:i,u=n.locale,h=n.onMouseLeave,f=new Date,p=Gl(f),g=$t(p),x=Ao(p),b=[],S=1;S<=7;S+=1){var w=new Date(g,x,S-Dh(p,e)),A=o(u,w);b.push(l.jsx("div",{className:Bg(S0,fB(w)&&"".concat(S0,"--current"),xj(w,e)&&"".concat(S0,"--weekend")),children:l.jsx("abbr",{"aria-label":A,title:A,children:s(u,w).replace(".","")})},S))}return l.jsx(S_,{className:_j,count:7,onFocus:h,onMouseOver:h,children:b})}var Qm=function(){return Qm=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Qm.apply(this,arguments)},hA=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t},fA="react-calendar__tile";function LB(n){var e=n.onClickWeekNumber,t=n.weekNumber,s=l.jsx("span",{children:t});if(e){var i=n.date,o=n.onClickWeekNumber,u=n.weekNumber,h=hA(n,["date","onClickWeekNumber","weekNumber"]);return l.jsx("button",Qm({},h,{className:fA,onClick:function(f){return o(u,i,f)},type:"button",children:s}))}else{n.date,n.onClickWeekNumber,n.weekNumber;var h=hA(n,["date","onClickWeekNumber","weekNumber"]);return l.jsx("div",Qm({},h,{className:fA,children:s}))}}function VB(n){var e=n.activeStartDate,t=n.calendarType,s=n.onClickWeekNumber,i=n.onMouseLeave,o=n.showFixedNumberOfWeeks,u=(function(){if(o)return 6;var p=fj(e),g=Dh(e,t),x=p-(7-g);return 1+Math.ceil(x/7)})(),h=(function(){for(var p=$t(e),g=Ao(e),x=Fg(e),b=[],S=0;S<u;S+=1)b.push(Ax(new Date(p,g,x+S*7),t));return b})(),f=h.map(function(p){return iB(p,t)});return l.jsx(S_,{className:"react-calendar__month-view__weekNumbers",count:u,direction:"column",onFocus:i,onMouseOver:i,style:{flexBasis:"calc(100% * (1 / 8)",flexShrink:0},children:f.map(function(p,g){var x=h[g];if(!x)throw new Error("date is not defined");return l.jsx(LB,{date:x,onClickWeekNumber:s,weekNumber:p},p)})})}var Vx=function(){return Vx=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Vx.apply(this,arguments)},UB=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};function BB(n){if(n)for(var e=0,t=Object.entries(B7);e<t.length;e++){var s=t[e],i=s[0],o=s[1];if(o.includes(n))return i}return Xn.ISO_8601}function FB(n){var e=n.activeStartDate,t=n.locale,s=n.onMouseLeave,i=n.showFixedNumberOfWeeks,o=n.calendarType,u=o===void 0?BB(t):o,h=n.formatShortWeekday,f=n.formatWeekday,p=n.onClickWeekNumber,g=n.showWeekNumbers,x=UB(n,["calendarType","formatShortWeekday","formatWeekday","onClickWeekNumber","showWeekNumbers"]);function b(){return l.jsx(MB,{calendarType:u,formatShortWeekday:h,formatWeekday:f,locale:t,onMouseLeave:s})}function S(){return g?l.jsx(VB,{activeStartDate:e,calendarType:u,onClickWeekNumber:p,onMouseLeave:s,showFixedNumberOfWeeks:i}):null}function w(){return l.jsx(kB,Vx({calendarType:u},x))}var A="react-calendar__month-view";return l.jsx("div",{className:Bg(A,g?"".concat(A,"--weekNumbers"):""),children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-end"},children:[S(),l.jsxs("div",{style:{flexGrow:1,width:"100%"},children:[b(),w()]})]})})}var Xc=function(){return Xc=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},Xc.apply(this,arguments)},zp="react-calendar",dm=["century","decade","year","month"],zB=["decade","year","month","day"],w_=new Date;w_.setFullYear(1,0,1);w_.setHours(0,0,0,0);var qB=new Date(864e13);function nh(n){return n instanceof Date?n:new Date(n)}function Sj(n,e){return dm.slice(dm.indexOf(n),dm.indexOf(e)+1)}function HB(n,e,t){var s=Sj(e,t);return s.indexOf(n)!==-1}function E_(n,e,t){return n&&HB(n,e,t)?n:t}function wj(n){var e=dm.indexOf(n);return zB[e]}function GB(n,e){var t=Array.isArray(n)?n[e]:n;if(!t)return null;var s=nh(t);if(Number.isNaN(s.getTime()))throw new Error("Invalid date: ".concat(n));return s}function Ej(n,e){var t=n.value,s=n.minDate,i=n.maxDate,o=n.maxDetail,u=GB(t,e);if(!u)return null;var h=wj(o),f=(function(){switch(e){case 0:return wl(h,u);case 1:return gj(h,u);default:throw new Error("Invalid index value: ".concat(e))}})();return gB(f,s,i)}var T_=function(n){return Ej(n,0)},Tj=function(n){return Ej(n,1)},$B=function(n){return[T_,Tj].map(function(e){return e(n)})};function Aj(n){var e=n.maxDate,t=n.maxDetail,s=n.minDate,i=n.minDetail,o=n.value,u=n.view,h=E_(u,i,t),f=T_({value:o,minDate:s,maxDate:e,maxDetail:t})||new Date;return wl(h,f)}function KB(n){var e=n.activeStartDate,t=n.defaultActiveStartDate,s=n.defaultValue,i=n.defaultView,o=n.maxDate,u=n.maxDetail,h=n.minDate,f=n.minDetail,p=n.value,g=n.view,x=E_(g,f,u),b=e||t;return b?wl(x,b):Aj({maxDate:o,maxDetail:u,minDate:h,minDetail:f,value:p||s,view:g||i})}function w0(n){return n&&(!Array.isArray(n)||n.length===1)}function qp(n,e){return n instanceof Date&&e instanceof Date&&n.getTime()===e.getTime()}var Cj=I.forwardRef(function(e,t){var s=e.activeStartDate,i=e.allowPartialRange,o=e.calendarType,u=e.className,h=e.defaultActiveStartDate,f=e.defaultValue,p=e.defaultView,g=e.formatDay,x=e.formatLongDate,b=e.formatMonth,S=e.formatMonthYear,w=e.formatShortWeekday,A=e.formatWeekday,C=e.formatYear,L=e.goToRangeStartOnSelect,z=L===void 0?!0:L,U=e.inputRef,F=e.locale,K=e.maxDate,Z=K===void 0?qB:K,j=e.maxDetail,N=j===void 0?"month":j,R=e.minDate,O=R===void 0?w_:R,V=e.minDetail,B=V===void 0?"century":V,k=e.navigationAriaLabel,fe=e.navigationAriaLive,me=e.navigationLabel,G=e.next2AriaLabel,ne=e.next2Label,Y=e.nextAriaLabel,ge=e.nextLabel,le=e.onActiveStartDateChange,M=e.onChange,W=e.onClickDay,H=e.onClickDecade,ce=e.onClickMonth,de=e.onClickWeekNumber,we=e.onClickYear,Pe=e.onDrillDown,tt=e.onDrillUp,He=e.onViewChange,Rn=e.prev2AriaLabel,us=e.prev2Label,ys=e.prevAriaLabel,rr=e.prevLabel,ot=e.returnValue,vs=ot===void 0?"start":ot,Zt=e.selectRange,ir=e.showDoubleView,zr=e.showFixedNumberOfWeeks,Pt=e.showNavigation,Kt=Pt===void 0?!0:Pt,xs=e.showNeighboringCentury,Se=e.showNeighboringDecade,It=e.showNeighboringMonth,Bt=It===void 0?!0:It,Ln=e.showWeekNumbers,Vs=e.tileClassName,bs=e.tileContent,Us=e.tileDisabled,_s=e.value,Io=e.view,Ro=I.useState(h),Kl=Ro[0],Jn=Ro[1],vn=I.useState(null),Ss=vn[0],Ft=vn[1],jo=I.useState(Array.isArray(f)?f.map(function(Ue){return Ue!==null?nh(Ue):null}):f!=null?nh(f):null),qr=jo[0],Ql=jo[1],Bs=I.useState(p),Ai=Bs[0],Qt=Bs[1],kt=s||Kl||KB({activeStartDate:s,defaultActiveStartDate:h,defaultValue:f,defaultView:p,maxDate:Z,maxDetail:N,minDate:O,minDetail:B,value:_s,view:Io}),Mt=(function(){var Ue=(function(){return Zt&&w0(qr)?qr:_s!==void 0?_s:qr})();return Ue?Array.isArray(Ue)?Ue.map(function(Dt){return Dt!==null?nh(Dt):null}):Ue!==null?nh(Ue):null:null})(),Zn=wj(N),Rt=E_(Io||Ai,B,N),ds=Sj(B,N),ar=Zt?Ss:null,wr=ds.indexOf(Rt)<ds.length-1,Yl=ds.indexOf(Rt)>0,Hr=I.useCallback(function(Ue){var Dt=(function(){switch(vs){case"start":return T_;case"end":return Tj;case"range":return $B;default:throw new Error("Invalid returnValue.")}})();return Dt({maxDate:Z,maxDetail:N,minDate:O,value:Ue})},[Z,N,O,vs]),Ci=I.useCallback(function(Ue,Dt){Jn(Ue);var Lt={action:Dt,activeStartDate:Ue,value:Mt,view:Rt};le&&!qp(kt,Ue)&&le(Lt)},[kt,le,Mt,Rt]),Gr=I.useCallback(function(Ue,Dt){var Lt=(function(){switch(Rt){case"century":return H;case"decade":return we;case"year":return ce;case"month":return W;default:throw new Error("Invalid view: ".concat(Rt,"."))}})();Lt&&Lt(Ue,Dt)},[W,H,ce,we,Rt]),Er=I.useCallback(function(Ue,Dt){if(wr){Gr(Ue,Dt);var Lt=ds[ds.indexOf(Rt)+1];if(!Lt)throw new Error("Attempted to drill down from the lowest view.");Jn(Ue),Qt(Lt);var es={action:"drillDown",activeStartDate:Ue,value:Mt,view:Lt};le&&!qp(kt,Ue)&&le(es),He&&Rt!==Lt&&He(es),Pe&&Pe(es)}},[kt,wr,le,Gr,Pe,He,Mt,Rt,ds]),Fs=I.useCallback(function(){if(Yl){var Ue=ds[ds.indexOf(Rt)-1];if(!Ue)throw new Error("Attempted to drill up from the highest view.");var Dt=wl(Ue,kt);Jn(Dt),Qt(Ue);var Lt={action:"drillUp",activeStartDate:Dt,value:Mt,view:Ue};le&&!qp(kt,Dt)&&le(Lt),He&&Rt!==Ue&&He(Lt),tt&&tt(Lt)}},[kt,Yl,le,tt,He,Mt,Rt,ds]),da=I.useCallback(function(Ue,Dt){var Lt=Mt;Gr(Ue,Dt);var es=Zt&&!w0(Lt),en;if(Zt)if(es)en=wl(Zn,Ue);else{if(!Lt)throw new Error("previousValue is required");if(Array.isArray(Lt))throw new Error("previousValue must not be an array");en=dB(Zn,Lt,Ue)}else en=Hr(Ue);var $r=!Zt||es||z?Aj({maxDate:Z,maxDetail:N,minDate:O,minDetail:B,value:en,view:Rt}):null;Dt.persist(),Jn($r),Ql(en);var lr={action:"onChange",activeStartDate:$r,value:en,view:Rt};if(le&&!qp(kt,$r)&&le(lr),M)if(Zt){var ws=w0(en);if(!ws)M(en||null,Dt);else if(i){if(Array.isArray(en))throw new Error("value must not be an array");M([en||null,null],Dt)}}else M(en||null,Dt)},[kt,i,Hr,z,Z,N,O,B,le,M,Gr,Zt,Mt,Zn,Rt]);function zs(Ue){Ft(Ue)}function hs(){Ft(null)}I.useImperativeHandle(t,function(){return{activeStartDate:kt,drillDown:Er,drillUp:Fs,onChange:da,setActiveStartDate:Ci,value:Mt,view:Rt}},[kt,Er,Fs,da,Ci,Mt,Rt]);function Yt(Ue){var Dt=Ue?mj(Rt,kt):wl(Rt,kt),Lt=wr?Er:da,es={activeStartDate:Dt,hover:ar,locale:F,maxDate:Z,minDate:O,onClick:Lt,onMouseOver:Zt?zs:void 0,tileClassName:Vs,tileContent:bs,tileDisabled:Us,value:Mt,valueType:Zn};switch(Rt){case"century":return l.jsx(wB,Xc({formatYear:C,showNeighboringCentury:xs},es));case"decade":return l.jsx(CB,Xc({formatYear:C,showNeighboringDecade:Se},es));case"year":return l.jsx(DB,Xc({formatMonth:b,formatMonthYear:S},es));case"month":return l.jsx(FB,Xc({calendarType:o,formatDay:g,formatLongDate:x,formatShortWeekday:w,formatWeekday:A,onClickWeekNumber:de,onMouseLeave:Zt?hs:void 0,showFixedNumberOfWeeks:typeof zr<"u"?zr:ir,showNeighboringMonth:Bt,showWeekNumbers:Ln},es));default:throw new Error("Invalid view: ".concat(Rt,"."))}}function xn(){return Kt?l.jsx(pB,{activeStartDate:kt,drillUp:Fs,formatMonthYear:S,formatYear:C,locale:F,maxDate:Z,minDate:O,navigationAriaLabel:k,navigationAriaLive:fe,navigationLabel:me,next2AriaLabel:G,next2Label:ne,nextAriaLabel:Y,nextLabel:ge,prev2AriaLabel:Rn,prev2Label:us,prevAriaLabel:ys,prevLabel:rr,setActiveStartDate:Ci,showDoubleView:ir,view:Rt,views:ds}):null}var or=Array.isArray(Mt)?Mt:[Mt];return l.jsxs("div",{className:Bg(zp,Zt&&or.length===1&&"".concat(zp,"--selectRange"),ir&&"".concat(zp,"--doubleView"),u),ref:U,children:[xn(),l.jsxs("div",{className:"".concat(zp,"__viewContainer"),onBlur:Zt?hs:void 0,onMouseLeave:Zt?hs:void 0,children:[Yt(),ir?Yt(!0):null]})]})});const QB=({description:n,maxLength:e=70})=>{const[t,s]=I.useState(!1);return n.length<=e?l.jsx("p",{children:n}):l.jsxs("p",{children:[t?n:`${n.slice(0,e)}... `,l.jsx("span",{className:"pg-see-more",onClick:i=>{i.stopPropagation(),s(!t)},children:t?"See less":"See more"})]})},YB=()=>{const n=Fl(),[e,t]=I.useState("service-list"),[s,i]=I.useState(null),[o,u]=I.useState(new Date),[h,f]=I.useState(!1),[p,g]=I.useState({name:"",description:""}),[x,b]=I.useState(null),[S,w]=I.useState(!1),[A,C]=I.useState(!1),[L,z]=I.useState({id:null,name:"",description:"",imageUrl:""}),[U,F]=I.useState(null),[K,Z]=I.useState(!1),{data:j=[],isLoading:N}=ls({queryKey:["services","Class"],queryFn:()=>bi.getServicesByType("Class"),staleTime:1e3*60*5}),{data:R=[],isLoading:O}=ls({queryKey:["students"],queryFn:()=>Vr.getAllChildren(),staleTime:1e3*60*5}),{data:V=[],isLoading:B}=ls({queryKey:["activities","playgroup"],queryFn:()=>Ug.getAllPlayGroupActivities(),staleTime:1e3*60*5}),k=N||O||B,fe=H=>{i(H),t("service-dashboard"),u(new Date)},me=()=>s?V.filter(H=>H.className===s.name||H.serviceType===s.name):[],G=()=>me().map(ce=>ce.date),ne=()=>{const H=o.getTimezoneOffset();return new Date(o.getTime()-H*60*1e3).toISOString().split("T")[0]},Y=()=>{const H=ne();return me().filter(ce=>ce.date===H)},ge=()=>{const H=Y(),ce=new Set;return H.forEach(de=>{de.participatingStudentIds&&de.participatingStudentIds.forEach(we=>ce.add(we))}),R.filter(de=>ce.has(de.id))},le=async H=>{if(H.preventDefault(),!!p.name){w(!0);try{let ce="";x&&(ce=await co.uploadImage(x,"little-lions/services")),await bi.createService({name:p.name,description:p.description,type:"Class",imageUrl:ce}),await n.invalidateQueries({queryKey:["services","Class"]}),g({name:"",description:""}),b(null),f(!1)}catch(ce){alert("Failed to create service: "+ce.message)}finally{w(!1)}}},M=()=>{i(null),t("service-list")},W=H=>{u(H)};return k&&j.length===0?l.jsx("div",{className:"pg-loading",children:"Loading Play Group Data..."}):l.jsxs("div",{className:"pg-container",children:[l.jsx(To,{}),l.jsx("div",{className:"pg-main",children:l.jsxs("div",{className:"pg-page",children:[l.jsxs("div",{className:"pg-content",children:[e==="service-list"&&l.jsxs("div",{className:"pg-service-list-view",children:[l.jsx("div",{className:"pg-header",children:l.jsxs("div",{className:"pg-title",children:[l.jsx("h1",{children:"PLAY GROUP SERVICES"}),l.jsx("p",{children:"Select a class to view calendar and students"})]})}),l.jsx("div",{className:"pg-content-area",children:l.jsxs("div",{className:"pg-services-grid",children:[j.map(H=>l.jsxs("div",{className:"pg-service-card",onClick:()=>fe(H),children:[H.imageUrl?l.jsx("div",{className:"pg-card-image-box",children:l.jsx("img",{src:H.imageUrl,alt:H.name,className:"pg-card-image"})}):l.jsx("div",{className:"pg-card-icon",children:""}),l.jsx("h3",{children:H.name}),l.jsx(QB,{description:H.description||"No description provided."}),l.jsx("button",{className:"pg-edit-btn",onClick:ce=>{ce.stopPropagation(),z({id:H.id,name:H.name,description:H.description||"",imageUrl:H.imageUrl||""}),F(null),C(!0)},children:""})]},H.id)),j.length===0&&!k&&l.jsx("p",{className:"pg-empty",children:"No Play Group services found. Add one to get started!"})]})}),l.jsxs("button",{className:"pg-fab",onClick:()=>f(!0),children:[l.jsx("span",{className:"pg-fab-icon",children:"+"}),l.jsx("span",{className:"pg-fab-text",children:"PLAY GROUP SERVICE"})]})]}),e==="service-dashboard"&&s&&l.jsxs("div",{className:"pg-dashboard-view",children:[l.jsx("div",{className:"pg-header",children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[l.jsx("span",{onClick:M,className:"pg-back-btn",children:""}),l.jsxs("div",{className:"pg-service-name-desc",children:[l.jsx("h1",{children:s.name}),l.jsx("p",{children:"Manage attendance and activities"})]})]})}),l.jsxs("div",{className:"pg-split-layout",children:[l.jsxs("div",{className:"pg-left-panel",children:[l.jsxs("div",{className:"pg-panel-header",children:[l.jsx("h2",{children:"Daily Activities"}),l.jsx("span",{className:"pg-date-label",children:o.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),l.jsxs("div",{className:"pg-inner-scroll",children:[l.jsx("div",{className:"pg-activities-container",children:Y().length>0?Y().map((H,ce)=>l.jsxs("div",{className:"pg-activity-block",children:[l.jsxs("div",{className:"pg-activity-text",children:[l.jsxs("h3",{className:"pg-activity-title",children:[" Activity: ",H.title||H.activityName||"Activity"]}),l.jsx("p",{className:"pg-activity-desc",children:H.description||H.notes})]}),H.photoUrls&&H.photoUrls.length>0?l.jsx("div",{className:"pg-photo-grid",children:H.photoUrls.map((de,we)=>l.jsx("div",{className:"pg-photo-card",onClick:()=>window.open(de,"_blank"),children:l.jsx("img",{src:de,alt:"Activity"})},we))}):l.jsx("div",{className:"pg-no-photos-msg",children:"No photos uploaded for this activity."})]},ce)):l.jsxs("div",{className:"pg-no-data",children:[l.jsx("p",{children:"No activities recorded for this date."}),l.jsx("small",{children:"Select a date with a green dot on the calendar."})]})}),Y().length>0&&l.jsxs("div",{className:"pg-attendance-section",children:[l.jsx("div",{className:"pg-attendance-header",children:l.jsxs("h3",{children:["Students Present (",ge().length,")"]})}),l.jsx("div",{className:"pg-attendance-grid",children:ge().map(H=>l.jsxs("div",{className:"pg-simple-student-card",children:[l.jsx("img",{src:H.photoUrl||"https://via.placeholder.com/40",alt:H.firstName}),l.jsxs("span",{children:[H.firstName," ",H.lastName]})]},H.id))})]})]})]}),l.jsxs("div",{className:"pg-right-panel",children:[l.jsx("div",{className:"pg-panel-header",children:l.jsx("h2",{children:"Schedule"})}),l.jsxs("div",{className:"pg-calendar-wrapper",children:[l.jsx(Cj,{onChange:W,value:o,tileClassName:({date:H,view:ce})=>{if(ce==="month"){const de=H.getTimezoneOffset(),Pe=new Date(H.getTime()-de*60*1e3).toISOString().split("T")[0];if(G().includes(Pe))return"has-activity-dot"}}}),l.jsxs("div",{className:"pg-calendar-legend",children:[l.jsx("span",{className:"dot-legend"})," Activities Recorded"]})]})]})]})]}),h&&l.jsx("div",{className:"pg-modal-overlay",onClick:()=>!S&&f(!1),children:l.jsxs("div",{className:"pg-modal-form-card",onClick:H=>H.stopPropagation(),children:[l.jsx("h2",{children:"Create New Class"}),l.jsxs("form",{onSubmit:le,children:[l.jsxs("div",{className:"pg-form-group",children:[l.jsx("label",{children:"Class Name"}),l.jsx("input",{type:"text",placeholder:"e.g. Morning Playgroup",value:p.name,onChange:H=>g({...p,name:H.target.value}),required:!0,autoFocus:!0,disabled:S})]}),l.jsxs("div",{className:"pg-form-group",children:[l.jsx("label",{children:"Description"}),l.jsx("textarea",{placeholder:"Short description of the class...",value:p.description,onChange:H=>g({...p,description:H.target.value}),disabled:S})]}),l.jsxs("div",{className:"pg-form-group",children:[l.jsx("label",{children:"Service Image (Optional)"}),l.jsx("input",{type:"file",accept:"image/*",onChange:H=>b(H.target.files[0]),disabled:S,className:"pg-file-input"}),x&&l.jsxs("span",{className:"pg-file-name",children:["Selected: ",x.name]})]}),l.jsxs("div",{className:"pg-form-actions",children:[l.jsx("button",{type:"button",className:"pg-cancel-btn",onClick:()=>f(!1),disabled:S,children:"Cancel"}),l.jsx("button",{type:"submit",className:"pg-submit-btn",disabled:S,children:S?"Uploading...":"Create Class"})]})]})]})}),A&&l.jsx("div",{className:"pg-modal-overlay",onClick:()=>!K&&C(!1),children:l.jsxs("div",{className:"pg-modal-form-card",onClick:H=>H.stopPropagation(),children:[l.jsx("h2",{children:"Edit Class"}),l.jsxs("form",{onSubmit:async H=>{H.preventDefault(),Z(!0);try{let ce=L.imageUrl;U&&(ce=await co.uploadImage(U,"little-lions/services")),await bi.updateService(L.id,{name:L.name,description:L.description,imageUrl:ce}),await n.invalidateQueries({queryKey:["services","Class"]}),C(!1)}catch(ce){alert("Failed to update service: "+ce.message)}finally{Z(!1)}},children:[l.jsxs("div",{className:"pg-form-group",children:[l.jsx("label",{children:"Class Name"}),l.jsx("input",{type:"text",value:L.name,onChange:H=>z({...L,name:H.target.value}),required:!0,autoFocus:!0,disabled:K})]}),l.jsxs("div",{className:"pg-form-group",children:[l.jsx("label",{children:"Description"}),l.jsx("textarea",{value:L.description,onChange:H=>z({...L,description:H.target.value}),disabled:K})]}),l.jsxs("div",{className:"pg-form-group",children:[l.jsx("label",{children:"Service Image (Optional)"}),l.jsx("input",{type:"file",accept:"image/*",onChange:H=>F(H.target.files[0]),disabled:K,className:"pg-file-input"}),U?l.jsxs("span",{className:"pg-file-name",children:["Selected: ",U.name]}):L.imageUrl?l.jsxs("span",{className:"pg-file-name",children:["Current Image: ",L.imageUrl.split("/").pop()]}):null]}),l.jsxs("div",{className:"pg-form-actions",children:[l.jsx("button",{type:"button",className:"pg-cancel-btn",onClick:()=>C(!1),disabled:K,children:"Cancel"}),l.jsx("button",{type:"submit",className:"pg-submit-btn",disabled:K,children:K?"Saving...":"Save Changes"})]})]})]})})]}),l.jsx(Og,{pageLabel:"PlayGroup"})]})})]})},Nj=()=>{Fl();const[n,e]=I.useState(null),{data:t=[],isLoading:s}=ZR({role:"teacher"}),{data:i=[],isLoading:o}=ej({type:"Class"}),u=s||o,[h,f]=I.useState({firstName:"",lastName:"",email:"",phone:"",specializations:[]});return{teachers:t,services:i,loading:u,error:n,newTeacher:h,handleInputChange:S=>{const{name:w,value:A}=S.target;f(C=>({...C,[w]:A}))},toggleSpecialization:S=>{f(w=>{const A=w.specializations.includes(S)?w.specializations.filter(C=>C!==S):[...w.specializations,S];return{...w,specializations:A}})},createTeacher:async S=>{S&&S.preventDefault(),e(null);try{const w=await Wi.createTeacherAccount(h.email,h);return f({firstName:"",lastName:"",email:"",phone:"",specializations:[]}),await pm("teacher"),{success:!0,user:w}}catch(w){return e(w.message),{success:!1,error:w.message}}},updateTeacher:async(S,w)=>{try{return await Ls.updateUser(S,w),await pm("teacher",S),{success:!0}}catch(A){return e(A.message),{success:!1,error:A.message}}}}},WB=({teacher:n})=>{const[e,t]=I.useState(!1);return n?l.jsx("div",{style:vt.mainContainer,children:l.jsxs("div",{style:vt.wrapper,children:[l.jsx("div",{style:vt.imageCard,children:n.profilePhoto?l.jsx("img",{src:n.profilePhoto,alt:n.firstName,style:vt.largePhoto}):l.jsxs("div",{style:vt.largePhotoPlaceholder,children:[n.firstName?.[0],n.lastName?.[0]]})}),l.jsxs("div",{style:vt.card,children:[l.jsxs("div",{style:vt.serviceBadge,children:["Teacher Profile  ID: ",n.uid]}),l.jsx("div",{style:vt.header,children:l.jsxs("div",{style:vt.info,children:[l.jsxs("h4",{style:vt.name,children:[n.firstName," ",n.lastName]}),l.jsxs("div",{style:vt.credentialRow,children:[l.jsx("span",{style:{...vt.verifiedIcon,color:n.profileCompleted?"#059669":"#d97706"},children:n.profileCompleted?"":""}),l.jsx("span",{style:{...vt.credentialText,color:n.profileCompleted?"#059669":"#d97706"},children:n.profileCompleted?"Profile Active":"Setup Pending"})]}),l.jsxs("div",{style:vt.metaRow,children:[" ",n.email]})]})}),l.jsx("div",{style:vt.divider}),l.jsxs("div",{style:vt.body,children:[l.jsxs("div",{style:vt.section,children:[l.jsx("div",{style:vt.sectionHeader,children:" Account Details"}),l.jsxs("div",{style:vt.eduItem,children:[l.jsx("strong",{children:"System Role"}),l.jsx("span",{style:vt.subText,children:"  Teacher Access"})]}),l.jsxs("div",{style:vt.eduItem,children:[l.jsx("strong",{children:"Email Status"}),l.jsxs("span",{style:vt.subText,children:["  ",n.email?"Linked":"Missing"]})]})]}),l.jsxs("div",{style:vt.bioContainer,children:[l.jsx("div",{style:vt.sectionHeader,children:"Specializations"}),n.specializations&&n.specializations.length>0?l.jsx("div",{style:vt.tagContainer,children:n.specializations.map((s,i)=>l.jsx("span",{style:vt.tag,children:s},i))}):l.jsx("p",{style:vt.bio,children:"No specializations listed yet."})]}),n.profileCompleted&&l.jsx("div",{style:vt.certSection,children:l.jsx("div",{style:vt.certTag,children:l.jsx("div",{children:" Verified Teacher Account"})})})]})]})]})}):null},vt={mainContainer:{width:"100%",maxWidth:"1000px",margin:"0 0 0 20px",animation:"fadeIn 0.3s ease-in-out"},wrapper:{display:"flex",gap:"2.5rem",marginBottom:"1rem",alignItems:"flex-start"},imageCard:{width:"300px",height:"385px",flexShrink:0,backgroundColor:"white",borderRadius:"16px",border:"1px solid #e2e8f0",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},largePhoto:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"12px"},largePhotoPlaceholder:{width:"100%",height:"100%",borderRadius:"12px",backgroundColor:"#cbd5e1",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"3rem",fontWeight:"bold",color:"white"},card:{flex:1,backgroundColor:"white",borderRadius:"16px",border:"1px solid #e2e8f0",overflow:"hidden",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},serviceBadge:{backgroundColor:"#f0f9ff",color:"#0369a1",padding:"0.5rem 1rem",fontSize:"0.75rem",fontWeight:700,textTransform:"uppercase",borderBottom:"1px solid #e0f2fe"},header:{padding:"1rem"},info:{flex:1},name:{margin:"0 0 0.25rem 0",fontSize:"1.1rem",fontWeight:700,color:"#0f172a"},credentialRow:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},verifiedIcon:{fontWeight:"bold"},credentialText:{fontSize:"0.8rem",fontWeight:600},metaRow:{fontSize:"0.8rem",color:"#64748b"},divider:{height:"1px",backgroundColor:"#f1f5f9"},body:{padding:"1rem"},section:{marginBottom:"0.75rem"},sectionHeader:{fontSize:"0.8rem",fontWeight:700,color:"#64748b",marginBottom:"0.5rem",textTransform:"uppercase"},eduItem:{fontSize:"0.9rem",color:"#334155",marginBottom:"4px"},subText:{fontSize:"0.8rem",color:"#94a3b8"},bioContainer:{backgroundColor:"#f8fafc",padding:"0.75rem",borderRadius:"0.5rem",marginTop:"1rem"},bio:{margin:0,fontSize:"0.875rem",color:"#475569",lineHeight:"1.5"},tagContainer:{display:"flex",flexWrap:"wrap",gap:"8px"},tag:{backgroundColor:"white",color:"#334155",padding:"4px 10px",borderRadius:"6px",fontSize:"0.8rem",fontWeight:"500",border:"1px solid #e2e8f0"},certSection:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px dashed #e2e8f0"},certTag:{fontSize:"0.8rem",backgroundColor:"#fffbeb",color:"#b45309",padding:"0.5rem",borderRadius:"0.25rem",border:"1px solid #fcd34d",display:"flex",justifyContent:"space-between",alignItems:"center"}};var XB=Object.defineProperty,Ym=Object.getOwnPropertySymbols,Ij=Object.prototype.hasOwnProperty,Rj=Object.prototype.propertyIsEnumerable,pA=(n,e,t)=>e in n?XB(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ux=(n,e)=>{for(var t in e||(e={}))Ij.call(e,t)&&pA(n,t,e[t]);if(Ym)for(var t of Ym(e))Rj.call(e,t)&&pA(n,t,e[t]);return n},Bx=(n,e)=>{var t={};for(var s in n)Ij.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&Ym)for(var s of Ym(n))e.indexOf(s)<0&&Rj.call(n,s)&&(t[s]=n[s]);return t};var Bl;(n=>{const e=class Ye{constructor(f,p,g,x){if(this.version=f,this.errorCorrectionLevel=p,this.modules=[],this.isFunction=[],f<Ye.MIN_VERSION||f>Ye.MAX_VERSION)throw new RangeError("Version value out of range");if(x<-1||x>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let b=[];for(let w=0;w<this.size;w++)b.push(!1);for(let w=0;w<this.size;w++)this.modules.push(b.slice()),this.isFunction.push(b.slice());this.drawFunctionPatterns();const S=this.addEccAndInterleave(g);if(this.drawCodewords(S),x==-1){let w=1e9;for(let A=0;A<8;A++){this.applyMask(A),this.drawFormatBits(A);const C=this.getPenaltyScore();C<w&&(x=A,w=C),this.applyMask(A)}}i(0<=x&&x<=7),this.mask=x,this.applyMask(x),this.drawFormatBits(x),this.isFunction=[]}static encodeText(f,p){const g=n.QrSegment.makeSegments(f);return Ye.encodeSegments(g,p)}static encodeBinary(f,p){const g=n.QrSegment.makeBytes(f);return Ye.encodeSegments([g],p)}static encodeSegments(f,p,g=1,x=40,b=-1,S=!0){if(!(Ye.MIN_VERSION<=g&&g<=x&&x<=Ye.MAX_VERSION)||b<-1||b>7)throw new RangeError("Invalid value");let w,A;for(w=g;;w++){const U=Ye.getNumDataCodewords(w,p)*8,F=u.getTotalBits(f,w);if(F<=U){A=F;break}if(w>=x)throw new RangeError("Data too long")}for(const U of[Ye.Ecc.MEDIUM,Ye.Ecc.QUARTILE,Ye.Ecc.HIGH])S&&A<=Ye.getNumDataCodewords(w,U)*8&&(p=U);let C=[];for(const U of f){t(U.mode.modeBits,4,C),t(U.numChars,U.mode.numCharCountBits(w),C);for(const F of U.getData())C.push(F)}i(C.length==A);const L=Ye.getNumDataCodewords(w,p)*8;i(C.length<=L),t(0,Math.min(4,L-C.length),C),t(0,(8-C.length%8)%8,C),i(C.length%8==0);for(let U=236;C.length<L;U^=253)t(U,8,C);let z=[];for(;z.length*8<C.length;)z.push(0);return C.forEach((U,F)=>z[F>>>3]|=U<<7-(F&7)),new Ye(w,p,z,b)}getModule(f,p){return 0<=f&&f<this.size&&0<=p&&p<this.size&&this.modules[p][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let g=0;g<this.size;g++)this.setFunctionModule(6,g,g%2==0),this.setFunctionModule(g,6,g%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),p=f.length;for(let g=0;g<p;g++)for(let x=0;x<p;x++)g==0&&x==0||g==0&&x==p-1||g==p-1&&x==0||this.drawAlignmentPattern(f[g],f[x]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const p=this.errorCorrectionLevel.formatBits<<3|f;let g=p;for(let b=0;b<10;b++)g=g<<1^(g>>>9)*1335;const x=(p<<10|g)^21522;i(x>>>15==0);for(let b=0;b<=5;b++)this.setFunctionModule(8,b,s(x,b));this.setFunctionModule(8,7,s(x,6)),this.setFunctionModule(8,8,s(x,7)),this.setFunctionModule(7,8,s(x,8));for(let b=9;b<15;b++)this.setFunctionModule(14-b,8,s(x,b));for(let b=0;b<8;b++)this.setFunctionModule(this.size-1-b,8,s(x,b));for(let b=8;b<15;b++)this.setFunctionModule(8,this.size-15+b,s(x,b));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let g=0;g<12;g++)f=f<<1^(f>>>11)*7973;const p=this.version<<12|f;i(p>>>18==0);for(let g=0;g<18;g++){const x=s(p,g),b=this.size-11+g%3,S=Math.floor(g/3);this.setFunctionModule(b,S,x),this.setFunctionModule(S,b,x)}}drawFinderPattern(f,p){for(let g=-4;g<=4;g++)for(let x=-4;x<=4;x++){const b=Math.max(Math.abs(x),Math.abs(g)),S=f+x,w=p+g;0<=S&&S<this.size&&0<=w&&w<this.size&&this.setFunctionModule(S,w,b!=2&&b!=4)}}drawAlignmentPattern(f,p){for(let g=-2;g<=2;g++)for(let x=-2;x<=2;x++)this.setFunctionModule(f+x,p+g,Math.max(Math.abs(x),Math.abs(g))!=1)}setFunctionModule(f,p,g){this.modules[p][f]=g,this.isFunction[p][f]=!0}addEccAndInterleave(f){const p=this.version,g=this.errorCorrectionLevel;if(f.length!=Ye.getNumDataCodewords(p,g))throw new RangeError("Invalid argument");const x=Ye.NUM_ERROR_CORRECTION_BLOCKS[g.ordinal][p],b=Ye.ECC_CODEWORDS_PER_BLOCK[g.ordinal][p],S=Math.floor(Ye.getNumRawDataModules(p)/8),w=x-S%x,A=Math.floor(S/x);let C=[];const L=Ye.reedSolomonComputeDivisor(b);for(let U=0,F=0;U<x;U++){let K=f.slice(F,F+A-b+(U<w?0:1));F+=K.length;const Z=Ye.reedSolomonComputeRemainder(K,L);U<w&&K.push(0),C.push(K.concat(Z))}let z=[];for(let U=0;U<C[0].length;U++)C.forEach((F,K)=>{(U!=A-b||K>=w)&&z.push(F[U])});return i(z.length==S),z}drawCodewords(f){if(f.length!=Math.floor(Ye.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let p=0;for(let g=this.size-1;g>=1;g-=2){g==6&&(g=5);for(let x=0;x<this.size;x++)for(let b=0;b<2;b++){const S=g-b,A=(g+1&2)==0?this.size-1-x:x;!this.isFunction[A][S]&&p<f.length*8&&(this.modules[A][S]=s(f[p>>>3],7-(p&7)),p++)}}i(p==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let p=0;p<this.size;p++)for(let g=0;g<this.size;g++){let x;switch(f){case 0:x=(g+p)%2==0;break;case 1:x=p%2==0;break;case 2:x=g%3==0;break;case 3:x=(g+p)%3==0;break;case 4:x=(Math.floor(g/3)+Math.floor(p/2))%2==0;break;case 5:x=g*p%2+g*p%3==0;break;case 6:x=(g*p%2+g*p%3)%2==0;break;case 7:x=((g+p)%2+g*p%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[p][g]&&x&&(this.modules[p][g]=!this.modules[p][g])}}getPenaltyScore(){let f=0;for(let b=0;b<this.size;b++){let S=!1,w=0,A=[0,0,0,0,0,0,0];for(let C=0;C<this.size;C++)this.modules[b][C]==S?(w++,w==5?f+=Ye.PENALTY_N1:w>5&&f++):(this.finderPenaltyAddHistory(w,A),S||(f+=this.finderPenaltyCountPatterns(A)*Ye.PENALTY_N3),S=this.modules[b][C],w=1);f+=this.finderPenaltyTerminateAndCount(S,w,A)*Ye.PENALTY_N3}for(let b=0;b<this.size;b++){let S=!1,w=0,A=[0,0,0,0,0,0,0];for(let C=0;C<this.size;C++)this.modules[C][b]==S?(w++,w==5?f+=Ye.PENALTY_N1:w>5&&f++):(this.finderPenaltyAddHistory(w,A),S||(f+=this.finderPenaltyCountPatterns(A)*Ye.PENALTY_N3),S=this.modules[C][b],w=1);f+=this.finderPenaltyTerminateAndCount(S,w,A)*Ye.PENALTY_N3}for(let b=0;b<this.size-1;b++)for(let S=0;S<this.size-1;S++){const w=this.modules[b][S];w==this.modules[b][S+1]&&w==this.modules[b+1][S]&&w==this.modules[b+1][S+1]&&(f+=Ye.PENALTY_N2)}let p=0;for(const b of this.modules)p=b.reduce((S,w)=>S+(w?1:0),p);const g=this.size*this.size,x=Math.ceil(Math.abs(p*20-g*10)/g)-1;return i(0<=x&&x<=9),f+=x*Ye.PENALTY_N4,i(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,p=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let g=[6];for(let x=this.size-7;g.length<f;x-=p)g.splice(1,0,x);return g}}static getNumRawDataModules(f){if(f<Ye.MIN_VERSION||f>Ye.MAX_VERSION)throw new RangeError("Version number out of range");let p=(16*f+128)*f+64;if(f>=2){const g=Math.floor(f/7)+2;p-=(25*g-10)*g-55,f>=7&&(p-=36)}return i(208<=p&&p<=29648),p}static getNumDataCodewords(f,p){return Math.floor(Ye.getNumRawDataModules(f)/8)-Ye.ECC_CODEWORDS_PER_BLOCK[p.ordinal][f]*Ye.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let p=[];for(let x=0;x<f-1;x++)p.push(0);p.push(1);let g=1;for(let x=0;x<f;x++){for(let b=0;b<p.length;b++)p[b]=Ye.reedSolomonMultiply(p[b],g),b+1<p.length&&(p[b]^=p[b+1]);g=Ye.reedSolomonMultiply(g,2)}return p}static reedSolomonComputeRemainder(f,p){let g=p.map(x=>0);for(const x of f){const b=x^g.shift();g.push(0),p.forEach((S,w)=>g[w]^=Ye.reedSolomonMultiply(S,b))}return g}static reedSolomonMultiply(f,p){if(f>>>8||p>>>8)throw new RangeError("Byte out of range");let g=0;for(let x=7;x>=0;x--)g=g<<1^(g>>>7)*285,g^=(p>>>x&1)*f;return i(g>>>8==0),g}finderPenaltyCountPatterns(f){const p=f[1];i(p<=this.size*3);const g=p>0&&f[2]==p&&f[3]==p*3&&f[4]==p&&f[5]==p;return(g&&f[0]>=p*4&&f[6]>=p?1:0)+(g&&f[6]>=p*4&&f[0]>=p?1:0)}finderPenaltyTerminateAndCount(f,p,g){return f&&(this.finderPenaltyAddHistory(p,g),p=0),p+=this.size,this.finderPenaltyAddHistory(p,g),this.finderPenaltyCountPatterns(g)}finderPenaltyAddHistory(f,p){p[0]==0&&(f+=this.size),p.pop(),p.unshift(f)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n.QrCode=e;function t(h,f,p){if(f<0||f>31||h>>>f)throw new RangeError("Value out of range");for(let g=f-1;g>=0;g--)p.push(h>>>g&1)}function s(h,f){return(h>>>f&1)!=0}function i(h){if(!h)throw new Error("Assertion error")}const o=class sn{constructor(f,p,g){if(this.mode=f,this.numChars=p,this.bitData=g,p<0)throw new RangeError("Invalid argument");this.bitData=g.slice()}static makeBytes(f){let p=[];for(const g of f)t(g,8,p);return new sn(sn.Mode.BYTE,f.length,p)}static makeNumeric(f){if(!sn.isNumeric(f))throw new RangeError("String contains non-numeric characters");let p=[];for(let g=0;g<f.length;){const x=Math.min(f.length-g,3);t(parseInt(f.substring(g,g+x),10),x*3+1,p),g+=x}return new sn(sn.Mode.NUMERIC,f.length,p)}static makeAlphanumeric(f){if(!sn.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let p=[],g;for(g=0;g+2<=f.length;g+=2){let x=sn.ALPHANUMERIC_CHARSET.indexOf(f.charAt(g))*45;x+=sn.ALPHANUMERIC_CHARSET.indexOf(f.charAt(g+1)),t(x,11,p)}return g<f.length&&t(sn.ALPHANUMERIC_CHARSET.indexOf(f.charAt(g)),6,p),new sn(sn.Mode.ALPHANUMERIC,f.length,p)}static makeSegments(f){return f==""?[]:sn.isNumeric(f)?[sn.makeNumeric(f)]:sn.isAlphanumeric(f)?[sn.makeAlphanumeric(f)]:[sn.makeBytes(sn.toUtf8ByteArray(f))]}static makeEci(f){let p=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)t(f,8,p);else if(f<16384)t(2,2,p),t(f,14,p);else if(f<1e6)t(6,3,p),t(f,21,p);else throw new RangeError("ECI assignment value out of range");return new sn(sn.Mode.ECI,0,p)}static isNumeric(f){return sn.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return sn.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,p){let g=0;for(const x of f){const b=x.mode.numCharCountBits(p);if(x.numChars>=1<<b)return 1/0;g+=4+b+x.bitData.length}return g}static toUtf8ByteArray(f){f=encodeURI(f);let p=[];for(let g=0;g<f.length;g++)f.charAt(g)!="%"?p.push(f.charCodeAt(g)):(p.push(parseInt(f.substring(g+1,g+3),16)),g+=2);return p}};o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let u=o;n.QrSegment=o})(Bl||(Bl={}));(n=>{(e=>{const t=class{constructor(i,o){this.ordinal=i,this.formatBits=o}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(n.QrCode||(n.QrCode={}))})(Bl||(Bl={}));(n=>{(e=>{const t=class{constructor(i,o){this.modeBits=i,this.numBitsCharCount=o}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(n.QrSegment||(n.QrSegment={}))})(Bl||(Bl={}));var Jc=Bl;var JB={L:Jc.QrCode.Ecc.LOW,M:Jc.QrCode.Ecc.MEDIUM,Q:Jc.QrCode.Ecc.QUARTILE,H:Jc.QrCode.Ecc.HIGH},jj=128,Dj="L",Oj="#FFFFFF",Pj="#000000",kj=!1,Mj=1,ZB=4,eF=0,tF=.1;function Lj(n,e=0){const t=[];return n.forEach(function(s,i){let o=null;s.forEach(function(u,h){if(!u&&o!==null){t.push(`M${o+e} ${i+e}h${h-o}v1H${o+e}z`),o=null;return}if(h===s.length-1){if(!u)return;o===null?t.push(`M${h+e},${i+e} h1v1H${h+e}z`):t.push(`M${o+e},${i+e} h${h+1-o}v1H${o+e}z`);return}u&&o===null&&(o=h)})}),t.join("")}function Vj(n,e){return n.slice().map((t,s)=>s<e.y||s>=e.y+e.h?t:t.map((i,o)=>o<e.x||o>=e.x+e.w?i:!1))}function nF(n,e,t,s){if(s==null)return null;const i=n.length+t*2,o=Math.floor(e*tF),u=i/e,h=(s.width||o)*u,f=(s.height||o)*u,p=s.x==null?n.length/2-h/2:s.x*u,g=s.y==null?n.length/2-f/2:s.y*u,x=s.opacity==null?1:s.opacity;let b=null;if(s.excavate){let w=Math.floor(p),A=Math.floor(g),C=Math.ceil(h+p-w),L=Math.ceil(f+g-A);b={x:w,y:A,w:C,h:L}}const S=s.crossOrigin;return{x:p,y:g,h:f,w:h,excavation:b,opacity:x,crossOrigin:S}}function sF(n,e){return e!=null?Math.max(Math.floor(e),0):n?ZB:eF}function Uj({value:n,level:e,minVersion:t,includeMargin:s,marginSize:i,imageSettings:o,size:u,boostLevel:h}){let f=rn.useMemo(()=>{const w=(Array.isArray(n)?n:[n]).reduce((A,C)=>(A.push(...Jc.QrSegment.makeSegments(C)),A),[]);return Jc.QrCode.encodeSegments(w,JB[e],t,void 0,void 0,h)},[n,e,t,h]);const{cells:p,margin:g,numCells:x,calculatedImageSettings:b}=rn.useMemo(()=>{let S=f.getModules();const w=sF(s,i),A=S.length+w*2,C=nF(S,u,w,o);return{cells:S,margin:w,numCells:A,calculatedImageSettings:C}},[f,u,o,s,i]);return{qrcode:f,margin:g,cells:p,numCells:x,calculatedImageSettings:b}}var rF=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),iF=rn.forwardRef(function(e,t){const s=e,{value:i,size:o=jj,level:u=Dj,bgColor:h=Oj,fgColor:f=Pj,includeMargin:p=kj,minVersion:g=Mj,boostLevel:x,marginSize:b,imageSettings:S}=s,A=Bx(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:C}=A,L=Bx(A,["style"]),z=S?.src,U=rn.useRef(null),F=rn.useRef(null),K=rn.useCallback(fe=>{U.current=fe,typeof t=="function"?t(fe):t&&(t.current=fe)},[t]),[Z,j]=rn.useState(!1),{margin:N,cells:R,numCells:O,calculatedImageSettings:V}=Uj({value:i,level:u,minVersion:g,boostLevel:x,includeMargin:p,marginSize:b,imageSettings:S,size:o});rn.useEffect(()=>{if(U.current!=null){const fe=U.current,me=fe.getContext("2d");if(!me)return;let G=R;const ne=F.current,Y=V!=null&&ne!==null&&ne.complete&&ne.naturalHeight!==0&&ne.naturalWidth!==0;Y&&V.excavation!=null&&(G=Vj(R,V.excavation));const ge=window.devicePixelRatio||1;fe.height=fe.width=o*ge;const le=o/O*ge;me.scale(le,le),me.fillStyle=h,me.fillRect(0,0,O,O),me.fillStyle=f,rF?me.fill(new Path2D(Lj(G,N))):R.forEach(function(M,W){M.forEach(function(H,ce){H&&me.fillRect(ce+N,W+N,1,1)})}),V&&(me.globalAlpha=V.opacity),Y&&me.drawImage(ne,V.x+N,V.y+N,V.w,V.h)}}),rn.useEffect(()=>{j(!1)},[z]);const B=Ux({height:o,width:o},C);let k=null;return z!=null&&(k=rn.createElement("img",{src:z,key:z,style:{display:"none"},onLoad:()=>{j(!0)},ref:F,crossOrigin:V?.crossOrigin})),rn.createElement(rn.Fragment,null,rn.createElement("canvas",Ux({style:B,height:o,width:o,ref:K,role:"img"},L)),k)});iF.displayName="QRCodeCanvas";var Bj=rn.forwardRef(function(e,t){const s=e,{value:i,size:o=jj,level:u=Dj,bgColor:h=Oj,fgColor:f=Pj,includeMargin:p=kj,minVersion:g=Mj,boostLevel:x,title:b,marginSize:S,imageSettings:w}=s,A=Bx(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:C,cells:L,numCells:z,calculatedImageSettings:U}=Uj({value:i,level:u,minVersion:g,boostLevel:x,includeMargin:p,marginSize:S,imageSettings:w,size:o});let F=L,K=null;w!=null&&U!=null&&(U.excavation!=null&&(F=Vj(L,U.excavation)),K=rn.createElement("image",{href:w.src,height:U.h,width:U.w,x:U.x+C,y:U.y+C,preserveAspectRatio:"none",opacity:U.opacity,crossOrigin:U.crossOrigin}));const Z=Lj(F,C);return rn.createElement("svg",Ux({height:o,width:o,viewBox:`0 0 ${z} ${z}`,ref:t,role:"img"},A),!!b&&rn.createElement("title",null,b),rn.createElement("path",{fill:h,d:`M0,0 h${z}v${z}H0z`,shapeRendering:"crispEdges"}),rn.createElement("path",{fill:f,d:Z,shapeRendering:"crispEdges"}),K)});Bj.displayName="QRCodeSVG";const rt={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{backgroundColor:"white",padding:"24px",borderRadius:"8px",maxWidth:"420px",width:"90%",maxHeight:"90vh",overflow:"auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},title:{fontSize:"18px",fontWeight:"600",margin:0},closeBtn:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#666"},success:{backgroundColor:"#ecfdf5",border:"1px solid #6ee7b7",padding:"12px",borderRadius:"6px",marginBottom:"16px",textAlign:"center"},qrContainer:{display:"flex",justifyContent:"center",padding:"20px",backgroundColor:"#f9fafb",borderRadius:"8px",marginBottom:"16px"},dividerText:{textAlign:"center",color:"#666",margin:"16px 0",fontSize:"14px"},codeBox:{backgroundColor:"#f3f4f6",padding:"16px",borderRadius:"6px",textAlign:"center",marginBottom:"16px"},codeLabel:{fontSize:"12px",color:"#666",marginBottom:"4px"},codeValue:{fontSize:"24px",fontWeight:"600",fontFamily:"monospace",letterSpacing:"2px"},urlText:{fontSize:"13px",color:"#666",marginBottom:"4px"},urlValue:{fontSize:"14px",fontWeight:"500",wordBreak:"break-all"},buttonRow:{display:"flex",gap:"8px",marginBottom:"12px"},button:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",fontSize:"14px"},buttonPrimary:{flex:1,padding:"10px",border:"none",borderRadius:"6px",backgroundColor:"#2563eb",color:"white",cursor:"pointer",fontSize:"14px"},divider:{borderTop:"1px solid #eee",margin:"16px 0"},helpLink:{display:"block",textAlign:"center",color:"#2563eb",fontSize:"14px",cursor:"pointer",background:"none",border:"none",textDecoration:"underline",width:"100%"},adminCodeSection:{backgroundColor:"#fef3c7",border:"1px solid #fcd34d",padding:"16px",borderRadius:"6px",marginTop:"16px"},adminCodeTitle:{fontWeight:"600",marginBottom:"8px",fontSize:"14px"},adminCodeValue:{fontSize:"20px",fontWeight:"600",fontFamily:"monospace",letterSpacing:"2px",textAlign:"center",padding:"12px",backgroundColor:"white",borderRadius:"4px",marginBottom:"8px"},adminCodeExpiry:{fontSize:"12px",color:"#92400e",textAlign:"center"},instructions:{fontSize:"13px",color:"#666",marginTop:"8px"}};function Kg({isOpen:n,onClose:e,userData:t,onEmailSent:s}){const[i,o]=I.useState(!1),[u,h]=I.useState(""),[f,p]=I.useState(null),[g,x]=I.useState(!1),[b,S]=I.useState(!1);if(I.useEffect(()=>{n&&(o(!1),h(""),p(null),S(!1))},[n]),!n||!t)return null;const w=`${window.location.origin}/activate?code=${t.activationCode}`,A=`${window.location.origin}/admin-activate`,C=()=>{navigator.clipboard.writeText(t.activationCode),alert("Code copied!")},L=()=>{navigator.clipboard.writeText(w),alert("URL copied!")},z=async()=>{x(!0);const K=await ms.sendActivationEmail(t.email,t.activationCode);x(!1),K.success?(S(!0),s&&s()):alert("Failed to send email: "+K.error)},U=async()=>{x(!0);const K=await ms.generateAdminAssistCodeForUser(t.uid);x(!1),K.success?(h(K.code),p(K.expiry),o(!0)):alert("Failed to generate admin code: "+K.error)},F=K=>K?`Expires in ${Math.max(0,Math.floor((K-Date.now())/6e4))} minutes`:"";return l.jsx("div",{style:rt.overlay,onClick:e,children:l.jsxs("div",{style:rt.modal,onClick:K=>K.stopPropagation(),children:[l.jsxs("div",{style:rt.header,children:[l.jsx("h2",{style:rt.title,children:"Account Created"}),l.jsx("button",{style:rt.closeBtn,onClick:e,children:""})]}),l.jsxs("div",{style:rt.success,children:[" Account created for ",l.jsxs("strong",{children:[t.firstName," ",t.lastName]})]}),i?l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:rt.adminCodeSection,children:[l.jsx("p",{style:rt.adminCodeTitle,children:" Admin-Assisted Activation"}),l.jsx("p",{style:rt.instructions,children:"1. On the parent's phone, go to:"}),l.jsx("p",{style:{...rt.urlValue,marginBottom:"12px"},children:A}),l.jsx("p",{style:rt.instructions,children:"2. Enter this code:"}),l.jsx("div",{style:rt.adminCodeValue,children:u}),l.jsx("p",{style:rt.adminCodeExpiry,children:F(f)}),l.jsx("p",{style:rt.instructions,children:"3. Help them set their password on their device"})]}),l.jsxs("div",{style:rt.buttonRow,children:[l.jsx("button",{style:rt.button,onClick:()=>navigator.clipboard.writeText(u),children:" Copy Code"}),l.jsx("button",{style:rt.button,onClick:U,disabled:g,children:" New Code"})]}),l.jsx("button",{style:{...rt.helpLink,marginTop:"8px"},onClick:()=>o(!1),children:" Back to QR Code"})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{style:rt.qrContainer,children:l.jsx(Bj,{value:w,size:180,level:"M"})}),l.jsx("p",{style:{textAlign:"center",fontSize:"14px",color:"#666",marginTop:"-8px",marginBottom:"16px"},children:"Scan with phone camera to activate"}),l.jsx("div",{style:rt.dividerText,children:" OR enter manually "}),l.jsxs("div",{style:rt.codeBox,children:[l.jsxs("p",{style:rt.urlText,children:["Go to: ",l.jsxs("strong",{children:[window.location.origin,"/activate"]})]}),l.jsx("p",{style:rt.codeLabel,children:"Activation Code:"}),l.jsx("p",{style:rt.codeValue,children:t.activationCode})]}),l.jsxs("div",{style:rt.buttonRow,children:[l.jsx("button",{style:rt.button,onClick:C,children:" Copy Code"}),l.jsx("button",{style:rt.button,onClick:L,children:" Copy Link"})]}),l.jsx("div",{style:rt.buttonRow,children:l.jsx("button",{style:rt.buttonPrimary,onClick:z,disabled:g||b,children:b?" Email Sent":g?"Sending...":" Send Email"})}),l.jsx("div",{style:rt.divider}),l.jsx("button",{style:rt.helpLink,onClick:U,children:"Parent having trouble? Activate for them "})]}),l.jsx("div",{style:rt.divider}),l.jsx("button",{style:rt.buttonPrimary,onClick:e,children:"Done"})]})})}const A_={standard:{staleTime:1e3*60*30,cacheTime:1e3*60*60*12,refetchOnWindowFocus:!1,refetchOnMount:!1}};function aF(){return ls({queryKey:["users","parent"],queryFn:()=>Ls.getUsersByRole("parent"),...A_.standard})}function oF(n){return ls({queryKey:["children","byParent",n],queryFn:()=>Vr.getChildrenByParentId(n),enabled:!!n,...A_.standard})}function Qg(n){return ls({queryKey:["children","byStaff",n],queryFn:()=>Vr.getChildrenByStaffId(n),enabled:!!n,...A_.standard})}function lF(){const n=Fl();return{invalidateParents:()=>{n.invalidateQueries({queryKey:["users","parent"]})},invalidateChildren:()=>{n.invalidateQueries({queryKey:["children"]})},invalidateChildrenByParent:e=>{n.invalidateQueries({queryKey:["children","byParent",e]})},invalidateStaff:()=>{n.invalidateQueries({queryKey:["users","teacher"]}),n.invalidateQueries({queryKey:["users","therapist"]}),n.invalidateQueries({queryKey:["users","staff"]})},invalidateAdmins:()=>{n.invalidateQueries({queryKey:["users","admin"]})},invalidateServices:()=>{n.invalidateQueries({queryKey:["services"]})},invalidateAll:()=>{n.invalidateQueries()}}}function cF(){const{currentUser:n}=In(),e=Qg(n?.uid);return{students:e.data||[],isLoading:e.isLoading,error:e.error,refetch:e.refetch}}function uF(){const{currentUser:n}=In(),e=Qg(n?.uid);return{students:e.data||[],isLoading:e.isLoading,error:e.error,refetch:e.refetch}}const dF=()=>{const{teachers:n,loading:e,error:t,createTeacher:s,newTeacher:i,handleInputChange:o}=Nj(),[u,h]=I.useState(!1),[f,p]=I.useState(""),[g,x]=I.useState(null),[b,S]=I.useState(!1),[w,A]=I.useState(null),[C,L]=I.useState(!1),{data:z=[],isLoading:U}=Qg(g);if(e)return l.jsx("div",{className:"pg-loading",children:"Loading teachers..."});const F=n.filter(N=>`${N.firstName} ${N.lastName}`.toLowerCase().includes(f.toLowerCase())||N.email.toLowerCase().includes(f.toLowerCase())),K=g?n.find(N=>N.uid===g):null,Z=N=>[...N.groupClassServices||[],...N.oneOnOneServices||[]].filter(O=>O.staffId===g).map(O=>O.serviceName).join(", "),j=async N=>{N.preventDefault(),L(!0);const R=await s(N);L(!1),R.success?(h(!1),A(R.user),S(!0)):alert("Failed to create teacher: "+R.error)};return l.jsxs("div",{className:"ooo-container",children:[l.jsx(To,{}),l.jsxs("div",{className:"ooo-main",children:[l.jsx("div",{className:"ooo-header",children:l.jsxs("div",{className:"mt-header-wrapper",children:[l.jsxs("div",{className:"mt-header-left",children:[g&&l.jsx("span",{className:"mt-back-btn",onClick:()=>x(null),children:""}),l.jsxs("div",{className:"header-title",children:[l.jsx("h1",{children:g?"TEACHER PROFILE":"TEACHER PROFILES"}),!g&&l.jsx("p",{className:"header-subtitle",children:"Add and Manage Teacher Accounts"})]})]}),!g&&l.jsxs("div",{className:"mt-search-container",children:[l.jsx("span",{className:"mt-search-icon",children:""}),l.jsx("input",{type:"text",placeholder:"Search teacher name...",value:f,onChange:N=>p(N.target.value),className:"mt-search-input"})]})]})}),t&&l.jsxs("div",{className:"mt-error-banner",children:[" Error: ",t]}),l.jsx("div",{className:"ooo-content-area",children:g&&K?l.jsxs("div",{style:{paddingBottom:"120px",width:"100%"},children:[l.jsx(WB,{teacher:K}),l.jsxs("div",{style:{marginTop:"30px"},children:[l.jsxs("h3",{className:"mt-section-title",children:["Enrolled Students (",z.length,")"]}),U?l.jsx("p",{style:{color:"#666",fontStyle:"italic"},children:"Loading students..."}):z.length===0?l.jsx("div",{className:"mt-empty-state",children:l.jsx("p",{children:"No students currently assigned to this teacher."})}):l.jsx("div",{className:"ooo-grid",children:z.map(N=>l.jsxs("div",{className:"ooo-card",style:{cursor:"default"},children:[l.jsx("div",{className:"ooo-photo-area",children:N.photoUrl?l.jsx("img",{src:N.photoUrl,alt:""}):l.jsx("span",{children:""})}),l.jsxs("div",{className:"ooo-card-info",children:[l.jsxs("p",{className:"ooo-name",children:[N.firstName," ",N.lastName]}),l.jsx("p",{className:"ooo-sub",style:{color:"#2563eb",fontWeight:"500"},children:Z(N)})]})]},N.id))})]})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mt-section-title-wrapper",children:l.jsx("h2",{className:"mt-section-title",children:"Teacher Accounts"})}),F.length===0?l.jsx("div",{className:"mt-empty-state",children:l.jsx("p",{className:"mt-empty-text",children:f?"No teachers found matching your search.":"No teachers yet."})}):l.jsx("div",{className:"mt-grid",children:F.map(N=>l.jsx("div",{className:`mt-card ${N.profileCompleted?"is-clickable":"is-locked"}`,onClick:()=>{N.profileCompleted?x(N.uid):alert("This teacher has not completed their profile yet.")},children:l.jsxs("div",{children:[l.jsx("div",{className:`mt-status-dot ${N.profileCompleted?"active":"pending"}`,title:N.profileCompleted?"Profile Complete":"Profile Incomplete"}),l.jsx("div",{className:"mt-avatar-container",children:N.profilePhoto?l.jsx("img",{src:N.profilePhoto,alt:"",className:"mt-avatar-img"}):""}),l.jsxs("h3",{className:"mt-teacher-name",children:[N.firstName," ",N.lastName]}),l.jsx("div",{className:`mt-badge ${N.profileCompleted?"complete":"incomplete"}`,children:N.profileCompleted?" Profile Active":" Setup Pending"}),l.jsx("div",{className:"mt-tags-wrapper",children:N.specializations?.slice(0,2).map((R,O)=>l.jsx("span",{className:"mt-tag",children:R},O))})]})},N.uid))})]})}),!g&&l.jsx("button",{onClick:()=>h(!0),className:"mt-fab",children:"+ ADD TEACHER"}),u&&l.jsx("div",{className:"mt-modal-overlay",onClick:()=>h(!1),children:l.jsxs("div",{className:"mt-form-container",onClick:N=>N.stopPropagation(),children:[l.jsx("h2",{className:"mt-form-title",children:"ADD TEACHER"}),l.jsxs("form",{onSubmit:j,children:[l.jsxs("div",{className:"mt-form-row",children:[l.jsx("input",{name:"lastName",placeholder:"Surname *",value:i.lastName,onChange:o,required:!0,className:"mt-input"}),l.jsx("input",{name:"firstName",placeholder:"First Name *",value:i.firstName,onChange:o,required:!0,className:"mt-input"})]}),l.jsx("input",{name:"email",type:"email",placeholder:"Email Address *",value:i.email,onChange:o,required:!0,className:"mt-input-full"}),l.jsxs("div",{className:"mt-info-box",children:[l.jsx("strong",{children:" How it works:"}),l.jsx("p",{children:"After creating the account, a QR code will appear. The teacher can scan it to set up their password and complete their profile."})]}),l.jsxs("div",{className:"mt-action-row",children:[l.jsx("button",{type:"button",onClick:()=>h(!1),disabled:C,className:"mt-btn-cancel",children:"CANCEL"}),l.jsx("button",{type:"submit",disabled:C,className:`mt-btn-submit ${C?"loading":"normal"}`,children:C?"CREATING...":"CREATE ACCOUNT"})]})]})]})}),l.jsx(Kg,{isOpen:b,onClose:()=>{S(!1),A(null)},userData:w})]})]})},hF=({therapistId:n,serviceName:e})=>{const[t,s]=I.useState(null),[i,o]=I.useState(!0),[u,h]=I.useState(!1);return I.useEffect(()=>{(async()=>{if(n)try{const p=await Ls.getUserById(n);p&&p.profileCompleted&&s(p)}catch(p){console.error("Could not fetch therapist info",p)}finally{o(!1)}})()},[n]),i?l.jsx("div",{style:ut.loading,children:"Loading therapist info..."}):t?l.jsxs("div",{style:ut.wrapper,children:[l.jsx("div",{style:ut.imageCard,children:t.profilePhoto?l.jsx("img",{src:t.profilePhoto,alt:t.firstName,style:ut.largePhoto}):l.jsxs("div",{style:ut.largePhotoPlaceholder,children:[t.firstName?.[0],t.lastName?.[0]]})}),l.jsxs("div",{style:ut.card,children:[l.jsx("div",{style:ut.serviceBadge,children:e}),l.jsx("div",{style:ut.header,children:l.jsxs("div",{style:ut.info,children:[l.jsxs("h4",{style:ut.name,children:[t.firstName," ",t.lastName]}),t.licenseNumber&&l.jsxs("div",{style:ut.credentialRow,children:[l.jsx("span",{style:ut.verifiedIcon,children:""}),l.jsxs("span",{style:ut.credentialText,children:["Lic. ",t.licenseNumber]})]}),l.jsxs("div",{style:ut.metaRow,children:[" ",t.yearsOfExperience||0," Years Experience"]})]})}),l.jsx("div",{style:ut.divider}),l.jsxs("div",{style:ut.body,children:[t.education&&t.education.length>0&&l.jsxs("div",{style:ut.section,children:[l.jsx("div",{style:ut.sectionHeader,children:" Education"}),Array.isArray(t.education)?t.education.map((f,p)=>l.jsxs("div",{style:ut.eduItem,children:[l.jsx("strong",{children:f.degree}),l.jsxs("span",{style:ut.subText,children:[" "," ",f.school," (",f.year,")"]})]},p)):l.jsx("div",{style:ut.eduItem,children:t.education})]}),t.languagesSpoken?.length>0&&l.jsxs("div",{style:ut.row,children:[l.jsx("span",{style:ut.icon,children:""}),l.jsx("div",{style:ut.text,children:t.languagesSpoken.join(", ")})]}),l.jsxs("div",{style:ut.bioContainer,children:[l.jsx("p",{style:ut.bio,children:u?t.bio:`${t.bio?.substring(0,80)}...`}),l.jsx("button",{onClick:()=>h(!u),style:ut.expandBtn,children:u?"Show Less":"View Full Profile"})]}),u&&t.certifications&&t.certifications.length>0&&l.jsxs("div",{style:ut.certSection,children:[l.jsx("div",{style:ut.certHeader,children:"Verified Certifications"}),l.jsx("div",{style:ut.certGrid,children:t.certifications.map((f,p)=>{const g=typeof f=="object"?f.name:f,x=typeof f=="object"?f.fileUrl:null,b=typeof f=="object"?f.issuer:null;return l.jsxs("div",{style:ut.certTag,children:[l.jsxs("div",{children:[" ",g,b&&l.jsxs("span",{style:{fontSize:"0.7em",color:"#666"},children:[" ","(",b,")"]})]}),x&&l.jsx("a",{href:x,target:"_blank",rel:"noreferrer",style:ut.proofLink,children:"View Proof "})]},p)})})]})]})]})]}):null},ut={wrapper:{display:"flex",gap:"2.5rem",marginBottom:"1rem",alignItems:"flex-start"},loading:{padding:"1rem",color:"#64748b",fontSize:"0.875rem",fontStyle:"italic"},imageCard:{width:"300px",height:"385px",flexShrink:0,backgroundColor:"white",borderRadius:"16px",border:"1px solid #e2e8f0",padding:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},largePhoto:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"12px"},largePhotoPlaceholder:{width:"100%",height:"100%",borderRadius:"12px",backgroundColor:"#cbd5e1",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"3rem",fontWeight:"bold",color:"white"},card:{flex:1,backgroundColor:"white",borderRadius:"16px",border:"1px solid #e2e8f0",overflow:"hidden",boxShadow:"0 2px 4px rgba(0,0,0,0.02)"},serviceBadge:{backgroundColor:"#f0f9ff",color:"#0369a1",padding:"0.5rem 1rem",fontSize:"0.75rem",fontWeight:700,textTransform:"uppercase",borderBottom:"1px solid #e0f2fe"},header:{padding:"1rem"},info:{flex:1},name:{margin:"0 0 0.25rem 0",fontSize:"1.1rem",fontWeight:700,color:"#0f172a"},credentialRow:{display:"flex",alignItems:"center",gap:"0.25rem",marginBottom:"0.25rem"},verifiedIcon:{color:"#059669",fontWeight:"bold"},credentialText:{fontSize:"0.8rem",color:"#059669",fontWeight:600},metaRow:{fontSize:"0.8rem",color:"#64748b"},divider:{height:"1px",backgroundColor:"#f1f5f9"},body:{padding:"1rem"},section:{marginBottom:"0.75rem"},sectionHeader:{fontSize:"0.8rem",fontWeight:700,color:"#64748b",marginBottom:"0.25rem",textTransform:"uppercase"},eduItem:{fontSize:"0.9rem",color:"#334155"},subText:{fontSize:"0.8rem",color:"#94a3b8"},row:{display:"flex",gap:"0.75rem",marginBottom:"0.75rem"},icon:{fontSize:"1rem"},text:{fontSize:"0.9rem",color:"#334155"},bioContainer:{backgroundColor:"#f8fafc",padding:"0.75rem",borderRadius:"0.5rem"},bio:{margin:0,fontSize:"0.875rem",color:"#475569",lineHeight:"1.5"},expandBtn:{background:"none",border:"none",color:"#2563eb",fontSize:"0.8rem",fontWeight:600,cursor:"pointer",marginTop:"0.5rem",padding:0},certSection:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px dashed #e2e8f0"},certHeader:{fontSize:"0.75rem",fontWeight:700,color:"#94a3b8",marginBottom:"0.5rem",textTransform:"uppercase"},certGrid:{display:"flex",flexDirection:"column",gap:"0.5rem"},certTag:{fontSize:"0.8rem",backgroundColor:"#fffbeb",color:"#b45309",padding:"0.5rem",borderRadius:"0.25rem",border:"1px solid #fcd34d",display:"flex",justifyContent:"space-between",alignItems:"center"},proofLink:{fontSize:"0.75rem",color:"#2563eb",textDecoration:"none",fontWeight:600,border:"1px solid #bfdbfe",padding:"2px 6px",borderRadius:"4px",backgroundColor:"white"}},fF=()=>{const{therapists:n,services:e,loading:t,error:s,newTherapist:i,handleInputChange:o,toggleSpecialization:u,createTherapist:h}=p_(),[f,p]=I.useState(!1),[g,x]=I.useState(""),[b,S]=I.useState(null),[w,A]=I.useState(!1),[C,L]=I.useState(null),[z,U]=I.useState(!1),{data:F=[],isLoading:K}=Qg(b);if(t)return l.jsx("div",{className:"pg-loading",children:"Loading therapists..."});const Z=n.filter(R=>`${R.firstName} ${R.lastName}`.toLowerCase().includes(g.toLowerCase())||R.email.toLowerCase().includes(g.toLowerCase())),j=R=>[...R.oneOnOneServices||[],...R.groupClassServices||[]].filter(V=>V.staffId===b).map(V=>V.serviceName).join(", "),N=async R=>{R.preventDefault(),U(!0);const O=await h(R);U(!1),O.success?(p(!1),L(O.user),A(!0)):alert("Failed to create therapist: "+O.error)};return b&&n.find(R=>R.uid===b),l.jsxs("div",{className:"ooo-container",children:[l.jsx(To,{}),l.jsxs("div",{className:"ooo-main",children:[l.jsx("div",{className:"ooo-header",children:l.jsxs("div",{className:"mt-header-wrapper",children:[l.jsxs("div",{className:"mt-header-left",children:[b&&l.jsx("span",{className:"mt-back-btn",onClick:()=>S(null),children:""}),l.jsxs("div",{className:"header-title",children:[l.jsx("h1",{children:b?"THERAPIST PROFILE":"THERAPIST PROFILES"}),!b&&l.jsx("p",{className:"header-subtitle",children:"Add and Manage Therapist Accounts"})]})]}),!b&&l.jsxs("div",{className:"mt-search-container",children:[l.jsx("span",{className:"mt-search-icon",children:""}),l.jsx("input",{type:"text",placeholder:"Search therapist name...",value:g,onChange:R=>x(R.target.value),className:"mt-search-input"})]})]})}),s&&l.jsxs("div",{className:"mt-error-banner",children:[" Error: ",s]}),l.jsx("div",{className:"ooo-content-area",children:b?l.jsxs("div",{style:{paddingBottom:"120px",width:"100%"},children:[l.jsx(hF,{therapistId:b,serviceName:"Therapist Profile"}),l.jsxs("div",{style:{marginTop:"30px"},children:[l.jsxs("h3",{className:"mt-section-title",children:["Assigned Patients (",F.length,")"]}),K?l.jsx("p",{style:{color:"#666",fontStyle:"italic"},children:"Loading patients..."}):F.length===0?l.jsx("div",{className:"mt-empty-state",children:l.jsx("p",{children:"No patients currently assigned to this therapist."})}):l.jsx("div",{className:"ooo-grid",children:F.map(R=>l.jsxs("div",{className:"ooo-card",style:{cursor:"default"},children:[l.jsx("div",{className:"ooo-photo-area",children:R.photoUrl?l.jsx("img",{src:R.photoUrl,alt:""}):l.jsx("span",{children:""})}),l.jsxs("div",{className:"ooo-card-info",children:[l.jsxs("p",{className:"ooo-name",children:[R.firstName," ",R.lastName]}),l.jsx("p",{className:"ooo-sub",style:{color:"#2563eb",fontWeight:"500"},children:j(R)})]})]},R.id))})]})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"mt-section-title-wrapper",children:l.jsx("h2",{className:"mt-section-title",children:"Therapist Accounts"})}),Z.length===0?l.jsx("div",{className:"mt-empty-state",children:l.jsx("p",{className:"mt-empty-text",children:g?"No therapists found matching your search.":"No therapists yet."})}):l.jsx("div",{className:"mt-grid",children:Z.map(R=>l.jsx("div",{className:`mt-card ${R.profileCompleted?"is-clickable":"is-locked"}`,onClick:()=>{R.profileCompleted?S(R.uid):alert("This therapist has not completed their profile yet.")},children:l.jsxs("div",{children:[l.jsx("div",{className:`mt-status-dot ${R.profileCompleted?"active":"pending"}`,title:R.profileCompleted?"Profile Complete":"Profile Incomplete"}),l.jsx("div",{className:"mt-avatar-container",children:R.profilePhoto?l.jsx("img",{src:R.profilePhoto,alt:"",className:"mt-avatar-img"}):""}),l.jsxs("h3",{className:"mt-teacher-name",children:[R.firstName," ",R.lastName]}),l.jsx("div",{className:`mt-badge ${R.profileCompleted?"complete":"incomplete"}`,children:R.profileCompleted?" Profile Active":" Setup Pending"}),l.jsx("div",{className:"mt-tags-wrapper",children:R.specializations?.length?R.specializations.slice(0,2).map((O,V)=>l.jsx("span",{className:"mt-tag",children:O},V)):l.jsx("span",{className:"mt-tag",children:"No specs"})})]})},R.uid))})]})}),!b&&l.jsx("button",{className:"mt-fab",onClick:()=>p(!0),children:"+ ADD THERAPIST"}),f&&l.jsx("div",{className:"mt-modal-overlay",onClick:()=>p(!1),children:l.jsxs("div",{className:"mt-form-container",onClick:R=>R.stopPropagation(),children:[l.jsx("h2",{className:"mt-form-title",children:"ADD THERAPIST"}),l.jsxs("form",{onSubmit:N,children:[l.jsxs("div",{style:{marginBottom:"24px"},children:[l.jsxs("div",{className:"mt-form-row",children:[l.jsx("input",{name:"lastName",placeholder:"Surname *",value:i.lastName,onChange:o,required:!0,className:"mt-input"}),l.jsx("input",{name:"firstName",placeholder:"First Name *",value:i.firstName,onChange:o,required:!0,className:"mt-input"})]}),l.jsx("input",{name:"middleName",placeholder:"Middle Name (Optional)",value:i.middleName||"",onChange:o,className:"mt-input-full",style:{marginBottom:0}})]}),l.jsx("input",{name:"email",type:"email",placeholder:"Email Address *",value:i.email,onChange:o,required:!0,className:"mt-input-full"}),l.jsxs("div",{className:"mt-info-box",children:[l.jsx("strong",{children:" How it works:"}),l.jsx("p",{children:"After creating the account, a QR code will appear. The therapist can scan it to set up their password and complete their profile."})]}),l.jsxs("div",{style:{marginBottom:"32px"},children:[l.jsx("h3",{style:{fontSize:"12px",fontWeight:"700",textTransform:"uppercase",color:"#666",marginBottom:"16px"},children:"Specialization"}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px"},children:e&&e.length>0?e.map(R=>l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[l.jsx("input",{type:"checkbox",checked:i.specializations.includes(R.name),onChange:()=>u(R.name),style:{width:"18px",height:"18px",cursor:"pointer"}}),l.jsx("span",{style:{fontSize:"13px",fontWeight:"600"},children:R.name.toUpperCase()})]},R.id)):l.jsx("p",{style:{fontSize:"13px",color:"#666"},children:"No specializations available"})})]}),l.jsxs("div",{className:"mt-action-row",children:[l.jsx("button",{type:"button",onClick:()=>p(!1),disabled:z,className:"mt-btn-cancel",children:"CANCEL"}),l.jsx("button",{type:"submit",disabled:z,className:`mt-btn-submit ${z?"loading":"normal"}`,children:z?"CREATING...":"ADD THERAPIST"})]})]})]})}),l.jsx(Kg,{isOpen:w,onClose:()=>{A(!1),L(null)},userData:C})]})]})};function pF({data:n,onChange:e}){return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"I. IDENTIFYING DATA"}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"First Name"}),l.jsx("input",{type:"text",value:n.firstName,onChange:t=>e("firstName",t.target.value),placeholder:"Enter First Name",required:!0})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Middle Name"}),l.jsx("input",{type:"text",value:n.middleName||"",onChange:t=>e("middleName",t.target.value),placeholder:"Enter Middle Name"})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Last Name"}),l.jsx("input",{type:"text",value:n.lastName,onChange:t=>e("lastName",t.target.value),placeholder:"Enter Last Name",required:!0})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Nickname"}),l.jsx("input",{type:"text",value:n.nickname,onChange:t=>e("nickname",t.target.value),placeholder:"Enter Nickname"})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Gender"}),l.jsxs("select",{value:n.gender,onChange:t=>e("gender",t.target.value),children:[l.jsx("option",{value:"",children:"Select Gender"}),l.jsx("option",{value:"Male",children:"Male"}),l.jsx("option",{value:"Female",children:"Female"})]})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Relationship to Client"}),l.jsxs("select",{value:n.relationshipToClient,onChange:t=>e("relationshipToClient",t.target.value),children:[l.jsx("option",{value:"biological child",children:"Biological Child"}),l.jsx("option",{value:"adopted child",children:"Adopted Child"}),l.jsx("option",{value:"foster child",children:"Foster Child"}),l.jsx("option",{value:"legal guardian",children:"Legal Guardian"}),l.jsx("option",{value:"Others",children:"Others"})]}),n.relationshipToClient==="Others"&&l.jsx("input",{type:"text",placeholder:"Please specify",onChange:t=>e("relationshipToClient",t.target.value),className:"mt-2"})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Date of Birth"}),l.jsx("input",{type:"date",value:n.dateOfBirth,onChange:t=>e("dateOfBirth",t.target.value)})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Age at Assessment"}),l.jsx("input",{type:"text",value:n.ageAtAssessment,readOnly:!0,placeholder:"Auto-calculated",style:{backgroundColor:"#f0f0f0"}})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Address"}),l.jsx("input",{type:"text",value:n.address,onChange:t=>e("address",t.target.value),placeholder:"Enter Address"})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"School"}),l.jsx("input",{type:"text",value:n.school,onChange:t=>e("school",t.target.value),placeholder:"Enter School"})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Grade Level"}),l.jsxs("select",{value:n.gradeLevel,onChange:t=>e("gradeLevel",t.target.value),children:[l.jsx("option",{value:"",children:"Select Level"}),l.jsx("option",{value:"Nursery",children:"Nursery"}),l.jsx("option",{value:"Kinder 1",children:"Kindergraten"}),l.jsx("option",{value:"Kinder 1",children:"Elementary"}),l.jsx("option",{value:"Others",children:"Others"})]})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Date of Assessment"}),l.jsx("input",{type:"date",value:n.assessmentDates,onChange:t=>e("assessmentDates",t.target.value)})]})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Examiner"}),l.jsx("input",{type:"text",value:n.examiner,onChange:t=>e("examiner",t.target.value),placeholder:"Enter Examiner Name"})]}),l.jsx("div",{className:"input-group"})]})]})}function mF({data:n,onChange:e}){return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"II. REASON FOR REFERRAL"}),l.jsx("div",{className:"input-group",children:l.jsx("textarea",{rows:"10",value:n.reasonForReferral,onChange:t=>e("reasonForReferral",t.target.value),placeholder:"Type referral details here...",required:!0})})]})}function gF({data:n,onChange:e}){const t=()=>{e("purposeOfAssessment",[...n.purposeOfAssessment,""])},s=o=>{const u=[...n.purposeOfAssessment];u.splice(o,1),e("purposeOfAssessment",u)},i=(o,u)=>{const h=[...n.purposeOfAssessment];h[o]=u,e("purposeOfAssessment",h)};return l.jsxs("div",{className:"form-section",children:[l.jsx("div",{className:"section-header-flex",children:l.jsx("h3",{children:"III. PURPOSE OF ASSESSMENT"})}),l.jsx("div",{className:"dynamic-list-container",children:(n.purposeOfAssessment.length>0?n.purposeOfAssessment:[""]).map((o,u)=>l.jsxs("div",{className:"dynamic-input-row",children:[l.jsx("span",{className:"row-index",children:u+1}),l.jsx("input",{type:"text",placeholder:"Enter purpose point...",value:o,onChange:h=>i(u,h.target.value),required:!0}),n.purposeOfAssessment.length>1&&l.jsx("button",{className:"remove-row-btn",onClick:()=>s(u),children:""})]},u))}),l.jsx("button",{className:"add-point-btn",onClick:t,children:"+ Add Assessment Purpose"})]})}function yF({data:n,onChange:e}){const[t,s]=I.useState([]);I.useEffect(()=>{(async()=>{const w=await bi.getAllServices();s(w)})()},[]);const i=()=>{const S=[...n.backgroundHistory.developmentalBackground,{devBgTitle:"",devBgInfo:""}];e("backgroundHistory","developmentalBackground",S)},o=S=>{const w=[...n.backgroundHistory.developmentalBackground];w.splice(S,1),e("backgroundHistory","developmentalBackground",w)},u=(S,w,A)=>{const C=[...n.backgroundHistory.developmentalBackground];C[S]={...C[S],[w]:A},e("backgroundHistory","developmentalBackground",C)},h=S=>{const w=[...n.backgroundHistory.interventions,{serviceType:S,serviceId:"",name:"",frequency:""}];e("backgroundHistory","interventions",w)},f=S=>{const w=n.backgroundHistory.interventions.filter((A,C)=>C!==S);e("backgroundHistory","interventions",w)},p=(S,w,A)=>{const C=[...n.backgroundHistory.interventions];C[S]={...C[S],[w]:A},e("backgroundHistory","interventions",C)},g=(S,w)=>{const A=t.find(L=>L.id===w),C=[...n.backgroundHistory.interventions];C[S]={...C[S],serviceId:w,name:A?A.name:""},e("backgroundHistory","interventions",C)},x=S=>n.backgroundHistory.interventions.filter(w=>w.serviceType===S&&w.serviceId).map(w=>w.serviceId),b=(S,w)=>l.jsxs("div",{style:{marginBottom:"20px"},children:[l.jsx("h4",{style:{fontSize:"0.9rem",marginBottom:"8px"},children:w}),n.backgroundHistory.interventions.map((A,C)=>({...A,originalIndex:C})).filter(A=>A.serviceType===S).map(A=>l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"10px"},children:[l.jsx("div",{style:{flex:2},children:l.jsxs("select",{style:{width:"100%"},value:A.serviceId,onChange:C=>g(A.originalIndex,C.target.value),children:[l.jsxs("option",{value:"",disabled:!0,children:["Select ",w]}),t.filter(C=>{if(C.type!==S)return!1;const L=x(S);return C.id===A.serviceId?!0:!L.includes(C.id)}).map(C=>l.jsx("option",{value:C.id,children:C.name},C.id))]})}),l.jsx("div",{style:{flex:1},children:l.jsx("input",{type:"text",placeholder:"e.g. 2x weekly",value:A.frequency,onChange:C=>p(A.originalIndex,"frequency",C.target.value),required:!0})}),l.jsx("button",{type:"button",className:"remove-entry-btn",onClick:()=>f(A.originalIndex),children:""})]},A.originalIndex)),l.jsxs("button",{type:"button",className:"add-point-btn",onClick:()=>h(S),children:["+ Add ",w]})]});return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{className:"section-title",children:"IV. BACKGROUND HISTORY"}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Family Background"}),l.jsx("textarea",{rows:"4",value:n.backgroundHistory.familyBackground,onChange:S=>e("backgroundHistory","familyBackground",S.target.value),placeholder:"Parents, residence, and occupations...",required:!0})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Family Relationships"}),l.jsx("textarea",{rows:"3",value:n.backgroundHistory.familyRelationships,onChange:S=>e("backgroundHistory","familyRelationships",S.target.value),placeholder:"Interactions, communication style, and siblings...",required:!0})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Daily Life & Activities"}),l.jsx("textarea",{rows:"3",value:n.backgroundHistory.dailyLifeActivities,onChange:S=>e("backgroundHistory","dailyLifeActivities",S.target.value),placeholder:"Independence levels and preferred activities...",required:!0})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Medical History"}),l.jsx("textarea",{rows:"2",value:n.backgroundHistory.medicalHistory,onChange:S=>e("backgroundHistory","medicalHistory",S.target.value),placeholder:"Dermatitis, allergies, asthma, etc...",required:!0})]}),l.jsxs("div",{className:"form-section-group input-group",children:[l.jsx("label",{children:"Developmental Background"}),n.backgroundHistory.developmentalBackground.map((S,w)=>l.jsxs("div",{className:"dev-bg-entry",children:[l.jsxs("div",{className:"dev-bg-header",children:[l.jsxs("span",{className:"dev-bg-number",children:[w+1,". Developmental Pediatric Assessment"]}),n.backgroundHistory.developmentalBackground.length>1&&l.jsx("button",{className:"remove-entry-btn",onClick:()=>o(w),children:"Remove"})]}),l.jsxs("div",{className:"dev-bg-grid",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Title"}),l.jsx("input",{type:"text",placeholder:"e.g. Maternal History",value:S.devBgTitle,onChange:A=>u(w,"devBgTitle",A.target.value),required:!0})]}),l.jsxs("div",{className:"input-group",style:{marginBottom:0},children:[l.jsx("label",{children:"Details"}),l.jsx("textarea",{rows:"3",placeholder:"Enter specific details...",value:S.devBgInfo,onChange:A=>u(w,"devBgInfo",A.target.value),required:!0})]})]})]},w)),l.jsx("button",{className:"add-point-btn",onClick:i,children:"+ Upload Developmental Pediatric Assessment / Diagnosis"})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"School History"}),l.jsx("textarea",{rows:"2",value:n.backgroundHistory.schoolHistory,onChange:S=>e("backgroundHistory","schoolHistory",S.target.value),placeholder:"Current and previous school placements...",required:!0})]}),l.jsxs("div",{className:"input-group highlight-box",children:[l.jsx("label",{children:"Clinical Diagnosis"}),l.jsx("textarea",{rows:"3",value:n.backgroundHistory.clinicalDiagnosis,onChange:S=>e("backgroundHistory","clinicalDiagnosis",S.target.value),placeholder:"Diagnosis and support requirements...",required:!0})]}),l.jsxs("div",{className:"form-section-group input-group",children:[l.jsx("label",{children:"Therapies / Interventions"}),b("Therapy","1 on 1 Services"),b("Class","Group Classes")]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Strengths & Interests"}),l.jsx("textarea",{rows:"3",value:n.backgroundHistory.strengthsAndInterests,onChange:S=>e("backgroundHistory","strengthsAndInterests",S.target.value),placeholder:"Academic skills and hobbies...",required:!0})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Social Skills"}),l.jsx("textarea",{rows:"2",value:n.backgroundHistory.socialSkills,onChange:S=>e("backgroundHistory","socialSkills",S.target.value),placeholder:"Peer interaction and behavior regulation...",required:!0})]})]})}function vF({data:n,onChange:e}){return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"V. BEHAVIOR DURING ASSESSMENT"}),l.jsx("div",{className:"input-group",children:l.jsx("textarea",{rows:"8",value:n.behaviorDuringAssessment,onChange:t=>e("behaviorDuringAssessment",t.target.value),placeholder:"Describe the student's behavior during assessment...",required:!0})})]})}function xF({data:n,onChange:e}){const t=()=>{const o=[...n.assessmentTools,{tool:"",details:""}];e("assessmentTools",null,o)},s=o=>{const u=n.assessmentTools.filter((h,f)=>f!==o);e("assessmentTools",null,u)},i=(o,u,h)=>{const f=[...n.assessmentTools];f[o]={...f[o],[u]:h},e("assessmentTools",null,f)};return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"VI. ASSESSMENT TOOLS AND MEASURES"}),n.assessmentTools.length>0&&l.jsxs("div",{className:"assessment-tools-header",children:[l.jsx("label",{children:"Tool / Measure"}),l.jsx("label",{children:"Details"})]}),n.assessmentTools.map((o,u)=>l.jsxs("div",{className:"assessment-tool-row",children:[l.jsx("div",{className:"assessment-tool-field",children:l.jsx("input",{type:"text",placeholder:"e.g. Cognitive / Pre-academic Skills",value:o.tool,onChange:h=>i(u,"tool",h.target.value),required:!0})}),l.jsx("div",{className:"assessment-tool-field",children:l.jsx("textarea",{rows:"2",placeholder:"Observation, structured tasks, ECCD Checklist...",value:o.details,onChange:h=>i(u,"details",h.target.value)})}),l.jsx("button",{type:"button",className:"remove-entry-btn",onClick:()=>s(u),children:""})]},u)),l.jsx("button",{type:"button",className:"add-point-btn",onClick:t,children:"+ Add Tool / Measure"})]})}function bF({data:n,onChange:e}){return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"VII. ASSESSMENT RESULTS"}),n.assessmentTools.map((t,s)=>l.jsxs("div",{className:"assessment-result-block",children:[l.jsxs("h4",{className:"assessment-result-title",children:[String.fromCharCode(65+s),". ",t.tool]}),l.jsx("textarea",{className:"assessment-result-text",rows:"6",placeholder:"Enter assessment findings and observations...",value:t.result||"",onChange:i=>{const o=[...n.assessmentTools];o[s].result=i.target.value,e("assessmentTools",null,o)},required:!0})]},s))]})}function _F({data:n,onChange:e}){return l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"VIII. SUMMARY AND RECOMMENDATIONS"}),l.jsxs("div",{className:"assessment-result-block",children:[l.jsx("h4",{className:"assessment-result-title",children:"Summary"}),l.jsx("textarea",{className:"assessment-result-text",rows:"6",placeholder:"Enter overall assessment summary...",value:n.assessmentSummary,onChange:t=>e("assessmentSummary",null,t.target.value),required:!0})]}),n.assessmentTools.map((t,s)=>l.jsxs("div",{className:"assessment-result-block",children:[l.jsxs("h4",{className:"assessment-result-title",children:[String.fromCharCode(65+s),". ",t.tool]}),l.jsx("textarea",{className:"assessment-result-text",rows:"5",placeholder:"Enter recommendations for this area...",value:t.recommendation||"",onChange:i=>{const o=[...n.assessmentTools];o[s].recommendation=i.target.value,e("assessmentTools",null,o)},required:!0})]},s))]})}function SF({data:n,onChange:e}){const[t,s]=I.useState(n.oneOnOneServices||[]),[i,o]=I.useState(n.groupClassServices||[]),{data:u=[]}=ls({queryKey:["services"],queryFn:()=>bi.getAllServices(),staleTime:1e3*60*5}),{data:h=[],isLoading:f}=ls({queryKey:["staff"],queryFn:()=>Ls.getAllStaff(),staleTime:1e3*60*5}),p=u.filter(j=>(n.backgroundHistory?.interventions||[]).map(O=>O.serviceId).includes(j.id)),g=h.filter(j=>j.role==="teacher"),x=h.filter(j=>j.role==="therapist"),b=j=>{const N={serviceId:"",serviceName:"",serviceType:"",staffId:"",staffName:""};if(j==="oneOnOne"){const R=[...t,N];s(R),e("oneOnOneServices",R)}else{const R=[...i,N];o(R),e("groupClassServices",R)}},S=(j,N)=>{const O=(j==="oneOnOne"?t:i).filter((V,B)=>B!==N);j==="oneOnOne"?(s(O),e("oneOnOneServices",O)):(o(O),e("groupClassServices",O))},w=(j,N,R)=>{const O=p.find(G=>G.id===R);if(!O)return;const k=(O.type==="Therapy"?x:g).find(G=>G.specializations?.some(ne=>ne.trim().toLowerCase()===O.name.trim().toLowerCase())),me=(j==="oneOnOne"?t:i).map((G,ne)=>ne===N?{serviceId:O.id,serviceName:O.name,serviceType:O.type,staffId:k?.uid||"",staffName:k?`${k.firstName} ${k.lastName}`:""}:G);j==="oneOnOne"?(s(me),e("oneOnOneServices",me)):(o(me),e("groupClassServices",me))},A=(j,N,R)=>{const O=j==="oneOnOne"?t:i,fe=(O[N].serviceType==="Therapy"?x:g).find(G=>G.uid===R),me=O.map((G,ne)=>ne===N?{...G,staffId:fe?.uid||"",staffName:fe?`${fe.firstName} ${fe.lastName}`:""}:G);j==="oneOnOne"?(s(me),e("oneOnOneServices",me)):(o(me),e("groupClassServices",me))},C=(j,N)=>!j||!N?[]:(N==="Therapy"?x:g).filter(V=>V.specializations?.some(B=>B.trim().toLowerCase()===j.trim().toLowerCase())),L={width:"100%",padding:"10px 35px 10px 12px",fontSize:"0.95rem",fontFamily:"inherit",color:"#1e293b",backgroundColor:"#ffffff",border:"1px solid #cbd5e1",borderRadius:"6px",outline:"none",cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center"},z={...L,backgroundColor:"#f1f5f9",color:"#94a3b8",cursor:"not-allowed",opacity:.6},U={...L,borderColor:"#ef4444",backgroundColor:"#fef2f2"},F={...L,borderColor:"#10b981"},K=j=>(j==="oneOnOne"?t:i).filter(R=>R.serviceId).map(R=>R.serviceId),Z=(j,N)=>{const R=N==="oneOnOne"?"Therapy":"Class";return l.jsxs(l.Fragment,{children:[j.length>0&&l.jsxs("div",{className:"assessment-tools-header",children:[l.jsx("label",{children:"Service"}),l.jsx("label",{children:"Assigned Staff"})]}),j.map((O,V)=>{const B=C(O.serviceName,O.serviceType),k=O.serviceId&&B.length===0;return l.jsxs("div",{className:"assessment-tool-row",style:{alignItems:"center"},children:[l.jsx("div",{className:"assessment-tool-field",children:l.jsxs("select",{value:O.serviceId,onChange:fe=>w(N,V,fe.target.value),style:O.serviceId&&!k?F:L,children:[l.jsxs("option",{value:"",children:["-- Select ",R," --"]}),p.filter(fe=>{if(fe.type!==R)return!1;const me=K(N);return fe.id===O.serviceId?!0:!me.includes(fe.id)}).map(fe=>l.jsx("option",{value:fe.id,children:fe.name},fe.id))]})}),l.jsxs("div",{className:"assessment-tool-field",children:[l.jsxs("select",{value:O.staffId,onChange:fe=>A(N,V,fe.target.value),disabled:!O.serviceId,style:O.serviceId?k?U:O.staffId?F:L:z,children:[l.jsxs("option",{value:"",children:["-- Select"," ",R==="Therapy"?"Therapist":"Teacher"," --"]}),B.map(fe=>l.jsxs("option",{value:fe.uid,children:[fe.firstName," ",fe.lastName]},fe.uid))]}),k&&l.jsxs("small",{style:{color:"#ef4444",fontSize:"0.75rem",marginTop:"5px",display:"block"},children:[" No qualified staff available for ",O.serviceName]})]}),l.jsx("button",{type:"button",className:"remove-entry-btn",onClick:()=>S(N,V),style:{marginTop:"0px"},children:""})]},`${N}-${V}`)})]})};return f?l.jsx("div",{className:"form-section",children:l.jsx("p",{style:{textAlign:"center",padding:"2rem",color:"#64748b"},children:"Loading staff and services..."})}):l.jsxs("div",{className:"form-section",children:[l.jsx("h3",{children:"IX. ENROLLMENT"}),l.jsx("p",{style:{color:"#64748b",marginBottom:"20px",fontSize:"0.95rem"},children:"Assign services and their respective teachers or therapists to this student."}),!1,l.jsxs("div",{style:{marginBottom:"30px"},children:[l.jsx("h4",{style:{fontSize:"1rem",color:"#334155",marginBottom:"15px"},children:"1 ON 1 SERVICE"}),Z(t,"oneOnOne"),l.jsx("button",{type:"button",className:"add-point-btn",onClick:()=>b("oneOnOne"),children:"+ Add 1 on 1 Service"})]}),l.jsx("hr",{style:{border:"0",borderTop:"1px solid #e2e8f0",margin:"30px 0"}}),l.jsxs("div",{style:{marginBottom:"30px"},children:[l.jsx("h4",{style:{fontSize:"1rem",color:"#334155",marginBottom:"15px"},children:"GROUP CLASS"}),Z(i,"groupClass"),l.jsx("button",{type:"button",className:"add-point-btn",onClick:()=>b("groupClass"),children:"+ Add Group Class"})]}),t.length===0&&i.length===0&&l.jsxs("div",{style:{padding:"40px 30px",textAlign:"center",color:"#94a3b8",backgroundColor:"#f8fafc",borderRadius:"8px",border:"2px dashed #e2e8f0"},children:[l.jsx("div",{style:{fontSize:"3rem",marginBottom:"10px",opacity:.5},children:""}),l.jsx("div",{children:"No services assigned yet."})]})]})}function Fj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}class wF{async createOrUpdateAssessment(e,t){try{const s=t.id||Fj(),i=at(Ee,"assessments",s),o={...t,id:s,childId:e,updatedAt:as(),createdAt:t.createdAt||as()};return await ml(i,o,{merge:!0}),s}catch(s){throw console.error("Error in assessmentService:",s),s}}async getAssessment(e){if(!e)throw new Error("Assessment ID is required");const t=at(Ee,"assessments",e),s=await ra(t);if(!s.exists())throw new Error("Assessment not found");return s.data()}}const C_=new wF,$d={firstName:"",middleName:"",lastName:"",nickname:"",dateOfBirth:"",gender:"",relationshipToClient:"biological child",photoUrl:"",active:!0,address:"",school:"",gradeLevel:"",assessmentDates:new Date().toISOString().split("T")[0],examiner:"",ageAtAssessment:"",oneOnOneServices:[],groupClassServices:[],reasonForReferral:"",purposeOfAssessment:[],backgroundHistory:{familyBackground:"",familyRelationships:"",dailyLifeActivities:"",medicalHistory:"",developmentalBackground:[{devBgTitle:"",devBgInfo:""}],schoolHistory:"",clinicalDiagnosis:"",interventions:[],strengthsAndInterests:"",socialSkills:""},behaviorDuringAssessment:"",assessmentTools:[{tool:"",details:"",result:"",recommendation:""}],assessmentSummary:""};function EF({show:n,onClose:e,onSave:t,selectedParent:s,editingStudent:i}){const[o,u]=I.useState(1),[h,f]=I.useState(!1),[p,g]=I.useState($d),[x,b]=I.useState(!1),S=(R=o,O=p)=>{switch(R){case 1:return!!(O.firstName&&O.lastName&&O.gender&&O.dateOfBirth&&O.assessmentDates&&O.examiner);case 2:return!!O.reasonForReferral;case 3:return!!(O.purposeOfAssessment?.length>0&&O.purposeOfAssessment.every(k=>k));case 4:return!!(O.backgroundHistory?.familyBackground&&O.backgroundHistory?.familyRelationships&&O.backgroundHistory?.dailyLifeActivities&&O.backgroundHistory?.medicalHistory&&O.backgroundHistory?.developmentalBackground?.length>0&&O.backgroundHistory?.developmentalBackground.every(k=>k.devBgTitle&&k.devBgInfo)&&O.backgroundHistory?.schoolHistory&&O.backgroundHistory?.clinicalDiagnosis&&O.backgroundHistory?.interventions?.length>0&&O.backgroundHistory?.interventions.every(k=>k.name&&k.frequency)&&O.backgroundHistory?.strengthsAndInterests&&O.backgroundHistory?.socialSkills);case 5:return!!O.behaviorDuringAssessment;case 6:return O.assessmentTools?.length>0&&O.assessmentTools.every(k=>k.tool&&k.details);case 7:return O.assessmentTools?.every(k=>k.result);case 8:return!!O.assessmentSummary&&O.assessmentTools?.every(k=>k.recommendation);case 9:const V=O.oneOnOneServices?.length>0&&O.oneOnOneServices.every(k=>k.serviceId&&k.staffId),B=O.groupClassServices?.length>0&&O.groupClassServices.every(k=>k.serviceId&&k.staffId);return V||B;default:return!0}},w=(R=p)=>{for(let O=1;O<=9;O++)if(!S(O,R))return O;return 9};if(I.useEffect(()=>{if(n){const R=i?{...$d,...i,backgroundHistory:{...$d.backgroundHistory,...i.backgroundHistory||{}},assessmentTools:i.assessmentTools||$d.assessmentTools,purposeOfAssessment:i.purposeOfAssessment||[]}:$d;g(R),u(w(R)),b(!1)}},[n,i]),!n)return null;const A=R=>{if(!R)return"";const O=new Date(R),V=new Date;let B=V.getFullYear()-O.getFullYear();const k=V.getMonth()-O.getMonth();return(k<0||k===0&&V.getDate()<O.getDate())&&B--,B>=0?B.toString():""},C=(R,O)=>{g(V=>{const B={...V,[R]:O};return R==="dateOfBirth"&&(B.ageAtAssessment=A(O)),B})},L=(R,O,V)=>{g(B=>({...B,[R]:O===null?V:{...B[R],[O]:V}}))},z=()=>S(o,p),U=async R=>{f(!0);try{const O=p.childId||p.id||Fj(),V={id:p.assessmentId||null,reasonForReferral:p.reasonForReferral,purposeOfAssessment:p.purposeOfAssessment,backgroundHistory:p.backgroundHistory,behaviorDuringAssessment:p.behaviorDuringAssessment,assessmentTools:p.assessmentTools,assessmentSummary:p.assessmentSummary},B=await C_.createOrUpdateAssessment(O,V);g(me=>({...me,assessmentId:B,childId:O}));const k={firstName:p.firstName,middleName:p.middleName,lastName:p.lastName,nickname:p.nickname,dateOfBirth:p.dateOfBirth,gender:p.gender,relationshipToClient:p.relationshipToClient,photoUrl:p.photoUrl,active:p.active,address:p.address,school:p.school,gradeLevel:p.gradeLevel,assessmentDates:p.assessmentDates,examiner:p.examiner,ageAtAssessment:p.ageAtAssessment,oneOnOneServices:p.oneOnOneServices||[],groupClassServices:p.groupClassServices||[],status:R?"ENROLLED":"ASSESSING",assessmentId:B,childId:O},fe=await Vr.createOrUpdateChild(s.uid||s.id,k);try{await Ls.addChildToParent(s.uid||s.id,fe.id)}catch(me){console.warn("Failed to link child to parent:",me)}t(fe),e(),alert(R?"Student enrolled successfully!":"Progress saved!")}catch(O){console.error("Save error:",O),alert("Failed to save student: "+O.message)}finally{f(!1)}},F=async()=>{if(!z()){alert("Please fill in all required fields before proceeding.");return}o===9?await U(!0):u(o+1)},K=()=>b(!0),Z=()=>{b(!1),e()},j=async()=>{b(!1),await U(!1),e()},N=()=>({1:"I. IDENTIFYING DATA",2:"II. REASON FOR REFERRAL",3:"III. PURPOSE OF ASSESSMENT",4:"IV. BACKGROUND HISTORY",5:"V. BEHAVIOR DURING ASSESSMENT",6:"VI. ASSESSMENT TOOLS AND MEASURES",7:"VII. ASSESSMENT RESULTS",8:"VIII. SUMMARY AND RECOMMENDATIONS",9:"IX. SERVICE ENROLLMENT"})[o]||"Assessment Section";return l.jsxs("div",{className:"modalOverlay",children:[l.jsxs("div",{className:"multi-step-modal",children:[l.jsxs("div",{className:"modal-header-sticky",children:[l.jsxs("div",{className:"modal-header-flex",children:[l.jsxs("h2",{children:["Step ",o,"/9: ",N()]}),l.jsx("button",{className:"close-x-btn",onClick:K,disabled:h,type:"button",children:""})]}),l.jsx("div",{className:"step-indicator",children:[1,2,3,4,5,6,7,8,9].map(R=>l.jsx("div",{className:`step-dot ${o>=R?"active":""}`},R))})]}),l.jsxs("div",{className:"enroll-form-scroll",children:[o===1&&l.jsx(pF,{data:p,onChange:C}),o===2&&l.jsx(mF,{data:p,onChange:C}),o===3&&l.jsx(gF,{data:p,onChange:C}),o===4&&l.jsx(yF,{data:p,onChange:L}),o===5&&l.jsx(vF,{data:p,onChange:C}),o===6&&l.jsx(xF,{data:p,onChange:L}),o===7&&l.jsx(bF,{data:p,onChange:L}),o===8&&l.jsx(_F,{data:p,onChange:L}),o===9&&l.jsx(SF,{data:p,onChange:C})]}),l.jsxs("div",{className:"modalActions sticky-footer",children:[l.jsxs("div",{className:"left-actions",children:[l.jsx("button",{className:"save-draft-btn",onClick:()=>U(!1),disabled:h,type:"button",children:h?"Saving...":"Save Progress"}),l.jsx("button",{className:"cancel-btn-alt",onClick:K,disabled:h,type:"button",children:"Cancel"})]}),l.jsxs("div",{className:"right-actions",children:[o>1&&l.jsx("button",{className:"cancel-btn",onClick:()=>u(o-1),disabled:h,type:"button",children:"Back"}),l.jsx("button",{className:"create-btn",onClick:F,disabled:h,type:"button",children:h?"Saving...":o===9?"Finalize & Enroll":"Next Step"})]})]})]}),x&&l.jsx("div",{className:"modalOverlay",style:{zIndex:1001},children:l.jsxs("div",{className:"multi-step-modal",style:{maxWidth:"450px",maxHeight:"auto"},children:[l.jsx("div",{className:"modal-header-sticky",children:l.jsx("div",{className:"modal-header-flex",children:l.jsx("h2",{style:{fontSize:"1.25rem"},children:" Unsaved Changes"})})}),l.jsxs("div",{className:"enroll-form-scroll",style:{padding:"2rem"},children:[l.jsx("p",{style:{margin:"0 0 1.5rem 0",color:"#64748b",lineHeight:"1.6"},children:"You have unsaved changes. What would you like to do?"}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l.jsx("button",{onClick:j,disabled:h,style:{padding:"0.875rem 1.5rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"0.5rem",fontWeight:"600",cursor:"pointer",fontSize:"0.9375rem"},children:" Save Progress & Close"}),l.jsx("button",{onClick:Z,style:{padding:"0.875rem 1.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"0.5rem",fontWeight:"600",cursor:"pointer",fontSize:"0.9375rem"},children:" Discard Changes & Close"}),l.jsx("button",{onClick:()=>b(!1),style:{padding:"0.875rem 1.5rem",backgroundColor:"#f1f5f9",color:"#334155",border:"none",borderRadius:"0.5rem",fontWeight:"600",cursor:"pointer",fontSize:"0.9375rem"},children:" Continue Editing"})]})]})]})})]})}function TF(){const{data:n=[],isLoading:e}=aF(),[t,s]=I.useState(null),[i,o]=I.useState(""),[u,h]=I.useState(null),[f,p]=I.useState(null),[g,x]=I.useState(!1),[b,S]=I.useState(!1),[w,A]=I.useState(null),[C,L]=I.useState(!1),[z,U]=I.useState(null),[F,K]=I.useState(!1),[Z,j]=I.useState({firstName:"",middleName:"",lastName:"",email:"",phone:""}),{data:N=[],isLoading:R}=oF(t?.uid),{invalidateParents:O,invalidateChildrenByParent:V}=lF(),B=Nn(),k=kn(),fe=async le=>{le.preventDefault(),K(!0);try{const{email:M,...W}=Z,H=await Wi.createParentAccount(M,{...W,email:M});O(),x(!1),j({firstName:"",middleName:"",lastName:"",email:"",phone:""}),U({uid:H.uid,firstName:W.firstName,lastName:W.lastName,email:M,activationCode:H.activationCode}),L(!0)}catch(M){console.error("Creation Error:",M),alert(`Failed to create parent: ${M.message}`)}finally{K(!1)}},me=()=>{L(!1),U(null)};I.useEffect(()=>{k.state?.selectedParent&&s(k.state.selectedParent)},[k.state]);const G=async le=>{if(le.status==="ASSESSING")try{const M=await C_.getAssessment(le.assessmentId),W={...le,...M};A(W),S(!0)}catch(M){console.error("Failed to load assessment data:",M),alert("Failed to load student assessment data. Please try again.")}else le.status==="ENROLLED"&&B("/admin/StudentProfile",{state:{studentId:le.id,fromEnrollment:!0,parent:t}})},ne=le=>{t?.uid&&V(t.uid),A(null)},Y=()=>{S(!1),A(null)},ge=n.filter(le=>`${le.firstName} ${le.middleName} ${le.lastName}`.toLowerCase().includes(i.toLowerCase()));return l.jsxs("div",{className:"ooo-container",children:[l.jsx(To,{}),l.jsxs("div",{className:"ooo-main",children:[l.jsxs("div",{className:"ooo-header",children:[l.jsxs("div",{className:"header-title",children:[l.jsx("h1",{children:"STUDENT ENROLLMENT"}),l.jsx("p",{className:"header-subtitle",children:"Manage accounts and enrollment progress"})]}),l.jsxs("div",{className:"search-wrapper",children:[l.jsx("span",{className:"search-icon",children:""}),l.jsx("input",{className:"sp-search",placeholder:"Search by name...",value:i,onChange:le=>o(le.target.value)})]})]}),l.jsx("div",{className:"ooo-content-area",children:t?l.jsxs("div",{className:"profile-wrapper",children:[l.jsxs("div",{className:"profile-top",children:[l.jsx("span",{className:"back-arrow",onClick:()=>s(null),children:""}),l.jsxs("h2",{children:[t.lastName," Family"]})]}),l.jsxs("div",{className:"profile-info",children:[l.jsx("h3",{className:"services-header",children:"Family Children"}),l.jsx("div",{className:"services-list",children:R?l.jsx("p",{style:{textAlign:"center",padding:"20px"},children:"Loading children..."}):N.length===0?l.jsx("p",{style:{textAlign:"center",padding:"20px"},children:"No children enrolled yet"}):N.map(le=>l.jsxs("div",{className:"service-row",onClick:()=>G(le),style:{cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:M=>{M.currentTarget.style.backgroundColor="rgba(0, 123, 255, 0.05)"},onMouseLeave:M=>{M.currentTarget.style.backgroundColor="transparent"},children:[l.jsxs("div",{className:"service-left",children:[" ",le.lastName,", ",le.firstName," ",le.nickname?`"${le.nickname}"`:""]}),l.jsxs("div",{className:`status-badge ${le.status?.toLowerCase()||"enrolled"}`,children:[le.status||"ENROLLED",le.status==="ASSESSING"&&""]})]},le.id))})]})]}):l.jsx("div",{className:"ooo-grid",children:ge.map(le=>l.jsxs("div",{className:"ooo-card",onClick:()=>s(le),children:[l.jsx("div",{className:"ooo-photo-area",children:""}),l.jsxs("div",{className:"ooo-card-info",children:[l.jsxs("p",{className:"ooo-name",children:[le.lastName,", ",le.firstName," ",le.middleName?le.middleName[0]+".":""]}),le.accountStatus==="pending_setup"&&l.jsx("span",{style:{fontSize:"11px",backgroundColor:"#fef3c7",color:"#92400e",padding:"2px 6px",borderRadius:"4px",marginTop:"4px",display:"inline-block"},children:" Pending Activation"})]})]},le.uid))})}),t?l.jsx("button",{className:"add-fab",onClick:()=>S(!0),children:"+ Enroll Student"}):l.jsx("button",{className:"add-fab secondary-fab",onClick:()=>x(!0),children:"+ Parent / Guardian Account"}),g&&l.jsx("div",{className:"modalOverlay",children:l.jsxs("div",{className:"modal",children:[l.jsx("h2",{className:"services-header create-parent-header",children:"New Parent / Guardian Account"}),l.jsxs("form",{className:"parent-form",onSubmit:fe,children:[l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"First Name"}),l.jsx("input",{type:"text",required:!0,value:Z.firstName,onChange:le=>j({...Z,firstName:le.target.value})})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Middle Name"}),l.jsx("input",{type:"text",value:Z.middleName,onChange:le=>j({...Z,middleName:le.target.value})})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Last Name"}),l.jsx("input",{type:"text",required:!0,value:Z.lastName,onChange:le=>j({...Z,lastName:le.target.value})})]})]}),f&&l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Photo Preview"}),l.jsx("img",{src:f,alt:"Preview",style:{maxWidth:"100px",borderRadius:"8px"}})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Email Address"}),l.jsx("input",{type:"email",required:!0,value:Z.email,onChange:le=>j({...Z,email:le.target.value})})]}),l.jsxs("div",{className:"input-group",children:[l.jsx("label",{children:"Phone Number"}),l.jsx("input",{type:"tel",value:Z.phone,onChange:le=>j({...Z,phone:le.target.value}),placeholder:"09XX-XXX-XXXX"})]}),l.jsxs("div",{style:{backgroundColor:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:"6px",padding:"12px",marginTop:"8px",fontSize:"13px",color:"#0369a1"},children:[l.jsx("strong",{children:" How activation works:"}),l.jsx("p",{style:{margin:"4px 0 0 0"},children:"After creating the account, a QR code will appear. The parent can scan it to set up their password."})]})]}),l.jsxs("div",{className:"modalActions",children:[l.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>x(!1),disabled:F,children:"Cancel"}),l.jsx("button",{type:"submit",className:"create-btn",onClick:fe,disabled:F,children:F?"Creating...":"Create Account"})]})]})}),t&&l.jsx(EF,{show:b,onClose:Y,selectedParent:t,onSave:ne,editingStudent:w}),l.jsx(Kg,{isOpen:C,onClose:me,userData:z,onEmailSent:()=>console.log("Activation email sent")}),l.jsx(Og,{pageLabel:"Enrollment"})]})]})}const AF=()=>{const[n,e]=I.useState([]),[t,s]=I.useState(!0),[i,o]=I.useState(null),[u,h]=I.useState({firstName:"",lastName:"",email:"",phone:"",password:"Welcome123!"});I.useEffect(()=>{f()},[]);const f=async()=>{try{s(!0);const b=await Ls.getUsersByRole("admin");e(b)}catch(b){o(b.message)}finally{s(!1)}};return{admins:n,loading:t,error:i,newAdmin:u,handleInputChange:b=>{const{name:S,value:w}=b.target;h(A=>({...A,[S]:w}))},createAdmin:async b=>{b.preventDefault(),o(null);try{await Wi.createAdminAccount(u.email,u.password,u),h({firstName:"",lastName:"",email:"",phone:"",password:"Welcome123!"}),f(),alert("Admin created successfully")}catch(S){o(S.message)}},deleteAdmin:async b=>{if(window.confirm("Are you sure you want to delete this admin?"))try{await Ls.deleteUser(b),f()}catch(S){o(S.message)}}}},CF=()=>{const{admins:n,loading:e,error:t,newAdmin:s,handleInputChange:i,createAdmin:o,deleteAdmin:u}=AF();return e?l.jsx("div",{children:"Loading admins..."}):l.jsxs("div",{style:{display:"flex",minHeight:"100vh"},children:[l.jsx(To,{}),l.jsxs("div",{style:{padding:"20px",width:"100%",backgroundColor:"#f8f9fa"},children:[l.jsx("h1",{style:{color:"#2c3e50"},children:"Manage Administrators"}),t&&l.jsxs("div",{style:{color:"red",marginBottom:"10px"},children:["Error: ",t]}),l.jsxs("div",{style:{border:"1px solid #ddd",padding:"25px",marginBottom:"30px",borderRadius:"12px",backgroundColor:"#fff",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},children:[l.jsx("h3",{style:{marginTop:0,color:"#444"},children:"Add New Admin"}),l.jsxs("form",{onSubmit:o,children:[l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",alignItems:"end"},children:[l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"First Name"}),l.jsx("input",{name:"firstName",placeholder:"First Name",value:s.firstName,onChange:i,required:!0,style:{padding:"10px",width:"100%",border:"1px solid #ccc",borderRadius:"6px"}})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Last Name"}),l.jsx("input",{name:"lastName",placeholder:"Last Name",value:s.lastName,onChange:i,required:!0,style:{padding:"10px",width:"100%",border:"1px solid #ccc",borderRadius:"6px"}})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Email"}),l.jsx("input",{name:"email",type:"email",placeholder:"Email",value:s.email,onChange:i,required:!0,style:{padding:"10px",width:"100%",border:"1px solid #ccc",borderRadius:"6px"}})]}),l.jsxs("div",{children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"600"},children:"Phone"}),l.jsx("input",{name:"phone",placeholder:"Phone",value:s.phone,onChange:i,style:{padding:"10px",width:"100%",border:"1px solid #ccc",borderRadius:"6px"}})]}),l.jsx("div",{children:l.jsx("button",{type:"submit",style:{padding:"12px",backgroundColor:"#2ecc71",color:"white",border:"none",cursor:"pointer",fontWeight:"bold",borderRadius:"6px",width:"100%"},children:"+ Create Admin"})})]}),l.jsxs("div",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:["Default Password: ",l.jsx("strong",{children:s.password})]})]})]}),l.jsxs("h3",{style:{color:"#444"},children:["Existing Admins (",n.length,")"]}),l.jsx("div",{style:{overflowX:"auto"},children:l.jsxs("table",{border:"0",cellPadding:"15",style:{width:"100%",backgroundColor:"white",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 5px rgba(0,0,0,0.05)",borderCollapse:"collapse"},children:[l.jsx("thead",{style:{backgroundColor:"#34495e",color:"white"},children:l.jsxs("tr",{children:[l.jsx("th",{style:{textAlign:"left"},children:"Name"}),l.jsx("th",{style:{textAlign:"left"},children:"Email"}),l.jsx("th",{style:{textAlign:"left"},children:"Phone"}),l.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),l.jsxs("tbody",{children:[n.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:"4",style:{textAlign:"center",padding:"20px",color:"#888"},children:"No admins found."})}),n.map(h=>l.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[l.jsxs("td",{children:[h.firstName," ",h.lastName]}),l.jsx("td",{children:h.email}),l.jsx("td",{children:h.phone||"N/A"}),l.jsx("td",{style:{textAlign:"center"},children:l.jsx("button",{onClick:()=>u(h.uid),style:{backgroundColor:"#e74c3c",color:"white",border:"none",padding:"6px 12px",cursor:"pointer",borderRadius:"4px",fontSize:"13px"},children:"Delete"})})]},h.uid))]})]})})]})]})},N_=()=>{const{currentUser:n,logout:e}=In(),t=Nn(),s=kn(),[i,o]=I.useState(!1),[u,h]=I.useState(window.innerWidth>=768),f=async()=>{await e(),t("/login")},p=g=>s.pathname===g;return I.useEffect(()=>{const g=()=>{window.innerWidth>=768?(h(!0),o(!0)):(h(!1),o(!1))};return window.addEventListener("resize",g),g(),()=>window.removeEventListener("resize",g)},[]),l.jsxs(l.Fragment,{children:[!u&&l.jsx("button",{className:"open-btn",onClick:()=>o(g=>!g),children:i?"":""}),l.jsxs("div",{className:`parent-sidebar ${i?"open":"closed"}`,children:[l.jsxs("div",{className:"profile-section",children:[l.jsx("div",{className:"avatar",children:""}),l.jsxs("div",{children:[l.jsx("div",{className:"role-label",children:"PARENT"}),l.jsx("div",{className:"profile-name",children:n?.firstName||"Parent"})]})]}),l.jsxs("div",{className:"menu-section",children:[l.jsx("div",{className:"section-title",children:"MAIN"}),l.jsxs("div",{className:`menu-item ${p("/parent/dashboard")?"active":""}`,onClick:()=>t("/parent/dashboard"),children:[l.jsxs("svg",{className:"menu-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),l.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),l.jsx("span",{className:"menu-label",children:"MY CHILDREN"})]}),l.jsxs("div",{className:`menu-item ${p("/parent/concerns")?"active":""}`,onClick:()=>t("/parent/concerns"),children:[l.jsx("svg",{className:"menu-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),l.jsx("span",{className:"menu-label",children:"CONCERNS"})]})]}),l.jsx("button",{className:"logout-btn",onClick:f,children:"LOG OUT"})]})]})},NF=n=>{const e=Fl(),t=n?.student||null,s=n?.activities||[],[i,o]=I.useState(t?.id||null),[u,h]=I.useState(""),[f,p]=I.useState("all"),{data:g=[],isLoading:x}=ls({queryKey:["students"],queryFn:()=>Vr.getAllChildren(),initialData:t?[t]:void 0});I.useEffect(()=>{n?.studentId&&o(n.studentId)},[n?.studentId]);const b=I.useMemo(()=>i?g.find(F=>F.id===i)||t:null,[g,i,t]),{data:S=[]}=ls({queryKey:["activities",i],queryFn:async()=>(await Ug.getActivitiesByChild(i)).sort((K,Z)=>new Date(Z.date)-new Date(K.date)),enabled:!!i,initialData:s.length?s:void 0}),{data:w=null}=ls({queryKey:["parent",b?.parentId],queryFn:()=>Ls.getUserById(b.parentId),enabled:!!b?.parentId}),{data:A=null,isLoading:C,error:L}=ls({queryKey:["assessment",b?.assessmentId],queryFn:async()=>b?.assessmentId?await C_.getAssessment(b.assessmentId):null,enabled:!!b?.assessmentId}),z=I.useMemo(()=>g.filter(F=>{if(!`${F.firstName} ${F.lastName}`.toLowerCase().includes(u.toLowerCase()))return!1;const Z=F.enrolledServices?.some(N=>N.type==="Therapy")||F.therapyServices?.length>0,j=F.enrolledServices?.some(N=>N.type==="Class")||F.groupClasses?.length>0;return f==="therapy"?Z:f==="group"?j:f==="none"?!Z&&!j:!0}),[g,u,f]);return{loading:x,students:g,selectedStudent:b,setSelectedStudent:F=>o(F?F.id:null),searchTerm:u,setSearchTerm:h,filterType:f,setFilterType:p,filteredStudents:z,studentActivities:S,parentData:w,assessmentData:A,isAssessmentLoading:C,assessmentError:L,refreshData:()=>{e.invalidateQueries({queryKey:["students"]}),b?.assessmentId&&e.invalidateQueries({queryKey:["assessment",b.assessmentId]})}}},IF=({childData:n,assessmentData:e})=>{if(!n&&!e)return null;const t={...n||{},...e||{}},{reasonForReferral:s,purposeOfAssessment:i,backgroundHistory:o,behaviorDuringAssessment:u,assessmentTools:h,assessmentSummary:f,examiner:p,assessmentDates:g,ageAtAssessment:x}=t,b=o||{};return l.jsxs("div",{className:"assessment-history-container",children:[l.jsxs("div",{className:"history-top-header",children:[l.jsx("h2",{className:"report-main-title",children:"ASSESSMENT REPORT"}),l.jsxs("div",{className:"report-meta-grid",children:[l.jsxs("div",{className:"meta-item",children:[l.jsx("span",{className:"label",children:"Examiner:"})," ",p||"N/A"]}),l.jsxs("div",{className:"meta-item",children:[l.jsx("span",{className:"label",children:"Date(s):"})," ",Array.isArray(g)?g.join(", "):g||"N/A"]}),l.jsxs("div",{className:"meta-item",children:[l.jsx("span",{className:"label",children:"Age at Assessment:"})," ",x||"N/A"]})]})]}),l.jsxs("section",{className:"report-section",children:[l.jsx("h3",{className:"report-heading",children:"II. REASON FOR REFERRAL"}),l.jsx("p",{className:"report-text",children:s||"No information provided."})]}),l.jsxs("section",{className:"report-section",children:[l.jsx("h3",{className:"report-heading",children:"III. PURPOSE OF ASSESSMENT"}),i&&i.length>0?l.jsx("ol",{className:"report-list",children:i.map((S,w)=>l.jsx("li",{children:S},w))}):l.jsx("p",{className:"report-text",children:"No purpose listed."})]}),l.jsxs("section",{className:"report-section",children:[l.jsx("h3",{className:"report-heading",children:"IV. BACKGROUND HISTORY"}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Family Background:"}),l.jsx("p",{className:"report-text",children:b.familyBackground||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Family Relationships:"}),l.jsx("p",{className:"report-text",children:b.familyRelationships||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Daily Life & Activities:"}),l.jsx("p",{className:"report-text",children:b.dailyLifeActivities||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Medical History:"}),l.jsx("p",{className:"report-text",children:b.medicalHistory||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Developmental Background:"}),b.developmentalBackground&&b.developmentalBackground.length>0?l.jsx("ul",{className:"report-list bulleted",children:b.developmentalBackground.map((S,w)=>l.jsxs("li",{children:[l.jsxs("strong",{children:[S.devBgTitle,":"]})," ",S.devBgInfo]},w))}):l.jsx("p",{className:"report-text",children:"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"School History:"}),l.jsx("p",{className:"report-text",children:b.schoolHistory||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Clinical Diagnosis:"}),l.jsx("p",{className:"report-text",children:b.clinicalDiagnosis||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Therapies/Interventions:"}),b.interventions&&b.interventions.length>0?l.jsx("ul",{className:"report-list bulleted",children:b.interventions.map((S,w)=>{if(!S)return l.jsx("li",{className:"report-text",children:"N/A"},w);if(typeof S=="string")return l.jsx("li",{children:S},w);const A=S.name||S.serviceName||S.serviceId||"Unnamed intervention",C=S.frequency?`  ${S.frequency}`:"";return l.jsxs("li",{children:[l.jsx("strong",{children:A}),C]},w)})}):l.jsx("p",{className:"report-text",children:"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Strengths & Interests:"}),l.jsx("p",{className:"report-text",children:b.strengthsAndInterests||"N/A"})]}),l.jsxs("div",{className:"sub-section",children:[l.jsx("h4",{children:"Social Skills:"}),l.jsx("p",{className:"report-text",children:b.socialSkills||"N/A"})]})]}),l.jsxs("section",{className:"report-section",children:[l.jsx("h3",{className:"report-heading",children:"V. BEHAVIOR DURING ASSESSMENT"}),l.jsx("p",{className:"report-text",children:u||"No information provided."})]}),l.jsxs("section",{className:"report-section assessment-results-joined",children:[l.jsx("h3",{className:"report-heading",children:"VI, VII, & VIII. ASSESSMENT TOOLS & MEASURES, RESULTS, RECOMMENDATIONS, & SUMMARY"}),h&&h.length>0?l.jsx("div",{className:"tools-list",children:h.map((S,w)=>l.jsxs("div",{className:"tool-card",children:[l.jsxs("div",{className:"tool-header",children:[l.jsxs("span",{className:"tool-index",children:[String.fromCharCode(65+w),"."]}),l.jsx("h4",{children:S.tool})]}),l.jsxs("div",{className:"tool-body",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Measure:"})," ",S.details]}),l.jsxs("div",{className:"result-box",children:[l.jsx("strong",{children:"Results:"}),l.jsx("p",{children:S.result||"No results recorded."})]}),S.recommendation&&l.jsxs("div",{className:"recommendation-box",children:[l.jsx("strong",{children:"Specific Recommendation:"}),l.jsx("p",{children:S.recommendation})]})]})]},w))}):l.jsx("p",{className:"report-text",children:"No assessment tools recorded."}),l.jsxs("div",{className:"summary-final-section",children:[l.jsx("h4",{className:"summary-title",children:"SUMMARY"}),l.jsx("div",{className:"summary-content-box",children:l.jsx("p",{className:"report-text",children:f||"No overall summary provided."})})]})]})]})},RF=({activities:n,teachers:e,selectedServiceName:t})=>{const[s,i]=I.useState(new Date);I.useEffect(()=>{i(new Date)},[t]);const o=g=>n.filter(x=>{const b=new Date(x.date);return b.getDate()===g.getDate()&&b.getMonth()===g.getMonth()&&b.getFullYear()===g.getFullYear()}),u=o(s),h=({date:g,view:x})=>x==="month"&&o(g).length>0?l.jsx("div",{className:"calendar-dot"}):null,f=g=>{const x=e.find(b=>b.id===g||b.uid===g);return x?`${x.firstName} ${x.lastName}`:""},p=g=>({Happy:"",Focused:"",Active:"",Tired:"",Upset:"",Social:""})[g]||"";return l.jsxs("div",{className:"calendar-view-container",children:[l.jsxs("div",{className:"day-details-section",children:[l.jsx("h3",{className:"date-heading",children:s.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),u.length===0?l.jsx("div",{className:"no-activity-msg",children:l.jsx("p",{children:"No activities recorded for this date."})}):l.jsx("div",{className:"daily-records-list",children:u.map((g,x)=>{const b=g.type==="therapy_session"||g._collection==="therapy_sessions";return l.jsxs("div",{className:"record-card",children:[l.jsxs("div",{className:"record-header",children:[l.jsx("span",{className:"record-type",children:g.serviceName||g.serviceType||"Activity"}),l.jsx("span",{style:{fontSize:"0.8rem",color:"#666",float:"right"},children:new Date(g.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),l.jsxs("p",{children:[l.jsx("span",{className:"label",children:"Staff:"})," ",g.authorName||g.teacherName||f(g.teacherId||g.authorId)]}),g.studentReaction?.length>0&&l.jsx("div",{style:{margin:"8px 0"},children:g.studentReaction.map((S,w)=>l.jsxs("span",{className:"reaction-tag",children:[p(S)," ",S]},w))}),l.jsxs("p",{children:[l.jsx("span",{className:"label",children:"Title:"})," ",g.title||""]}),b?l.jsxs(l.Fragment,{children:[g.sessionNotes&&l.jsxs("p",{children:[l.jsx("span",{className:"label",children:"Notes:"})," ",g.sessionNotes]}),l.jsxs("div",{style:{display:"grid",gap:"8px",marginTop:"8px"},children:[g.strengths&&l.jsxs("div",{className:"therapy-strength",children:[l.jsx("strong",{children:" Strengths:"})," ",g.strengths]}),g.weaknesses&&l.jsxs("div",{className:"therapy-weakness",children:[l.jsx("strong",{children:" Improvements:"})," ",g.weaknesses]})]}),g.homeActivities&&l.jsxs("div",{style:{marginTop:"8px"},children:[l.jsx("span",{className:"label",children:" Home Plan:"})," ",g.homeActivities]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:[l.jsx("span",{className:"label",children:"Description:"})," ",g.progressNotes||g.description||""]}),g.goalsAddressed&&l.jsxs("p",{children:[l.jsx("span",{className:"label",children:"Goals:"})," ",g.goalsAddressed.join(", ")]})]}),g.photoUrls?.length>0&&l.jsx("div",{style:{marginTop:"10px"},children:g.photoUrls.map((S,w)=>l.jsx("img",{className:"activity-image-preview",src:S,alt:"activity",onClick:()=>window.open(S,"_blank")},w))})]},x)})})]}),l.jsx("div",{className:"calendar-section",children:l.jsx(Cj,{onChange:i,value:s,tileContent:h,className:"custom-calendar"})})]})},No=()=>l.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:l.jsx("div",{children:"Loading..."})}),zj=({isParentView:n=!1,childIdFromRoute:e=null,hideSidebar:t=!1,noContainer:s=!1})=>{I.useEffect(()=>(console.log("StudentProfile mounted",{isParentView:n,childIdFromRoute:e,hideSidebar:t,noContainer:s}),()=>console.log("StudentProfile unmounted")),[n,e,t,s]);const i=kn(),o=Nn(),{currentUser:u}=In(),h=i.state?.studentId,f=i.state?.fromEnrollment,p=i.state?.parent,{loading:g,selectedStudent:x,setSelectedStudent:b,searchTerm:S,setSearchTerm:w,filterType:A,setFilterType:C,filteredStudents:L,studentActivities:z,refreshData:U,parentData:F,assessmentData:K,isAssessmentLoading:Z}=NF(i.state),[j,N]=I.useState(h||x||e?"profile":"list"),[R,O]=I.useState(""),[V,B]=I.useState(!1),[k,fe]=I.useState(!1),me=I.useRef(null);I.useEffect(()=>{n&&e&&!x&&!k&&(async()=>{try{const Bt=(await Vr.getChildrenByParentId(u.uid)).find(Ln=>Ln.id===e);if(!Bt){alert("Child not found or access denied"),o("/parent/dashboard");return}b(Bt),N("profile")}catch(It){console.error("Error loading child:",It),alert("Failed to load child data"),o("/parent/dashboard")}})()},[n,e,x,u,o,b,k]),I.useEffect(()=>{h&&x&&N("profile")},[h,x]);const{teachers:G}=Nj(),{therapists:ne}=p_(),Y=[...G||[],...ne||[]],[ge,le]=I.useState(!1),[M,W]=I.useState(null),[H,ce]=I.useState([]),[de,we]=I.useState({serviceId:"",staffId:""}),[Pe,tt]=I.useState(!1),He=Se=>{b(Se),N("profile"),B(!1),O("")},Rn=()=>{if(n){fe(!0),b(null),N("list");return}i.state?.fromOneOnOne?o("/admin/one-on-one",{state:{...i.state,level:"students"}}):f?o("/admin/enrollment",{state:{selectedParent:p}}):(b(null),N("list"))},us=Se=>{O(Se),setTimeout(()=>{me.current?.scrollIntoView({behavior:"smooth",block:"start"})},100)},ys=async Se=>{if(!n){W(Se),we({serviceId:"",staffId:""});try{const It=await bi.getServicesByType(Se),Bt=K?.backgroundHistory?.interventions||[],Ln=[...new Set(Bt.map(_s=>_s.serviceId).filter(Boolean))],Vs=[...x?.oneOnOneServices||[],...x?.groupClassServices||[]],bs=new Set(Vs.map(_s=>_s.serviceId)),Us=It.filter(_s=>Ln.includes(_s.id)&&!bs.has(_s.id));Us.length===0?(ce([]),alert("No services match the student's recorded interventions. Please review Step IV - Background History.")):ce(Us),le(!0)}catch(It){alert("Error loading services: "+It.message)}}},rr=async()=>{if(!de.serviceId||!de.staffId)return alert("Select service and staff.");tt(!0);try{const Se=H.find(bs=>bs.id===de.serviceId),It=M==="Therapy",Ln=(It?ne:G).find(bs=>(bs.uid||bs.id)===de.staffId),Vs={serviceId:Se.id,serviceName:Se.name,staffId:de.staffId,staffName:`${Ln.firstName} ${Ln.lastName}`,type:M,staffRole:It?"therapist":"teacher"};await Vr.assignService(x.id,Vs),await Ls.addSpecialization(de.staffId,Se.name),await U(),le(!1),alert("Service added and Staff updated!")}catch(Se){alert("Failed: "+Se.message)}finally{tt(!1)}};if(g)return l.jsx("div",{className:"loading-spinner",children:"Loading Student Data..."});const ot=Se=>{if(!Se)return"N/A";const It=Math.abs(new Date(Date.now()-new Date(Se).getTime()).getUTCFullYear()-1970);return isNaN(It)?"N/A":It},vs=[...x?.enrolledServices||[],...x?.oneOnOneServices||[],...x?.groupClassServices||[]],Zt=vs.filter(Se=>Se.serviceType==="Therapy"||Se.staffRole==="therapist"),ir=vs.filter(Se=>Se.serviceType==="Class"||Se.staffRole==="teacher"),zr=(Se,It)=>!Se||!It?[]:(It==="Therapy"?ne:G).filter(Ln=>Ln.specializations?.some(Vs=>Vs.trim().toLowerCase()===Se.trim().toLowerCase())),Pt=n?L.filter(Se=>Se.parentId===u.uid):L,Kt=n?N_:To,xs=l.jsxs("div",{className:"sp-main",children:[l.jsxs("div",{className:"sp-page",children:[j==="list"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"sp-header",children:[l.jsxs("div",{className:"header-title",children:[l.jsx("h1",{children:n?"MY CHILDREN":"STUDENT PROFILES"}),l.jsx("p",{className:"header-subtitle",children:n?"View your children's profiles and activities":"Manage enrolled students and view activities"})]}),l.jsxs("div",{className:"filter-actions",children:[l.jsxs("div",{className:"search-wrapper",children:[l.jsx("span",{className:"search-icon",children:""}),l.jsx("input",{className:"sp-search",placeholder:"Search by name...",value:S,onChange:Se=>w(Se.target.value)})]}),l.jsx("div",{className:"filter-wrapper",children:l.jsxs("select",{className:"sp-filter-select",value:A,onChange:Se=>C(Se.target.value),children:[l.jsx("option",{value:"all",children:"All Students"}),l.jsx("option",{value:"therapy",children:"Therapy Only"}),l.jsx("option",{value:"group",children:"Group Class Only"})]})})]})]}),l.jsx("div",{className:"sp-content-area",children:l.jsx("div",{className:"sp-grid",children:Pt.map(Se=>l.jsxs("div",{className:"sp-card",onClick:()=>He(Se),children:[l.jsx("div",{className:"sp-card-image-box",children:Se.photoUrl?l.jsx("img",{src:Se.photoUrl,className:"sp-photo",alt:""}):l.jsx("div",{className:"sp-photo-placeholder",children:Se.firstName[0]})}),l.jsx("div",{className:"sp-card-body",children:l.jsxs("h3",{className:"sp-name",children:[Se.firstName," ",Se.lastName]})})]},Se.id))})})]}),j==="profile"&&x&&l.jsxs("div",{className:"profile-wrapper",children:[l.jsx("div",{className:"profile-top",children:l.jsxs("div",{className:"left-group",children:[l.jsx("span",{className:"back-arrow",onClick:Rn,children:""}),l.jsx("h2",{children:n?`${x.firstName}'S PROFILE`:"STUDENT PROFILE"})]})}),l.jsxs("div",{className:"profile-3col",children:[l.jsx("div",{className:"profile-photo-frame",children:x.photoUrl?l.jsx("img",{src:x.photoUrl,className:"profile-photo",alt:"profile"}):l.jsx("div",{className:"profile-photo-placeholder",style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"3rem",background:"#eee"},children:x.firstName[0]})}),l.jsxs("div",{className:"profile-info",children:[l.jsxs("h1",{className:"profile-fullname",children:[x.lastName,", ",x.firstName]}),l.jsxs("div",{className:"profile-details",children:[l.jsxs("div",{className:"profile-left",children:[l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"Nickname:"})," ",x.nickname||"N/A"]}),l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"Address:"})," ",x.address||"N/A"]}),l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"Date of Birth:"})," ",x.dateOfBirth||"N/A"]}),l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"Current Age:"})," ",ot(x.dateOfBirth)??"N/A"]})]}),l.jsxs("div",{className:"profile-right",children:[l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"Gender:"})," ",x.gender||"N/A"]}),l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"School:"})," ",x.school||"N/A"]}),l.jsxs("p",{children:[l.jsx("span",{className:"icon",children:""})," ",l.jsx("b",{children:"Relationship to Guardian:"})," ",x.relationshipToClient||"N/A"]})]})]}),F&&l.jsxs("div",{style:{marginTop:"15px",paddingTop:"15px",borderTop:"1px solid #eee",fontSize:"0.95rem"},children:[l.jsxs("p",{style:{marginBottom:"5px"},children:[l.jsx("span",{style:{fontSize:"1.1em"},children:""})," ",l.jsx("b",{children:"Guardian:"})," ",F.firstName," ",F.lastName]}),l.jsxs("div",{style:{display:"flex",gap:"15px",flexWrap:"wrap",color:"#555"},children:[l.jsxs("span",{children:[" ",F.email]}),l.jsxs("span",{children:[" ",F.phone]})]})]}),l.jsx("div",{style:{marginTop:"20px"},children:l.jsx("button",{className:"see-more-btn",style:{padding:"10px 20px",background:V?"#e0e0e0":"#4a90e2",color:V?"#333":"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},onClick:()=>B(!V),children:V?"Hide Assessment History":"See Assessment History"})})]})]}),V&&(Z?l.jsx(No,{}):l.jsx(IF,{childData:x,assessmentData:K})),l.jsxs("div",{className:"profile-content-scroll",style:{marginTop:"30px"},children:[l.jsxs("div",{className:"services-split-row",children:[l.jsxs("div",{className:"content-section",children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("h2",{className:"services-header",children:"Therapy Services"}),!n&&l.jsx("button",{onClick:()=>ys("Therapy"),children:"+ Add"})]}),l.jsx("div",{className:"services-list",children:Zt.map((Se,It)=>l.jsx("div",{children:l.jsxs("div",{className:`service-row clickable ${R===Se.serviceName?"active":""}`,onClick:()=>us(Se.serviceName),children:[l.jsxs("div",{className:"service-left",children:[" ",Se.serviceName]}),l.jsx("div",{children:Se.staffName})]})},It))})]}),l.jsxs("div",{className:"content-section",children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[l.jsx("h2",{className:"services-header",children:"Group Classes"}),!n&&l.jsx("button",{onClick:()=>ys("Class"),children:"+ Add"})]}),l.jsx("div",{className:"services-list",children:ir.map((Se,It)=>l.jsxs("div",{className:`service-row clickable ${R===Se.serviceName?"active":""}`,onClick:()=>us(Se.serviceName),children:[l.jsxs("div",{className:"service-left",children:[" ",Se.serviceName]}),l.jsx("div",{children:Se.staffName})]},It))})]})]}),R&&l.jsx("div",{ref:me,children:l.jsx(RF,{activities:z.filter(Se=>Se.serviceName===R||Se.serviceType===R||Se.className===R),teachers:Y,selectedServiceName:R})})]})]}),l.jsx(Og,{pageLabel:n?"Child Profile":"Student Profile"})]}),!n&&ge&&l.jsx("div",{className:"add-service-overlay",children:l.jsxs("div",{className:"add-service-modal",children:[l.jsxs("h3",{children:["Enroll in ",M]}),l.jsxs("div",{className:"modal-form-body",children:[H.length===0?l.jsx("p",{style:{color:"#ef4444",marginBottom:"10px"},children:"No services available for this student based on recorded interventions. Please check Background History."}):null,l.jsxs("select",{className:"modal-select",onChange:Se=>we({...de,serviceId:Se.target.value}),value:de.serviceId,children:[l.jsx("option",{value:"",children:"Select Service..."}),H.map(Se=>l.jsx("option",{value:Se.id,children:Se.name},Se.id))]}),l.jsxs("select",{className:"modal-select",style:{marginTop:"10px"},onChange:Se=>we({...de,staffId:Se.target.value}),value:de.staffId,disabled:!de.serviceId,children:[l.jsx("option",{value:"",children:"Select Staff..."}),zr(H.find(Se=>Se.id===de.serviceId)?.name,M).map(Se=>l.jsxs("option",{value:Se.uid||Se.id,children:[Se.firstName," ",Se.lastName]},Se.uid||Se.id))]})]}),l.jsxs("div",{className:"modal-actions",children:[l.jsx("button",{className:"btn-cancel",onClick:()=>le(!1),children:"Cancel"}),l.jsx("button",{className:"btn-confirm",disabled:Pe,onClick:rr,children:"Confirm"})]})]})})]});return s?xs:t?l.jsx("div",{className:"sp-container",children:xs}):l.jsxs("div",{className:"sp-container",children:[l.jsx(Kt,{}),xs]})},xt={layout:{display:"flex",minHeight:"100vh"},main:{flex:1,padding:"24px",backgroundColor:"#f5f5f5"},header:{marginBottom:"24px"},title:{fontSize:"24px",fontWeight:"600",marginBottom:"4px"},subtitle:{color:"#666",fontSize:"14px"},card:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden"},table:{width:"100%",borderCollapse:"collapse"},th:{textAlign:"left",padding:"12px 16px",backgroundColor:"#f9fafb",borderBottom:"1px solid #e5e7eb",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",color:"#6b7280"},td:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",fontSize:"14px"},roleBadge:{display:"inline-block",padding:"2px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500"},expirySoon:{color:"#f59e0b",fontWeight:"500"},expiryOk:{color:"#6b7280"},actionBtn:{padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"white",cursor:"pointer",fontSize:"13px",marginRight:"8px"},actionBtnPrimary:{padding:"6px 12px",border:"none",borderRadius:"4px",backgroundColor:"#2563eb",color:"white",cursor:"pointer",fontSize:"13px",marginRight:"8px"},emptyState:{padding:"48px",textAlign:"center",color:"#666"},loading:{padding:"48px",textAlign:"center",color:"#666"},filterRow:{display:"flex",gap:"12px",marginBottom:"16px"},select:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"6px",fontSize:"14px"},refreshBtn:{padding:"8px 16px",border:"1px solid #ddd",borderRadius:"6px",backgroundColor:"white",cursor:"pointer",fontSize:"14px"}},jF=n=>{const t={parent:{bg:"#dbeafe",color:"#1e40af"},teacher:{bg:"#dcfce7",color:"#166534"},therapist:{bg:"#fef3c7",color:"#92400e"},admin:{bg:"#fce7f3",color:"#9d174d"}}[n]||{bg:"#f3f4f6",color:"#374151"};return{...xt.roleBadge,backgroundColor:t.bg,color:t.color}},DF=n=>n?new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",OF=n=>{if(!n)return 0;const e=n-Date.now();return Math.ceil(e/(1e3*60*60*24))};function PF(){const[n,e]=I.useState([]),[t,s]=I.useState(!0),[i,o]=I.useState("all"),[u,h]=I.useState(null),[f,p]=I.useState(!1);I.useEffect(()=>{g()},[]);const g=async()=>{s(!0);const w=await ms.getPendingAccounts();e(w),s(!1)},x=w=>{h(w),p(!0)},b=async w=>{if(!window.confirm(`Generate a new activation code for ${w.firstName}?`))return;const A=await ms.regenerateActivationCode(w.uid);A.success?(e(C=>C.map(L=>L.uid===w.uid?{...L,activationCode:A.newCode,activationExpiry:Date.now()+336*60*60*1e3}:L)),h({...w,activationCode:A.newCode}),p(!0)):alert("Failed to regenerate code")},S=i==="all"?n:n.filter(w=>w.role===i);return l.jsxs("div",{style:xt.layout,children:[l.jsx(To,{}),l.jsxs("main",{style:xt.main,children:[l.jsxs("div",{style:xt.header,children:[l.jsx("h1",{style:xt.title,children:"Pending Account Activations"}),l.jsxs("p",{style:xt.subtitle,children:[n.length," account",n.length!==1?"s":""," waiting for activation"]})]}),l.jsxs("div",{style:xt.filterRow,children:[l.jsxs("select",{style:xt.select,value:i,onChange:w=>o(w.target.value),children:[l.jsx("option",{value:"all",children:"All Roles"}),l.jsx("option",{value:"parent",children:"Parents"}),l.jsx("option",{value:"teacher",children:"Teachers"}),l.jsx("option",{value:"therapist",children:"Therapists"}),l.jsx("option",{value:"admin",children:"Admins"})]}),l.jsx("button",{style:xt.refreshBtn,onClick:g,children:" Refresh"})]}),l.jsx("div",{style:xt.card,children:t?l.jsx("div",{style:xt.loading,children:"Loading..."}):S.length===0?l.jsxs("div",{style:xt.emptyState,children:[l.jsx("p",{style:{fontSize:"48px",marginBottom:"8px"},children:""}),l.jsx("p",{children:"No pending activations"})]}):l.jsxs("table",{style:xt.table,children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{style:xt.th,children:"User"}),l.jsx("th",{style:xt.th,children:"Role"}),l.jsx("th",{style:xt.th,children:"Code"}),l.jsx("th",{style:xt.th,children:"Created"}),l.jsx("th",{style:xt.th,children:"Expires"}),l.jsx("th",{style:xt.th,children:"Actions"})]})}),l.jsx("tbody",{children:S.map(w=>{const A=OF(w.activationExpiry),C=A<=3;return l.jsxs("tr",{children:[l.jsxs("td",{style:xt.td,children:[l.jsx("div",{children:l.jsxs("strong",{children:[w.firstName," ",w.lastName]})}),l.jsx("div",{style:{fontSize:"12px",color:"#666"},children:w.email})]}),l.jsx("td",{style:xt.td,children:l.jsx("span",{style:jF(w.role),children:w.role})}),l.jsx("td",{style:xt.td,children:l.jsx("code",{style:{fontSize:"13px"},children:w.activationCode})}),l.jsx("td",{style:xt.td,children:DF(w.activationCreatedAt)}),l.jsx("td",{style:xt.td,children:l.jsxs("span",{style:C?xt.expirySoon:xt.expiryOk,children:[A<=0?"Expired":`${A} days`,C&&A>0&&" "]})}),l.jsxs("td",{style:xt.td,children:[l.jsx("button",{style:xt.actionBtnPrimary,onClick:()=>x(w),children:"Show QR"}),l.jsx("button",{style:xt.actionBtn,onClick:()=>b(w),children:"New Code"})]})]},w.uid)})})]})})]}),l.jsx(Kg,{isOpen:f,onClose:()=>p(!1),userData:u})]})}const ph=({label:n,options:e,selected:t=[],onChange:s,multiSelect:i=!0,color:o="blue"})=>{const u=p=>{i?t.includes(p)?s(t.filter(g=>g!==p)):s([...t,p]):s(t.includes(p)?[]:[p])},f=(p=>{const g={blue:{border:"#3b82f6",bg:"#eff6ff",text:"#2563eb"},green:{border:"#22c55e",bg:"#f0fdf4",text:"#16a34a"},red:{border:"#ef4444",bg:"#fef2f2",text:"#dc2626"},purple:{border:"#a855f7",bg:"#faf5ff",text:"#9333ea"}};return g[p]||g.blue})(o);return l.jsxs("div",{style:{marginBottom:"1.5rem"},children:[n&&l.jsx("label",{style:{display:"block",fontSize:"1rem",fontWeight:"600",color:"#334155",marginBottom:"0.75rem"},children:n}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:e.map(p=>{const g=t.includes(p);return l.jsxs("button",{type:"button",onClick:()=>u(p),style:{padding:"0.5rem 1rem",borderRadius:"2rem",border:"1px solid",borderColor:g?f.border:"#e2e8f0",backgroundColor:g?f.bg:"white",color:g?f.text:"#64748b",cursor:"pointer",fontSize:"0.875rem",fontWeight:"500",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.25rem"},children:[g&&l.jsx("span",{children:""}),p]},p)})})]})},Gc=({onTranscript:n})=>{const[e,t]=I.useState(!1),[s,i]=I.useState(!0);I.useEffect(()=>{!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)&&i(!1)},[]);const o=()=>{if(!s){alert("Voice input is not supported in this browser. Please use Chrome, Edge, or Safari.");return}if(e){t(!1);return}const u=window.SpeechRecognition||window.webkitSpeechRecognition,h=new u;h.continuous=!1,h.interimResults=!1,h.lang="en-US",h.onstart=()=>t(!0),h.onend=()=>t(!1),h.onerror=f=>{console.error("Speech recognition error",f.error),t(!1)},h.onresult=f=>{const p=f.results[0][0].transcript;n(p)},h.start()};return s?l.jsx("button",{type:"button",onClick:o,title:"Dictate Note",style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",borderRadius:"0.5rem",border:"none",cursor:"pointer",backgroundColor:e?"#fee2e2":"#f1f5f9",color:e?"#dc2626":"#64748b",fontWeight:"600",fontSize:"0.8rem",transition:"all 0.2s"},children:l.jsx("span",{children:e?" Listening...":" Dictate"})}):null},kF=["Circle Time","Art Class","Music","Math","Reading","Free Play","Snack/Lunch","Social Skills","Nap Time"],MF=["Happy ","Focused ","Active ","Tired ","Upset ","Social ","Quiet "],LF=["Participated","Shared Toys","Followed Rules","Helped Others","Good Listening","Creative","Ate Well"],VF=()=>{const{currentUser:n,logout:e}=In(),t=Nn(),[s,i]=I.useState([]),[o,u]=I.useState(""),[h,f]=I.useState(!1),[p,g]=I.useState(null),[x,b]=I.useState(!1),[S,w]=I.useState(null),[A,C]=I.useState(!1),[L,z]=I.useState(""),[U,F]=I.useState([]),[K,Z]=I.useState([]),[j,N]=I.useState(""),[R,O]=I.useState([]),[V,B]=I.useState(""),[k,fe]=I.useState(""),[me,G]=I.useState(""),{students:ne,isLoading:Y,error:ge}=uF();I.useEffect(()=>{if(ne&&n){const de={};ne.forEach(we=>{[...we.groupClassServices||[],...we.oneOnOneServices||[],...we.enrolledServices||[]].filter(He=>He.staffId===n.uid).forEach(He=>{const Rn=He.serviceName||"Unassigned Group";de[Rn]||(de[Rn]={name:Rn,serviceId:He.serviceId,students:[]}),de[Rn].students.find(us=>us.id===we.id)||de[Rn].students.push(we)})}),i(Object.values(de))}},[ne,n]),I.useEffect(()=>{n&&f(!n.prcId)},[n]);const le=async()=>{await e(),t("/login")},M=()=>{t("/teacher/play-group-upload",{state:{preSelectedClassName:p.name,preSelectedStudents:p.students}})},W=de=>{w(de),z(""),F([]),Z([]),N(""),O([]),B(""),fe(""),G(""),b(!0)},H=async de=>{if(de.preventDefault(),!L){alert("Please select or type a topic.");return}C(!0);const we=[...K,j].filter(Boolean).join(". "),Pe=[...R,V].filter(Boolean).join(". ");try{const tt={childId:S.id,childName:`${S.firstName} ${S.lastName}`,serviceId:p.serviceId||"teacher-group-id",serviceName:p.name,date:new Date().toISOString(),type:"observation",authorId:n.uid,authorName:`${n.firstName} ${n.lastName}`,title:L,studentReaction:U,strengths:we,weaknesses:Pe,homeActivities:k,sessionNotes:me};await JR(tt),alert(`Observation saved for ${S.firstName}!`),b(!1)}catch{alert("Failed to save observation.")}finally{C(!1)}},ce=(de,we,Pe)=>{const tt=de.trim();Pe(tt?`${tt}. ${we}. `:`${we}. `)};return Y?l.jsx(No,{}):ge?l.jsx(bx,{message:ge.message}):l.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto",fontFamily:"system-ui, sans-serif"},children:[h&&l.jsxs("div",{style:it.notifBanner,children:[l.jsxs("div",{children:[l.jsx("strong",{style:{display:"block",color:"#92400e"},children:" Profile Incomplete"}),l.jsx("p",{style:{margin:0,fontSize:"13px",color:"#b45309"},children:"Please update your professional credentials (PRC ID, School, etc.) to verify your account."})]}),l.jsx("button",{onClick:()=>t("/teacher/profile"),style:it.notifBtn,children:"Setup Profile "})]}),l.jsxs("div",{style:it.header,children:[l.jsxs("div",{children:[l.jsx("h1",{style:{margin:0,color:"#1e293b"},children:"Teacher Dashboard "}),l.jsxs("p",{style:{margin:"5px 0 0",color:"#64748b"},children:[n?.firstName," ",n?.lastName]})]}),l.jsxs("div",{style:{display:"flex",gap:"10px"},children:[l.jsx("button",{onClick:()=>t("/teacher/profile"),style:it.secondaryBtn,children:" Profile"}),l.jsx("button",{onClick:()=>t("/staff/inquiries"),style:it.secondaryBtn,children:" Inbox"}),l.jsx("button",{onClick:le,style:it.logoutBtn,children:"Sign Out"})]})]}),l.jsx(bx,{message:o}),!p&&l.jsxs(l.Fragment,{children:[l.jsx("h2",{style:{color:"#334155",marginBottom:"20px"},children:"My Classes"}),s.length===0?l.jsxs("div",{style:it.emptyState,children:[l.jsx("div",{style:{fontSize:"40px",marginBottom:"10px"},children:""}),l.jsx("p",{children:"No classes assigned yet."})]}):l.jsx("div",{style:it.grid,children:s.map((de,we)=>l.jsxs("div",{style:it.classCard,onClick:()=>g(de),children:[l.jsx("div",{style:it.classIcon,children:""}),l.jsxs("div",{children:[l.jsx("h3",{style:{margin:"0 0 5px 0",color:"#1e293b"},children:de.name}),l.jsxs("p",{style:{margin:0,color:"#64748b",fontSize:"14px"},children:[de.students.length," Student",de.students.length!==1?"s":""]})]}),l.jsx("div",{style:it.arrow,children:""})]},we))})]}),p&&l.jsxs("div",{style:it.fadeIn,children:[l.jsx("button",{onClick:()=>g(null),style:it.backBtn,children:" Back to Classes"}),l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"25px",flexWrap:"wrap",gap:"15px"},children:[l.jsx("h2",{style:{margin:0,fontSize:"28px",color:"#0f172a"},children:p.name}),l.jsx("button",{onClick:M,style:it.primaryBtn,children:" Post Group Activity"})]}),l.jsx("div",{style:it.grid,children:p.students.map(de=>l.jsxs("div",{style:it.studentCard,children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px",marginBottom:"15px"},children:[l.jsx("div",{style:it.avatar,children:de.photoUrl?l.jsx("img",{src:de.photoUrl,alt:"",style:it.avatarImg}):""}),l.jsxs("div",{children:[l.jsx("h4",{style:{margin:0,color:"#1e293b"},children:de.firstName}),l.jsx("span",{style:{fontSize:"12px",color:"#64748b"},children:de.lastName})]})]}),l.jsx("button",{onClick:()=>W(de),style:it.actionBtn,children:" Write Observation"})]},de.id))})]}),x&&S&&l.jsx("div",{style:it.modalOverlay,children:l.jsxs("div",{style:it.modalContent,children:[l.jsxs("div",{style:it.modalHeader,children:[l.jsxs("h3",{style:{margin:0},children:["Observation: ",S.firstName]}),l.jsx("button",{onClick:()=>b(!1),style:it.closeBtn,children:""})]}),l.jsxs("form",{onSubmit:H,style:{padding:"20px",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[l.jsxs("div",{children:[l.jsx("label",{style:it.label,children:" Activity / Topic"}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"0.5rem"},children:kF.map(de=>l.jsx("button",{type:"button",onClick:()=>z(de),style:it.chipBtn(L===de),children:de},de))}),l.jsx("input",{required:!0,style:it.input,value:L,onChange:de=>z(de.target.value),placeholder:"Or type custom topic..."})]}),l.jsx(ph,{label:" Mood",options:MF,selected:U,onChange:F,color:"purple"}),l.jsxs("div",{children:[l.jsx(ph,{label:" Strengths",options:LF,selected:K,onChange:Z,color:"green"}),l.jsx("textarea",{rows:"2",style:it.textarea,value:j,onChange:de=>N(de.target.value),placeholder:"Details..."})]}),l.jsxs("div",{children:[l.jsxs("div",{style:it.flexBetween,children:[l.jsx("label",{style:it.label,children:" Home Note"}),l.jsx(Gc,{onTranscript:de=>ce(k,de,fe)})]}),l.jsx("textarea",{rows:"2",style:it.textarea,value:k,onChange:de=>fe(de.target.value),placeholder:"Message for parents..."})]}),l.jsxs("div",{style:it.modalActions,children:[l.jsx("button",{type:"button",onClick:()=>b(!1),style:it.cancelBtn,children:"Cancel"}),l.jsx("button",{type:"submit",disabled:A,style:it.saveBtn,children:A?"Saving...":"Save Report"})]})]})]})})]})},it={header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",borderBottom:"1px solid #e2e8f0",paddingBottom:"20px"},notifBanner:{backgroundColor:"#fffbeb",border:"1px solid #fef3c7",borderRadius:"12px",padding:"16px 24px",marginBottom:"24px",display:"flex",justifyContent:"space-between",alignItems:"center"},notifBtn:{backgroundColor:"#fbbf24",color:"white",border:"none",padding:"10px 18px",borderRadius:"8px",fontWeight:"700",cursor:"pointer",fontSize:"14px"},primaryBtn:{padding:"10px 20px",backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},secondaryBtn:{padding:"8px 16px",backgroundColor:"#f1c40f",color:"#333",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600"},logoutBtn:{padding:"8px 16px",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px"},classCard:{backgroundColor:"white",borderRadius:"12px",padding:"20px",display:"flex",alignItems:"center",gap:"15px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0",cursor:"pointer"},studentCard:{backgroundColor:"white",borderRadius:"12px",padding:"20px",border:"1px solid #e2e8f0"},avatar:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},avatarImg:{width:"100%",height:"100%",objectFit:"cover"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},modalContent:{backgroundColor:"white",borderRadius:"12px",width:"90%",maxWidth:"550px",maxHeight:"90vh",overflowY:"auto"},modalHeader:{padding:"15px 20px",borderBottom:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f8fafc"},label:{display:"block",fontSize:"13px",fontWeight:"700",color:"#334155",marginBottom:"6px"},textarea:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #cbd5e1",boxSizing:"border-box"},input:{width:"100%",padding:"10px",borderRadius:"6px",border:"1px solid #cbd5e1",boxSizing:"border-box"},chipBtn:n=>({padding:"6px 12px",borderRadius:"20px",border:"1px solid",borderColor:n?"#3b82f6":"#cbd5e1",backgroundColor:n?"#eff6ff":"white",color:n?"#2563eb":"#64748b",cursor:"pointer"}),modalActions:{display:"flex",justifyContent:"flex-end",gap:"10px",padding:"15px 20px",borderTop:"1px solid #e2e8f0"},saveBtn:{padding:"10px 20px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontWeight:"600",cursor:"pointer"},cancelBtn:{background:"none",border:"none",color:"#64748b",cursor:"pointer"},backBtn:{background:"none",border:"none",color:"#64748b",marginBottom:"20px",cursor:"pointer",fontSize:"16px"},emptyState:{textAlign:"center",color:"#64748b",marginTop:"40px"},actionBtn:{width:"100%",padding:"8px",backgroundColor:"#e2e8f0",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600",color:"#475569",marginTop:"10px"}},UF=()=>{const{currentUser:n}=In(),e=kn(),t=Nn(),{preSelectedClassName:s,preSelectedStudents:i}=e.state||{},[o,u]=I.useState([]),[h,f]=I.useState(!0),[p,g]=I.useState(!1),[x,b]=I.useState(""),[S,w]=I.useState(""),[A,C]=I.useState(s||""),[L,z]=I.useState(new Date().toISOString().split("T")[0]),[U,F]=I.useState([]),[K,Z]=I.useState([]),[j,N]=I.useState([]);I.useEffect(()=>{(async()=>{if(i&&i.length>0){u(i),f(!1);return}if(n){f(!0);try{let G=[];n.role==="admin"?G=await Vr.getAllChildren():G=await Vr.getChildrenByTeacherId(n.uid),u(G)}catch(G){console.error("Error fetching students:",G),alert("Failed to load student list")}finally{f(!1)}}})()},[n,i]);const R=me=>{const G=Array.from(me.target.files);if(G.length===0)return;const ne=G.map(Y=>URL.createObjectURL(Y));F(Y=>[...Y,...G]),Z(Y=>[...Y,...ne])},O=me=>{F(G=>G.filter((ne,Y)=>Y!==me)),Z(G=>G.filter((ne,Y)=>Y!==me))},V=me=>{N(G=>G.includes(me)?G.filter(ne=>ne!==me):[...G,me])},B=()=>{j.length===o.length?N([]):N(o.map(me=>me.id))},k=async me=>{if(me.preventDefault(),U.length===0)return alert("Please select at least one photo.");if(j.length===0)return alert("Please tag at least one student.");g(!0);try{const G=`little-lions/group-images/${L}`,ne=U.map(le=>co.uploadImage(le,G)),Y=await Promise.all(ne),ge={title:x,description:S,date:L,className:A,photoUrls:Y,participatingStudentIds:j,teacherId:n.uid,teacherName:`${n.firstName} ${n.lastName}`,authorRole:"teacher"};await Ug.createGroupActivity(ge),alert("Activity Uploaded Successfully!"),t(-1)}catch(G){console.error("Upload failed:",G),alert("Failed to upload activity."),g(!1)}},fe={container:{padding:"20px",maxWidth:"1000px",margin:"0 auto",fontFamily:"system-ui, sans-serif"},backBtn:{background:"none",border:"none",color:"#64748b",cursor:"pointer",marginBottom:"20px",fontSize:"15px",fontWeight:"600"},section:{marginBottom:"30px",padding:"20px",border:"1px solid #e2e8f0",borderRadius:"12px",backgroundColor:"white",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},label:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#334155"},input:{width:"100%",padding:"10px",marginBottom:"15px",borderRadius:"6px",border:"1px solid #cbd5e1",boxSizing:"border-box"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"15px"},card:me=>({border:me?"2px solid #2ecc71":"1px solid #e2e8f0",backgroundColor:me?"#f0fdf4":"#fff",borderRadius:"8px",padding:"10px",textAlign:"center",cursor:"pointer",opacity:me?1:.8,transition:"all 0.2s",boxShadow:me?"0 2px 4px rgba(46, 204, 113, 0.2)":"none"}),previewImg:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"6px",border:"1px solid #e2e8f0"},removeBtn:{background:"#ef4444",color:"white",border:"none",cursor:"pointer",borderRadius:"50%",width:"20px",height:"20px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"-5px",right:"-5px"}};return l.jsxs("div",{style:fe.container,children:[l.jsx("button",{onClick:()=>t(-1),style:fe.backBtn,children:" Back"}),l.jsx("h1",{style:{color:"#0f172a",marginBottom:"25px"},children:" New Group Activity"}),l.jsxs("form",{onSubmit:k,children:[l.jsxs("div",{style:fe.section,children:[l.jsx("h3",{style:{marginTop:0,color:"#475569"},children:"1. Activity Details"}),l.jsx("label",{style:fe.label,children:"Class Name"}),l.jsx("input",{style:{...fe.input,backgroundColor:s?"#f1f5f9":"white"},placeholder:"e.g. Art Class",value:A,onChange:me=>C(me.target.value)}),l.jsx("label",{style:fe.label,children:"Activity Title"}),l.jsx("input",{style:fe.input,placeholder:"e.g. Outdoor Building Blocks",value:x,onChange:me=>b(me.target.value),required:!0}),l.jsx("label",{style:fe.label,children:"Date"}),l.jsx("input",{style:fe.input,type:"date",value:L,onChange:me=>z(me.target.value),required:!0}),l.jsx("label",{style:fe.label,children:"Description"}),l.jsx("textarea",{style:{...fe.input,height:"80px",fontFamily:"inherit"},value:S,onChange:me=>w(me.target.value),placeholder:"What did the children do today?"})]}),l.jsxs("div",{style:fe.section,children:[l.jsx("h3",{style:{marginTop:0,color:"#475569"},children:"2. Select Photos"}),l.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:R,style:{marginBottom:"20px"}}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"15px"},children:K.map((me,G)=>l.jsxs("div",{style:{position:"relative"},children:[l.jsx("img",{src:me,alt:"Preview",style:fe.previewImg}),l.jsx("button",{type:"button",onClick:()=>O(G),style:fe.removeBtn,children:""})]},G))})]}),l.jsxs("div",{style:fe.section,children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[l.jsxs("h3",{style:{margin:0,color:"#475569"},children:["3. Who was present? ",l.jsxs("span",{style:{fontSize:"14px",color:"#64748b",fontWeight:"normal"},children:["(",j.length," selected)"]})]}),l.jsx("button",{type:"button",onClick:B,style:{padding:"6px 12px",cursor:"pointer",backgroundColor:"#e2e8f0",border:"none",borderRadius:"4px",fontSize:"13px",fontWeight:"600",color:"#475569"},children:j.length===o.length?"Deselect All":"Select All"})]}),h?l.jsx("p",{children:"Loading your class list..."}):l.jsx(l.Fragment,{children:o.length===0?l.jsx("p",{style:{color:"#ef4444",fontStyle:"italic"},children:"No students found assigned to this class."}):l.jsx("div",{style:fe.grid,children:o.map(me=>{const G=j.includes(me.id);return l.jsxs("div",{style:fe.card(G),onClick:()=>V(me.id),children:[l.jsx("div",{style:{fontSize:"24px",marginBottom:"5px"},children:me.photoUrl?l.jsx("img",{src:me.photoUrl,alt:"child",style:{width:"50px",height:"50px",borderRadius:"50%",objectFit:"cover"}}):""}),l.jsx("div",{style:{fontWeight:"600",fontSize:"13px",color:"#334155"},children:me.firstName}),G&&l.jsx("div",{style:{color:"#2ecc71",fontWeight:"bold",fontSize:"12px",marginTop:"4px"},children:" Here"})]},me.id)})})})]}),l.jsx("button",{type:"submit",disabled:p,style:{width:"100%",padding:"16px",backgroundColor:p?"#94a3b8":"#2ecc71",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",cursor:p?"not-allowed":"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(46, 204, 113, 0.25)",transition:"background-color 0.2s"},children:p?"Uploading...":" Upload Group Activity"})]})]})},qj=({profilePhoto:n,fullName:e,role:t,statusBadge:s,onPhotoUpload:i,uploading:o})=>l.jsxs("div",{className:"tp-photo-section",children:[l.jsxs("div",{className:"tp-photo-container",children:[n?l.jsx("img",{src:n,alt:"Profile",className:"tp-photo"}):l.jsx("div",{className:"tp-photo-placeholder",children:""}),l.jsxs("label",{className:"tp-photo-upload-btn",children:[o?"Uploading...":"Change Photo",l.jsx("input",{type:"file",accept:"image/*",onChange:i,disabled:o,style:{display:"none"}})]})]}),l.jsxs("div",{className:"tp-photo-info",children:[l.jsx("h2",{className:"tp-profile-name",children:e||"Name"}),l.jsx("p",{className:"tp-profile-role",children:t}),s&&l.jsx("span",{className:`tp-license-status ${s.className}`,children:s.text})]})]}),Hj=({formData:n,validationErrors:e,onInputChange:t,onNestedChange:s,readOnlyFields:i=["firstName","middleName","lastName","email"]})=>l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"First Name"}),l.jsx("input",{type:"text",className:"tp-input tp-input-disabled",value:n.firstName,disabled:!0})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Middle Name"}),l.jsx("input",{type:"text",className:"tp-input tp-input-disabled",value:n.middleName,disabled:!0})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Last Name"}),l.jsx("input",{type:"text",className:"tp-input tp-input-disabled",value:n.lastName,disabled:!0})]})]}),l.jsx("p",{className:"tp-helper-text",children:"Your name is managed by the administrator"}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Date of Birth ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"date",className:`tp-input ${e.dateOfBirth?"tp-input-error":""}`,value:n.dateOfBirth,onChange:o=>t("dateOfBirth",o.target.value)}),e.dateOfBirth&&l.jsx("span",{className:"tp-error-text",children:e.dateOfBirth})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Gender"}),l.jsxs("select",{className:"tp-input",value:n.gender,onChange:o=>t("gender",o.target.value),children:[l.jsx("option",{value:"",children:"Select gender"}),l.jsx("option",{value:"Male",children:"Male"}),l.jsx("option",{value:"Female",children:"Female"}),l.jsx("option",{value:"Non-binary",children:"Non-binary"}),l.jsx("option",{value:"Prefer not to say",children:"Prefer not to say"})]})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Phone Number ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"tel",className:`tp-input ${e.phone?"tp-input-error":""}`,value:n.phone,onChange:o=>t("phone",o.target.value),placeholder:"123-456-7890"}),e.phone&&l.jsx("span",{className:"tp-error-text",children:e.phone})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Email Address"}),l.jsx("input",{type:"email",className:"tp-input tp-input-disabled",value:n.email,disabled:!0})]})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Street Address"}),l.jsx("input",{type:"text",className:"tp-input",value:n.address.street,onChange:o=>s("address","street",o.target.value),placeholder:"123 Main St"})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"City"}),l.jsx("input",{type:"text",className:"tp-input",value:n.address.city,onChange:o=>s("address","city",o.target.value)})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"State"}),l.jsx("input",{type:"text",className:"tp-input",value:n.address.state,onChange:o=>s("address","state",o.target.value)})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"ZIP Code"}),l.jsx("input",{type:"text",className:"tp-input",value:n.address.zip,onChange:o=>s("address","zip",o.target.value),placeholder:"12345"})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Emergency Contact Name"}),l.jsx("input",{type:"text",className:"tp-input",value:n.emergencyContact.name,onChange:o=>s("emergencyContact","name",o.target.value)})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Emergency Contact Phone"}),l.jsx("input",{type:"tel",className:"tp-input",value:n.emergencyContact.phone,onChange:o=>s("emergencyContact","phone",o.target.value),placeholder:"123-456-7890"})]})]})]}),Wm=({education:n,index:e,isNew:t=!1,onChange:s,onRemove:i,onAdd:o,onFileUpload:u,uploading:h})=>t?l.jsxs("div",{className:"tp-add-new-section",children:[l.jsx("h4",{className:"tp-add-new-title",children:"Add New Education"}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Institution Name ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"text",className:"tp-input",value:n.institution,onChange:f=>s("institution",f.target.value),placeholder:"e.g., Harvard University"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Degree Type ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsxs("select",{className:"tp-input",value:n.degreeType,onChange:f=>s("degreeType",f.target.value),children:[l.jsx("option",{value:"",children:"Select degree type"}),l.jsx("option",{value:"Bachelor's",children:"Bachelor's"}),l.jsx("option",{value:"Master's",children:"Master's"}),l.jsx("option",{value:"Doctorate",children:"Doctorate"}),l.jsx("option",{value:"Professional Degree",children:"Professional Degree"})]})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Field of Study ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"text",className:"tp-input",value:n.fieldOfStudy,onChange:f=>s("fieldOfStudy",f.target.value),placeholder:"e.g., Occupational Therapy"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Graduation Year ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"number",className:"tp-input",value:n.graduationYear,onChange:f=>s("graduationYear",f.target.value),min:"1950",max:"2100",placeholder:"2020"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"GPA (Optional)"}),l.jsx("input",{type:"number",className:"tp-input",value:n.gpa,onChange:f=>s("gpa",f.target.value),min:"0",max:"4",step:"0.01",placeholder:"3.50"})]})]}),l.jsxs("div",{className:"tp-upload-section",children:[l.jsx("label",{className:"tp-label",children:"Certificate/Diploma (Optional)"}),n.certificateURL?l.jsxs("div",{className:"tp-uploaded-file",children:[l.jsx("a",{href:n.certificateURL,target:"_blank",rel:"noopener noreferrer",children:" Certificate Uploaded"}),l.jsx("button",{type:"button",className:"tp-remove-file-btn",onClick:()=>s("certificateURL",""),children:""})]}):l.jsxs("label",{className:"tp-upload-btn-secondary",children:[h?"Uploading...":" Upload Certificate",l.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:u,disabled:h,style:{display:"none"}})]}),l.jsx("small",{className:"tp-helper-text",children:'Tip: Name your file like "Harvard_Masters_OT_2020.pdf" for auto-suggestions'})]}),l.jsx("button",{type:"button",className:"tp-add-btn",onClick:o,children:"+ Add Education"})]}):l.jsxs("div",{className:"tp-entry-card",children:[l.jsxs("div",{className:"tp-entry-header",children:[l.jsxs("h4",{className:"tp-entry-title",children:[n.degreeType," - ",n.fieldOfStudy]}),l.jsx("button",{type:"button",className:"tp-remove-btn",onClick:()=>i(e),children:"Remove"})]}),l.jsxs("div",{className:"tp-entry-details",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Institution:"})," ",n.institution]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Graduation Year:"})," ",n.graduationYear]}),n.gpa&&l.jsxs("p",{children:[l.jsx("strong",{children:"GPA:"})," ",n.gpa]}),n.certificateURL&&l.jsx("a",{href:n.certificateURL,target:"_blank",rel:"noopener noreferrer",className:"tp-certificate-link",children:" View Certificate"})]})]}),BF=n=>{if(!n)return{suggestedYear:"",suggestedDegree:"",suggestedInstitution:""};const t=n.replace(/\.(pdf|jpg|jpeg|png|doc|docx)$/i,"").split(/[_\-\s]+/),s=t.find(h=>/^\d{4}$/.test(h)&&parseInt(h)>=1950&&parseInt(h)<=2100),i={bachelor:"Bachelor's",bachelors:"Bachelor's",ba:"Bachelor's",bs:"Bachelor's",bsc:"Bachelor's",master:"Master's",masters:"Master's",ma:"Master's",ms:"Master's",msc:"Master's",mba:"Master's",phd:"Doctorate",doctorate:"Doctorate",doctoral:"Doctorate",edd:"Doctorate",jd:"Professional Degree",md:"Professional Degree"};let o="";for(const h of t){const f=h.toLowerCase();if(i[f]){o=i[f];break}}const u=t[0]?t[0].replace(/[_-]/g," "):"";return{suggestedYear:s?parseInt(s):"",suggestedDegree:o,suggestedInstitution:u}},E0=(n,e=5)=>{if(!n)return{isValid:!1,error:"No file provided"};const t=e*1024*1024;return n.size>t?{isValid:!1,error:`File size must be less than ${e}MB. Your file is ${(n.size/1024/1024).toFixed(2)}MB.`}:{isValid:!0,error:null}},FF=(n,e=["image/jpeg","image/png","application/pdf"])=>n?e.includes(n.type)?{isValid:!0,error:null}:{isValid:!1,error:`Invalid file type. Allowed types: ${e.map(t=>t.split("/")[1].toUpperCase()).join(", ")}`}:{isValid:!1,error:"No file provided"},I_=n=>{if(!n)return"Unknown";const e=new Date(n),t=new Date;return e.setHours(0,0,0,0),t.setHours(0,0,0,0),e<t?"Expired":Math.ceil((e-t)/(1e3*60*60*24))<=60?"Expiring Soon":"Active"},mA=(n,e="medium")=>{if(!n)return"";const t=new Date(n);if(isNaN(t.getTime()))return"";const s={short:{year:"numeric",month:"numeric",day:"numeric"},medium:{year:"numeric",month:"long",day:"numeric"},long:{weekday:"long",year:"numeric",month:"long",day:"numeric"}};return t.toLocaleDateString("en-US",s[e]||s.medium)},Xm=({certification:n,index:e,isNew:t=!1,onChange:s,onRemove:i,onAdd:o,onFileUpload:u,uploading:h})=>{if(t)return l.jsxs("div",{className:"tp-add-new-section",children:[l.jsx("h4",{className:"tp-add-new-title",children:"Add New Certification"}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Certification Name ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"text",className:"tp-input",value:n.name,onChange:p=>s("name",p.target.value),placeholder:"e.g., Board Certified Behavior Analyst"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Issuing Organization ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"text",className:"tp-input",value:n.issuingOrg,onChange:p=>s("issuingOrg",p.target.value),placeholder:"e.g., BACB, ASHA"})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Certification Number"}),l.jsx("input",{type:"text",className:"tp-input",value:n.certNumber,onChange:p=>s("certNumber",p.target.value),placeholder:"e.g., 1-23-45678"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Issue Date ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"date",className:"tp-input",value:n.issueDate,onChange:p=>s("issueDate",p.target.value)})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Expiration Date (if applicable)"}),l.jsx("input",{type:"date",className:"tp-input",value:n.expirationDate,onChange:p=>s("expirationDate",p.target.value)})]})]}),l.jsx("div",{className:"tp-form-row",children:l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"CEUs Completed (Optional)"}),l.jsx("input",{type:"number",className:"tp-input",value:n.ceusCompleted,onChange:p=>s("ceusCompleted",p.target.value),min:"0",placeholder:"0"})]})}),l.jsxs("div",{className:"tp-upload-section",children:[l.jsx("label",{className:"tp-label",children:"Certificate (Optional)"}),n.certificateURL?l.jsxs("div",{className:"tp-uploaded-file",children:[l.jsx("a",{href:n.certificateURL,target:"_blank",rel:"noopener noreferrer",children:" Certificate Uploaded"}),l.jsx("button",{type:"button",className:"tp-remove-file-btn",onClick:()=>s("certificateURL",""),children:""})]}):l.jsxs("label",{className:"tp-upload-btn-secondary",children:[h?"Uploading...":" Upload Certificate",l.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:u,disabled:h,style:{display:"none"}})]})]}),l.jsx("button",{type:"button",className:"tp-add-btn",onClick:o,children:"+ Add Certification"})]});const f=I_(n.expirationDate);return l.jsxs("div",{className:"tp-entry-card",children:[l.jsxs("div",{className:"tp-entry-header",children:[l.jsx("h4",{className:"tp-entry-title",children:n.name}),l.jsxs("div",{className:"tp-entry-actions",children:[l.jsx("span",{className:`tp-status-badge ${f==="Active"?"tp-status-active":f==="Expiring Soon"?"tp-status-warning":"tp-status-expired"}`,children:f}),l.jsx("button",{type:"button",className:"tp-remove-btn",onClick:()=>i(e),children:"Remove"})]})]}),l.jsxs("div",{className:"tp-entry-details",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Issuing Organization:"})," ",n.issuingOrg]}),n.certNumber&&l.jsxs("p",{children:[l.jsx("strong",{children:"Certification Number:"})," ",n.certNumber]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Issue Date:"})," ",mA(n.issueDate)]}),n.expirationDate&&l.jsxs("p",{children:[l.jsx("strong",{children:"Expiration Date:"})," ",mA(n.expirationDate)]}),n.ceusCompleted&&l.jsxs("p",{children:[l.jsx("strong",{children:"CEUs Completed:"})," ",n.ceusCompleted]}),n.certificateURL&&l.jsx("a",{href:n.certificateURL,target:"_blank",rel:"noopener noreferrer",className:"tp-certificate-link",children:" View Certificate"})]})]})},zF=({formData:n,validationErrors:e,licenseStatus:t,onInputChange:s,onSpecializationToggle:i})=>{const o=["Early Childhood Education","Special Education","Elementary Education","Language Arts","Mathematics","Science","Social Studies","Physical Education","Art Education","Music Education","ESL/TESOL","Behavior Management","Autism Spectrum Disorders","Learning Disabilities","ADHD Support","Gifted Education"];return l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"tp-section-description",children:"Professional teaching license and credentials"}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Teaching License Number ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"text",className:`tp-input ${e.teachingLicense?"tp-input-error":""}`,value:n.teachingLicense,onChange:u=>s("teachingLicense",u.target.value),placeholder:"e.g., TL-123456"}),e.teachingLicense&&l.jsx("span",{className:"tp-error-text",children:e.teachingLicense})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"PRC ID Number"}),l.jsx("input",{type:"text",className:"tp-input",value:n.prcIdNumber,onChange:u=>s("prcIdNumber",u.target.value),placeholder:"e.g., 1234567"})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["Certification Level ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsxs("select",{className:`tp-input ${e.certificationLevel?"tp-input-error":""}`,value:n.certificationLevel,onChange:u=>s("certificationLevel",u.target.value),children:[l.jsx("option",{value:"",children:"Select certification level"}),l.jsx("option",{value:"Initial",children:"Initial"}),l.jsx("option",{value:"Professional",children:"Professional"}),l.jsx("option",{value:"Master Teacher",children:"Master Teacher"}),l.jsx("option",{value:"Provisional",children:"Provisional"})]}),e.certificationLevel&&l.jsx("span",{className:"tp-error-text",children:e.certificationLevel})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"License State/Region"}),l.jsx("input",{type:"text",className:"tp-input",value:n.licenseState,onChange:u=>s("licenseState",u.target.value),placeholder:"e.g., Philippines"})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"License Issue Date"}),l.jsx("input",{type:"date",className:"tp-input",value:n.licenseIssueDate,onChange:u=>s("licenseIssueDate",u.target.value)})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"License Expiration Date"}),l.jsx("input",{type:"date",className:"tp-input",value:n.licenseExpirationDate,onChange:u=>s("licenseExpirationDate",u.target.value)}),t==="Expiring Soon"&&l.jsx("span",{className:"tp-warning-text",children:" License expires soon. Please renew."}),t==="Expired"&&l.jsx("span",{className:"tp-error-text",children:" License expired. Please renew immediately."})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Years of Teaching Experience"}),l.jsx("input",{type:"number",className:"tp-input",value:n.yearsExperience,onChange:u=>s("yearsExperience",parseInt(u.target.value)),min:"0"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Employment Status"}),l.jsxs("select",{className:"tp-input",value:n.employmentStatus,onChange:u=>s("employmentStatus",u.target.value),children:[l.jsx("option",{value:"",children:"Select status"}),l.jsx("option",{value:"Full-time",children:"Full-time"}),l.jsx("option",{value:"Part-time",children:"Part-time"}),l.jsx("option",{value:"Contract",children:"Contract"}),l.jsx("option",{value:"Substitute",children:"Substitute"})]})]})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Teaching Specializations"}),l.jsx("p",{className:"tp-helper-text",children:"Select all that apply"}),l.jsx("div",{className:"tp-checkbox-grid",children:o.map(u=>l.jsxs("label",{className:"tp-checkbox-label",children:[l.jsx("input",{type:"checkbox",checked:n.specializations.includes(u),onChange:()=>i(u)}),l.jsx("span",{children:u})]},u))})]})]})},qF={profile:{therapist:{required:["firstName","lastName","licenseType","licenseNumber","phone"],optional:["middleName","dateOfBirth","gender","address","emergencyContact"],recommended:["educationHistory","certifications","specializations"]},teacher:{required:["firstName","lastName","teachingLicense","certificationLevel","phone"],optional:["middleName","dateOfBirth","gender","address","emergencyContact","prcIdNumber"],recommended:["educationHistory","certifications","specializations"]},parent:{required:["firstName","lastName","email"],optional:["middleName","phone","address"]},admin:{required:["firstName","lastName","email"],optional:["middleName","phone"]}}},ui={email:{pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,errorMessage:"Please enter a valid email address"},phone:{pattern:/^[\d\s\-\(\)]+$/,errorMessage:"Please enter a valid phone number (e.g., 123-456-7890)"},licenseNumber:{pattern:/^[A-Z0-9-]{3,20}$/i,errorMessage:"License number must be 3-20 characters (letters, numbers, hyphens only)"},teachingLicense:{pattern:/^[A-Z0-9-]{3,20}$/i,errorMessage:"Teaching license must be 3-20 characters (letters, numbers, hyphens only)"},prcId:{pattern:/^[0-9]{7,10}$/,errorMessage:"PRC ID must be 7-10 digits"}},HF=(n,e)=>{const t=qF.profile[e];if(!t)return{isValid:!1,errors:{role:"Invalid role specified"},warnings:{}};const s={},i={};if(t.required.forEach(o=>{(!n[o]||n[o]==="")&&(s[o]=`${GF(o)} is required`)}),n.address&&!n.address.street&&!n.address.city&&!n.address.state&&!n.address.zip&&(i.address="Adding your address is recommended for emergency contacts"),n.emergencyContact&&(!n.emergencyContact.name||!n.emergencyContact.phone)&&(i.emergencyContact="Emergency contact information is recommended"),e==="therapist"||e==="teacher"){!n.educationHistory||n.educationHistory.length===0?i.educationHistory="Adding your education history is recommended":n.educationHistory.forEach((u,h)=>{(!u.institution||!u.degreeType||!u.fieldOfStudy||!u.graduationYear)&&(s[`education_${h}`]=`Education entry ${h+1} is incomplete`)}),!n.certifications||n.certifications.length===0?i.certifications="Adding certifications is recommended":n.certifications.forEach((u,h)=>{(!u.name||!u.issuingOrg||!u.issueDate)&&(s[`certification_${h}`]=`Certification entry ${h+1} is incomplete`)});const o="licenseExpirationDate";if(n[o]){const u=new Date(n[o]),h=new Date,f=new Date;f.setDate(h.getDate()+60),u<h?s[o]="Your license has expired. Please renew immediately.":u<f&&(i[o]="Your license expires within 60 days. Please renew soon.")}e==="teacher"&&(n.teachingLicense&&!ui.teachingLicense.pattern.test(n.teachingLicense)&&(s.teachingLicense=ui.teachingLicense.errorMessage),n.prcIdNumber&&n.prcIdNumber!==""&&!ui.prcId.pattern.test(n.prcIdNumber)&&(s.prcIdNumber=ui.prcId.errorMessage)),e==="therapist"&&n.licenseNumber&&!ui.licenseNumber.pattern.test(n.licenseNumber)&&(s.licenseNumber=ui.licenseNumber.errorMessage)}return n.email&&!ui.email.pattern.test(n.email)&&(s.email=ui.email.errorMessage),n.phone&&!ui.phone.pattern.test(n.phone)&&(s.phone=ui.phone.errorMessage),{isValid:Object.keys(s).length===0,errors:s,warnings:i}};function GF(n){return n.split(".").pop().replace(/([A-Z])/g," $1").replace(/^./,t=>t.toUpperCase()).trim()}const Gj=(n,e,t)=>{const[s,i]=I.useState(!0),[o,u]=I.useState(!1),[h,f]=I.useState(null),[p,g]=I.useState({}),[x,b]=I.useState({personal:!0,credentials:!0,education:!0,certifications:!0}),[S,w]=I.useState({profilePhoto:"",firstName:"",middleName:"",lastName:"",dateOfBirth:"",gender:"",phone:"",email:"",address:{street:"",city:"",state:"",zip:""},emergencyContact:{name:"",phone:""},licenseType:"",licenseNumber:"",licenseState:"",licenseIssueDate:"",licenseExpirationDate:"",teachingLicense:"",prcIdNumber:"",certificationLevel:"",yearsExperience:0,specializations:[],employmentStatus:"",educationHistory:[],certifications:[]}),[A,C]=I.useState({institution:"",degreeType:"",fieldOfStudy:"",graduationYear:"",gpa:"",certificateURL:""}),[L,z]=I.useState({name:"",issuingOrg:"",certNumber:"",issueDate:"",expirationDate:"",certificateURL:"",ceusCompleted:""});I.useEffect(()=>{(async()=>{if(n?.uid)try{const Y=await Ls.getUserById(n.uid);w({profilePhoto:Y.profilePhoto||"",firstName:Y.firstName||"",middleName:Y.middleName||"",lastName:Y.lastName||"",dateOfBirth:Y.dateOfBirth||"",gender:Y.gender||"",phone:Y.phone||"",email:Y.email||"",address:Y.address||{street:"",city:"",state:"",zip:""},emergencyContact:Y.emergencyContact||{name:"",phone:""},licenseType:Y.licenseType||"",licenseNumber:Y.licenseNumber||"",teachingLicense:Y.teachingLicense||"",prcIdNumber:Y.prcIdNumber||"",certificationLevel:Y.certificationLevel||"",licenseState:Y.licenseState||"",licenseIssueDate:Y.licenseIssueDate||"",licenseExpirationDate:Y.licenseExpirationDate||"",yearsExperience:Y.yearsExperience||0,specializations:Y.specializations||[],employmentStatus:Y.employmentStatus||"",educationHistory:Y.educationHistory||[],certifications:Y.certifications||[]})}catch(Y){console.error("Error loading profile:",Y),alert("Failed to load profile data. Please refresh the page.")}finally{i(!1)}})()},[n]);const U=(ne,Y)=>{w(ge=>({...ge,[ne]:Y})),p[ne]&&g(ge=>{const{[ne]:le,...M}=ge;return M})};return{loading:s,saving:o,uploadingFile:h,validationErrors:p,expandedSections:x,formData:S,newEducation:A,newCertification:L,handleInputChange:U,handleNestedChange:(ne,Y,ge)=>{w(le=>({...le,[ne]:{...le[ne],[Y]:ge}}))},handleSpecializationToggle:ne=>{w(Y=>({...Y,specializations:Y.specializations.includes(ne)?Y.specializations.filter(ge=>ge!==ne):[...Y.specializations,ne]}))},toggleSection:ne=>{b(Y=>({...Y,[ne]:!Y[ne]}))},handleProfilePhotoUpload:async ne=>{const Y=ne.target.files[0];if(Y){if(!FF(Y,["image/jpeg","image/jpg","image/png"])){alert("Please upload a valid image file (JPG, PNG).");return}if(!E0(Y,5)){alert("File size must be less than 5MB.");return}f("profile-photo");try{const ge=e==="teacher"?"little-lions/teachers":"little-lions/therapists",le=await co.uploadImage(Y,ge);U("profilePhoto",le)}catch(ge){console.error("Upload failed:",ge),alert("Failed to upload photo. Please try again.")}finally{f(null)}}},handleEducationCertificateUpload:async ne=>{const Y=ne.target.files[0];if(Y){if(!E0(Y,10)){alert("File size must be less than 10MB.");return}f("new-education-cert");try{const ge=e==="teacher"?"little-lions/teachers/education":"little-lions/therapists/education",le=await co.uploadImage(Y,ge),M=BF(Y.name);C(W=>({...W,certificateURL:le,institution:W.institution||M.institution,degreeType:W.degreeType||M.degreeType,fieldOfStudy:W.fieldOfStudy||M.fieldOfStudy,graduationYear:W.graduationYear||M.year}))}catch(ge){console.error("Upload failed:",ge),alert("Failed to upload certificate. Please try again.")}finally{f(null)}}},handleCertificationCertificateUpload:async ne=>{const Y=ne.target.files[0];if(Y){if(!E0(Y,10)){alert("File size must be less than 10MB.");return}f("new-cert-cert");try{const ge=e==="teacher"?"little-lions/teachers/certifications":"little-lions/therapists/certifications",le=await co.uploadImage(Y,ge);z(M=>({...M,certificateURL:le}))}catch(ge){console.error("Upload failed:",ge),alert("Failed to upload certificate. Please try again.")}finally{f(null)}}},handleNewEducationChange:(ne,Y)=>{C(ge=>({...ge,[ne]:Y}))},handleAddEducation:()=>{if(!A.institution||!A.degreeType||!A.fieldOfStudy||!A.graduationYear){alert("Please fill in all required education fields (Institution, Degree Type, Field of Study, Graduation Year).");return}const ne={id:Date.now().toString(),institution:A.institution,degreeType:A.degreeType,fieldOfStudy:A.fieldOfStudy,graduationYear:parseInt(A.graduationYear),gpa:A.gpa?parseFloat(A.gpa):null,certificateURL:A.certificateURL};w(Y=>({...Y,educationHistory:[...Y.educationHistory,ne]})),C({institution:"",degreeType:"",fieldOfStudy:"",graduationYear:"",gpa:"",certificateURL:""})},handleRemoveEducation:ne=>{window.confirm("Are you sure you want to remove this education entry?")&&w(Y=>({...Y,educationHistory:Y.educationHistory.filter((ge,le)=>le!==ne)}))},handleNewCertificationChange:(ne,Y)=>{z(ge=>({...ge,[ne]:Y}))},handleAddCertification:()=>{if(!L.name||!L.issuingOrg||!L.issueDate){alert("Please fill in all required certification fields (Name, Issuing Organization, Issue Date).");return}const ne={id:Date.now().toString(),name:L.name,issuingOrg:L.issuingOrg,certNumber:L.certNumber,issueDate:L.issueDate,expirationDate:L.expirationDate,certificateURL:L.certificateURL,ceusCompleted:L.ceusCompleted?parseInt(L.ceusCompleted):null};w(Y=>({...Y,certifications:[...Y.certifications,ne]})),z({name:"",issuingOrg:"",certNumber:"",issueDate:"",expirationDate:"",certificateURL:"",ceusCompleted:""})},handleRemoveCertification:ne=>{window.confirm("Are you sure you want to remove this certification?")&&w(Y=>({...Y,certifications:Y.certifications.filter((ge,le)=>le!==ne)}))},handleSaveProfile:async ne=>{ne.preventDefault();const{isValid:Y,errors:ge,warnings:le}=HF(S,e);if(!Y){g(ge),alert(`Please fix the following errors:
${Object.values(ge).join(`
`)}`);const M=Object.keys(ge);M.some(W=>["firstName","lastName","phone"].includes(W))?b(W=>({...W,personal:!0})):M.some(W=>["licenseType","licenseNumber","teachingLicense"].includes(W))&&b(W=>({...W,credentials:!0}));return}Object.keys(le).length>0&&console.log("Profile warnings:",le),u(!0);try{await Ls.updateUser(n.uid,{...S,profileCompleted:!0,updatedAt:new Date().toISOString()}),alert("Profile updated successfully!"),t(`/${e}/dashboard`)}catch(M){console.error("Failed to save profile:",M),alert("Failed to save profile. Please try again.")}finally{u(!1)}}}},$F=()=>{const{currentUser:n}=In(),e=Nn(),{loading:t,saving:s,uploadingFile:i,validationErrors:o,expandedSections:u,formData:h,newEducation:f,newCertification:p,handleInputChange:g,handleNestedChange:x,handleSpecializationToggle:b,toggleSection:S,handleProfilePhotoUpload:w,handleEducationCertificateUpload:A,handleCertificationCertificateUpload:C,handleNewEducationChange:L,handleAddEducation:z,handleRemoveEducation:U,handleNewCertificationChange:F,handleAddCertification:K,handleRemoveCertification:Z,handleSaveProfile:j}=Gj(n,"teacher",e);if(t)return l.jsx(No,{});const N=`${h.firstName} ${h.middleName} ${h.lastName}`.trim(),R=h.licenseExpirationDate?I_(h.licenseExpirationDate):null,O=R?{text:`License: ${R}`,className:R==="Active"?"tp-status-active":R==="Expiring Soon"?"tp-status-warning":"tp-status-expired"}:null;return l.jsx("div",{className:"tp-container",children:l.jsxs("div",{className:"tp-main-content",children:[l.jsxs("div",{className:"tp-header",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"tp-page-title",children:"Teacher Profile"}),l.jsx("p",{className:"tp-page-subtitle",children:"Complete your professional information"})]}),l.jsx("button",{className:"tp-back-btn",onClick:()=>e("/teacher/dashboard"),children:" Back to Dashboard"})]}),l.jsxs("form",{onSubmit:j,children:[l.jsx(qj,{profilePhoto:h.profilePhoto,fullName:N,role:"Teacher",statusBadge:O,onPhotoUpload:w,uploading:i==="profile-photo"}),l.jsxs("div",{className:"tp-section",children:[l.jsxs("div",{className:"tp-section-header",onClick:()=>S("personal"),children:[l.jsx("h3",{className:"tp-section-title",children:"1. Personal Information"}),l.jsx("span",{className:"tp-section-toggle",children:u.personal?"":"+"})]}),u.personal&&l.jsx("div",{className:"tp-section-content",children:l.jsx(Hj,{formData:h,validationErrors:o,onInputChange:g,onNestedChange:x})})]}),l.jsxs("div",{className:"tp-section",children:[l.jsxs("div",{className:"tp-section-header",onClick:()=>S("credentials"),children:[l.jsx("h3",{className:"tp-section-title",children:"2. Teaching Credentials"}),l.jsx("span",{className:"tp-section-toggle",children:u.credentials?"":"+"})]}),u.credentials&&l.jsx("div",{className:"tp-section-content",children:l.jsx(zF,{formData:h,validationErrors:o,licenseStatus:R,onInputChange:g,onSpecializationToggle:b})})]}),l.jsxs("div",{className:"tp-section",children:[l.jsxs("div",{className:"tp-section-header",onClick:()=>S("education"),children:[l.jsx("h3",{className:"tp-section-title",children:"3. Education History"}),l.jsx("span",{className:"tp-section-toggle",children:u.education?"":"+"})]}),u.education&&l.jsxs("div",{className:"tp-section-content",children:[l.jsx("p",{className:"tp-section-description",children:"College and Graduate Education"}),h.educationHistory.length>0&&l.jsx("div",{className:"tp-entries-list",children:h.educationHistory.map((V,B)=>l.jsx(Wm,{education:V,index:B,onRemove:U},V.id||B))}),l.jsx(Wm,{education:f,isNew:!0,onChange:L,onAdd:z,onFileUpload:A,uploading:i==="new-education-cert"})]})]}),l.jsxs("div",{className:"tp-section",children:[l.jsxs("div",{className:"tp-section-header",onClick:()=>S("certifications"),children:[l.jsx("h3",{className:"tp-section-title",children:"4. Certifications"}),l.jsx("span",{className:"tp-section-toggle",children:u.certifications?"":"+"})]}),u.certifications&&l.jsxs("div",{className:"tp-section-content",children:[h.certifications.length>0&&l.jsx("div",{className:"tp-entries-list",children:h.certifications.map((V,B)=>l.jsx(Xm,{certification:V,index:B,onRemove:Z},V.id||B))}),l.jsx(Xm,{certification:p,isNew:!0,onChange:F,onAdd:K,onFileUpload:C,uploading:i==="new-cert-cert"})]})]}),l.jsxs("div",{className:"tp-actions",children:[l.jsx("button",{type:"button",className:"tp-cancel-btn",onClick:()=>e("/teacher/dashboard"),disabled:s,children:"Cancel"}),l.jsx("button",{type:"submit",className:"tp-save-btn",disabled:s,children:s?"Saving...":"Save Profile"})]})]})]})})},R_=({role:n,roleLabel:e,avatar:t="",menuSections:s=[],forceActive:i,children:o})=>{const{currentUser:u,logout:h}=In(),f=Nn(),p=kn(),[g,x]=I.useState(!1),[b,S]=I.useState(window.innerWidth<768);I.useEffect(()=>{const L=()=>{const z=window.innerWidth<768;S(z),z||x(!1)};return window.addEventListener("resize",L),L(),()=>window.removeEventListener("resize",L)},[]),I.useEffect(()=>{x(!1)},[p.pathname]);const w=async()=>{await h(),f("/login")},A=L=>i?L===i:p.pathname===L,C=L=>{f(L),b&&x(!1)};return l.jsxs("div",{className:"page-layout",children:[b&&l.jsxs("header",{className:"page-layout__mobile-header",children:[l.jsx("button",{className:"page-layout__menu-toggle",onClick:()=>x(!g),"aria-label":"Toggle menu",children:g?"":""}),l.jsx("span",{className:"page-layout__mobile-title",children:e})]}),b&&g&&l.jsx("div",{className:"page-layout__overlay",onClick:()=>x(!1)}),l.jsxs("aside",{className:`page-layout__sidebar page-layout__sidebar--${n} ${b?g?"open":"closed":""}`,children:[l.jsxs("div",{className:"page-layout__profile",children:[l.jsx("div",{className:"page-layout__avatar",children:t}),l.jsxs("div",{className:"page-layout__profile-info",children:[l.jsx("span",{className:"page-layout__role",children:e}),l.jsx("span",{className:"page-layout__name",children:u?.firstName||n.charAt(0).toUpperCase()+n.slice(1)})]})]}),l.jsx("nav",{className:"page-layout__nav",children:s.map((L,z)=>l.jsxs("div",{className:"page-layout__nav-section",children:[L.title&&l.jsx("h3",{className:"page-layout__nav-title",children:L.title}),l.jsx("ul",{className:"page-layout__nav-list",children:L.items.filter(U=>!U.hidden).map((U,F)=>l.jsx("li",{children:l.jsxs("button",{className:`page-layout__nav-item ${A(U.path)?"active":""}`,onClick:()=>C(U.path),children:[U.icon&&l.jsx("span",{className:"page-layout__nav-icon",children:typeof U.icon=="string"?l.jsx("img",{src:U.icon,alt:""}):U.icon}),l.jsx("span",{className:"page-layout__nav-label",children:U.label}),U.showNotification&&l.jsx("span",{className:"page-layout__notification"})]})},F))})]},z))}),l.jsx("button",{className:"page-layout__logout",onClick:w,children:"LOG OUT"})]}),l.jsx("main",{className:"page-layout__main",children:o})]})},KF=l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})}),QF=l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"})}),YF=l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),j_=(n=!0)=>({role:"therapist",roleLabel:"THERAPIST",avatar:"",menuSections:[{title:"MAIN",items:[{path:"/therapist/dashboard",icon:KF,label:"MY STUDENTS"},{path:"/therapist/profile",icon:QF,label:"MY PROFILE",showNotification:!n},{path:"/staff/inquiries",icon:YF,label:"INQUIRIES"}]}]}),WF=()=>{const{currentUser:n}=In(),e=Nn(),[t,s]=I.useState(""),[i,o]=I.useState(!1),[u,h]=I.useState(null),[f,p]=I.useState([]),{students:g,isLoading:x,error:b}=cF(),[S,w]=I.useState("");I.useEffect(()=>{b&&w("Failed to load assigned students.")},[b]),I.useEffect(()=>{if(n&&n.profileCompleted===!1){const F=setTimeout(()=>{window.confirm(` Complete your professional profile to help parents know you better.

Would you like to do it now?`)&&e("/therapist/profile")},1e3);return()=>clearTimeout(F)}},[n,e]);const A=I.useMemo(()=>g.filter(F=>`${F.firstName} ${F.lastName}`.toLowerCase().includes(t.toLowerCase())),[g,t]),C=F=>(F.enrolledServices||[...F.therapyServices||[],...F.services||[]]).filter(Z=>Z.staffId===n.uid||Z.therapistId===n.uid),L=F=>{const K=C(F);if(K.length===0){alert("Error: You are not assigned to any services for this student.");return}K.length===1?z(F,K[0]):(h(F),p(K),o(!0))},z=(F,K)=>{e("/therapist/session-form",{state:{child:F,service:{id:K.serviceId,name:K.serviceName}}}),o(!1)};if(x)return l.jsx(No,{});const U=j_(n?.profileCompleted!==!1);return l.jsxs(R_,{...U,children:[l.jsxs("div",{className:"therapist-dashboard__content",children:[l.jsx("div",{className:"therapist-dashboard__header-banner",children:l.jsxs("div",{className:"therapist-dashboard__header-content",children:[l.jsxs("div",{className:"therapist-dashboard__header-text",children:[l.jsx("h1",{className:"therapist-dashboard__title",children:"MY STUDENTS"}),l.jsx("p",{className:"therapist-dashboard__subtitle",children:"Manage and Track Student Sessions"})]}),l.jsxs("div",{className:"therapist-dashboard__search-wrapper",children:[l.jsx("span",{className:"therapist-dashboard__search-icon",children:""}),l.jsx("input",{type:"text",placeholder:"Search student name...",value:t,onChange:F=>s(F.target.value),className:"therapist-dashboard__search-input"})]})]})}),S&&l.jsx("div",{className:"therapist-dashboard__error",children:S}),n?.profileCompleted===!1&&l.jsxs("div",{className:"therapist-dashboard__profile-banner",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"therapist-dashboard__profile-banner-title",children:" Complete Your Profile"}),l.jsx("p",{className:"therapist-dashboard__profile-banner-text",children:"Help parents know you better by adding your credentials, bio, and certifications."})]}),l.jsx("button",{onClick:()=>e("/therapist/profile"),className:"therapist-dashboard__profile-banner-button",children:"Complete Now "})]}),A.length===0?l.jsx("div",{className:"therapist-dashboard__empty-state",children:l.jsx("h3",{className:"therapist-dashboard__empty-state-title",children:"No students found"})}):l.jsx("div",{className:"therapist-dashboard__students-grid",children:A.map(F=>{const K=C(F);return l.jsxs("div",{className:"therapist-dashboard__student-card",children:[l.jsxs("div",{className:"therapist-dashboard__student-card-header",children:[l.jsxs("div",{className:"therapist-dashboard__student-info",children:[l.jsx("div",{className:"therapist-dashboard__student-avatar",children:F.photoUrl?l.jsx("img",{src:F.photoUrl,alt:""}):""}),l.jsxs("div",{children:[l.jsxs("h3",{className:"therapist-dashboard__student-name",children:[F.firstName," ",F.lastName]}),l.jsxs("p",{className:"therapist-dashboard__student-dob",children:["DOB: ",F.dateOfBirth]})]})]}),l.jsx("div",{className:"therapist-dashboard__services-list",children:K.map((Z,j)=>l.jsx("div",{className:"therapist-dashboard__service-tag",children:Z.serviceName},j))})]}),l.jsx("div",{className:"therapist-dashboard__student-card-footer",children:l.jsx("button",{onClick:()=>L(F),className:"therapist-dashboard__start-session-button",children:" Start Session"})})]},F.id)})})]}),i&&l.jsx("div",{className:"therapist-dashboard__modal-overlay",children:l.jsxs("div",{className:"therapist-dashboard__modal",children:[l.jsx("h3",{className:"therapist-dashboard__modal-title",children:"Select Service"}),l.jsxs("p",{className:"therapist-dashboard__modal-subtitle",children:["Which session are you starting for ",l.jsx("strong",{children:u?.firstName}),"?"]}),l.jsx("div",{className:"therapist-dashboard__modal-services",children:f.map(F=>l.jsx("button",{onClick:()=>z(u,F),className:"therapist-dashboard__modal-service-button",children:F.serviceName},F.serviceId))}),l.jsx("button",{onClick:()=>o(!1),className:"therapist-dashboard__modal-cancel-button",children:"Cancel"})]})})]})},XF=["Fine Motor Puzzles","Handwriting Practice","Sensory Bin","Scissor Skills","Peg Board","Lacing Beads","Buttoning/Zipping","Zone of Regulation","Obstacle Course","Clay/Playdough","Theraputty","Balance Beam"],JF=["Articulation Drills","Vocabulary Building","Wh- Questions","Social Stories","Following Directions","Flashcards","Oral Motor Exercises","Sequencing Cards","Reading Comprehension","Conversation Skills","Pronoun Practice","Prepositions"],ZF=["Arrived on time","Transitioned well","Separated easily","Required minimal prompting","Hand-over-hand assistance needed","Sustained attention","Frequent redirection needed","Parent observed"],ez=["Continue home program","Daily practice (10 mins)","Monitor sensory needs","Use visual schedule","Model words at home","Review goals next session"],tz=["Good Focus","Followed Instructions","Social Interaction","Eye Contact","Completed Tasks","Gentle Hands","Energetic","Happy"],nz=["Distracted","Refused Task","Crying","Aggressive","Sensory Overload","Difficulty Transitioning","Needs Prompts"],sz=["Happy ","Focused ","Active ","Tired ","Upset ","Social ","Anxious "],gA=()=>{const n=kn(),e=Nn(),{currentUser:t}=In(),{child:s,service:i}=n.state||{},o=i?.name?.toLowerCase().includes("speech"),u=i?.name?.toLowerCase().includes("occupational"),h=o||u||["Occupational Therapy","Speech Therapy","Occupational Service","Speech Service"].includes(i?.name),[f,p]=I.useState(!1),[g,x]=I.useState([]),[b,S]=I.useState([]),[w,A]=I.useState(""),[C,L]=I.useState(""),[z,U]=I.useState(""),[F,K]=I.useState(""),[Z,j]=I.useState([]),[N,R]=I.useState(""),[O,V]=I.useState([]),[B,k]=I.useState(""),[fe,me]=I.useState(""),[G,ne]=I.useState(""),Y=(H,ce,de)=>{const we=H.trim();de(we?`${we}. ${ce}. `:`${ce}. `)},ge=H=>{H.trim()&&(b.some(ce=>ce.name===H)||(S([...b,{name:H,performance:""}]),A("")))},le=H=>{S(b.filter((ce,de)=>de!==H))},M=async H=>{if(H.preventDefault(),h&&b.length===0&&!window.confirm("No activities listed. Save anyway?"))return;p(!0);const ce=[...Z,N].filter(Boolean).join(". "),de=[...O,B].filter(Boolean).join(". "),we={childId:s.id,childName:`${s.firstName} ${s.lastName}`,serviceId:i.id,serviceName:i.name,date:new Date().toISOString(),type:h?"activity":"observation",data:h?{activities:b}:{},studentReaction:h?g:[],sessionNotes:C,recommendations:z,activityPurpose:F,strengths:ce,weaknesses:de,homeActivities:fe,concerns:G};try{await JR(we),alert("Saved successfully!"),e("/therapist/dashboard")}catch(Pe){console.error("Error saving",Pe),alert("Failed to save.")}finally{p(!1)}};if(!s||!i)return l.jsx("div",{style:{padding:"2rem"},children:"No session details provided."});if(f)return l.jsx(No,{});const W=j_(t?.profileCompleted!==!1);return l.jsx(R_,{...W,children:l.jsxs("div",{className:"therapy-session-form",children:[l.jsxs("div",{style:{backgroundColor:"white",borderBottom:"1px solid #e2e8f0",padding:"1.5rem 2rem",borderRadius:"1rem",marginBottom:"1.5rem"},children:[l.jsx("button",{onClick:()=>e(-1),style:Le.backBtn,children:" Back"}),l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[l.jsxs("div",{children:[l.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:"700",color:"#0f172a",margin:"0.5rem 0"},children:h?"New Session Log":"Observation Report"}),l.jsxs("p",{style:{color:"#64748b",margin:0},children:["Student: ",l.jsxs("span",{style:{fontWeight:"600",color:"#3b82f6"},children:[s.firstName," ",s.lastName]}),"  ",l.jsx("span",{style:{fontWeight:"600",color:"#6d28d9"},children:i.name})]})]}),l.jsx("div",{style:{padding:"0.5rem 1rem",borderRadius:"2rem",backgroundColor:h?"#eff6ff":"#f0fdf4",color:h?"#2563eb":"#16a34a",fontWeight:"bold",fontSize:"0.85rem"},children:h?"Clinical Session":"Class Observation"})]})]}),l.jsx("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"0 1rem"},children:l.jsxs("form",{onSubmit:M,style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[h&&l.jsxs(l.Fragment,{children:[l.jsx("div",{style:Le.card,children:l.jsx(ph,{label:" Student's Mood",options:sz,selected:g,onChange:x,color:"purple"})}),l.jsxs("div",{style:Le.card,children:[l.jsxs("div",{style:{marginBottom:"1rem"},children:[l.jsx("label",{style:Le.label,children:" Activities Done"}),l.jsx("p",{style:Le.hint,children:"Tap to add or type your own."})]}),l.jsx("div",{style:Le.chipContainer,children:(o?JF:XF).map(H=>l.jsxs("button",{type:"button",onClick:()=>ge(H),style:Le.chipBtn(b.some(ce=>ce.name===H)),children:["+ ",H]},H))}),l.jsxs("div",{style:Le.inputRow,children:[l.jsx("input",{type:"text",value:w,onChange:H=>A(H.target.value),placeholder:"Type custom activity...",style:Le.input}),l.jsx("button",{type:"button",onClick:()=>ge(w),style:Le.addBtn,children:"Add"})]}),l.jsxs("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[b.map((H,ce)=>l.jsxs("div",{style:Le.activityItem,children:[l.jsx("div",{style:Le.badge,children:ce+1}),l.jsx("span",{style:{flex:1,fontWeight:"600",color:"#334155"},children:H.name}),l.jsx("button",{type:"button",onClick:()=>le(ce),style:Le.removeBtn,children:""})]},ce)),b.length===0&&l.jsx("p",{style:Le.emptyText,children:"No activities added."})]})]}),l.jsxs("div",{style:Le.card,children:[l.jsxs("div",{style:Le.headerRow,children:[l.jsx("label",{style:Le.label,children:" Clinical Notes"}),l.jsx(Gc,{onTranscript:H=>Y(C,H,L)})]}),l.jsx("div",{style:Le.chipContainer,children:ZF.map(H=>l.jsx("button",{type:"button",onClick:()=>Y(C,H,L),style:Le.phraseBtn,children:H},H))}),l.jsx("textarea",{rows:"5",value:C,onChange:H=>L(H.target.value),placeholder:"Session observations...",style:Le.textarea})]}),l.jsxs("div",{style:Le.card,children:[l.jsxs("div",{style:Le.headerRow,children:[l.jsx("label",{style:Le.label,children:" Recommendations / Plan"}),l.jsx(Gc,{onTranscript:H=>Y(z,H,U)})]}),l.jsx("div",{style:Le.chipContainer,children:ez.map(H=>l.jsx("button",{type:"button",onClick:()=>Y(z,H,U),style:Le.phraseBtn,children:H},H))}),l.jsx("textarea",{rows:"3",value:z,onChange:H=>U(H.target.value),placeholder:"Next steps...",style:Le.textarea})]})]}),!h&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:Le.card,children:[l.jsxs("div",{style:Le.headerRow,children:[l.jsx("label",{style:Le.label,children:" Activity Purpose"}),l.jsx(Gc,{onTranscript:H=>Y(F,H,K)})]}),l.jsx("p",{style:Le.hint,children:"What was the goal of today's session?"}),l.jsx("textarea",{rows:"2",value:F,onChange:H=>K(H.target.value),style:Le.textarea})]}),l.jsxs("div",{style:Le.card,children:[l.jsx(ph,{label:" Strengths (Observed)",options:tz,selected:Z,onChange:j,color:"green"}),l.jsxs("div",{style:Le.headerRow,children:[l.jsx("span",{style:Le.miniLabel,children:"Specific Details"}),l.jsx(Gc,{onTranscript:H=>Y(N,H,R)})]}),l.jsx("textarea",{rows:"2",value:N,onChange:H=>R(H.target.value),placeholder:"Details...",style:Le.textarea})]}),l.jsxs("div",{style:Le.card,children:[l.jsx(ph,{label:" Areas for Improvement",options:nz,selected:O,onChange:V,color:"red"}),l.jsxs("div",{style:Le.headerRow,children:[l.jsx("span",{style:Le.miniLabel,children:"Specific Details"}),l.jsx(Gc,{onTranscript:H=>Y(B,H,k)})]}),l.jsx("textarea",{rows:"2",value:B,onChange:H=>k(H.target.value),placeholder:"Details...",style:Le.textarea})]}),l.jsxs("div",{style:Le.card,children:[l.jsx("label",{style:Le.label,children:" Home Instructions"}),l.jsx("textarea",{rows:"3",value:fe,onChange:H=>me(H.target.value),style:Le.textarea,placeholder:"For parents..."}),l.jsxs("div",{style:{marginTop:"1.5rem"},children:[l.jsx("label",{style:Le.label,children:" Other Concerns"}),l.jsx("textarea",{rows:"2",value:G,onChange:H=>ne(H.target.value),style:Le.textarea,placeholder:"Behavioral notes..."})]})]})]}),l.jsx("button",{type:"submit",disabled:f,style:Le.submitBtn,children:f?"Saving Record...":" Complete Session"})]})})]})})},Le={card:{backgroundColor:"white",borderRadius:"1rem",padding:"1.5rem",boxShadow:"0 1px 2px rgba(0,0,0,0.05)",border:"1px solid #e2e8f0"},label:{fontSize:"1.1rem",fontWeight:"700",color:"#1e293b"},miniLabel:{fontSize:"0.85rem",fontWeight:"600",color:"#64748b"},hint:{fontSize:"0.9rem",color:"#64748b",margin:"0 0 0.5rem 0"},emptyText:{color:"#94a3b8",fontStyle:"italic",textAlign:"center",marginTop:"0.5rem"},textarea:{width:"100%",padding:"0.75rem",border:"1px solid #cbd5e1",borderRadius:"0.5rem",fontFamily:"inherit",boxSizing:"border-box",marginTop:"0.5rem"},input:{flex:1,padding:"0.75rem",border:"1px solid #cbd5e1",borderRadius:"0.5rem",fontSize:"1rem"},headerRow:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},chipContainer:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},inputRow:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem",borderTop:"1px dashed #e2e8f0",paddingTop:"1rem"},backBtn:{background:"none",border:"none",color:"#64748b",cursor:"pointer",fontSize:"0.9rem",fontWeight:"600",marginBottom:"0.5rem"},submitBtn:{width:"100%",padding:"1rem",backgroundColor:"#10b981",color:"white",fontSize:"1.1rem",fontWeight:"bold",border:"none",borderRadius:"0.75rem",cursor:"pointer",marginTop:"1rem",boxShadow:"0 4px 6px -1px rgba(16, 185, 129, 0.2)"},addBtn:{padding:"0 1.5rem",backgroundColor:"#6366f1",color:"white",borderRadius:"0.5rem",border:"none",fontWeight:"600",cursor:"pointer"},removeBtn:{color:"#ef4444",border:"none",background:"none",cursor:"pointer",fontSize:"1.1rem",padding:"0 0.5rem"},badge:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#e2e8f0",color:"#64748b",fontSize:"0.75rem",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center"},activityItem:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 12px",backgroundColor:"#f8fafc",borderRadius:"0.5rem",border:"1px solid #e2e8f0"},chipBtn:n=>({padding:"0.4rem 0.8rem",borderRadius:"20px",border:"1px solid #cbd5e1",backgroundColor:"white",color:"#475569",cursor:"pointer",fontSize:"0.85rem",opacity:n?.5:1,textDecoration:n?"line-through":"none",transition:"all 0.2s"}),phraseBtn:{padding:"0.3rem 0.6rem",borderRadius:"6px",border:"1px solid #bfdbfe",backgroundColor:"#eff6ff",color:"#1d4ed8",cursor:"pointer",fontSize:"0.75rem",fontWeight:"500"}},rz=({formData:n,validationErrors:e,licenseStatus:t,onInputChange:s,onSpecializationToggle:i})=>{const o=["Applied Behavior Analysis (ABA)","Speech-Language Pathology","Occupational Therapy","Physical Therapy","Feeding Therapy","Sensory Integration","Early Intervention (0-3 years)","Autism Spectrum Disorders","ADHD","Learning Disabilities","Developmental Delays","Behavioral Disorders","Social Skills Training","Parent Training & Coaching","Augmentative & Alternative Communication (AAC)","Motor Skills Development"];return l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"tp-section-description",children:"Professional license and clinical credentials"}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["License Type ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsxs("select",{className:`tp-input ${e.licenseType?"tp-input-error":""}`,value:n.licenseType,onChange:u=>s("licenseType",u.target.value),children:[l.jsx("option",{value:"",children:"Select license type"}),l.jsx("option",{value:"BCBA",children:"BCBA (Board Certified Behavior Analyst)"}),l.jsx("option",{value:"BCaBA",children:"BCaBA (Board Certified Assistant Behavior Analyst)"}),l.jsx("option",{value:"SLP",children:"SLP (Speech-Language Pathologist)"}),l.jsx("option",{value:"OT",children:"OT (Occupational Therapist)"}),l.jsx("option",{value:"PT",children:"PT (Physical Therapist)"}),l.jsx("option",{value:"LMFT",children:"LMFT (Licensed Marriage & Family Therapist)"}),l.jsx("option",{value:"LPCC",children:"LPCC (Licensed Professional Clinical Counselor)"}),l.jsx("option",{value:"Other",children:"Other"})]}),e.licenseType&&l.jsx("span",{className:"tp-error-text",children:e.licenseType})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsxs("label",{className:"tp-label",children:["License Number ",l.jsx("span",{className:"tp-required",children:"*"})]}),l.jsx("input",{type:"text",className:`tp-input ${e.licenseNumber?"tp-input-error":""}`,value:n.licenseNumber,onChange:u=>s("licenseNumber",u.target.value),placeholder:"e.g., 1-23-45678"}),e.licenseNumber&&l.jsx("span",{className:"tp-error-text",children:e.licenseNumber})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"License State/Region"}),l.jsx("input",{type:"text",className:"tp-input",value:n.licenseState,onChange:u=>s("licenseState",u.target.value),placeholder:"e.g., California, Philippines"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"License Issue Date"}),l.jsx("input",{type:"date",className:"tp-input",value:n.licenseIssueDate,onChange:u=>s("licenseIssueDate",u.target.value)})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"License Expiration Date"}),l.jsx("input",{type:"date",className:"tp-input",value:n.licenseExpirationDate,onChange:u=>s("licenseExpirationDate",u.target.value)}),t==="Expiring Soon"&&l.jsx("span",{className:"tp-warning-text",children:" License expires soon. Please renew."}),t==="Expired"&&l.jsx("span",{className:"tp-error-text",children:" License expired. Please renew immediately."})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Years of Clinical Experience"}),l.jsx("input",{type:"number",className:"tp-input",value:n.yearsExperience,onChange:u=>s("yearsExperience",parseInt(u.target.value)||0),min:"0"})]})]}),l.jsxs("div",{className:"tp-form-row",children:[l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Employment Status"}),l.jsxs("select",{className:"tp-input",value:n.employmentStatus,onChange:u=>s("employmentStatus",u.target.value),children:[l.jsx("option",{value:"",children:"Select status"}),l.jsx("option",{value:"Full-time",children:"Full-time"}),l.jsx("option",{value:"Part-time",children:"Part-time"}),l.jsx("option",{value:"Contract",children:"Contract"}),l.jsx("option",{value:"Per Diem",children:"Per Diem"})]})]}),l.jsx("div",{className:"tp-input-group"})]}),l.jsxs("div",{className:"tp-input-group",children:[l.jsx("label",{className:"tp-label",children:"Clinical Specializations"}),l.jsx("p",{className:"tp-helper-text",children:"Select all areas of expertise"}),l.jsx("div",{className:"tp-checkbox-grid",children:o.map(u=>l.jsxs("label",{className:"tp-checkbox-label",children:[l.jsx("input",{type:"checkbox",checked:n.specializations.includes(u),onChange:()=>i(u)}),l.jsx("span",{children:u})]},u))})]})]})},iz=()=>{const{currentUser:n}=In(),e=Nn(),[t,s]=I.useState(0),[i,o]=I.useState(!1),{loading:u,saving:h,uploadingFile:f,validationErrors:p,formData:g,newEducation:x,newCertification:b,handleInputChange:S,handleNestedChange:w,handleSpecializationToggle:A,handleProfilePhotoUpload:C,handleEducationCertificateUpload:L,handleCertificationCertificateUpload:z,handleNewEducationChange:U,handleAddEducation:F,handleRemoveEducation:K,handleNewCertificationChange:Z,handleAddCertification:j,handleRemoveCertification:N,handleSaveProfile:R}=Gj(n,"therapist",e),O=[{id:"personal",title:"Personal Information",icon:"1"},{id:"credentials",title:"Credentials",icon:"2"},{id:"education",title:"Education",icon:"3"},{id:"certifications",title:"Certifications",icon:"4"}],V=ge=>{ge!==t&&!i&&(o(!0),setTimeout(()=>{s(ge),setTimeout(()=>o(!1),50)},150))},B=()=>{t<O.length-1&&!i&&V(t+1)},k=()=>{t>0&&!i&&V(t-1)};if(u)return l.jsx(No,{});const fe=`${g.firstName} ${g.middleName} ${g.lastName}`.trim(),me=g.licenseExpirationDate?I_(g.licenseExpirationDate):null,G=me?{text:`License: ${me}`,className:me==="Active"?"tp-status-active":me==="Expiring Soon"?"tp-status-warning":"tp-status-expired"}:null,ne=j_(n?.profileCompleted!==!1),Y=()=>{switch(t){case 0:return l.jsxs("div",{className:"tp-step-content",children:[l.jsxs("div",{className:"tp-step-header",children:[l.jsx("h2",{className:"tp-step-title",children:"Personal Information"}),l.jsx("p",{className:"tp-step-desc",children:"Enter your basic details and contact information"})]}),l.jsx(Hj,{formData:g,validationErrors:p,onInputChange:S,onNestedChange:w})]});case 1:return l.jsxs("div",{className:"tp-step-content",children:[l.jsxs("div",{className:"tp-step-header",children:[l.jsx("h2",{className:"tp-step-title",children:"Professional Credentials"}),l.jsx("p",{className:"tp-step-desc",children:"Your license information and specializations"})]}),l.jsx(rz,{formData:g,validationErrors:p,licenseStatus:me,onInputChange:S,onSpecializationToggle:A})]});case 2:return l.jsxs("div",{className:"tp-step-content",children:[l.jsxs("div",{className:"tp-step-header",children:[l.jsx("h2",{className:"tp-step-title",children:"Education History"}),l.jsx("p",{className:"tp-step-desc",children:"Your academic background and qualifications"})]}),g.educationHistory.length>0&&l.jsx("div",{className:"tp-entries-list",children:g.educationHistory.map((ge,le)=>l.jsx(Wm,{education:ge,index:le,onRemove:K},ge.id||le))}),l.jsxs("div",{className:"tp-add-section",children:[l.jsx("h3",{className:"tp-add-title",children:"Add Education"}),l.jsx(Wm,{education:x,isNew:!0,onChange:U,onAdd:F,onFileUpload:L,uploading:f==="new-education-cert"})]})]});case 3:return l.jsxs("div",{className:"tp-step-content",children:[l.jsxs("div",{className:"tp-step-header",children:[l.jsx("h2",{className:"tp-step-title",children:"Certifications"}),l.jsx("p",{className:"tp-step-desc",children:"Professional certifications and credentials"})]}),g.certifications.length>0&&l.jsx("div",{className:"tp-entries-list",children:g.certifications.map((ge,le)=>l.jsx(Xm,{certification:ge,index:le,onRemove:N},ge.id||le))}),l.jsxs("div",{className:"tp-add-section",children:[l.jsx("h3",{className:"tp-add-title",children:"Add Certification"}),l.jsx(Xm,{certification:b,isNew:!0,onChange:Z,onAdd:j,onFileUpload:z,uploading:f==="new-cert-cert"})]})]});default:return null}};return l.jsx(R_,{...ne,forceActive:"/therapist/profile",children:l.jsxs("div",{className:"therapist-profile-main",children:[l.jsx("button",{className:"tp-back-btn",onClick:()=>e("/therapist/dashboard"),children:" Back to Dashboard"}),l.jsx("div",{className:"tp-page-header",children:l.jsx(qj,{profilePhoto:g.profilePhoto,fullName:fe||"Your Name",role:g.licenseType||"Therapist",statusBadge:G,onPhotoUpload:C,uploading:f==="profile-photo"})}),l.jsx("div",{className:"tp-step-indicator",children:O.map((ge,le)=>l.jsxs(rn.Fragment,{children:[l.jsxs("button",{type:"button",className:`tp-step-item ${le===t?"tp-step-item--active":""} ${le<t?"tp-step-item--completed":""}`,onClick:()=>V(le),children:[l.jsx("div",{className:"tp-step-circle",children:le<t?l.jsx("svg",{className:"tp-step-check",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:l.jsx("polyline",{points:"20 6 9 17 4 12"})}):l.jsx("span",{children:ge.icon})}),l.jsx("span",{className:"tp-step-label",children:ge.title})]}),le<O.length-1&&l.jsx("div",{className:`tp-step-connector ${le<t?"tp-step-connector--completed":""}`})]},ge.id))}),l.jsxs("form",{onSubmit:R,className:"tp-form",children:[l.jsx("div",{className:`tp-step-wrapper ${i?"tp-step-wrapper--animating":""}`,children:Y()}),l.jsxs("div",{className:"tp-nav-footer",children:[l.jsx("div",{className:"tp-nav-left",children:t>0&&l.jsx("button",{type:"button",className:"tp-nav-btn tp-nav-btn--secondary",onClick:k,disabled:i,children:" Previous"})}),l.jsx("div",{className:"tp-nav-center",children:l.jsxs("span",{className:"tp-nav-step-count",children:["Step ",t+1," of ",O.length]})}),l.jsx("div",{className:"tp-nav-right",children:t<O.length-1?l.jsx("button",{type:"button",className:"tp-nav-btn tp-nav-btn--primary",onClick:B,disabled:i,children:"Next "}):l.jsx("button",{type:"submit",className:"tp-nav-btn tp-nav-btn--success",disabled:h||i,children:h?"Saving...":"Save Profile"})})]})]})]})})},az=()=>{const{childId:n}=NA();return console.log("ParentChildProfile render",{childId:n}),l.jsxs("div",{className:"sp-container",children:[l.jsx(N_,{}),l.jsx(zj,{isParentView:!0,childIdFromRoute:n,hideSidebar:!0,noContainer:!0})]})},oz=()=>{const{childId:n}=NA(),e=Nn(),[t,s]=I.useState([]),[i,o]=I.useState(!0);if(I.useEffect(()=>{(async()=>{try{const x=(await Ug.getActivitiesByChild(n)).filter(b=>b.type==="therapy_session"?b.visibleToParents!==!1:!0);s(x)}catch(g){console.error("Failed to load activities",g)}finally{o(!1)}})()},[n]),i)return l.jsx(No,{});const u=({activity:p})=>{const g=new Date(p.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});return l.jsxs("div",{style:{...pt.card,borderLeft:"5px solid #4a90e2"},children:[l.jsxs("div",{style:pt.cardHeader,children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[l.jsxs("span",{style:{...pt.badge,backgroundColor:"#e3f2fd",color:"#0d47a1"},children:[" ",p.serviceName||"Therapy Session"]}),l.jsx("span",{style:pt.date,children:g})]}),l.jsxs("div",{style:pt.author,children:["Th: ",p.childName?p.childName.split(" ")[0]:""," "]})]}),l.jsxs("div",{style:pt.cardBody,children:[p.studentReaction&&p.studentReaction.length>0&&l.jsx("div",{style:{marginBottom:"15px",display:"flex",gap:"8px"},children:p.studentReaction.map((x,b)=>l.jsxs("span",{style:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",padding:"4px 8px",borderRadius:"12px",fontSize:"13px",color:"#475569"},children:[f(x)," ",x]},b))}),p.activityPurpose&&l.jsxs("div",{style:pt.section,children:[l.jsx("strong",{style:{color:"#1e293b"},children:" Purpose of Session:"}),l.jsx("p",{style:pt.text,children:p.activityPurpose})]}),p.data?.activities&&p.data.activities.length>0&&l.jsxs("div",{style:{...pt.section,backgroundColor:"#f8fafc",padding:"12px",borderRadius:"8px",border:"1px solid #f1f5f9"},children:[l.jsx("strong",{style:{display:"block",marginBottom:"8px",color:"#334155"},children:" Activities Performed:"}),l.jsx("ul",{style:{margin:0,paddingLeft:"20px"},children:p.data.activities.map((x,b)=>l.jsxs("li",{style:{marginBottom:"4px",fontSize:"14px",color:"#475569"},children:[l.jsx("span",{style:{fontWeight:"600"},children:x.name}),x.performance&&l.jsxs("span",{style:{fontSize:"12px",color:"#64748b",marginLeft:"6px",fontStyle:"italic"},children:["(",x.performance,")"]})]},b))})]}),l.jsxs("div",{style:{display:"grid",gap:"15px",marginTop:"15px",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[p.strengths&&l.jsxs("div",{style:{padding:"12px",backgroundColor:"#f0fdf4",borderRadius:"8px",border:"1px solid #bbf7d0"},children:[l.jsx("strong",{style:{color:"#166534",fontSize:"14px"},children:" Strengths"}),l.jsx("p",{style:{...pt.text,marginTop:"5px",fontSize:"14px"},children:p.strengths})]}),p.weaknesses&&l.jsxs("div",{style:{padding:"12px",backgroundColor:"#fef2f2",borderRadius:"8px",border:"1px solid #fecaca"},children:[l.jsx("strong",{style:{color:"#991b1b",fontSize:"14px"},children:" Areas for Improvement"}),l.jsx("p",{style:{...pt.text,marginTop:"5px",fontSize:"14px"},children:p.weaknesses})]})]}),p.sessionNotes&&l.jsxs("div",{style:{marginTop:"15px"},children:[l.jsx("strong",{style:{color:"#1e293b"},children:" Session Notes:"}),l.jsx("p",{style:pt.text,children:p.sessionNotes})]}),(p.homeActivities||p.recommendations)&&l.jsxs("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:"1px dashed #e2e8f0"},children:[l.jsx("strong",{style:{color:"#7c3aed"},children:" Home Plan & Recommendations:"}),p.homeActivities&&l.jsx("p",{style:pt.text,children:p.homeActivities}),p.recommendations&&l.jsx("p",{style:{...pt.text,fontStyle:"italic",color:"#64748b"},children:p.recommendations})]}),p.concerns&&l.jsxs("div",{style:{marginTop:"10px"},children:[l.jsx("span",{style:{fontSize:"12px",fontWeight:"700",color:"#f59e0b"},children:" NOTE: "}),l.jsx("span",{style:{fontSize:"13px",color:"#64748b"},children:p.concerns})]})]})]})},h=({activity:p})=>{const g=new Date(p.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});return l.jsxs("div",{style:{...pt.card,borderLeft:"5px solid #2ecc71"},children:[l.jsxs("div",{style:pt.cardHeader,children:[l.jsxs("div",{children:[l.jsx("span",{style:{...pt.badge,backgroundColor:"#e8f5e9",color:"#1b5e20"},children:" Group Class"}),l.jsx("span",{style:pt.date,children:g})]}),l.jsxs("div",{style:pt.author,children:["Tr: ",p.teacherName||"Teacher"]})]}),l.jsxs("div",{style:pt.cardBody,children:[l.jsx("h3",{style:pt.title,children:p.title}),l.jsx("h4",{style:pt.subTitle,children:p.className||"Class Activity"}),l.jsx("p",{style:pt.text,children:p.description}),p.photoUrls&&p.photoUrls.length>0&&l.jsx("div",{style:pt.photoGrid,children:p.photoUrls.map((x,b)=>l.jsx("img",{src:x,alt:"Activity",style:pt.mainPhoto,onClick:()=>window.open(x,"_blank")},b))})]})]})},f=p=>({Happy:"",Focused:"",Active:"",Tired:"",Upset:"",Social:""})[p]||"";return l.jsxs("div",{style:pt.container,children:[l.jsx("button",{style:pt.backBtn,onClick:()=>e("/parent/dashboard"),children:" Back to Dashboard"}),l.jsxs("div",{style:pt.pageHeader,children:[l.jsx("h1",{children:"Activity Journal"}),l.jsx("p",{style:{color:"#666",marginTop:"5px"},children:"Your child's progress updates and class activities."})]}),t.length===0?l.jsx("div",{style:pt.empty,children:"No activities recorded yet."}):l.jsx("div",{style:pt.feed,children:t.map(p=>l.jsx(rn.Fragment,{children:p.type==="therapy_session"||p._collection==="therapy_sessions"?l.jsx(u,{activity:p}):l.jsx(h,{activity:p})},p.id))})]})},pt={container:{padding:"20px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, sans-serif"},backBtn:{background:"none",border:"none",color:"#64748b",cursor:"pointer",fontSize:"15px",marginBottom:"20px",padding:0,fontWeight:"600"},pageHeader:{marginBottom:"30px",borderBottom:"1px solid #e2e8f0",paddingBottom:"15px"},empty:{textAlign:"center",padding:"50px",color:"#94a3b8",backgroundColor:"#f8fafc",borderRadius:"12px",border:"2px dashed #e2e8f0"},feed:{display:"flex",flexDirection:"column",gap:"25px"},card:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",overflow:"hidden",border:"1px solid #f1f5f9"},cardHeader:{padding:"15px 20px",backgroundColor:"#fff",borderBottom:"1px solid #f1f5f9",display:"flex",justifyContent:"space-between",alignItems:"center"},cardBody:{padding:"20px"},badge:{padding:"4px 10px",borderRadius:"20px",fontSize:"12px",fontWeight:"bold"},date:{color:"#64748b",fontSize:"13px",fontWeight:"500"},author:{fontSize:"13px",color:"#64748b",fontWeight:"500"},title:{margin:"0 0 5px 0",fontSize:"18px",color:"#0f172a",fontWeight:"700"},subTitle:{margin:"0 0 15px 0",fontSize:"14px",color:"#64748b",fontWeight:"500"},text:{lineHeight:"1.6",color:"#334155",fontSize:"15px",margin:0},section:{marginBottom:"15px"},photoGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"10px",marginTop:"15px"},mainPhoto:{width:"100%",height:"150px",objectFit:"cover",borderRadius:"8px",cursor:"pointer",transition:"opacity 0.2s",border:"1px solid #e2e8f0"}};var T0={exports:{}},A0,yA;function lz(){if(yA)return A0;yA=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return A0=n,A0}var C0,vA;function cz(){if(vA)return C0;vA=1;var n=lz();function e(){}function t(){}return t.resetWarningCache=e,C0=function(){function s(u,h,f,p,g,x){if(x!==n){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}s.isRequired=s;function i(){return s}var o={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:i,element:s,elementType:s,instanceOf:i,node:s,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},C0}var xA;function uz(){return xA||(xA=1,T0.exports=cz()()),T0.exports}var dz=uz();const Re=Fx(dz),D_=({isOpen:n,onClose:e,onSubmit:t,children:s,isSubmitting:i,preselectedChildId:o=null})=>{const[u,h]=I.useState({childId:"",subject:"",message:""});I.useEffect(()=>{if(n&&s.length>0){const w=o||s[0]?.id||"";h(A=>({...A,childId:w}))}},[n,s,o]);const f=w=>A=>{h(C=>({...C,[w]:A.target.value}))},p=async w=>{w.preventDefault(),!(!u.childId||!u.message.trim())&&(await t(u),g())},g=()=>{h({childId:"",subject:"",message:""})},x=()=>{g(),e()};if(!n)return null;const b=s.find(w=>w.id===u.childId),S=b?`${b.firstName} ${b.lastName}`:"";return l.jsx("div",{className:"pc-modal-overlay",onClick:x,children:l.jsxs("div",{className:"pc-modal",onClick:w=>w.stopPropagation(),children:[l.jsxs("div",{className:"pc-modal-header",children:[l.jsx("h3",{children:"Raise a Concern"}),l.jsx("button",{className:"pc-modal-close",onClick:x,"aria-label":"Close modal",children:""})]}),S&&l.jsxs("div",{className:"pc-child-context",children:[l.jsx("span",{className:"pc-child-label",children:"For:"}),l.jsx("span",{className:"pc-child-name",children:S}),s.length>1&&l.jsx("select",{className:"pc-child-switcher",value:u.childId,onChange:f("childId"),"aria-label":"Switch child",children:s.map(w=>l.jsxs("option",{value:w.id,children:[w.firstName," ",w.lastName]},w.id))})]}),l.jsxs("form",{onSubmit:p,className:"pc-form",children:[l.jsxs("div",{className:"pc-form-group",children:[l.jsx("label",{className:"pc-label",children:"Subject (Optional)"}),l.jsx("input",{className:"pc-input",placeholder:"Brief summary of your concern...",value:u.subject,onChange:f("subject"),autoFocus:!0})]}),l.jsxs("div",{className:"pc-form-group",children:[l.jsx("label",{className:"pc-label",children:"Concern Details *"}),l.jsx("textarea",{required:!0,className:"pc-textarea",placeholder:"Please describe your concern in detail...",value:u.message,onChange:f("message")})]}),l.jsxs("div",{className:"pc-form-actions",children:[l.jsx("button",{type:"submit",disabled:i||!u.message.trim(),className:"pc-send-btn",children:i?"Submitting...":"Submit Concern"}),l.jsx("button",{type:"button",onClick:x,className:"pc-cancel-btn",children:"Cancel"})]})]})]})})};D_.propTypes={isOpen:Re.bool.isRequired,onClose:Re.func.isRequired,onSubmit:Re.func.isRequired,children:Re.array.isRequired,isSubmitting:Re.bool,preselectedChildId:Re.string};D_.defaultProps={isSubmitting:!1,preselectedChildId:null};const $j=({concerns:n,selectedConcernId:e,onSelectConcern:t,onNewConcern:s,isHidden:i})=>{const o=u=>u==="waiting_for_parent"?"waiting":u==="waiting_for_staff"?"pending":"";return l.jsxs("section",{className:`pc-list-column ${i?"hidden":""}`,children:[l.jsxs("header",{className:"pc-column-header",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"pc-header-title",children:"Concerns"}),l.jsxs("span",{className:"pc-sub-text",children:[n.length," Items"]})]}),l.jsx("button",{onClick:s,className:"pc-compose-btn",title:"New Concern","aria-label":"Compose new concern",children:"+"})]}),l.jsx("div",{className:"pc-scroll-area",children:n.length===0?l.jsx(Qj,{onNewConcern:s}):n.map(u=>l.jsx(Kj,{concern:u,isActive:e===u.id,statusClass:o(u.status),onSelect:()=>t(u)},u.id))})]})},Kj=({concern:n,isActive:e,statusClass:t,onSelect:s})=>{const i=o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),s())};return l.jsxs("div",{onClick:s,className:`pc-concern-card ${e?"active":""} status-${t}`,role:"button",tabIndex:0,onKeyDown:i,children:[l.jsxs("div",{className:"pc-card-header",children:[l.jsx("span",{className:"pc-card-subject",children:n.subject}),l.jsx("span",{className:"pc-card-date",children:new Date(n.createdAt).toLocaleDateString()})]}),l.jsxs("div",{className:"pc-card-child",children:["Child: ",n.childName]})]})},Qj=({onNewConcern:n})=>l.jsxs("div",{className:"pc-empty-state",children:[l.jsx("div",{className:"pc-empty-icon",children:""}),l.jsx("p",{children:"No concerns yet"}),l.jsx("button",{onClick:n,className:"pc-secondary-btn",children:"Raise a Concern"})]});$j.propTypes={concerns:Re.array.isRequired,selectedConcernId:Re.string,onSelectConcern:Re.func.isRequired,onNewConcern:Re.func.isRequired,isHidden:Re.bool};Kj.propTypes={concern:Re.shape({id:Re.string.isRequired,subject:Re.string.isRequired,childName:Re.string.isRequired,createdAt:Re.oneOfType([Re.string,Re.number]).isRequired,status:Re.string.isRequired}).isRequired,isActive:Re.bool,statusClass:Re.string,onSelect:Re.func.isRequired};Qj.propTypes={onNewConcern:Re.func.isRequired};const Yj=({concern:n,currentUserId:e,replyText:t,onReplyChange:s,onSendReply:i,isSending:o,onBack:u,onNewConcern:h})=>n?l.jsxs("div",{className:"pc-view-container",children:[l.jsx(Wj,{concern:n}),l.jsx(Xj,{messages:n.messages,currentUserId:e}),l.jsx(Zj,{replyText:t,onReplyChange:s,onSendReply:i,isSending:o})]}):l.jsx(eD,{onNewConcern:h}),Wj=({concern:n})=>{const e=s=>s.replace(/_/g,"_"),t=n.status==="waiting_for_parent"?" Awaiting Your Response":" Pending Review";return l.jsxs("div",{className:"pc-message-header",children:[l.jsxs("div",{className:"pc-header-top",children:[l.jsx("h2",{children:n.subject}),l.jsx("span",{className:`pc-status-badge ${e(n.status)}`,children:n.status.replace(/_/g," ").toUpperCase()})]}),l.jsxs("div",{className:"pc-header-meta",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Child:"})," ",n.childName]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Status:"})," ",t]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Created:"})," ",new Date(n.createdAt).toLocaleDateString()]})]})]})},Xj=({messages:n=[],currentUserId:e})=>l.jsx("div",{className:"pc-chat-window",children:n.map((t,s)=>l.jsx(Jj,{message:t,isSent:t.senderId===e},s))}),Jj=({message:n,isSent:e})=>l.jsxs("div",{className:`pc-bubble ${e?"pc-bubble-sent":"pc-bubble-received"}`,children:[l.jsxs("div",{className:"pc-bubble-meta",children:[l.jsx("strong",{children:e?"You":n.senderName}),l.jsx("span",{children:new Date(n.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),l.jsx("p",{className:"pc-bubble-text",children:n.text})]}),Zj=({replyText:n,onReplyChange:e,onSendReply:t,isSending:s})=>l.jsxs("div",{className:"pc-reply-section",children:[l.jsx("textarea",{value:n,onChange:i=>e(i.target.value),placeholder:"Type your response...",className:"pc-reply-input"}),l.jsxs("div",{className:"pc-reply-footer",children:[l.jsx("small",{className:"pc-reply-count"}),l.jsx("button",{onClick:t,disabled:s||!n,className:"pc-send-btn",children:s?"Sending...":"Send Response"})]})]}),eD=({onNewConcern:n})=>l.jsxs("div",{className:"pc-empty-state",children:[l.jsx("div",{className:"pc-empty-icon",children:""}),l.jsx("p",{children:"Select a concern to view details"}),l.jsx("button",{onClick:n,className:"pc-secondary-btn",children:"Raise a New Concern"})]}),tD=({onClick:n})=>l.jsxs("button",{className:"pc-back-btn",onClick:n,children:[l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back"]});Yj.propTypes={concern:Re.shape({id:Re.string.isRequired,subject:Re.string.isRequired,childName:Re.string.isRequired,status:Re.string.isRequired,createdAt:Re.oneOfType([Re.string,Re.number]).isRequired,messages:Re.array}),currentUserId:Re.string.isRequired,replyText:Re.string.isRequired,onReplyChange:Re.func.isRequired,onSendReply:Re.func.isRequired,isSending:Re.bool,onBack:Re.func.isRequired,onNewConcern:Re.func.isRequired};Wj.propTypes={concern:Re.object.isRequired};Xj.propTypes={messages:Re.array,currentUserId:Re.string.isRequired};Jj.propTypes={message:Re.shape({senderId:Re.string,senderName:Re.string,text:Re.string.isRequired,timestamp:Re.oneOfType([Re.string,Re.number]).isRequired}).isRequired,isSent:Re.bool};Zj.propTypes={replyText:Re.string.isRequired,onReplyChange:Re.func.isRequired,onSendReply:Re.func.isRequired,isSending:Re.bool};Re.string.isRequired;eD.propTypes={onNewConcern:Re.func.isRequired};tD.propTypes={onClick:Re.func.isRequired};class hz{async createInquiry(e){try{return(await Su(bt(Ee,"inquiries"),{...e,status:"waiting_for_staff",createdAt:new Date().toISOString(),lastUpdated:new Date().toISOString(),messages:[{senderId:e.parentId,senderName:e.parentName,text:e.message,timestamp:new Date().toISOString(),type:"parent"}]})).id}catch(t){throw new Error("Failed to send inquiry: "+t.message)}}async addMessageToThread(e,t,s,i){try{const o=at(Ee,"inquiries",e),u={senderId:s.id,senderName:s.name,text:t,timestamp:new Date().toISOString(),type:i};await is(o,{messages:Hm(u),status:i==="staff"?"waiting_for_parent":"waiting_for_staff",lastUpdated:new Date().toISOString()})}catch(o){throw new Error("Failed to send message: "+o.message)}}async closeInquiry(e,t){try{const s=at(Ee,"inquiries",e);await is(s,{status:"closed",closedAt:new Date().toISOString(),closedBy:t})}catch(s){throw new Error("Failed to close inquiry: "+s.message)}}async getInquiriesByParent(e){const t=an(bt(Ee,"inquiries"),mn("parentId","==",e));return(await Wt(t)).docs.map(o=>({id:o.id,...o.data()})).sort((o,u)=>new Date(u.lastUpdated||u.createdAt)-new Date(o.lastUpdated||o.createdAt))}async getInquiriesByStaff(e){const t=an(bt(Ee,"inquiries"),mn("targetId","==",e));return(await Wt(t)).docs.map(o=>({id:o.id,...o.data()})).sort((o,u)=>new Date(u.lastUpdated||u.createdAt)-new Date(o.lastUpdated||o.createdAt))}}const Za=new hz,fz=n=>{const[e,t]=I.useState([]),[s,i]=I.useState([]),[o,u]=I.useState(null),[h,f]=I.useState(!0),[p,g]=I.useState(!1),[x,b]=I.useState(null),S=I.useCallback(async()=>{if(n){f(!0),b(null);try{const[U,F]=await Promise.all([Za.getInquiriesByParent(n),Vr.getChildrenByParentId(n)]);t(U),i(F)}catch(U){console.error("Failed to load concerns:",U),b("Failed to load concerns. Please try again.")}finally{f(!1)}}},[n]);I.useEffect(()=>{S()},[S]);const w=I.useCallback(async(U,F)=>{if(!U.childId||!U.message.trim())throw new Error("Child and message are required");g(!0);try{const K=s.find(N=>N.id===U.childId);if(!K)throw new Error("Child not found");const Z={parentId:F.uid,parentName:`${F.firstName} ${F.lastName}`,childId:K.id,childName:`${K.firstName} ${K.lastName}`,subject:U.subject||"General Concern",message:U.message};await Za.createInquiry(Z);const j=await Za.getInquiriesByParent(F.uid);return t(j),!0}catch(K){throw console.error("Error creating concern:",K),K}finally{g(!1)}},[s]),A=I.useCallback(async(U,F,K)=>{if(!F.trim())throw new Error("Reply text is required");if((e.find(N=>N.id===U)?.messages?.filter(N=>N.type==="parent").length||0)>=3)throw new Error("Reply limit reached");g(!0);try{await Za.addMessageToThread(U,F,K,"parent");const N=await Za.getInquiriesByParent(K.id);t(N);const R=N.find(O=>O.id===U);return u(R),!0}catch(N){throw console.error("Error sending reply:",N),N}finally{g(!1)}},[e]),C=I.useCallback(U=>{u(U)},[]),L=I.useCallback(()=>{u(null)},[]),z=I.useCallback(()=>{S()},[S]);return{concerns:e,children:s,selectedConcern:o,loading:h,sending:p,error:x,createConcern:w,sendReply:A,selectConcern:C,clearSelection:L,refresh:z}},pz=()=>{const{currentUser:n}=In(),{concerns:e,children:t,selectedConcern:s,loading:i,sending:o,createConcern:u,sendReply:h,selectConcern:f,clearSelection:p}=fz(n?.uid),[g,x]=I.useState("list"),[b,S]=I.useState(!1),[w,A]=I.useState(""),C=j=>{f(j),x("detail")},L=()=>{x("list"),p()},z=()=>{S(!0)},U=()=>{S(!1)},F=async j=>{try{await u(j,n),S(!1),x("list")}catch{alert("Error creating concern. Please try again.")}},K=async()=>{if(w.trim())try{await h(s.id,w,{id:n.uid,name:`${n.firstName} ${n.lastName}`}),A("")}catch{alert("Error sending reply. Please try again.")}};if(i)return l.jsx("div",{className:"pc-loading",children:"Loading Concerns..."});const Z=g==="detail"||s;return l.jsxs("div",{className:"pc-page-wrapper",children:[l.jsx(N_,{}),l.jsxs("main",{className:"pc-content-container",children:[l.jsx(D_,{isOpen:b,onClose:U,onSubmit:F,children:t,isSubmitting:o}),l.jsx($j,{concerns:e,selectedConcernId:s?.id,onSelectConcern:C,onNewConcern:z,isHidden:g==="detail"}),l.jsxs("section",{className:`pc-detail-column ${Z?"visible":""}`,children:[l.jsx(tD,{onClick:L}),l.jsx(Yj,{concern:s,currentUserId:n?.uid,replyText:w,onReplyChange:A,onSendReply:K,isSending:o,onBack:L,onNewConcern:z})]}),l.jsx("button",{className:"pc-mobile-fab",onClick:z,"aria-label":"Compose new concern",children:"+"})]})]})},mz=()=>{const{currentUser:n}=In(),e=Nn(),[t,s]=I.useState([]),[i,o]=I.useState(!0),[u,h]=I.useState({}),[f,p]=I.useState(null);I.useEffect(()=>{(async()=>{if(n?.uid)try{const w=await Za.getInquiriesByStaff(n.uid);s(w)}catch(w){console.error(w)}finally{o(!1)}})()},[n]);const g=S=>S?.messages?.filter(w=>w.type==="staff").length||0,x=(S,w)=>{h(A=>({...A,[S]:w}))},b=async S=>{const w=u[S],A=t.find(C=>C.id===S);if(!(!w||g(A)>=3)&&window.confirm("Send this reply? You cannot edit it later.")){p(S);try{const C={id:n.uid,name:`${n.firstName} ${n.lastName}`,role:n.role};await Za.addMessageToThread(S,w,C,"staff");const L=await Za.getInquiriesByStaff(n.uid);s(L),h(z=>({...z,[S]:""})),alert("Reply sent successfully.")}catch{alert("Failed to send reply.")}finally{p(null)}}};return i?l.jsx("div",{style:{padding:"20px"},children:"Loading inbox..."}):l.jsxs("div",{style:Qn.container,children:[l.jsxs("div",{style:Qn.header,children:[l.jsx("button",{onClick:()=>e(-1),style:Qn.backBtn,children:" Back to Dashboard"}),l.jsx("h1",{style:{margin:0,color:"#2c3e50"},children:"My Inbox "})]}),t.length===0?l.jsx("div",{style:Qn.empty,children:"No inquiries found."}):l.jsx("div",{style:Qn.list,children:t.map(S=>l.jsxs("div",{style:Qn.card(S.status),children:[l.jsxs("div",{style:Qn.cardHeader,children:[l.jsx("span",{style:Qn.statusBadge(S.status),children:S.status==="answered"?" Active Thread":" Pending Action"}),l.jsxs("span",{style:Qn.date,children:["Last Activity: ",new Date(S.lastUpdated||S.createdAt).toLocaleDateString()]})]}),l.jsxs("div",{style:Qn.content,children:[l.jsxs("div",{style:{marginBottom:"10px"},children:[l.jsx("strong",{children:"From:"})," ",S.parentName,l.jsx("br",{}),l.jsx("strong",{children:"Student:"})," ",S.studentName,l.jsx("br",{}),l.jsx("strong",{children:"Subject:"})," ",S.subject]}),l.jsx("div",{style:Qn.threadContainer,children:S.messages?.map((w,A)=>l.jsxs("div",{style:w.type==="staff"?Qn.staffBubble:Qn.parentBubble,children:[l.jsx("strong",{children:w.senderName}),l.jsx("p",{style:{margin:"5px 0"},children:w.text}),l.jsx("small",{style:{fontSize:"10px",opacity:.7},children:new Date(w.timestamp).toLocaleString()})]},A))})]}),l.jsx("div",{style:Qn.actionArea,children:g(S)<3?l.jsxs("div",{children:[l.jsx("textarea",{style:Qn.textArea,placeholder:"Type your professional reply here...",value:u[S.id]||"",onChange:w=>x(S.id,w.target.value)}),l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:["Responses used: ",g(S)," / 3"]}),l.jsx("button",{onClick:()=>b(S.id),disabled:f===S.id||!u[S.id],style:Qn.sendBtn,children:f===S.id?"Sending...":"Send Reply"})]})]}):l.jsx("div",{style:Qn.limitNotice,children:"Maximum response limit (3) reached for this inquiry."})})]},S.id))})]})},Qn={container:{padding:"20px",maxWidth:"800px",margin:"0 auto"},header:{display:"flex",alignItems:"center",gap:"20px",marginBottom:"30px"},backBtn:{background:"none",border:"1px solid #ccc",borderRadius:"4px",padding:"5px 10px",cursor:"pointer"},empty:{textAlign:"center",padding:"40px",color:"#888",backgroundColor:"#f9f9f9",borderRadius:"8px"},list:{display:"flex",flexDirection:"column",gap:"20px"},card:n=>({backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderLeft:n==="answered"?"5px solid #2ecc71":"5px solid #e74c3c",overflow:"hidden"}),cardHeader:{padding:"15px 20px",backgroundColor:"#f8f9fa",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},statusBadge:n=>({padding:"4px 10px",borderRadius:"12px",fontSize:"12px",fontWeight:"bold",backgroundColor:n==="answered"?"#e8f5e9":"#fff3e0",color:n==="answered"?"#1b5e20":"#d35400"}),date:{fontSize:"12px",color:"#888"},content:{padding:"20px"},threadContainer:{display:"flex",flexDirection:"column",gap:"15px",marginTop:"10px"},parentBubble:{alignSelf:"flex-start",backgroundColor:"#fff8e1",padding:"12px",borderRadius:"0 12px 12px 12px",border:"1px solid #ffe0b2",maxWidth:"85%"},staffBubble:{alignSelf:"flex-end",backgroundColor:"#e3f2fd",padding:"12px",borderRadius:"12px 12px 0 12px",border:"1px solid #bbdefb",maxWidth:"85%"},actionArea:{padding:"20px",backgroundColor:"#fdfdfd",borderTop:"1px solid #eee"},textArea:{width:"100%",minHeight:"80px",padding:"10px",borderRadius:"4px",border:"1px solid #ccc",marginBottom:"10px",boxSizing:"border-box"},sendBtn:{padding:"8px 20px",backgroundColor:"#4a90e2",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},limitNotice:{textAlign:"center",color:"#d32f2f",fontWeight:"bold",padding:"10px",backgroundColor:"#ffebee",borderRadius:"4px"}},We={LOGIN:"/login",CHANGE_PASSWORD:"/change-password",UNAUTHORIZED:"/unauthorized",ACTIVATE:"/activate",ADMIN_ACTIVATE:"/admin-activate",ADMIN:{DASHBOARD:"/admin/dashboard",STUDENT_PROFILE:"/admin/StudentProfile",ONE_ON_ONE:"/admin/one-on-one",PLAY_GROUP:"/admin/play-group",MANAGE_TEACHERS:"/admin/manage-teachers",MANAGE_THERAPISTS:"/admin/manage-therapists",ENROLLMENT:"/admin/enrollment",MANAGE_ADMINS:"/admin/manage-admins",PENDING_ACCOUNTS:"/admin/pending-accounts"},TEACHER:{DASHBOARD:"/teacher/dashboard",PROFILE:"/teacher/profile",PLAY_GROUP_UPLOAD:"/teacher/play-group-upload"},THERAPIST:{DASHBOARD:"/therapist/dashboard",SESSION:"/therapist/session/:studentId",SESSION_FORM:"/therapist/session-form",PROFILE:"/therapist/profile"},PARENT:{DASHBOARD:"/parent/dashboard",CHILD:"/parent/child/:childId",CONCERNS:"/parent/concerns"},STAFF:{INQUIRIES:"/staff/inquiries"}},fn={SUPER_ADMIN:"super_admin",ADMIN:"admin",TEACHER:"teacher",THERAPIST:"therapist",PARENT:"parent"},Ka={ADMINS:[fn.ADMIN,fn.SUPER_ADMIN],STAFF:[fn.TEACHER,fn.THERAPIST]},gz=n=>{switch(n){case fn.SUPER_ADMIN:case fn.ADMIN:return We.ADMIN.STUDENT_PROFILE;case fn.TEACHER:return We.TEACHER.DASHBOARD;case fn.THERAPIST:return We.THERAPIST.DASHBOARD;case fn.PARENT:return We.PARENT.DASHBOARD;default:return We.LOGIN}},yz=n=>n?gz(n.role):We.LOGIN;new GA({defaultOptions:{queries:{staleTime:1e3*60*5,cacheTime:1e3*60*30,refetchOnWindowFocus:!1,retry:1}}});const vz=()=>l.jsxs("div",{style:{padding:"50px",textAlign:"center",color:"#d32f2f"},children:[l.jsx("h1",{children:" Access Denied"}),l.jsx("p",{children:"You do not have permission to view this page."})]}),bA=({children:n})=>{const{currentUser:e}=In();return e?l.jsx(dl,{to:yz(e),replace:!0}):n},Dn=({children:n,allowedRoles:e})=>{const{currentUser:t}=In(),s=kn();return t?t.accountStatus==="pending_setup"?l.jsx(dl,{to:We.ACTIVATE,replace:!0}):t.mustChangePassword&&s.pathname!==We.CHANGE_PASSWORD?l.jsx(dl,{to:We.CHANGE_PASSWORD,replace:!0}):e&&!e.includes(t.role)?l.jsx(dl,{to:We.UNAUTHORIZED,replace:!0}):n:l.jsx(dl,{to:We.LOGIN,replace:!0,state:{from:s}})},xz=()=>{const{loading:n}=In();return n?l.jsx(No,{}):l.jsxs(P3,{children:[l.jsx(Nt,{path:We.CHANGE_PASSWORD,element:l.jsx(w9,{})}),l.jsx(Nt,{path:"/",element:l.jsx(bA,{children:l.jsx(k2,{})})}),l.jsx(Nt,{path:We.LOGIN,element:l.jsx(bA,{children:l.jsx(k2,{})})}),l.jsx(Nt,{path:We.ACTIVATE,element:l.jsx(E9,{})}),l.jsx(Nt,{path:We.ADMIN_ACTIVATE,element:l.jsx(T9,{})}),l.jsx(Nt,{path:We.ADMIN.DASHBOARD,element:l.jsx(dl,{to:We.ADMIN.STUDENT_PROFILE,replace:!0})}),l.jsx(Nt,{path:We.ADMIN.STUDENT_PROFILE,element:l.jsx(Dn,{allowedRoles:Ka.ADMINS,children:l.jsx(zj,{})})}),l.jsx(Nt,{path:We.ADMIN.ONE_ON_ONE,element:l.jsx(Dn,{allowedRoles:Ka.ADMINS,children:l.jsx(m7,{})})}),l.jsx(Nt,{path:We.ADMIN.PLAY_GROUP,element:l.jsx(Dn,{allowedRoles:Ka.ADMINS,children:l.jsx(YB,{})})}),l.jsx(Nt,{path:We.ADMIN.MANAGE_TEACHERS,element:l.jsx(Dn,{allowedRoles:Ka.ADMINS,children:l.jsx(dF,{})})}),l.jsx(Nt,{path:We.ADMIN.MANAGE_THERAPISTS,element:l.jsx(Dn,{allowedRoles:Ka.ADMINS,children:l.jsx(fF,{})})}),l.jsx(Nt,{path:We.ADMIN.ENROLLMENT,element:l.jsx(Dn,{allowedRoles:[fn.SUPER_ADMIN],children:l.jsx(TF,{})})}),l.jsx(Nt,{path:We.ADMIN.MANAGE_ADMINS,element:l.jsx(Dn,{allowedRoles:[fn.SUPER_ADMIN],children:l.jsx(CF,{})})}),l.jsx(Nt,{path:We.ADMIN.PENDING_ACCOUNTS,element:l.jsx(Dn,{allowedRoles:Ka.ADMINS,children:l.jsx(PF,{})})}),l.jsx(Nt,{path:We.TEACHER.DASHBOARD,element:l.jsx(Dn,{allowedRoles:[fn.TEACHER],children:l.jsx(VF,{})})}),l.jsx(Nt,{path:We.TEACHER.PROFILE,element:l.jsx(Dn,{allowedRoles:[fn.TEACHER],children:l.jsx($F,{})})}),l.jsx(Nt,{path:We.TEACHER.PLAY_GROUP_UPLOAD,element:l.jsx(Dn,{allowedRoles:[fn.TEACHER,...Ka.ADMINS],children:l.jsx(UF,{})})}),l.jsx(Nt,{path:We.THERAPIST.DASHBOARD,element:l.jsx(Dn,{allowedRoles:[fn.THERAPIST],children:l.jsx(WF,{})})}),l.jsx(Nt,{path:We.THERAPIST.SESSION,element:l.jsx(Dn,{allowedRoles:[fn.THERAPIST],children:l.jsx(gA,{})})}),l.jsx(Nt,{path:We.THERAPIST.SESSION_FORM,element:l.jsx(Dn,{allowedRoles:[fn.THERAPIST],children:l.jsx(gA,{})})}),l.jsx(Nt,{path:We.THERAPIST.PROFILE,element:l.jsx(Dn,{allowedRoles:[fn.THERAPIST],children:l.jsx(iz,{})})}),l.jsx(Nt,{path:We.PARENT.DASHBOARD,element:l.jsx(Dn,{allowedRoles:[fn.PARENT],children:l.jsx(az,{})})}),l.jsx(Nt,{path:We.PARENT.CHILD,element:l.jsx(Dn,{allowedRoles:[fn.PARENT],children:l.jsx(oz,{})})}),l.jsx(Nt,{path:We.PARENT.CONCERNS,element:l.jsx(Dn,{allowedRoles:[fn.PARENT],children:l.jsx(pz,{})})}),l.jsx(Nt,{path:We.STAFF.INQUIRIES,element:l.jsx(Dn,{allowedRoles:Ka.STAFF,children:l.jsx(mz,{})})}),l.jsx(Nt,{path:We.UNAUTHORIZED,element:l.jsx(vz,{})}),l.jsx(Nt,{path:"*",element:l.jsx(dl,{to:"/",replace:!0})})]})};function bz(){const n=kn();I.useEffect(()=>{const t=n.pathname.split("/").filter(Boolean).map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")||"Home";console.debug(` Page changed to: ${t}`)},[n.pathname])}function _z(){return bz(),null}function Sz(){return l.jsx(VP,{client:Bn,children:l.jsxs(rP,{children:[l.jsx(_z,{}),l.jsx(u9,{children:l.jsx(xz,{})}),!1]})})}const wz=zO.createRoot(document.getElementById("root"));wz.render(l.jsx(rn.StrictMode,{children:l.jsx(Sz,{})}));
